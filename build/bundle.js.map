{"version":3,"file":"bundle.js","sources":["../../node_modules/tinycolor2/tinycolor.js","../../node_modules/svelte/internal/index.mjs","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/gl-matrix/esm/quat.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/gl-matrix/esm/mat3.js","../../node_modules/gl-matrix/esm/vec2.js","../../src/pages/Editor/WeaveDisplay/gfx/VertexArray.js","../../src/pages/Editor/WeaveDisplay/gfx/shader/Shader.js","../../src/components/ColorPicker/Ring.js","../../src/components/ColorPicker/ColorPicker.svelte","../../src/components/ColorPicker/util.js","../../node_modules/svelte/store/index.mjs","../../src/pages/Editor/ColorPickerDialog/ColorPickerStore.js","../../src/pages/Editor/ColorPickerDialog/ColorPickerDialog.svelte","../../node_modules/precompile-intl-runtime/dist/modules/includes/utils.js","../../node_modules/precompile-intl-runtime/dist/modules/stores/dictionary.js","../../node_modules/precompile-intl-runtime/dist/modules/stores/loading.js","../../node_modules/precompile-intl-runtime/dist/modules/includes/loaderQueue.js","../../node_modules/precompile-intl-runtime/dist/modules/includes/localeGetters.js","../../node_modules/precompile-intl-runtime/dist/modules/stores/locale.js","../../node_modules/precompile-intl-runtime/dist/modules/includes/lookup.js","../../node_modules/precompile-intl-runtime/dist/modules/stores/formatters.js","../../node_modules/math-expression-evaluator/src/math_function.js","../../node_modules/math-expression-evaluator/src/lexer.js","../../node_modules/math-expression-evaluator/src/postfix.js","../../node_modules/math-expression-evaluator/src/postfix_evaluator.js","../../node_modules/math-expression-evaluator/src/formula_evaluator.js","../../src/components/NumberInput/NumberInput.svelte","../../node_modules/immer/dist/immer.esm.js","../../src/stores/undo.js","../../src/stores/Changes.js","../../src/stores/Draft.js","../../src/stores/UI.js","../../src/util/DraftUtil.js","../../src/pages/Editor/Sidebar/Subcomponents/WeaveSettings.svelte","../../src/components/TextInput/TextInput.svelte","../../src/pages/Editor/Sidebar/Subcomponents/YarnSettings.svelte","../../src/components/CheckboxInput/CheckboxInput.svelte","../../src/pages/Editor/Selection/SelectionStore.js","../../src/pages/Editor/Sidebar/Subcomponents/Repeat.svelte","../../src/util/MathUtil.js","../../src/components/Grid/Grid.svelte","../../src/pages/Editor/Sidebar/Subcomponents/PatternFill/HeddleThreadingFill.svelte","../../src/pages/Editor/Sidebar/Subcomponents/PatternFill/PatternFill.svelte","../../src/components/YarnFillTable/Repeats.svelte","../../src/components/YarnFillTable/YarnDropDown.svelte","../../src/components/YarnFillTable/YarnFillTable.svelte","../../src/pages/Editor/Sidebar/Subcomponents/WarpWeftFill.svelte","../../src/pages/Editor/Sidebar/Subcomponents/index.js","../../src/pages/Editor/Sidebar/Sidebar.svelte","../../src/components/YarnSelector/YarnSelector.svelte","../../src/components/Dropdown/Dropdown.svelte","../../src/components/Dropdown/DropdownItem.svelte","../../src/pages/Editor/Toolbar.svelte","../../src/pages/Editor/WeaveDisplay/gfx/shader/index.js","../../src/pages/Editor/WeaveDisplay/gfx/Texture.js","../../src/pages/Editor/WeaveDisplay/gfx/renderers/RendererEventTarget.js","../../src/pages/Editor/WeaveDisplay/gfx/renderers/TieupRenderer.js","../../src/pages/Editor/WeaveDisplay/gfx/renderers/GridRenderer.js","../../src/pages/Editor/WeaveDisplay/gfx/renderers/WeaveRenderer.js","../../src/pages/Editor/WeaveDisplay/gfx/renderers/ColorRowRenderer.js","../../src/pages/Editor/WeaveDisplay/gfx/TextureUtil.js","../../src/pages/Editor/WeaveDisplay/gfx/Renderer.js","../../src/pages/Editor/WeaveDisplay/WeaveDisplay.svelte","../../src/pages/Editor/Selection/SelectionComponent.svelte","../../src/pages/Editor/RulerBar.svelte","../../src/pages/Editor/InfoBar.svelte","../../src/pages/Editor/Sidebar/Dialog.svelte","../../src/pages/Editor/Editor.svelte","../../src/App.svelte","../../src/main.js","../../node_modules/precompile-intl-runtime/dist/modules/configs.js"],"sourcesContent":["// TinyColor v1.4.2\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\n(function(Math) {\n\nvar trimLeft = /^\\s+/,\n    trimRight = /\\s+$/,\n    tinyCounter = 0,\n    mathRound = Math.round,\n    mathMin = Math.min,\n    mathMax = Math.max,\n    mathRandom = Math.random;\n\nfunction tinycolor (color, opts) {\n\n    color = (color) ? color : '';\n    opts = opts || { };\n\n    // If input is already a tinycolor, return itself\n    if (color instanceof tinycolor) {\n       return color;\n    }\n    // If we are called as a function, call using new instead\n    if (!(this instanceof tinycolor)) {\n        return new tinycolor(color, opts);\n    }\n\n    var rgb = inputToRGB(color);\n    this._originalInput = color,\n    this._r = rgb.r,\n    this._g = rgb.g,\n    this._b = rgb.b,\n    this._a = rgb.a,\n    this._roundA = mathRound(100*this._a) / 100,\n    this._format = opts.format || rgb.format;\n    this._gradientType = opts.gradientType;\n\n    // Don't let the range of [0,255] come back in [0,1].\n    // Potentially lose a little bit of precision here, but will fix issues where\n    // .5 gets interpreted as half of the total, instead of half of 1\n    // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n    if (this._r < 1) { this._r = mathRound(this._r); }\n    if (this._g < 1) { this._g = mathRound(this._g); }\n    if (this._b < 1) { this._b = mathRound(this._b); }\n\n    this._ok = rgb.ok;\n    this._tc_id = tinyCounter++;\n}\n\ntinycolor.prototype = {\n    isDark: function() {\n        return this.getBrightness() < 128;\n    },\n    isLight: function() {\n        return !this.isDark();\n    },\n    isValid: function() {\n        return this._ok;\n    },\n    getOriginalInput: function() {\n      return this._originalInput;\n    },\n    getFormat: function() {\n        return this._format;\n    },\n    getAlpha: function() {\n        return this._a;\n    },\n    getBrightness: function() {\n        //http://www.w3.org/TR/AERT#color-contrast\n        var rgb = this.toRgb();\n        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n    },\n    getLuminance: function() {\n        //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        var rgb = this.toRgb();\n        var RsRGB, GsRGB, BsRGB, R, G, B;\n        RsRGB = rgb.r/255;\n        GsRGB = rgb.g/255;\n        BsRGB = rgb.b/255;\n\n        if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}\n        if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}\n        if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}\n        return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);\n    },\n    setAlpha: function(value) {\n        this._a = boundAlpha(value);\n        this._roundA = mathRound(100*this._a) / 100;\n        return this;\n    },\n    toHsv: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\n    },\n    toHsvString: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\n        return (this._a == 1) ?\n          \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\n          \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\n    },\n    toHsl: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\n    },\n    toHslString: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\n        return (this._a == 1) ?\n          \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\n          \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\n    },\n    toHex: function(allow3Char) {\n        return rgbToHex(this._r, this._g, this._b, allow3Char);\n    },\n    toHexString: function(allow3Char) {\n        return '#' + this.toHex(allow3Char);\n    },\n    toHex8: function(allow4Char) {\n        return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n    },\n    toHex8String: function(allow4Char) {\n        return '#' + this.toHex8(allow4Char);\n    },\n    toRgb: function() {\n        return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\n    },\n    toRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\n          \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\n    },\n    toPercentageRgb: function() {\n        return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\n    },\n    toPercentageRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\n          \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n    },\n    toName: function() {\n        if (this._a === 0) {\n            return \"transparent\";\n        }\n\n        if (this._a < 1) {\n            return false;\n        }\n\n        return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n    },\n    toFilter: function(secondColor) {\n        var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n        var secondHex8String = hex8String;\n        var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n\n        if (secondColor) {\n            var s = tinycolor(secondColor);\n            secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n        }\n\n        return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\n    },\n    toString: function(format) {\n        var formatSet = !!format;\n        format = format || this._format;\n\n        var formattedString = false;\n        var hasAlpha = this._a < 1 && this._a >= 0;\n        var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n\n        if (needsAlphaFormat) {\n            // Special case for \"transparent\", all other non-alpha formats\n            // will return rgba when there is transparency.\n            if (format === \"name\" && this._a === 0) {\n                return this.toName();\n            }\n            return this.toRgbString();\n        }\n        if (format === \"rgb\") {\n            formattedString = this.toRgbString();\n        }\n        if (format === \"prgb\") {\n            formattedString = this.toPercentageRgbString();\n        }\n        if (format === \"hex\" || format === \"hex6\") {\n            formattedString = this.toHexString();\n        }\n        if (format === \"hex3\") {\n            formattedString = this.toHexString(true);\n        }\n        if (format === \"hex4\") {\n            formattedString = this.toHex8String(true);\n        }\n        if (format === \"hex8\") {\n            formattedString = this.toHex8String();\n        }\n        if (format === \"name\") {\n            formattedString = this.toName();\n        }\n        if (format === \"hsl\") {\n            formattedString = this.toHslString();\n        }\n        if (format === \"hsv\") {\n            formattedString = this.toHsvString();\n        }\n\n        return formattedString || this.toHexString();\n    },\n    clone: function() {\n        return tinycolor(this.toString());\n    },\n\n    _applyModification: function(fn, args) {\n        var color = fn.apply(null, [this].concat([].slice.call(args)));\n        this._r = color._r;\n        this._g = color._g;\n        this._b = color._b;\n        this.setAlpha(color._a);\n        return this;\n    },\n    lighten: function() {\n        return this._applyModification(lighten, arguments);\n    },\n    brighten: function() {\n        return this._applyModification(brighten, arguments);\n    },\n    darken: function() {\n        return this._applyModification(darken, arguments);\n    },\n    desaturate: function() {\n        return this._applyModification(desaturate, arguments);\n    },\n    saturate: function() {\n        return this._applyModification(saturate, arguments);\n    },\n    greyscale: function() {\n        return this._applyModification(greyscale, arguments);\n    },\n    spin: function() {\n        return this._applyModification(spin, arguments);\n    },\n\n    _applyCombination: function(fn, args) {\n        return fn.apply(null, [this].concat([].slice.call(args)));\n    },\n    analogous: function() {\n        return this._applyCombination(analogous, arguments);\n    },\n    complement: function() {\n        return this._applyCombination(complement, arguments);\n    },\n    monochromatic: function() {\n        return this._applyCombination(monochromatic, arguments);\n    },\n    splitcomplement: function() {\n        return this._applyCombination(splitcomplement, arguments);\n    },\n    triad: function() {\n        return this._applyCombination(triad, arguments);\n    },\n    tetrad: function() {\n        return this._applyCombination(tetrad, arguments);\n    }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function(color, opts) {\n    if (typeof color == \"object\") {\n        var newColor = {};\n        for (var i in color) {\n            if (color.hasOwnProperty(i)) {\n                if (i === \"a\") {\n                    newColor[i] = color[i];\n                }\n                else {\n                    newColor[i] = convertToPercentage(color[i]);\n                }\n            }\n        }\n        color = newColor;\n    }\n\n    return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n\n    var rgb = { r: 0, g: 0, b: 0 };\n    var a = 1;\n    var s = null;\n    var v = null;\n    var l = null;\n    var ok = false;\n    var format = false;\n\n    if (typeof color == \"string\") {\n        color = stringInputToObject(color);\n    }\n\n    if (typeof color == \"object\") {\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n            rgb = rgbToRgb(color.r, color.g, color.b);\n            ok = true;\n            format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n            s = convertToPercentage(color.s);\n            v = convertToPercentage(color.v);\n            rgb = hsvToRgb(color.h, s, v);\n            ok = true;\n            format = \"hsv\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n            s = convertToPercentage(color.s);\n            l = convertToPercentage(color.l);\n            rgb = hslToRgb(color.h, s, l);\n            ok = true;\n            format = \"hsl\";\n        }\n\n        if (color.hasOwnProperty(\"a\")) {\n            a = color.a;\n        }\n    }\n\n    a = boundAlpha(a);\n\n    return {\n        ok: ok,\n        format: color.format || format,\n        r: mathMin(255, mathMax(rgb.r, 0)),\n        g: mathMin(255, mathMax(rgb.g, 0)),\n        b: mathMin(255, mathMax(rgb.b, 0)),\n        a: a\n    };\n}\n\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b){\n    return {\n        r: bound01(r, 255) * 255,\n        g: bound01(g, 255) * 255,\n        b: bound01(b, 255) * 255\n    };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if(max == min) {\n        h = s = 0; // achromatic\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n\n        h /= 6;\n    }\n\n    return { h: h, s: s, l: l };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n    var r, g, b;\n\n    h = bound01(h, 360);\n    s = bound01(s, 100);\n    l = bound01(l, 100);\n\n    function hue2rgb(p, q, t) {\n        if(t < 0) t += 1;\n        if(t > 1) t -= 1;\n        if(t < 1/6) return p + (q - p) * 6 * t;\n        if(t < 1/2) return q;\n        if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n        return p;\n    }\n\n    if(s === 0) {\n        r = g = b = l; // achromatic\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1/3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1/3);\n    }\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, v = max;\n\n    var d = max - min;\n    s = max === 0 ? 0 : d / max;\n\n    if(max == min) {\n        h = 0; // achromatic\n    }\n    else {\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, v: v };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\n function hsvToRgb(h, s, v) {\n\n    h = bound01(h, 360) * 6;\n    s = bound01(s, 100);\n    v = bound01(v, 100);\n\n    var i = Math.floor(h),\n        f = h - i,\n        p = v * (1 - s),\n        q = v * (1 - f * s),\n        t = v * (1 - (1 - f) * s),\n        mod = i % 6,\n        r = [v, q, p, p, t, v][mod],\n        g = [t, v, v, q, p, p][mod],\n        b = [p, p, t, v, v, q][mod];\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    // Return a 3 character hex if possible\n    if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16)),\n        pad2(convertDecimalToHex(a))\n    ];\n\n    // Return a 4 character hex if possible\n    if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n\n    var hex = [\n        pad2(convertDecimalToHex(a)),\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n    if (!color1 || !color2) { return false; }\n    return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\n\ntinycolor.random = function() {\n    return tinycolor.fromRatio({\n        r: mathRandom(),\n        g: mathRandom(),\n        b: mathRandom()\n    });\n};\n\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction desaturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s -= amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction saturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s += amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction greyscale(color) {\n    return tinycolor(color).desaturate(100);\n}\n\nfunction lighten (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l += amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\nfunction brighten(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var rgb = tinycolor(color).toRgb();\n    rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\n    rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\n    rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\n    return tinycolor(rgb);\n}\n\nfunction darken (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l -= amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction spin(color, amount) {\n    var hsl = tinycolor(color).toHsl();\n    var hue = (hsl.h + amount) % 360;\n    hsl.h = hue < 0 ? 360 + hue : hue;\n    return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction complement(color) {\n    var hsl = tinycolor(color).toHsl();\n    hsl.h = (hsl.h + 180) % 360;\n    return tinycolor(hsl);\n}\n\nfunction triad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction tetrad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction splitcomplement(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\n        tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\n    ];\n}\n\nfunction analogous(color, results, slices) {\n    results = results || 6;\n    slices = slices || 30;\n\n    var hsl = tinycolor(color).toHsl();\n    var part = 360 / slices;\n    var ret = [tinycolor(color)];\n\n    for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\n        hsl.h = (hsl.h + part) % 360;\n        ret.push(tinycolor(hsl));\n    }\n    return ret;\n}\n\nfunction monochromatic(color, results) {\n    results = results || 6;\n    var hsv = tinycolor(color).toHsv();\n    var h = hsv.h, s = hsv.s, v = hsv.v;\n    var ret = [];\n    var modification = 1 / results;\n\n    while (results--) {\n        ret.push(tinycolor({ h: h, s: s, v: v}));\n        v = (v + modification) % 1;\n    }\n\n    return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function(color1, color2, amount) {\n    amount = (amount === 0) ? 0 : (amount || 50);\n\n    var rgb1 = tinycolor(color1).toRgb();\n    var rgb2 = tinycolor(color2).toRgb();\n\n    var p = amount / 100;\n\n    var rgba = {\n        r: ((rgb2.r - rgb1.r) * p) + rgb1.r,\n        g: ((rgb2.g - rgb1.g) * p) + rgb1.g,\n        b: ((rgb2.b - rgb1.b) * p) + rgb1.b,\n        a: ((rgb2.a - rgb1.a) * p) + rgb1.a\n    };\n\n    return tinycolor(rgba);\n};\n\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function(color1, color2) {\n    var c1 = tinycolor(color1);\n    var c2 = tinycolor(color2);\n    return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function(color1, color2, wcag2) {\n    var readability = tinycolor.readability(color1, color2);\n    var wcag2Parms, out;\n\n    out = false;\n\n    wcag2Parms = validateWCAG2Parms(wcag2);\n    switch (wcag2Parms.level + wcag2Parms.size) {\n        case \"AAsmall\":\n        case \"AAAlarge\":\n            out = readability >= 4.5;\n            break;\n        case \"AAlarge\":\n            out = readability >= 3;\n            break;\n        case \"AAAsmall\":\n            out = readability >= 7;\n            break;\n    }\n    return out;\n\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function(baseColor, colorList, args) {\n    var bestColor = null;\n    var bestScore = 0;\n    var readability;\n    var includeFallbackColors, level, size ;\n    args = args || {};\n    includeFallbackColors = args.includeFallbackColors ;\n    level = args.level;\n    size = args.size;\n\n    for (var i= 0; i < colorList.length ; i++) {\n        readability = tinycolor.readability(baseColor, colorList[i]);\n        if (readability > bestScore) {\n            bestScore = readability;\n            bestColor = tinycolor(colorList[i]);\n        }\n    }\n\n    if (tinycolor.isReadable(baseColor, bestColor, {\"level\":level,\"size\":size}) || !includeFallbackColors) {\n        return bestColor;\n    }\n    else {\n        args.includeFallbackColors=false;\n        return tinycolor.mostReadable(baseColor,[\"#fff\", \"#000\"],args);\n    }\n};\n\n\n// Big List of Colors\n// ------------------\n// <http://www.w3.org/TR/css3-color/#svg-color>\nvar names = tinycolor.names = {\n    aliceblue: \"f0f8ff\",\n    antiquewhite: \"faebd7\",\n    aqua: \"0ff\",\n    aquamarine: \"7fffd4\",\n    azure: \"f0ffff\",\n    beige: \"f5f5dc\",\n    bisque: \"ffe4c4\",\n    black: \"000\",\n    blanchedalmond: \"ffebcd\",\n    blue: \"00f\",\n    blueviolet: \"8a2be2\",\n    brown: \"a52a2a\",\n    burlywood: \"deb887\",\n    burntsienna: \"ea7e5d\",\n    cadetblue: \"5f9ea0\",\n    chartreuse: \"7fff00\",\n    chocolate: \"d2691e\",\n    coral: \"ff7f50\",\n    cornflowerblue: \"6495ed\",\n    cornsilk: \"fff8dc\",\n    crimson: \"dc143c\",\n    cyan: \"0ff\",\n    darkblue: \"00008b\",\n    darkcyan: \"008b8b\",\n    darkgoldenrod: \"b8860b\",\n    darkgray: \"a9a9a9\",\n    darkgreen: \"006400\",\n    darkgrey: \"a9a9a9\",\n    darkkhaki: \"bdb76b\",\n    darkmagenta: \"8b008b\",\n    darkolivegreen: \"556b2f\",\n    darkorange: \"ff8c00\",\n    darkorchid: \"9932cc\",\n    darkred: \"8b0000\",\n    darksalmon: \"e9967a\",\n    darkseagreen: \"8fbc8f\",\n    darkslateblue: \"483d8b\",\n    darkslategray: \"2f4f4f\",\n    darkslategrey: \"2f4f4f\",\n    darkturquoise: \"00ced1\",\n    darkviolet: \"9400d3\",\n    deeppink: \"ff1493\",\n    deepskyblue: \"00bfff\",\n    dimgray: \"696969\",\n    dimgrey: \"696969\",\n    dodgerblue: \"1e90ff\",\n    firebrick: \"b22222\",\n    floralwhite: \"fffaf0\",\n    forestgreen: \"228b22\",\n    fuchsia: \"f0f\",\n    gainsboro: \"dcdcdc\",\n    ghostwhite: \"f8f8ff\",\n    gold: \"ffd700\",\n    goldenrod: \"daa520\",\n    gray: \"808080\",\n    green: \"008000\",\n    greenyellow: \"adff2f\",\n    grey: \"808080\",\n    honeydew: \"f0fff0\",\n    hotpink: \"ff69b4\",\n    indianred: \"cd5c5c\",\n    indigo: \"4b0082\",\n    ivory: \"fffff0\",\n    khaki: \"f0e68c\",\n    lavender: \"e6e6fa\",\n    lavenderblush: \"fff0f5\",\n    lawngreen: \"7cfc00\",\n    lemonchiffon: \"fffacd\",\n    lightblue: \"add8e6\",\n    lightcoral: \"f08080\",\n    lightcyan: \"e0ffff\",\n    lightgoldenrodyellow: \"fafad2\",\n    lightgray: \"d3d3d3\",\n    lightgreen: \"90ee90\",\n    lightgrey: \"d3d3d3\",\n    lightpink: \"ffb6c1\",\n    lightsalmon: \"ffa07a\",\n    lightseagreen: \"20b2aa\",\n    lightskyblue: \"87cefa\",\n    lightslategray: \"789\",\n    lightslategrey: \"789\",\n    lightsteelblue: \"b0c4de\",\n    lightyellow: \"ffffe0\",\n    lime: \"0f0\",\n    limegreen: \"32cd32\",\n    linen: \"faf0e6\",\n    magenta: \"f0f\",\n    maroon: \"800000\",\n    mediumaquamarine: \"66cdaa\",\n    mediumblue: \"0000cd\",\n    mediumorchid: \"ba55d3\",\n    mediumpurple: \"9370db\",\n    mediumseagreen: \"3cb371\",\n    mediumslateblue: \"7b68ee\",\n    mediumspringgreen: \"00fa9a\",\n    mediumturquoise: \"48d1cc\",\n    mediumvioletred: \"c71585\",\n    midnightblue: \"191970\",\n    mintcream: \"f5fffa\",\n    mistyrose: \"ffe4e1\",\n    moccasin: \"ffe4b5\",\n    navajowhite: \"ffdead\",\n    navy: \"000080\",\n    oldlace: \"fdf5e6\",\n    olive: \"808000\",\n    olivedrab: \"6b8e23\",\n    orange: \"ffa500\",\n    orangered: \"ff4500\",\n    orchid: \"da70d6\",\n    palegoldenrod: \"eee8aa\",\n    palegreen: \"98fb98\",\n    paleturquoise: \"afeeee\",\n    palevioletred: \"db7093\",\n    papayawhip: \"ffefd5\",\n    peachpuff: \"ffdab9\",\n    peru: \"cd853f\",\n    pink: \"ffc0cb\",\n    plum: \"dda0dd\",\n    powderblue: \"b0e0e6\",\n    purple: \"800080\",\n    rebeccapurple: \"663399\",\n    red: \"f00\",\n    rosybrown: \"bc8f8f\",\n    royalblue: \"4169e1\",\n    saddlebrown: \"8b4513\",\n    salmon: \"fa8072\",\n    sandybrown: \"f4a460\",\n    seagreen: \"2e8b57\",\n    seashell: \"fff5ee\",\n    sienna: \"a0522d\",\n    silver: \"c0c0c0\",\n    skyblue: \"87ceeb\",\n    slateblue: \"6a5acd\",\n    slategray: \"708090\",\n    slategrey: \"708090\",\n    snow: \"fffafa\",\n    springgreen: \"00ff7f\",\n    steelblue: \"4682b4\",\n    tan: \"d2b48c\",\n    teal: \"008080\",\n    thistle: \"d8bfd8\",\n    tomato: \"ff6347\",\n    turquoise: \"40e0d0\",\n    violet: \"ee82ee\",\n    wheat: \"f5deb3\",\n    white: \"fff\",\n    whitesmoke: \"f5f5f5\",\n    yellow: \"ff0\",\n    yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n    var flipped = { };\n    for (var i in o) {\n        if (o.hasOwnProperty(i)) {\n            flipped[o[i]] = i;\n        }\n    }\n    return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n    a = parseFloat(a);\n\n    if (isNaN(a) || a < 0 || a > 1) {\n        a = 1;\n    }\n\n    return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n    if (isOnePointZero(n)) { n = \"100%\"; }\n\n    var processPercent = isPercentage(n);\n    n = mathMin(max, mathMax(0, parseFloat(n)));\n\n    // Automatically convert percentage into number\n    if (processPercent) {\n        n = parseInt(n * max, 10) / 100;\n    }\n\n    // Handle floating point rounding errors\n    if ((Math.abs(n - max) < 0.000001)) {\n        return 1;\n    }\n\n    // Convert into [0, 1] range if it isn't already\n    return (n % max) / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n    return mathMin(1, mathMax(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n    return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n    return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n    return typeof n === \"string\" && n.indexOf('%') != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n    return c.length == 1 ? '0' + c : '' + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n    if (n <= 1) {\n        n = (n * 100) + \"%\";\n    }\n\n    return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n    return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n    return (parseIntFromHex(h) / 255);\n}\n\nvar matchers = (function() {\n\n    // <http://www.w3.org/TR/css3-values/#integers>\n    var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n    // <http://www.w3.org/TR/css3-values/#number-value>\n    var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n    // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n    var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n    // Actual matching.\n    // Parentheses and commas are optional, but not required.\n    // Whitespace can take the place of commas or opening paren\n    var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n    var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n\n    return {\n        CSS_UNIT: new RegExp(CSS_UNIT),\n        rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n        rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n        hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n        hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n        hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n        hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n    };\n})();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n    return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n\n    color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\n    var named = false;\n    if (names[color]) {\n        color = names[color];\n        named = true;\n    }\n    else if (color == 'transparent') {\n        return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\n    }\n\n    // Try to match string input using regular expressions.\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n    // Just return an object and let the conversion functions handle that.\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\n    var match;\n    if ((match = matchers.rgb.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3] };\n    }\n    if ((match = matchers.rgba.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsl.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3] };\n    }\n    if ((match = matchers.hsla.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsv.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3] };\n    }\n    if ((match = matchers.hsva.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\n    }\n    if ((match = matchers.hex8.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            a: convertHexToDecimal(match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex6.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n    if ((match = matchers.hex4.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            a: convertHexToDecimal(match[4] + '' + match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex3.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n\n    return false;\n}\n\nfunction validateWCAG2Parms(parms) {\n    // return valid WCAG2 parms for isReadable.\n    // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n    var level, size;\n    parms = parms || {\"level\":\"AA\", \"size\":\"small\"};\n    level = (parms.level || \"AA\").toUpperCase();\n    size = (parms.size || \"small\").toLowerCase();\n    if (level !== \"AA\" && level !== \"AAA\") {\n        level = \"AA\";\n    }\n    if (size !== \"small\" && size !== \"large\") {\n        size = \"small\";\n    }\n    return {\"level\":level, \"size\":size};\n}\n\n// Node: Export function\nif (typeof module !== \"undefined\" && module.exports) {\n    module.exports = tinycolor;\n}\n// AMD/requirejs: Define the module\nelse if (typeof define === 'function' && define.amd) {\n    define(function () {return tinycolor;});\n}\n// Browser: Expose to window\nelse {\n    window.tinycolor = tinycolor;\n}\n\n})(Math);\n","function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentElement !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration();\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    select.selectedIndex = -1; // no option should be selected\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, bubbles = false) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor() {\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes) {\n        super();\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = append_empty_stylesheet(node).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction escape_attribute_value(value) {\n    return typeof value === 'string' ? escape(value) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.43.0' }, detail), true));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, src_url_equal, start_hydrating, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","export default class VertexArray {\n  constructor(gl, vertexData, indexData, attrs, drawMode = gl.TRIANGLES) {\n    this.gl = gl;\n    if (vertexData instanceof Float32Array) {\n      this.vertexData = vertexData;\n    } else {\n      this.vertexData = new Float32Array(vertexData);\n    }\n\n    if (indexData instanceof Uint16Array) {\n      this.indexData = indexData;\n    } else {\n      this.indexData = new Uint16Array(indexData);\n    }\n\n    this.drawMode = drawMode;\n    this.attrs = attrs;\n    this.initialize(gl);\n  }\n\n  initialize(gl) {\n    this.vertBuf = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertBuf);\n    gl.bufferData(gl.ARRAY_BUFFER, this.vertexData, gl.STATIC_DRAW);\n    if (this.indexData !== undefined) {\n      this.indexBuf = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indexData, gl.STATIC_DRAW);\n    }\n    this.isInitialized = true;\n  }\n\n  bind() {\n    if (this.isInitialized !== true) {\n      console.error('Tried to use uninitialized VertexArray!');\n      return;\n    }\n    const attrSum = this.attrs.reduce((a, b) => a + b);\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertBuf);\n    if (this.indexData !== undefined) {\n      this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\n    }\n    let pointer = 0;\n    for (let i = 0; i < this.attrs.length; i++) {\n      this.gl.vertexAttribPointer(i, this.attrs[i], this.gl.FLOAT, false, attrSum * 4, pointer * 4);\n      this.gl.enableVertexAttribArray(i);\n      pointer += this.attrs[i];\n    }\n  }\n\n  draw() {\n    this.gl.drawElements(this.drawMode, this.indexData.length, this.gl.UNSIGNED_SHORT, 0);\n  }\n\n  unbind() {\n    for (let i = 0; i < this.attrs.length; i++) {\n      this.gl.disableVertexAttribArray(i);\n    }\n    if (this.indexData !== undefined) {\n      this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, null);\n    }\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);\n  }\n\n  free() {\n    this.gl.deleteBuffer(this.vertBuf);\n    if(this.indexBuf) {\n      this.gl.deleteBuffer(this.indexBuf);\n    }\n  }\n}\n","export default class Shader {\n  constructor(src) {\n    this.vert = src.vert;\n    this.frag = src.frag;\n    this.attributes = this.getAttributes(src.vert);\n  }\n\n  getAttributes(source) {\n    return source\n      .split('\\n')\n      .filter(row => row.includes('attribute'))\n      .map(a => a.substring(a.lastIndexOf(' ') + 1, a.length - 1));\n  }\n\n  bind() {\n    if(!this.compiled) {\n      throw new Error(\"Can't bind uncompiled shader\");\n    }\n    this.gl.useProgram(this.program);\n  }\n\n  compile(gl) {\n    this.gl = gl;\n    if (!this.compiled) {\n      this.uniforms = {};\n      const vertProgram = this.compileShader(this.gl, this.vert, gl.VERTEX_SHADER);\n      const fragProgram = this.compileShader(this.gl, this.frag, gl.FRAGMENT_SHADER);\n      this.program = this.createShaderProgram(this.gl, vertProgram, fragProgram);\n      this.compiled = true;\n    }\n  }\n\n  isCompiled() {\n    return this.compiled;\n  }\n\n  compileShader(gl, src, type) {\n    const shader = gl.createShader(type);\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      console.error(`Error when compiling shader: ${gl.getShaderInfoLog(shader)}`);\n      console.groupCollapsed('Shader source');\n      console.log(src);\n      console.groupEnd();\n      return null;\n    }\n    return shader;\n  }\n\n  createShaderProgram(gl, vertexShader, fragmentShader) {\n    const shaderProgram = gl.createProgram();\n    gl.attachShader(shaderProgram, vertexShader);\n    gl.attachShader(shaderProgram, fragmentShader);\n\n    for(let i = 0; i < this.attributes.length; i++) {\n      gl.bindAttribLocation(shaderProgram, i, this.attributes[i]);\n    }\n\n    gl.linkProgram(shaderProgram);\n    if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n      let info = gl.getProgramInfoLog(shaderProgram);\n      console.error(`Error compiling shader: \\n\\n${info}`);\n    }\n    gl.useProgram(shaderProgram);\n    return shaderProgram;\n  }\n\n\n  getUniformHandle(uniformName) {\n    if(this.uniforms[uniformName] === undefined) {\n      let handle = this.gl.getUniformLocation(this.program, uniformName);\n      this.uniforms[uniformName] = handle;\n    }\n    return this.uniforms[uniformName];\n  }\n\n  setBool(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1i(uniformHandle, value?1:0);\n  }\n\n  setInt(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1i(uniformHandle, value);\n  }\n\n  setFloat(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1f(uniformHandle, value);\n  }\n\n  setVec2(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform2fv(uniformHandle, value);\n  }\n\n  setVec3(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform3fv(uniformHandle, value);\n  }\n\n  setVec4(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform4fv(uniformHandle, value);\n  }\n\n  setMat3(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniformMatrix3fv(uniformHandle, false, value);\n  }\n\n  setMat4(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniformMatrix4fv(uniformHandle, false, value);\n  }\n\n  setSampler2D(uniformName, value) {\n    this.setInt(uniformName, value);\n  }\n\n  unbind() {\n    this.gl.useProgram(null);\n  }\n}\n\n\n","import VertexArray from 'pages/Editor/WeaveDisplay/gfx/VertexArray';\n\nfunction generateGeometry(gl, numPoints, innerRadius) {\n  let points = [0, 0, 0];\n  let indices = [];\n  for (let i = 0; i < (numPoints + 1) * 2; i++) {\n    let rad = (Math.PI / numPoints) * i;\n    let justify = [\n      ((1.0 - innerRadius) / 2) * Math.sin(rad),\n      ((1.0 - innerRadius) / 2) * Math.cos(rad),\n    ];\n\n    if (i % 2 === 0) {\n      points.push(Math.sin(rad) + justify[0]);\n      points.push(Math.cos(rad) + justify[1]);\n    } else {\n      points.push(Math.sin(rad) * innerRadius + justify[0]);\n      points.push(Math.cos(rad) * innerRadius + justify[1]);\n    }\n    points.push(0);\n  }\n\n  for (let i = 0; i < numPoints; i++) {\n    [3, 2, 1, 3, 4, 2].map((n) => n + i * 2).forEach((n) => indices.push(n));\n  }\n  return new VertexArray(gl, points, indices, [3], gl.TRIANGLES);\n}\n\nexport default class Ring {\n  constructor(gl, points = 6, innerRadius = 0.5) {\n    this.points = points;\n    this.geometry = generateGeometry(gl, points, innerRadius);\n  }\n\n  bind(gl) {\n    this.geometry.bind(gl);\n  }\n\n  unbind(gl) {\n    this.geometry.bind(gl);\n  }\n\n  draw(gl) {\n    this.geometry.draw(gl);\n  }\n}\n","<script>\n  import { onMount, onDestroy } from 'svelte';\n  import {\n    fromRotationTranslationScale as mat4FromRotationTranslationScale,\n    create as mat4Create,\n    translate as mat4Translate,\n    rotate as mat4Rotate,\n    scale as mat4Scale,\n    fromQuat as mat4FromQuat,\n    multiply as mat4Multiply,\n  } from 'gl-matrix/mat4';\n  import {\n    setAxisAngle as quatSetAxisAngle,\n    create as quatCreate,\n  } from 'gl-matrix/quat';\n  import { create as vec3Create } from 'gl-matrix/vec3';\n  import { vec2 } from 'gl-matrix';\n  import tinycolor from 'tinycolor2';\n\n  import { getAngle } from './util';\n  import colorWheelVert from './colorWheel.vert';\n  import colorWheelFrag from './colorWheel.frag';\n  import satValVert from './satVal.vert';\n  import satValFrag from './satVal.frag';\n  import solidFrag from './solid.frag';\n  import solidVert from './solid.vert';\n  import VertexArray from 'pages/Editor/WeaveDisplay/gfx/VertexArray';\n  import Shader from 'pages/Editor/WeaveDisplay/gfx/shader/Shader';\n  import Ring from './Ring';\n\n  let canvas;\n  let root = document.body;\n  let gl;\n  let colorWheelShader;\n  let satValShader;\n  let solidShader;\n  let quad;\n  let triP;\n  let triPT;\n  let triangle;\n  let ring;\n  let triangleModel;\n\n  function initCanvas() {\n    gl = canvas.getContext('webgl', {\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: true,\n    });\n    gl.clearColor(0, 0, 0, 1.0);\n    colorWheelShader = new Shader({\n      frag: colorWheelFrag,\n      vert: colorWheelVert,\n    });\n    colorWheelShader.compile(gl);\n    satValShader = new Shader({ frag: satValFrag, vert: satValVert });\n    satValShader.compile(gl);\n    solidShader = new Shader({ frag: solidFrag, vert: solidVert });\n    solidShader.compile(gl);\n\n    quad = new VertexArray(\n      gl,\n      [1, 1, -1, 1, -1, -1, 1, -1],\n      [1, 0, 2, 2, 0, 3],\n      [2]\n    );\n    let t = [\n      [0, 1.0],\n      [0.8660253882408142, -0.5],\n      [-0.8660253882408142, -0.5],\n    ];\n    triP = t;\n    triPT = [vec2.create(), vec2.create(), vec2.create()];\n    let uv = [\n      [1.0, 0.0, 0.0],\n      [0.0, 1.0, 0.0],\n      [0.0, 0.0, 1.0],\n    ];\n    triangle = new VertexArray(\n      gl,\n      [\n        t[0][0],\n        t[0][1],\n        uv[0][0],\n        uv[0][1],\n        uv[0][2],\n        t[1][0],\n        t[1][1],\n        uv[1][0],\n        uv[1][1],\n        uv[1][2],\n        t[2][0],\n        t[2][1],\n        uv[2][0],\n        uv[2][1],\n        uv[2][2],\n      ],\n      [1, 0, 2],\n      [2, 3]\n    );\n    ring = new Ring(gl, 24, 0.6);\n    triangleModel = mat4Create();\n    canvas.addEventListener('pointerdown', onCanvasMouseDown);\n    canvas.addEventListener('pointerup', onCanvasMouseUp);\n  }\n\n  let mouseDown = false;\n  let colorWheelToggle = false;\n  let triangleToggle = false;\n\n  let state = {};\n\n  function onHexInputChange(event) {\n    let str = event.target.value;\n    if (str[0] === '#') {\n      str = str.substr(1);\n    }\n    let color = tinycolor(`#${str}`);\n    if (str.length === 6 && color.isValid()) {\n      let hsv = color.toHsv();\n      updateColor(hsv.h / 360, hsv.s, hsv.v);\n    }\n  }\n\n  function onCanvasMouseDown(event) {\n    event.preventDefault();\n    root.addEventListener('pointermove', onCanvasMouseMove);\n    mouseDown = true;\n    let rect = canvas.getBoundingClientRect();\n    let coords = [\n      2.0 * ((event.clientX - rect.x) / rect.width - 0.5),\n      2.0 * (-(event.clientY - rect.y) / rect.height + 0.5),\n    ];\n    let hsv = handleInput(coords);\n    if (hsv === undefined) {\n      return;\n    } else {\n      let { hue, saturation, value } = hsv;\n      updateColor(hue, saturation, value);\n    }\n  }\n\n  function onCanvasMouseMove(event) {\n    event.preventDefault();\n    if (mouseDown === true && event.buttons === 0) {\n      mouseDown = false;\n      colorWheelToggle = false;\n      triangleToggle = false;\n      root.removeEventListener('mousemove', onCanvasMouseMove);\n      return;\n    }\n    if (mouseDown) {\n      let rect = canvas.getBoundingClientRect();\n      let coords = [\n        2.0 * ((event.clientX - rect.x) / rect.width - 0.5),\n        2.0 * (-(event.clientY - rect.y) / rect.height + 0.5),\n      ];\n      let hsv = handleInput(coords);\n      if (hsv === undefined) {\n        return;\n      } else {\n        let { hue, saturation, value } = hsv;\n        updateColor(hue, saturation, value);\n      }\n    }\n  }\n\n  function onCanvasMouseUp(event) {\n    console.log('onCanvasMouseUp');\n    event.preventDefault();\n    root.removeEventListener('mousemove', onCanvasMouseMove);\n    mouseDown = false;\n    colorWheelToggle = false;\n    triangleToggle = false;\n  }\n\n  onDestroy(() => {\n    root.removeEventListener('mousemove', onCanvasMouseMove);\n  });\n\n  function handleInput(coords) {\n    let { hue, saturation, value } = state;\n    let positionInWheel = getPositionInWheel(coords);\n    let positionInTriangle = getPositionInTriangle(coords);\n    if (positionInWheel !== undefined) {\n      hue = positionInWheel;\n      colorWheelToggle = true;\n      return { hue, saturation, value };\n    } else if (positionInTriangle !== undefined) {\n      let pos = positionInTriangle;\n      if (pos.w + pos.v > 1.0 || pos.v < 0 || pos.w < 0) {\n        pos = getClosestPointToTriangle(pos, coords);\n      }\n\n      value = Math.max(0, Math.min(1.0, 1.0 - pos.w));\n      saturation = Math.max(0, Math.min(1.0, pos.u / value));\n      // Still some weirdness when value is around zero\n      if (Number.isNaN(saturation)) {\n        saturation = 0.0;\n      }\n      triangleToggle = true;\n      return { hue, saturation, value };\n    } else {\n      return undefined;\n    }\n  }\n\n  function updateColor(hue, saturation, value, fireEvent = true) {\n    let newColor = tinycolor.fromRatio({\n      h: hue,\n      s: saturation,\n      v: value,\n    });\n    setState({\n      hue,\n      saturation,\n      value,\n    });\n    let rgb = newColor.toRgb();\n    let ratio = {\n      r: rgb.r / 255,\n      g: rgb.g / 255,\n      b: rgb.b / 255,\n      a: rgb.a,\n    };\n\n    if (fireEvent) {\n      emit(ratio);\n    }\n  }\n\n  function getPositionInTriangle(coord) {\n    let a = triPT[0];\n\n    let b = vec2.sub(vec2.create(), triPT[1], a);\n    let c = vec2.sub(vec2.create(), triPT[2], a);\n    let p = vec2.sub(vec2.create(), coord, a);\n\n    let d = b[0] * c[1] - c[0] * b[1];\n    let u =\n      (p[0] * (b[1] - c[1]) +\n        p[1] * (c[0] - b[0]) +\n        b[0] * c[1] -\n        c[0] * b[1]) /\n      d;\n    let v = (p[0] * c[1] - p[1] * c[0]) / d;\n    let w = (p[1] * b[0] - p[0] * b[1]) / d;\n\n    if (\n      !colorWheelToggle &&\n      (triangleToggle ||\n        (u > 0.0 && u < 1.0 && v > 0.0 && v < 1.0 && w > 0.0 && w < 1.0))\n    ) {\n      return {\n        u,\n        v,\n        w,\n      };\n    }\n    return undefined;\n  }\n\n  function getTriangleCoordinateFromColor(color) {\n    let v = 1.0 - color.value;\n    let s = (1.0 - color.saturation) * color.value;\n\n    let a = triPT[0];\n    let b = triPT[1];\n    let c = triPT[2];\n\n    let v1 = vec2.sub(vec2.create(), b, a);\n    let v2 = vec2.sub(vec2.create(), c, a);\n\n    let r1 = vec2.mul(vec2.create(), v1, [s, s]);\n    let r2 = vec2.mul(vec2.create(), v2, [v, v]);\n    let res = vec2.add(vec2.create(), r1, r2);\n    vec2.add(res, res, a);\n    return res;\n  }\n\n  function getClosestPointToTriangle(pos, coords) {\n    let from;\n    let to;\n    if (pos.w + pos.v > 1.0) {\n      from = triPT[1];\n      to = triPT[2];\n    } else if (pos.v < 0) {\n      from = triPT[0];\n      to = triPT[2];\n    } else if (pos.w < 0) {\n      from = triPT[0];\n      to = triPT[1];\n    }\n    let line = vec2.sub(vec2.create(), from, to);\n    let len = vec2.len(line);\n\n    vec2.normalize(line, line);\n\n    let v = vec2.sub(vec2.create(), coords, to);\n    let d = vec2.dot(v, line);\n    d = Math.max(0, Math.min(len, d));\n    let res = vec2.scaleAndAdd(vec2.create(), to, line, d);\n    return getPositionInTriangle(res);\n  }\n\n  function getPositionInWheel(p) {\n    let center = [0, 0];\n    let dist = vec2.distance(p, center);\n    if (!triangleToggle && (colorWheelToggle || (dist > 0.8 && dist < 1.0))) {\n      return getAngle([1, 0], p) / (2.0 * Math.PI);\n    }\n    return undefined;\n  }\n\n  function render() {\n    let color = tinycolor.fromRatio({\n      h: state.hue,\n      s: state.saturation,\n      v: state.value,\n    });\n\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    quad.bind();\n\n    let resolution = [\n      canvas.getAttribute('width'),\n      canvas.getAttribute('height'),\n    ];\n    colorWheelShader.bind();\n    colorWheelShader.setVec2('resolution', resolution);\n    quad.draw();\n    quad.unbind();\n    colorWheelShader.unbind();\n\n    satValShader.bind();\n    triangle.bind();\n\n    triangleModel = mat4Create();\n    let rot = state.hue * Math.PI * 2.0 - Math.PI / 2.0;\n    let hueRot = quatSetAxisAngle(quatCreate(), [0, 0, 1], rot);\n    mat4FromRotationTranslationScale(triangleModel, hueRot, vec3Create(), [\n      0.8,\n      0.8,\n      0.8,\n    ]);\n    vec2.transformMat4(triPT[0], triP[0], triangleModel);\n    vec2.transformMat4(triPT[1], triP[1], triangleModel);\n    vec2.transformMat4(triPT[2], triP[2], triangleModel);\n\n    let mvp2 = mat4Create();\n    mat4Translate(mvp2, mvp2, [0.5, 0.5, 0.0]);\n    mat4Rotate(mvp2, mvp2, rot, [0, 0, 1.0]);\n    mat4Scale(mvp2, mvp2, [0.8, 0.8, 0.8]);\n\n    satValShader.setMat4('mvp', triangleModel);\n    satValShader.setFloat('hue', state.hue);\n    triangle.draw();\n    triangle.unbind();\n    satValShader.unbind();\n\n    solidShader.bind();\n    ring.bind();\n    let pos = getTriangleCoordinateFromColor(state);\n    let svMarkerColor = color.isLight()\n      ? [0.0, 0.0, 0.0, 1.0]\n      : [1.0, 1.0, 1.0, 1.0];\n\n    solidShader.setVec4('color', svMarkerColor);\n    solidShader.setMat4(\n      'mvp',\n      mat4FromRotationTranslationScale(\n        mat4Create(),\n        quatCreate(),\n        [pos[0], pos[1], 0],\n        [0.03, 0.03, 1.0]\n      )\n    );\n\n    ring.draw();\n    ring.unbind();\n\n    let hue = tinycolor.fromRatio({\n      h: state.hue,\n      s: 1.0,\n      v: 1.0,\n    });\n    let hueMarkerColor = hue.isLight()\n      ? [0.0, 0.0, 0.0, 1.0]\n      : [1.0, 1.0, 1.0, 1.0];\n    let hueMarkerMatrix = mat4Create();\n    let quatMat = mat4FromQuat(mat4Create(), hueRot);\n    mat4Multiply(hueMarkerMatrix, hueMarkerMatrix, quatMat);\n    mat4Translate(hueMarkerMatrix, hueMarkerMatrix, [0, 0.9, 0]);\n    mat4Scale(hueMarkerMatrix, hueMarkerMatrix, [0.015, 0.1, 1.0]);\n    quad.bind();\n    solidShader.setVec4('color', hueMarkerColor);\n    solidShader.setMat4('mvp', hueMarkerMatrix);\n    quad.draw();\n    quad.unbind();\n    solidShader.unbind();\n  }\n\n  function emit(inColor) {\n    color = tinycolor.fromRatio(inColor);\n    hexString = color.toHex();\n    onChange(inColor);\n  }\n\n  function setState(newState) {\n    state = newState;\n    render();\n  }\n\n  export let value;\n  export let onChange = () => {};\n\n  let elm;\n\n  let color = tinycolor.fromRatio(value);\n  let hsv = color.toHsv();\n  let hexString = color.toHex();\n  state = {\n    hue: hsv.h / 360,\n    value: hsv.v,\n    saturation: hsv.s,\n  };\n\n  onMount(() => {\n    initCanvas();\n    setState(state);\n  });\n</script>\n\n<div class=\"color-picker\" bind:this={elm}>\n  <div class=\"color-input-color\">\n    <canvas\n      bind:this={canvas}\n      class=\"color-input-canvas\"\n      width=\"512\"\n      height=\"512\"\n    />\n    <input\n      type=\"text\"\n      spellCheck=\"false\"\n      maxLength=\"7\"\n      style={`color: ${\n        color.isLight() ? 'black' : 'white'\n      }; background-color: #${hexString}`}\n      value={hexString}\n      on:input={onHexInputChange}\n      on:paste={onHexInputChange}\n    />\n  </div>\n</div>\n\n<style>\n  .color-input-canvas {\n    padding: 10px;\n    margin: auto;\n    display: flex;\n    width: 256px;\n    height: 256px;\n  }\n\n  .color-picker {\n    margin: 0.2em;\n    margin-top: 0.5em;\n    border-radius: 4px;\n  }\n\n  .color-picker .color-input-color input {\n    background: none;\n    width: 100%;\n    text-align: center;\n    font-size: 14pt;\n    margin: 0;\n  }\n</style>\n","import { vec2 } from 'gl-matrix';\n\nexport function getAngle(v1, v2) {\n  let v1n = vec2.normalize(vec2.create(), v1);\n  let v2n = vec2.normalize(vec2.create(), v2);\n  let dot = vec2.dot(v1n, v2n);\n  let det = v1n[0]*v2n[1] - v1n[1]*v2n[0];\n  let rad = Math.atan2(det, dot);\n  if(rad < 0) {\n    rad += 2*Math.PI;\n  }\n  return rad;\n}\n\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { writable } from 'svelte/store';\nlet lastListenerId = 0;\nlet listenersSnapshot;\n\nlet listeners = writable({});\nlet isVisible = writable(false);\nlet position = writable([0, 0]);\nlet color = writable({ r: 1.0, g: 0.0, b: 0.0 });\n\nlisteners.subscribe((s) => (listenersSnapshot = s));\n\nlet colorPickerStore = {\n  onColorChange: (listener) => {\n    let id = lastListenerId++;\n    listeners.update((l) => ({\n      ...l,\n      [id]: listener,\n    }));\n    return id;\n  },\n  removeListener: (id) => {\n    listeners.update((s) => {\n      let ls = { ...s };\n      delete ls[id];\n      return { ...ls };\n    });\n  },\n  showColorPicker: (x, y, startColor) => {\n    position.set([x, y]);\n    isVisible.set(true);\n    color.set(startColor);\n  },\n  emit: (color) => {\n    console.log('emit');\n    Object.values(listenersSnapshot).forEach((l) => l(color));\n  },\n  listeners,\n  isVisible,\n  position,\n  color,\n};\nexport { colorPickerStore };\n","<script>\n  import { afterUpdate } from 'svelte';\n  import { vec2 } from 'gl-matrix';\n  import ColorPicker from '../../../components/ColorPicker/ColorPicker.svelte';\n  import { colorPickerStore } from './ColorPickerStore';\n  let realX;\n  let realY;\n\n  let position = colorPickerStore.position;\n  let isVisible = colorPickerStore.isVisible;\n  let colorPickerColor = colorPickerStore.color;\n  let elm;\n\n  afterUpdate(() => {\n    let pos = $position;\n    if ($isVisible) {\n      setPosition(pos[0], pos[1]);\n    }\n  });\n\n  function setPosition(x, y) {\n    if (elm !== undefined && elm !== null) {\n      let rect = elm.getBoundingClientRect();\n      realX = x - rect.width / 2;\n      realY = y + 10;\n      if (realX < 0) {\n        realX = 0;\n      }\n      if (realX + rect.width > window.innerWidth) {\n        realX = window.innerWidth - rect.width;\n      }\n    }\n  }\n\n  function bodyMouseMove(event) {\n    if ($isVisible) {\n      let rect = elm.getBoundingClientRect();\n      let centerX = rect.x + rect.width / 2;\n      let centerY = rect.y + rect.height / 2;\n      let distToCenter = vec2.sub(\n        vec2.create(),\n        [event.clientX, event.clientY],\n        [centerX, centerY]\n      );\n      if (Math.abs(distToCenter[0]) > 220 || Math.abs(distToCenter[1]) > 220) {\n        $isVisible = false;\n      }\n    }\n  }\n\n  function bodyMouseDown(event) {\n    if ($isVisible) {\n      if (!elm.contains(event.target)) {\n        $isVisible = false;\n      }\n    }\n  }\n\n  function onColorChange(newColor) {\n    colorPickerStore.emit(newColor);\n  }\n</script>\n\n<svelte:body on:pointermove={bodyMouseMove} on:pointerdown={bodyMouseDown} />\n{#if $isVisible}\n  <div\n    bind:this={elm}\n    class=\"dialog\"\n    style={`left: ${realX}px; top: ${realY}px`}\n  >\n    <ColorPicker value={$colorPickerColor} onChange={onColorChange} />\n  </div>\n{/if}\n\n<style>\n  .dialog {\n    position: absolute;\n    padding: 12px;\n    background-color: var(--color-2);\n    border: 1px solid var(--color-4);\n    z-index: 10;\n  }\n</style>\n","export const defaultFormats = {\n    number: {\n        scientific: { notation: 'scientific' },\n        engineering: { notation: 'engineering' },\n        compactLong: { notation: 'compact', compactDisplay: 'long' },\n        compactShort: { notation: 'compact', compactDisplay: 'short' },\n    },\n    date: {\n        short: { month: 'numeric', day: 'numeric', year: '2-digit' },\n        medium: { month: 'short', day: 'numeric', year: 'numeric' },\n        long: { month: 'long', day: 'numeric', year: 'numeric' },\n        full: { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' },\n    },\n    time: {\n        short: { hour: 'numeric', minute: 'numeric' },\n        medium: { hour: 'numeric', minute: 'numeric', second: 'numeric' },\n        long: {\n            hour: 'numeric',\n            minute: 'numeric',\n            second: 'numeric',\n            timeZoneName: 'short',\n        },\n        full: {\n            hour: 'numeric',\n            minute: 'numeric',\n            second: 'numeric',\n            timeZoneName: 'short',\n        },\n    },\n};\nconst defaultOptions = {\n    fallbackLocale: '',\n    initialLocale: '',\n    loadingDelay: 200,\n    formats: defaultFormats,\n    warnOnMissingMessages: true,\n};\nconst options = defaultOptions;\nlet currentLocale;\nexport function getCurrentLocale() {\n    return currentLocale;\n}\nexport function setCurrentLocale(val) {\n    return currentLocale = val;\n}\nexport function getOptions() {\n    return options;\n}\nfunction getSubLocales(refLocale) {\n    return refLocale\n        .split('-')\n        .map((_, i, arr) => arr.slice(0, i + 1).join('-'))\n        .reverse();\n}\nexport function getPossibleLocales(refLocale, fallbackLocale = getOptions().fallbackLocale) {\n    const locales = getSubLocales(refLocale);\n    if (fallbackLocale) {\n        return [...new Set([...locales, ...getSubLocales(fallbackLocale)])];\n    }\n    return locales;\n}\n","// @ts-ignore\nimport { writable, derived } from 'svelte/store';\nimport { getPossibleLocales } from '../includes/utils';\nlet dictionary;\nconst $dictionary = writable({});\nexport function getLocaleDictionary(locale) {\n    return dictionary[locale] || null;\n}\nexport function getDictionary() {\n    return dictionary;\n}\nexport function hasLocaleDictionary(locale) {\n    return locale in dictionary;\n}\nexport function getMessageFromDictionary(locale, id) {\n    if (hasLocaleDictionary(locale)) {\n        const localeDictionary = getLocaleDictionary(locale);\n        if (id in localeDictionary) {\n            return localeDictionary[id];\n        }\n        const ids = id.split('.');\n        let tmpDict = localeDictionary;\n        for (let i = 0; i < ids.length; i++) {\n            if (typeof tmpDict[ids[i]] !== 'object') {\n                return tmpDict[ids[i]] || null;\n            }\n            tmpDict = tmpDict[ids[i]];\n        }\n    }\n    return null;\n}\nexport function getClosestAvailableLocale(refLocale) {\n    if (refLocale == null)\n        return null;\n    const relatedLocales = getPossibleLocales(refLocale);\n    for (let i = 0; i < relatedLocales.length; i++) {\n        const locale = relatedLocales[i];\n        if (hasLocaleDictionary(locale)) {\n            return locale;\n        }\n    }\n    return null;\n}\nexport function addMessages(locale, ...partials) {\n    $dictionary.update(d => {\n        d[locale] = Object.assign(d[locale] || {}, ...partials);\n        return d;\n    });\n}\nconst $locales = /*@__PURE__*/ derived([$dictionary], ([$dictionary]) => Object.keys($dictionary));\n$dictionary.subscribe(newDictionary => (dictionary = newDictionary));\nexport { $dictionary, $locales };\n","// @ts-ignore\nimport { writable } from \"svelte/store\";\nexport const $isLoading = writable(false);\n","import { hasLocaleDictionary, $dictionary, addMessages, } from '../stores/dictionary';\nimport { getPossibleLocales, getOptions } from '../includes/utils';\nimport { $isLoading } from '../stores/loading';\nconst loaderQueue = {};\nexport function resetQueues() {\n    Object.keys(loaderQueue).forEach(key => {\n        delete loaderQueue[key];\n    });\n}\nfunction createLocaleQueue(locale) {\n    loaderQueue[locale] = new Set();\n}\nfunction removeLocaleFromQueue(locale) {\n    delete loaderQueue[locale];\n}\nfunction getLocaleQueue(locale) {\n    return loaderQueue[locale];\n}\nfunction getLocalesQueues(locale) {\n    return getPossibleLocales(locale)\n        .reverse()\n        .map(localeItem => {\n        const queue = getLocaleQueue(localeItem);\n        return [localeItem, queue ? [...queue] : []];\n    })\n        .filter(([, queue]) => queue.length > 0);\n}\nexport function hasLocaleQueue(locale) {\n    return getPossibleLocales(locale)\n        .reverse()\n        .some(getLocaleQueue);\n}\nconst activeLocaleFlushes = {};\nexport function flush(locale) {\n    if (!hasLocaleQueue(locale))\n        return Promise.resolve();\n    if (locale in activeLocaleFlushes)\n        return activeLocaleFlushes[locale];\n    // get queue of XX-YY and XX locales\n    const queues = getLocalesQueues(locale);\n    // istanbul ignore if\n    if (queues.length === 0)\n        return Promise.resolve();\n    const loadingDelay = setTimeout(() => $isLoading.set(true), getOptions().loadingDelay);\n    // TODO what happens if some loader fails\n    activeLocaleFlushes[locale] = Promise.all(queues.map(([locale, queue]) => {\n        return Promise.all(queue.map(loader => loader())).then(partials => {\n            removeLocaleFromQueue(locale);\n            partials = partials.map(partial => partial.default || partial);\n            addMessages(locale, ...partials);\n        });\n    })).then(() => {\n        clearTimeout(loadingDelay);\n        $isLoading.set(false);\n        delete activeLocaleFlushes[locale];\n    });\n    return activeLocaleFlushes[locale];\n}\nexport function registerLocaleLoader(locale, loader) {\n    if (!getLocaleQueue(locale))\n        createLocaleQueue(locale);\n    const queue = getLocaleQueue(locale);\n    // istanbul ignore if\n    if (getLocaleQueue(locale).has(loader))\n        return;\n    if (!hasLocaleDictionary(locale)) {\n        $dictionary.update(d => {\n            d[locale] = {};\n            return d;\n        });\n    }\n    queue.add(loader);\n}\n","const getFromQueryString = (queryString, key) => {\n    const keyVal = queryString.split('&').find((i) => i.indexOf(`${key}=`) === 0);\n    if (keyVal) {\n        return keyVal.split('=').pop();\n    }\n    return null;\n};\nconst getFirstMatch = (base, pattern) => {\n    const match = pattern.exec(base);\n    // istanbul ignore if\n    if (!match)\n        return null;\n    // istanbul ignore else\n    return match[1] || null;\n};\nexport const getLocaleFromHostname = (hostname) => {\n    // istanbul ignore next\n    if (typeof window === 'undefined')\n        return null;\n    return getFirstMatch(window.location.hostname, hostname);\n};\nexport const getLocaleFromPathname = (pathname) => {\n    // istanbul ignore next\n    if (typeof window === 'undefined')\n        return null;\n    return getFirstMatch(window.location.pathname, pathname);\n};\nexport const getLocaleFromNavigator = (ssrDefault) => {\n    // istanbul ignore next\n    if (typeof window === 'undefined') {\n        return ssrDefault || null;\n    }\n    return window.navigator.language || window.navigator.languages[0];\n};\nexport const getLocaleFromQueryString = (search) => {\n    // istanbul ignore next\n    if (typeof window === 'undefined')\n        return null;\n    return getFromQueryString(window.location.search.substr(1), search);\n};\nexport const getLocaleFromHash = (hash) => {\n    // istanbul ignore next\n    if (typeof window === 'undefined')\n        return null;\n    return getFromQueryString(window.location.hash.substr(1), hash);\n};\n","import { writable } from 'svelte/store';\nimport { flush, hasLocaleQueue } from '../includes/loaderQueue';\nimport { getCurrentLocale, setCurrentLocale } from '../includes/utils';\nimport { getClosestAvailableLocale } from './dictionary';\nconst $locale = writable('');\n$locale.subscribe((newLocale) => {\n    setCurrentLocale(newLocale);\n    if (typeof window !== 'undefined') {\n        document.documentElement.setAttribute('lang', newLocale);\n    }\n});\nconst localeSet = $locale.set;\n$locale.set = (newLocale) => {\n    if (getClosestAvailableLocale(newLocale) && hasLocaleQueue(newLocale)) {\n        return flush(newLocale).then(() => localeSet(newLocale));\n    }\n    return localeSet(newLocale);\n};\n// istanbul ignore next\n$locale.update = (fn) => {\n    let currentLocale = getCurrentLocale();\n    fn(currentLocale);\n    localeSet(currentLocale);\n};\nexport { $locale };\n","import { getMessageFromDictionary } from '../stores/dictionary';\nimport { getPossibleLocales } from './utils';\nexport const lookupCache = {};\nconst addToCache = (path, locale, message) => {\n    if (!message)\n        return message;\n    if (!(locale in lookupCache))\n        lookupCache[locale] = {};\n    if (!(path in lookupCache[locale]))\n        lookupCache[locale][path] = message;\n    return message;\n};\nexport const lookup = (path, refLocale) => {\n    if (refLocale == null)\n        return undefined;\n    if (refLocale in lookupCache && path in lookupCache[refLocale]) {\n        return lookupCache[refLocale][path];\n    }\n    const locales = getPossibleLocales(refLocale);\n    for (let i = 0; i < locales.length; i++) {\n        const locale = locales[i];\n        const message = getMessageFromDictionary(locale, path);\n        if (message) {\n            // Used the requested locale as the cache key\n            // Ex: { en: { title: \"Title\" }}\n            // lookup('title', 'en-GB') should cache with 'en-GB' instead of 'en'\n            return addToCache(path, refLocale, message);\n        }\n    }\n    return undefined;\n};\n","import { derived } from \"svelte/store\";\nimport { lookup } from '../includes/lookup';\nimport { hasLocaleQueue } from '../includes/loaderQueue';\nimport { getTimeFormatter, getDateFormatter, getNumberFormatter, } from '../includes/formatters';\nimport { getOptions, getCurrentLocale, getPossibleLocales } from '../includes/utils';\nimport { $dictionary } from './dictionary';\nimport { $locale } from './locale';\nexport const formatMessage = (optionsOrId, maybeOptions = {}) => {\n    const id = typeof optionsOrId === 'string' ? optionsOrId : optionsOrId.id;\n    const options = typeof optionsOrId === 'string' ? maybeOptions : optionsOrId;\n    const { values, locale = getCurrentLocale(), default: defaultValue, } = options;\n    if (locale == null) {\n        throw new Error('[svelte-i18n] Cannot format a message without first setting the initial locale.');\n    }\n    let message = lookup(id, locale);\n    if (typeof message === 'string') {\n        return message;\n    }\n    if (typeof message === 'function') {\n        return message(...Object.keys(options.values || {}).sort().map(k => (options.values || {})[k]));\n    }\n    if (getOptions().warnOnMissingMessages) {\n        // istanbul ignore next\n        console.warn(`[svelte-i18n] The message \"${id}\" was not found in \"${getPossibleLocales(locale).join('\", \"')}\".${hasLocaleQueue(getCurrentLocale())\n            ? `\\n\\nNote: there are at least one loader still registered to this locale that wasn't executed.`\n            : ''}`);\n    }\n    return defaultValue || id;\n};\nexport const getJSON = (id, locale) => {\n    locale ||= getCurrentLocale();\n    return lookup(id, locale) || id;\n};\nexport const formatTime = (t, options) => getTimeFormatter(options).format(t);\nexport const formatDate = (d, options) => getDateFormatter(options).format(d);\nexport const formatNumber = (n, options) => getNumberFormatter(options).format(n);\nexport const $format = /*@__PURE__*/ derived([$locale, $dictionary], () => formatMessage);\nexport const $formatTime = /*@__PURE__*/ derived([$locale], () => formatTime);\nexport const $formatDate = /*@__PURE__*/ derived([$locale], () => formatDate);\nexport const $formatNumber = /*@__PURE__*/ derived([$locale], () => formatNumber);\nexport const $getJSON = /*@__PURE__*/ derived([$locale, $dictionary], () => getJSON);\n","\"use strict\";\r\nvar Mexp = function (parsed) {\r\n  this.value = parsed\r\n}\r\n\r\nMexp.math = {\r\n  isDegree: true, // mode of calculator\r\n  acos: function (x) {\r\n    return (Mexp.math.isDegree ? 180 / Math.PI * Math.acos(x) : Math.acos(x))\r\n  },\r\n  add: function (a, b) {\r\n    return a + b\r\n  },\r\n  asin: function (x) {\r\n    return (Mexp.math.isDegree ? 180 / Math.PI * Math.asin(x) : Math.asin(x))\r\n  },\r\n  atan: function (x) {\r\n    return (Mexp.math.isDegree ? 180 / Math.PI * Math.atan(x) : Math.atan(x))\r\n  },\r\n  acosh: function (x) {\r\n    return Math.log(x + Math.sqrt(x * x - 1))\r\n  },\r\n  asinh: function (x) {\r\n    return Math.log(x + Math.sqrt(x * x + 1))\r\n  },\r\n  atanh: function (x) {\r\n    return Math.log((1 + x) / (1 - x))\r\n  },\r\n  C: function (n, r) {\r\n    var pro = 1\r\n    var other = n - r\r\n    var choice = r\r\n    if (choice < other) {\r\n      choice = other\r\n      other = r\r\n    }\r\n    for (var i = choice + 1; i <= n; i++) {\r\n      pro *= i\r\n    }\r\n    return pro / Mexp.math.fact(other)\r\n  },\r\n  changeSign: function (x) {\r\n    return -x\r\n  },\r\n  cos: function (x) {\r\n    if (Mexp.math.isDegree) x = Mexp.math.toRadian(x)\r\n    return Math.cos(x)\r\n  },\r\n  cosh: function (x) {\r\n    return (Math.pow(Math.E, x) + Math.pow(Math.E, -1 * x)) / 2\r\n  },\r\n  div: function (a, b) {\r\n    return a / b\r\n  },\r\n  fact: function (n) {\r\n    if (n % 1 !== 0) return 'NaN'\r\n    var pro = 1\r\n    for (var i = 2; i <= n; i++) {\r\n      pro *= i\r\n    }\r\n    return pro\r\n  },\r\n  inverse: function (x) {\r\n    return 1 / x\r\n  },\r\n  log: function (i) {\r\n    return Math.log(i) / Math.log(10)\r\n  },\r\n  mod: function (a, b) {\r\n    return a % b\r\n  },\r\n  mul: function (a, b) {\r\n    return a * b\r\n  },\r\n  P: function (n, r) {\r\n    var pro = 1\r\n    for (var i = Math.floor(n) - Math.floor(r) + 1; i <= Math.floor(n); i++) {\r\n      pro *= i\r\n    }\r\n    return pro\r\n  },\r\n  Pi: function (low, high, ex) {\r\n    var pro = 1\r\n    for (var i = low; i <= high; i++) {\r\n      pro *= Number(ex.postfixEval({\r\n        n: i\r\n      }))\r\n    }\r\n    return pro\r\n  },\r\n  pow10x: function (e) {\r\n    var x = 1\r\n    while (e--) {\r\n      x *= 10\r\n    }\r\n    return x\r\n  },\r\n  sigma: function (low, high, ex) {\r\n    var sum = 0\r\n    for (var i = low; i <= high; i++) {\r\n      sum += Number(ex.postfixEval({\r\n        n: i\r\n      }))\r\n    }\r\n    return sum\r\n  },\r\n  sin: function (x) {\r\n    if (Mexp.math.isDegree) x = Mexp.math.toRadian(x)\r\n    return Math.sin(x)\r\n  },\r\n  sinh: function (x) {\r\n    return (Math.pow(Math.E, x) - Math.pow(Math.E, -1 * x)) / 2\r\n  },\r\n  sub: function (a, b) {\r\n    return a - b\r\n  },\r\n  tan: function (x) {\r\n    if (Mexp.math.isDegree) x = Mexp.math.toRadian(x)\r\n    return Math.tan(x)\r\n  },\r\n  tanh: function (x) {\r\n    return Mexp.sinha(x) / Mexp.cosha(x)\r\n  },\r\n  toRadian: function (x) {\r\n    return x * Math.PI / 180\r\n  }\r\n}\r\nMexp.Exception = function (message) {\r\n  this.message = message\r\n}\r\nmodule.exports = Mexp\r\n","'use strict'\r\nvar Mexp = require('./math_function.js')\r\nfunction inc (arr, val) {\r\n  for (var i = 0; i < arr.length; i++) {\r\n    arr[i] += val\r\n  }\r\n  return arr\r\n}\r\nvar token = [\r\n  'sin',\r\n  'cos',\r\n  'tan',\r\n  'pi',\r\n  '(',\r\n  ')',\r\n  'P',\r\n  'C',\r\n  ' ',\r\n  'asin',\r\n  'acos',\r\n  'atan',\r\n  '7',\r\n  '8',\r\n  '9',\r\n  'int',\r\n  'cosh',\r\n  'acosh',\r\n  'ln',\r\n  '^',\r\n  'root',\r\n  '4',\r\n  '5',\r\n  '6',\r\n  '/',\r\n  '!',\r\n  'tanh',\r\n  'atanh',\r\n  'Mod',\r\n  '1',\r\n  '2',\r\n  '3',\r\n  '*',\r\n  'sinh',\r\n  'asinh',\r\n  'e',\r\n  'log',\r\n  '0',\r\n  '.',\r\n  '+',\r\n  '-',\r\n  ',',\r\n  'Sigma',\r\n  'n',\r\n  'Pi',\r\n  'pow'\r\n]\r\nvar show = [\r\n  'sin',\r\n  'cos',\r\n  'tan',\r\n  '&pi;',\r\n  '(',\r\n  ')',\r\n  'P',\r\n  'C',\r\n  ' ',\r\n  'asin',\r\n  'acos',\r\n  'atan',\r\n  '7',\r\n  '8',\r\n  '9',\r\n  'Int',\r\n  'cosh',\r\n  'acosh',\r\n  ' ln',\r\n  '^',\r\n  'root',\r\n  '4',\r\n  '5',\r\n  '6',\r\n  '&divide;',\r\n  '!',\r\n  'tanh',\r\n  'atanh',\r\n  ' Mod ',\r\n  '1',\r\n  '2',\r\n  '3',\r\n  '&times;',\r\n  'sinh',\r\n  'asinh',\r\n  'e',\r\n  ' log',\r\n  '0',\r\n  '.',\r\n  '+',\r\n  '-',\r\n  ',',\r\n  '&Sigma;',\r\n  'n',\r\n  '&Pi;',\r\n  'pow'\r\n]\r\nvar eva = [\r\n  Mexp.math.sin,\r\n  Mexp.math.cos,\r\n  Mexp.math.tan,\r\n  'PI',\r\n  '(',\r\n  ')',\r\n  Mexp.math.P,\r\n  Mexp.math.C,\r\n  ' '.anchor,\r\n  Mexp.math.asin,\r\n  Mexp.math.acos,\r\n  Mexp.math.atan,\r\n  '7',\r\n  '8',\r\n  '9',\r\n  Math.floor,\r\n  Mexp.math.cosh,\r\n  Mexp.math.acosh,\r\n  Math.log,\r\n  Math.pow,\r\n  Math.sqrt,\r\n  '4',\r\n  '5',\r\n  '6',\r\n  Mexp.math.div,\r\n  Mexp.math.fact,\r\n  Mexp.math.tanh,\r\n  Mexp.math.atanh,\r\n  Mexp.math.mod,\r\n  '1',\r\n  '2',\r\n  '3',\r\n  Mexp.math.mul,\r\n  Mexp.math.sinh,\r\n  Mexp.math.asinh,\r\n  'E',\r\n  Mexp.math.log,\r\n  '0',\r\n  '.',\r\n  Mexp.math.add,\r\n  Mexp.math.sub,\r\n  ',',\r\n  Mexp.math.sigma,\r\n  'n',\r\n  Mexp.math.Pi,\r\n  Math.pow\r\n]\r\nvar preced = {\r\n  0: 11,\r\n  1: 0,\r\n  2: 3,\r\n  3: 0,\r\n  4: 0,\r\n  5: 0,\r\n  6: 0,\r\n  7: 11,\r\n  8: 11,\r\n  9: 1,\r\n  10: 10,\r\n  11: 0,\r\n  12: 11,\r\n  13: 0,\r\n  14: -1 // will be filtered after lexer\r\n} // stores precedence by types\r\nvar type = [\r\n  0, 0, 0, 3, 4, 5, 10, 10, 14, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 10, 0, 1, 1, 1, 2, 7, 0, 0, 2, 1, 1,\r\n  1, 2, 0, 0, 3, 0, 1, 6, 9, 9, 11, 12, 13, 12, 8\r\n]\r\n/*\r\n0 : function with syntax function_name(Maths_exp)\r\n1 : numbers\r\n2 : binary operators like * / Mod left associate and same precedence\r\n3 : Math constant values like e,pi,Cruncher ans\r\n4 : opening bracket\r\n5 : closing bracket\r\n6 : decimal\r\n7 : function with syntax (Math_exp)function_name\r\n8: function with syntax function_name(Math_exp1,Math_exp2)\r\n9 : binary operator like +,-\r\n10: binary operator like P C or ^\r\n11: ,\r\n12: function with , seperated three parameters and third parameter is a string that will be mexp string\r\n13: variable of Sigma function\r\n*/\r\nvar type0 = {\r\n  0: true,\r\n  1: true,\r\n  3: true,\r\n  4: true,\r\n  6: true,\r\n  8: true,\r\n  9: true,\r\n  12: true,\r\n  13: true,\r\n  14: true\r\n} // type2:true,type4:true,type9:true,type11:true,type21:true,type22\r\nvar type1 = {\r\n  0: true,\r\n  1: true,\r\n  2: true,\r\n  3: true,\r\n  4: true,\r\n  5: true,\r\n  6: true,\r\n  7: true,\r\n  8: true,\r\n  9: true,\r\n  10: true,\r\n  11: true,\r\n  12: true,\r\n  13: true\r\n} // type3:true,type5:true,type7:true,type23\r\nvar type1Asterick = {\r\n  0: true,\r\n  3: true,\r\n  4: true,\r\n  8: true,\r\n  12: true,\r\n  13: true\r\n}\r\nvar empty = {}\r\nvar type3Asterick = {\r\n  0: true,\r\n  1: true,\r\n  3: true,\r\n  4: true,\r\n  6: true,\r\n  8: true,\r\n  12: true,\r\n  13: true\r\n} // type_5:true,type_7:true,type_23\r\nvar type6 = {\r\n  1: true\r\n}\r\nvar newAr = [\r\n  [],\r\n  [\r\n    '1',\r\n    '2',\r\n    '3',\r\n    '7',\r\n    '8',\r\n    '9',\r\n    '4',\r\n    '5',\r\n    '6',\r\n    '+',\r\n    '-',\r\n    '*',\r\n    '/',\r\n    '(',\r\n    ')',\r\n    '^',\r\n    '!',\r\n    'P',\r\n    'C',\r\n    'e',\r\n    '0',\r\n    '.',\r\n    ',',\r\n    'n',\r\n    ' '\r\n  ],\r\n  ['pi', 'ln', 'Pi'],\r\n  ['sin', 'cos', 'tan', 'Del', 'int', 'Mod', 'log', 'pow'],\r\n  ['asin', 'acos', 'atan', 'cosh', 'root', 'tanh', 'sinh'],\r\n  ['acosh', 'atanh', 'asinh', 'Sigma']\r\n]\r\n\r\nfunction match (str1, str2, i, x) {\r\n  for (var f = 0; f < x; f++) {\r\n    if (str1[i + f] !== str2[f]) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\nMexp.addToken = function (tokens) {\r\n  for (var i = 0; i < tokens.length; i++) {\r\n    var x = tokens[i].token.length\r\n    var temp = -1\r\n\r\n    // newAr is a specially designed data structure index of 1d array = length of tokens\r\n    newAr[x] = newAr[x] || []\r\n    for (var y = 0; y < newAr[x].length; y++) {\r\n      if (tokens[i].token === newAr[x][y]) {\r\n        temp = token.indexOf(newAr[x][y])\r\n        break\r\n      }\r\n    }\r\n    if (temp === -1) {\r\n      token.push(tokens[i].token)\r\n      type.push(tokens[i].type)\r\n      if (newAr.length <= tokens[i].token.length) {\r\n        newAr[tokens[i].token.length] = []\r\n      }\r\n      newAr[tokens[i].token.length].push(tokens[i].token)\r\n      eva.push(tokens[i].value)\r\n      show.push(tokens[i].show)\r\n    } else {\r\n      // overwrite\r\n      token[temp] = tokens[i].token\r\n      type[temp] = tokens[i].type\r\n      eva[temp] = tokens[i].value\r\n      show[temp] = tokens[i].show\r\n    }\r\n  }\r\n}\r\n\r\nfunction tokenize (string) {\r\n  var nodes = []\r\n  var length = string.length\r\n  var key, x, y\r\n  for (var i = 0; i < length; i++) {\r\n    if (i < length - 1 && string[i] === ' ' && string[i + 1] === ' ') {\r\n      continue\r\n    }\r\n    key = ''\r\n    for (\r\n      x = string.length - i > newAr.length - 2 ? newAr.length - 1 : string.length - i;\r\n      x > 0;\r\n      x--\r\n    ) {\r\n      if (newAr[x] === undefined) continue\r\n      for (y = 0; y < newAr[x].length; y++) {\r\n        if (match(string, newAr[x][y], i, x)) {\r\n          key = newAr[x][y]\r\n          y = newAr[x].length\r\n          x = 0\r\n        }\r\n      }\r\n    }\r\n    i += key.length - 1\r\n    if (key === '') {\r\n      throw new Mexp.Exception(\"Can't understand after \" + string.slice(i))\r\n    }\r\n    var index = token.indexOf(key)\r\n    nodes.push({\r\n      index: index,\r\n      token: key,\r\n      type: type[index],\r\n      eval: eva[index],\r\n      precedence: preced[type[index]],\r\n      show: show[index]\r\n    })\r\n  }\r\n  return nodes\r\n}\r\n\r\nMexp.lex = function (inp, tokens) {\r\n  'use strict'\r\n\r\n  var changeSignObj = {\r\n    value: Mexp.math.changeSign,\r\n    type: 0,\r\n    pre: 21,\r\n    show: '-'\r\n  }\r\n  var closingParObj = {\r\n    value: ')',\r\n    show: ')',\r\n    type: 5,\r\n    pre: 0\r\n  }\r\n  var openingParObj = {\r\n    value: '(',\r\n    type: 4,\r\n    pre: 0,\r\n    show: '('\r\n  }\r\n  var str = [openingParObj]\r\n\r\n  var ptc = [] // Parenthesis to close at the beginning is after one token\r\n  var inpStr = inp\r\n  var allowed = type0\r\n  var bracToClose = 0\r\n  var asterick = empty\r\n  var prevKey = ''\r\n  var i\r\n  if (typeof tokens !== 'undefined') {\r\n    Mexp.addToken(tokens)\r\n  }\r\n  var obj = {}\r\n  var nodes = tokenize(inpStr)\r\n  for (i = 0; i < nodes.length; i++) {\r\n    var node = nodes[i]\r\n    if (node.type === 14) {\r\n      if (\r\n        i > 0 &&\r\n        i < nodes.length - 1 &&\r\n        nodes[i + 1].type === 1 &&\r\n        (nodes[i - 1].type === 1 || nodes[i - 1].type === 6)\r\n      ) { throw new Mexp.Exception('Unexpected Space') }\r\n      continue\r\n    }\r\n    var cToken = node.token\r\n    var cType = node.type\r\n    var cEv = node.eval\r\n    var cPre = node.precedence\r\n    var cShow = node.show\r\n    var pre = str[str.length - 1]\r\n    var j\r\n    for (j = ptc.length; j--;) {\r\n      // loop over ptc\r\n      if (ptc[j] === 0) {\r\n        if ([0, 2, 3, 4, 5, 9, 11, 12, 13].indexOf(cType) !== -1) {\r\n          if (allowed[cType] !== true) {\r\n            throw new Mexp.Exception(cToken + ' is not allowed after ' + prevKey)\r\n          }\r\n          str.push(closingParObj)\r\n          allowed = type1\r\n          asterick = type3Asterick\r\n          inc(ptc, -1).pop()\r\n        }\r\n      } else break\r\n    }\r\n    if (allowed[cType] !== true) {\r\n      throw new Mexp.Exception(cToken + ' is not allowed after ' + prevKey)\r\n    }\r\n    if (asterick[cType] === true) {\r\n      cType = 2\r\n      cEv = Mexp.math.mul\r\n      cShow = '&times;'\r\n      cPre = 3\r\n      i = i - 1\r\n    }\r\n    obj = {\r\n      value: cEv,\r\n      type: cType,\r\n      pre: cPre,\r\n      show: cShow\r\n    }\r\n    if (cType === 0) {\r\n      allowed = type0\r\n      asterick = empty\r\n      inc(ptc, 2).push(2)\r\n      str.push(obj)\r\n      str.push(openingParObj)\r\n    } else if (cType === 1) {\r\n      if (pre.type === 1) {\r\n        pre.value += cEv\r\n        inc(ptc, 1)\r\n      } else {\r\n        str.push(obj)\r\n      }\r\n      allowed = type1\r\n      asterick = type1Asterick\r\n    } else if (cType === 2) {\r\n      allowed = type0\r\n      asterick = empty\r\n      inc(ptc, 2)\r\n      str.push(obj)\r\n    } else if (cType === 3) {\r\n      // constant\r\n      str.push(obj)\r\n      allowed = type1\r\n      asterick = type3Asterick\r\n    } else if (cType === 4) {\r\n      inc(ptc, 1)\r\n      bracToClose++\r\n      allowed = type0\r\n      asterick = empty\r\n      str.push(obj)\r\n    } else if (cType === 5) {\r\n      if (!bracToClose) {\r\n        throw new Mexp.Exception('Closing parenthesis are more than opening one, wait What!!!')\r\n      }\r\n      bracToClose--\r\n      allowed = type1\r\n      asterick = type3Asterick\r\n      str.push(obj)\r\n      inc(ptc, 1)\r\n    } else if (cType === 6) {\r\n      if (pre.hasDec) {\r\n        throw new Mexp.Exception('Two decimals are not allowed in one number')\r\n      }\r\n      if (pre.type !== 1) {\r\n        pre = {\r\n          value: 0,\r\n          type: 1,\r\n          pre: 0\r\n        } // pre needs to be changed as it will the last value now to be safe in later code\r\n        str.push(pre)\r\n        inc(ptc, -1)\r\n      }\r\n      allowed = type6\r\n      inc(ptc, 1)\r\n      asterick = empty\r\n      pre.value += cEv\r\n      pre.hasDec = true\r\n    } else if (cType === 7) {\r\n      allowed = type1\r\n      asterick = type3Asterick\r\n      inc(ptc, 1)\r\n      str.push(obj)\r\n    }\r\n    if (cType === 8) {\r\n      allowed = type0\r\n      asterick = empty\r\n      inc(ptc, 4).push(4)\r\n      str.push(obj)\r\n      str.push(openingParObj)\r\n    } else if (cType === 9) {\r\n      if (pre.type === 9) {\r\n        if (pre.value === Mexp.math.add) {\r\n          pre.value = cEv\r\n          pre.show = cShow\r\n          inc(ptc, 1)\r\n        } else if (pre.value === Mexp.math.sub && cShow === '-') {\r\n          pre.value = Mexp.math.add\r\n          pre.show = '+'\r\n          inc(ptc, 1)\r\n        }\r\n      } else if (\r\n        pre.type !== 5 &&\r\n        pre.type !== 7 &&\r\n        pre.type !== 1 &&\r\n        pre.type !== 3 &&\r\n        pre.type !== 13\r\n      ) {\r\n        // changesign only when negative is found\r\n        if (cToken === '-') {\r\n          // do nothing for + token\r\n          // don't add with the above if statement as that will run the else statement of parent if on Ctoken +\r\n          allowed = type0\r\n          asterick = empty\r\n          inc(ptc, 2).push(2)\r\n          str.push(changeSignObj)\r\n          str.push(openingParObj)\r\n        }\r\n      } else {\r\n        str.push(obj)\r\n        inc(ptc, 2)\r\n      }\r\n      allowed = type0\r\n      asterick = empty\r\n    } else if (cType === 10) {\r\n      allowed = type0\r\n      asterick = empty\r\n      inc(ptc, 2)\r\n      str.push(obj)\r\n    } else if (cType === 11) {\r\n      allowed = type0\r\n      asterick = empty\r\n      str.push(obj)\r\n    } else if (cType === 12) {\r\n      allowed = type0\r\n      asterick = empty\r\n      inc(ptc, 6).push(6)\r\n      str.push(obj)\r\n      str.push(openingParObj)\r\n    } else if (cType === 13) {\r\n      allowed = type1\r\n      asterick = type3Asterick\r\n      str.push(obj)\r\n    }\r\n    inc(ptc, -1)\r\n    prevKey = cToken\r\n  }\r\n  for (j = ptc.length; j--;) {\r\n    // loop over ptc\r\n    if (ptc[j] === 0) {\r\n      str.push(closingParObj)\r\n      inc(ptc, -1).pop()\r\n    } else break // if it is not zero so before ptc also cant be zero\r\n  }\r\n  if (allowed[5] !== true) {\r\n    throw new Mexp.Exception('complete the expression')\r\n  }\r\n  while (bracToClose--) {\r\n    str.push(closingParObj)\r\n  }\r\n\r\n  str.push(closingParObj)\r\n  //        console.log(str);\r\n  return new Mexp(str)\r\n}\r\nmodule.exports = Mexp\r\n","\r\nvar Mexp = require('./lexer.js');\r\n\r\nMexp.prototype.toPostfix = function () {\r\n\t'use strict';\r\n\tvar post = [], elem, popped, prep, pre, ele;\r\n\tvar stack = [{ value: \"(\", type: 4, pre: 0 }];\r\n\tvar arr = this.value;\r\n\tfor (var i = 1; i < arr.length; i++) {\r\n\t\tif (arr[i].type === 1 || arr[i].type === 3 || arr[i].type === 13) {\t//if token is number,constant,or n(which is also a special constant in our case)\r\n\t\t\tif (arr[i].type === 1)\r\n\t\t\t\tarr[i].value = Number(arr[i].value);\r\n\t\t\tpost.push(arr[i]);\r\n\t\t}\r\n\t\telse if (arr[i].type === 4) {\r\n\t\t\tstack.push(arr[i]);\r\n\t\t}\r\n\t\telse if (arr[i].type === 5) {\r\n\t\t\twhile ((popped = stack.pop()).type !== 4) {\r\n\t\t\t\tpost.push(popped);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (arr[i].type === 11) {\r\n\t\t\twhile ((popped = stack.pop()).type !== 4) {\r\n\t\t\t\tpost.push(popped);\r\n\t\t\t}\r\n\t\t\tstack.push(popped);\r\n\t\t}\r\n\t\telse {\r\n\t\t\telem = arr[i];\r\n\t\t\tpre = elem.pre;\r\n\t\t\tele = stack[stack.length - 1];\r\n\t\t\tprep = ele.pre;\r\n\t\t\tvar flag = ele.value == 'Math.pow' && elem.value == 'Math.pow';\r\n\t\t\tif (pre > prep) stack.push(elem);\r\n\t\t\telse {\r\n\t\t\t\twhile (prep >= pre && !flag || flag && pre < prep) {\r\n\t\t\t\t\tpopped = stack.pop();\r\n\t\t\t\t\tele = stack[stack.length - 1];\r\n\t\t\t\t\tpost.push(popped);\r\n\t\t\t\t\tprep = ele.pre;\r\n\t\t\t\t\tflag = elem.value == 'Math.pow' && ele.value == 'Math.pow';\r\n\t\t\t\t}\r\n\t\t\t\tstack.push(elem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn new Mexp(post);\r\n};\r\nmodule.exports = Mexp;","var Mexp=require('./postfix.js');\r\nMexp.prototype.postfixEval = function (UserDefined) {\r\n\t'use strict';\r\n\tUserDefined=UserDefined||{};\r\n\tUserDefined.PI=Math.PI;\r\n\tUserDefined.E=Math.E;\r\n\tvar stack=[],pop1,pop2,pop3;\r\n\tvar disp=[];\r\n\tvar temp='';\r\n\tvar arr=this.value;\r\n\tvar bool=(typeof UserDefined.n!==\"undefined\");\r\n\tfor(var i=0;i<arr.length;i++){\r\n\t\tif(arr[i].type===1){\r\n\t\t\tstack.push({value:arr[i].value,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===3){\r\n\t\t\tstack.push({value:UserDefined[arr[i].value],type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===0){\r\n\t\t\tif(typeof stack[stack.length-1].type===\"undefined\"){\r\n\t\t\t\tstack[stack.length-1].value.push(arr[i]);\r\n\t\t\t}\r\n\t\t\telse stack[stack.length-1].value=arr[i].value(stack[stack.length-1].value);\r\n\t\t}\r\n\t\telse if(arr[i].type===7){\r\n\t\t\tif(typeof stack[stack.length-1].type===\"undefined\"){\r\n\t\t\t\tstack[stack.length-1].value.push(arr[i]);\r\n\t\t\t}\r\n\t\t\telse stack[stack.length-1].value=arr[i].value(stack[stack.length-1].value);\r\n\t\t}\r\n\t\telse if(arr[i].type===8){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n\t\t}\r\n\t\telse if(arr[i].type===10){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tif(typeof pop2.type===\"undefined\"){\r\n\t\t\t\tpop2.value=pop2.concat(pop1);\r\n\t\t\t\tpop2.value.push(arr[i]);\r\n\t\t\t\tstack.push(pop2);\r\n\t\t\t}\r\n\t\t\telse if (typeof pop1.type===\"undefined\") {\r\n\t\t\t\tpop1.unshift(pop2);\r\n\t\t\t\tpop1.push(arr[i]);\r\n\t\t\t\tstack.push(pop1);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n            }\r\n\t\t}\r\n\t\telse if(arr[i].type===2||arr[i].type===9){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tif(typeof pop2.type===\"undefined\"){\r\n\t\t\t\tpop2=pop2.concat(pop1);\r\n\t\t\t\tpop2.push(arr[i]);\r\n\t\t\t\tstack.push(pop2);\r\n\t\t\t}\r\n\t\t\telse if (typeof pop1.type===\"undefined\") {\r\n\t\t\t\tpop1.unshift(pop2);\r\n\t\t\t\tpop1.push(arr[i]);\r\n\t\t\t\tstack.push(pop1);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(arr[i].type===12){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tif (typeof pop1.type!==\"undefined\") {\r\n\t\t\t\tpop1=[pop1];\r\n\t\t\t}\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tpop3=stack.pop();\r\n\t\t\tstack.push({type:1,value:arr[i].value(pop3.value,pop2.value,new Mexp(pop1))});\r\n\t\t}\r\n\t\telse if(arr[i].type===13){\r\n\t\t\tif(bool){\r\n\t\t\t\tstack.push({value:UserDefined[arr[i].value],type:3});\r\n\t\t\t}\r\n\t\t\telse stack.push([arr[i]]);\r\n\t\t}\r\n\t}\r\n\tif (stack.length>1) {\r\n\t\tthrow(new Mexp.Exception(\"Uncaught Syntax error\"));\r\n\t}\r\n\treturn stack[0].value>1000000000000000?\"Infinity\":parseFloat(stack[0].value.toFixed(15));\r\n};\r\nMexp.eval=function(str,tokens,obj){\r\n\tif (typeof tokens===\"undefined\") {\r\n\t\treturn this.lex(str).toPostfix().postfixEval();\r\n\t}\r\n\telse if (typeof obj===\"undefined\") {\r\n\t\tif (typeof tokens.length!==\"undefined\") \r\n\t\t\treturn this.lex(str,tokens).toPostfix().postfixEval();\r\n\t\telse\r\n\t\t\treturn this.lex(str).toPostfix().postfixEval(tokens);\r\n\t}\r\n\telse\r\n\t\treturn this.lex(str,tokens).toPostfix().postfixEval(obj);\r\n};\r\nmodule.exports=Mexp;","var Mexp=require('./postfix_evaluator.js');\r\nMexp.prototype.formulaEval = function () {\r\n\t\"use strict\";\r\n\tvar stack=[],pop1,pop2,pop3;\r\n\tvar disp=[];\r\n\tvar temp='';\r\n\tvar arr=this.value;\r\n\tfor(var i=0;i<arr.length;i++){\r\n\t\tif(arr[i].type===1||arr[i].type===3){\r\n\t\t\tdisp.push({value:arr[i].type===3?arr[i].show:arr[i].value,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===13){\r\n\t\t\tdisp.push({value:arr[i].show,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===0){\r\n\t\t\tdisp[disp.length-1]={value:arr[i].show+(arr[i].show!=\"-\"?\"(\":\"\")+disp[disp.length-1].value+(arr[i].show!=\"-\"?\")\":\"\"),type:0};\r\n\t\t}\r\n\t\telse if(arr[i].type===7){\r\n\t\t\tdisp[disp.length-1]={value:(disp[disp.length-1].type!=1?\"(\":\"\")+disp[disp.length-1].value+(disp[disp.length-1].type!=1?\")\":\"\")+arr[i].show,type:7};\r\n\t\t}\r\n\t\telse if(arr[i].type===10){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tif(arr[i].show==='P'||arr[i].show==='C')disp.push({value:\"<sup>\"+pop2.value+\"</sup>\"+arr[i].show+\"<sub>\"+pop1.value+\"</sub>\",type:10});\r\n\t\t\telse disp.push({value:(pop2.type!=1?\"(\":\"\")+pop2.value+(pop2.type!=1?\")\":\"\")+\"<sup>\"+pop1.value+\"</sup>\",type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===2||arr[i].type===9){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tdisp.push({value:(pop2.type!=1?\"(\":\"\")+pop2.value+(pop2.type!=1?\")\":\"\")+arr[i].show+(pop1.type!=1?\"(\":\"\")+pop1.value+(pop1.type!=1?\")\":\"\"),type:arr[i].type});\r\n\t\t}\r\n\t\telse if(arr[i].type===12){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tpop3=disp.pop();\r\n\t\t\tdisp.push({value:arr[i].show+\"(\"+pop3.value+\",\"+pop2.value+\",\"+pop1.value+\")\",type:12});\r\n\t\t}\r\n\t}\r\n\treturn disp[0].value;\r\n};\r\nmodule.exports=Mexp;","<script>\n  import mexp from 'math-expression-evaluator';\n  export let value;\n  export let label;\n  export let min = undefined;\n  export let max = undefined;\n  export let disabled = undefined;\n  export let showArrows = false;\n  export let evalExpr = true;\n\n  let lastValidValue = value;\n  function evalMath() {\n    if (evalExpr) {\n      let result = value;\n      try {\n        result = mexp.eval(result);\n      } catch (e) {\n        // sic\n      }\n      value = Math.floor(result);\n      if (max !== undefined) {\n        value = Math.min(max, result);\n      }\n      if (min !== undefined) {\n        value = Math.max(min, result);\n      }\n      if (isNaN(value)) {\n        value = lastValidValue;\n      } else {\n        lastValidValue = value;\n      }\n    }\n  }\n\n  function keydown(e) {\n    if (showArrows) {\n      if (e.key === 'ArrowUp') {\n        event.preventDefault();\n        value++;\n      } else if (e.key === 'ArrowDown') {\n        event.preventDefault();\n        value--;\n      }\n    }\n  }\n</script>\n\n<label class:disabled for=\"number-input\"\n  >{label}\n  <div>\n    <input\n      name=\"number-input\"\n      type=\"text\"\n      on:blur={evalMath}\n      on:keydown={keydown}\n      bind:value\n      autocomplete=\"off\"\n      {min}\n      {max}\n      {disabled}\n    />\n    {#if showArrows}\n      <button class=\"arrow top\" type=\"button\" on:click={() => value++}>▲</button\n      >\n      <button class=\"arrow bottom\" type=\"button\" on:click={() => value--}\n        >▼</button\n      >\n    {/if}\n  </div>\n</label>\n\n<style>\n  label > div {\n    display: flex;\n    position: relative;\n  }\n\n  button.arrow {\n    position: absolute;\n    right: 0;\n    margin: 0;\n    padding: 0;\n    margin-right: 2px;\n    padding-left: 2px;\n    padding-right: 2px;\n  }\n\n  .top {\n    top: 4px;\n  }\n\n  .bottom {\n    bottom: 8px;\n  }\n\n  input {\n    margin: 4px 0 0.5em 0;\n    box-sizing: border-box;\n    border-radius: 4px;\n    padding: 10px 8px;\n    background-color: white;\n    border: 1px solid transparent;\n    display: block;\n    width: 100%;\n    font-size: 16px;\n  }\n\n  label.disabled,\n  input:disabled {\n    color: #ccc;\n  }\n\n  input:not(:disabled):hover {\n    border: 1px solid var(--color-4);\n    cursor: pointer;\n  }\n</style>\n","function n(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=Y[n],o=i?\"function\"==typeof i?i.apply(null,t):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(t.length?\" \"+t.map((function(n){return\"'\"+n+\"'\"})).join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function r(n){return!!n&&!!n[Q]}function t(n){return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var r=Object.getPrototypeOf(n);if(null===r)return!0;var t=Object.hasOwnProperty.call(r,\"constructor\")&&r.constructor;return\"function\"==typeof t&&Function.toString.call(t)===Z}(n)||Array.isArray(n)||!!n[L]||!!n.constructor[L]||s(n)||v(n))}function e(t){return r(t)||n(23,t),t[Q].t}function i(n,r,t){void 0===t&&(t=!1),0===o(n)?(t?Object.keys:nn)(n).forEach((function(e){t&&\"symbol\"==typeof e||r(e,n[e],n)})):n.forEach((function(t,e){return r(e,t,n)}))}function o(n){var r=n[Q];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:s(n)?2:v(n)?3:0}function u(n,r){return 2===o(n)?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function a(n,r){return 2===o(n)?n.get(r):n[r]}function f(n,r,t){var e=o(n);2===e?n.set(r,t):3===e?(n.delete(r),n.add(t)):n[r]=t}function c(n,r){return n===r?0!==n||1/n==1/r:n!=n&&r!=r}function s(n){return X&&n instanceof Map}function v(n){return q&&n instanceof Set}function p(n){return n.o||n.t}function l(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=rn(n);delete r[Q];for(var t=nn(r),e=0;e<t.length;e++){var i=t[e],o=r[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),r)}function d(n,e){return void 0===e&&(e=!1),y(n)||r(n)||!t(n)?n:(o(n)>1&&(n.set=n.add=n.clear=n.delete=h),Object.freeze(n),e&&i(n,(function(n,r){return d(r,!0)}),!0),n)}function h(){n(2)}function y(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function b(r){var t=tn[r];return t||n(18,r),t}function m(n,r){tn[n]||(tn[n]=r)}function _(){return\"production\"===process.env.NODE_ENV||U||n(0),U}function j(n,r){r&&(b(\"Patches\"),n.u=[],n.s=[],n.v=r)}function g(n){O(n),n.p.forEach(S),n.p=null}function O(n){n===U&&(U=n.l)}function w(n){return U={p:[],l:U,h:n,m:!0,_:0}}function S(n){var r=n[Q];0===r.i||1===r.i?r.j():r.g=!0}function P(r,e){e._=e.p.length;var i=e.p[0],o=void 0!==r&&r!==i;return e.h.O||b(\"ES5\").S(e,r,o),o?(i[Q].P&&(g(e),n(4)),t(r)&&(r=M(e,r),e.l||x(e,r)),e.u&&b(\"Patches\").M(i[Q],r,e.u,e.s)):r=M(e,i,[]),g(e),e.u&&e.v(e.u,e.s),r!==H?r:void 0}function M(n,r,t){if(y(r))return r;var e=r[Q];if(!e)return i(r,(function(i,o){return A(n,e,r,i,o,t)}),!0),r;if(e.A!==n)return r;if(!e.P)return x(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=l(e.k):e.o;i(3===e.i?new Set(o):o,(function(r,i){return A(n,e,o,r,i,t)})),x(n,o,!1),t&&n.u&&b(\"Patches\").R(e,t,n.u,n.s)}return e.o}function A(e,i,o,a,c,s){if(\"production\"!==process.env.NODE_ENV&&c===o&&n(5),r(c)){var v=M(e,c,s&&i&&3!==i.i&&!u(i.D,a)?s.concat(a):void 0);if(f(o,a,v),!r(v))return;e.m=!1}if(t(c)&&!y(c)){if(!e.h.F&&e._<1)return;M(e,c),i&&i.A.l||x(e,c)}}function x(n,r,t){void 0===t&&(t=!1),n.h.F&&n.m&&d(r,t)}function z(n,r){var t=n[Q];return(t?p(t):n)[r]}function I(n,r){if(r in n)for(var t=Object.getPrototypeOf(n);t;){var e=Object.getOwnPropertyDescriptor(t,r);if(e)return e;t=Object.getPrototypeOf(t)}}function k(n){n.P||(n.P=!0,n.l&&k(n.l))}function E(n){n.o||(n.o=l(n.t))}function R(n,r,t){var e=s(r)?b(\"MapSet\").N(r,t):v(r)?b(\"MapSet\").T(r,t):n.O?function(n,r){var t=Array.isArray(n),e={i:t?1:0,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:null,o:null,j:null,C:!1},i=e,o=en;t&&(i=[e],o=on);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(r,t):b(\"ES5\").J(r,t);return(t?t.A:_()).p.push(e),e}function D(e){return r(e)||n(22,e),function n(r){if(!t(r))return r;var e,u=r[Q],c=o(r);if(u){if(!u.P&&(u.i<4||!b(\"ES5\").K(u)))return u.t;u.I=!0,e=F(r,c),u.I=!1}else e=F(r,c);return i(e,(function(r,t){u&&a(u.t,r)===t||f(e,r,n(t))})),3===c?new Set(e):e}(e)}function F(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return l(n)}function N(){function t(n,r){var t=s[n];return t?t.enumerable=r:s[n]=t={configurable:!0,enumerable:r,get:function(){var r=this[Q];return\"production\"!==process.env.NODE_ENV&&f(r),en.get(r,n)},set:function(r){var t=this[Q];\"production\"!==process.env.NODE_ENV&&f(t),en.set(t,n,r)}},t}function e(n){for(var r=n.length-1;r>=0;r--){var t=n[r][Q];if(!t.P)switch(t.i){case 5:a(t)&&k(t);break;case 4:o(t)&&k(t)}}}function o(n){for(var r=n.t,t=n.k,e=nn(t),i=e.length-1;i>=0;i--){var o=e[i];if(o!==Q){var a=r[o];if(void 0===a&&!u(r,o))return!0;var f=t[o],s=f&&f[Q];if(s?s.t!==a:!c(f,a))return!0}}var v=!!r[Q];return e.length!==nn(r).length+(v?0:1)}function a(n){var r=n.k;if(r.length!==n.t.length)return!0;var t=Object.getOwnPropertyDescriptor(r,r.length-1);return!(!t||t.get)}function f(r){r.g&&n(3,JSON.stringify(p(r)))}var s={};m(\"ES5\",{J:function(n,r){var e=Array.isArray(n),i=function(n,r){if(n){for(var e=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(e,\"\"+i,t(i,!0));return e}var o=rn(r);delete o[Q];for(var u=nn(o),a=0;a<u.length;a++){var f=u[a];o[f]=t(f,n||!!o[f].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(e,n),o={i:e?5:4,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,Q,{value:o,writable:!0}),i},S:function(n,t,o){o?r(t)&&t[Q].A===n&&e(n.p):(n.u&&function n(r){if(r&&\"object\"==typeof r){var t=r[Q];if(t){var e=t.t,o=t.k,f=t.D,c=t.i;if(4===c)i(o,(function(r){r!==Q&&(void 0!==e[r]||u(e,r)?f[r]||n(o[r]):(f[r]=!0,k(t)))})),i(e,(function(n){void 0!==o[n]||u(o,n)||(f[n]=!1,k(t))}));else if(5===c){if(a(t)&&(k(t),f.length=!0),o.length<e.length)for(var s=o.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<o.length;v++)f[v]=!0;for(var p=Math.min(o.length,e.length),l=0;l<p;l++)void 0===f[l]&&n(o[l])}}}}(n.p[0]),e(n.p))},K:function(n){return 4===n.i?o(n):a(n)}})}function T(){function e(n){if(!t(n))return n;if(Array.isArray(n))return n.map(e);if(s(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],e(n[1])]})));if(v(n))return new Set(Array.from(n).map(e));var r=Object.create(Object.getPrototypeOf(n));for(var i in n)r[i]=e(n[i]);return u(n,L)&&(r[L]=n[L]),r}function f(n){return r(n)?e(n):n}var c=\"add\";m(\"Patches\",{$:function(r,t){return t.forEach((function(t){for(var i=t.path,u=t.op,f=r,s=0;s<i.length-1;s++){var v=o(f),p=i[s];0!==v&&1!==v||\"__proto__\"!==p&&\"constructor\"!==p||n(24),\"function\"==typeof f&&\"prototype\"===p&&n(24),\"object\"!=typeof(f=a(f,p))&&n(15,i.join(\"/\"))}var l=o(f),d=e(t.value),h=i[i.length-1];switch(u){case\"replace\":switch(l){case 2:return f.set(h,d);case 3:n(16);default:return f[h]=d}case c:switch(l){case 1:return f.splice(h,0,d);case 2:return f.set(h,d);case 3:return f.add(d);default:return f[h]=d}case\"remove\":switch(l){case 1:return f.splice(h,1);case 2:return f.delete(h);case 3:return f.delete(t.value);default:return delete f[h]}default:n(17,u)}})),r},R:function(n,r,t,e){switch(n.i){case 0:case 4:case 2:return function(n,r,t,e){var o=n.t,s=n.o;i(n.D,(function(n,i){var v=a(o,n),p=a(s,n),l=i?u(o,n)?\"replace\":c:\"remove\";if(v!==p||\"replace\"!==l){var d=r.concat(n);t.push(\"remove\"===l?{op:l,path:d}:{op:l,path:d,value:p}),e.push(l===c?{op:\"remove\",path:d}:\"remove\"===l?{op:c,path:d,value:f(v)}:{op:\"replace\",path:d,value:f(v)})}}))}(n,r,t,e);case 5:case 1:return function(n,r,t,e){var i=n.t,o=n.D,u=n.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[e,t];t=s[0],e=s[1]}for(var v=0;v<i.length;v++)if(o[v]&&u[v]!==i[v]){var p=r.concat([v]);t.push({op:\"replace\",path:p,value:f(u[v])}),e.push({op:\"replace\",path:p,value:f(i[v])})}for(var l=i.length;l<u.length;l++){var d=r.concat([l]);t.push({op:c,path:d,value:f(u[l])})}i.length<u.length&&e.push({op:\"replace\",path:r.concat([\"length\"]),value:i.length})}(n,r,t,e);case 3:return function(n,r,t,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=r.concat([u]);t.push({op:\"remove\",path:i,value:n}),e.unshift({op:c,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=r.concat([u]);t.push({op:c,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,r,t,e)}},M:function(n,r,t,e){t.push({op:\"replace\",path:[],value:r}),e.push({op:\"replace\",path:[],value:n.t})}})}function C(){function r(n,r){function t(){this.constructor=n}a(n,r),n.prototype=(t.prototype=r.prototype,new t)}function e(n){n.o||(n.D=new Map,n.o=new Map(n.t))}function o(n){n.o||(n.o=new Set,n.t.forEach((function(r){if(t(r)){var e=R(n.A.h,r,n);n.p.set(r,e),n.o.add(e)}else n.o.add(r)})))}function u(r){r.g&&n(3,JSON.stringify(p(r)))}var a=function(n,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t])})(n,r)},f=function(){function n(n,r){return this[Q]={i:2,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,D:void 0,t:n,k:this,C:!1,g:!1},this}r(n,Map);var o=n.prototype;return Object.defineProperty(o,\"size\",{get:function(){return p(this[Q]).size}}),o.has=function(n){return p(this[Q]).has(n)},o.set=function(n,r){var t=this[Q];return u(t),p(t).has(n)&&p(t).get(n)===r||(e(t),k(t),t.D.set(n,!0),t.o.set(n,r),t.D.set(n,!0)),this},o.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),e(r),k(r),r.D.set(n,!1),r.o.delete(n),!0},o.clear=function(){var n=this[Q];u(n),p(n).size&&(e(n),k(n),n.D=new Map,i(n.t,(function(r){n.D.set(r,!1)})),n.o.clear())},o.forEach=function(n,r){var t=this;p(this[Q]).forEach((function(e,i){n.call(r,t.get(i),i,t)}))},o.get=function(n){var r=this[Q];u(r);var i=p(r).get(n);if(r.I||!t(i))return i;if(i!==r.t.get(n))return i;var o=R(r.A.h,i,r);return e(r),r.o.set(n,o),o},o.keys=function(){return p(this[Q]).keys()},o.values=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.values()},n.next=function(){var n=t.next();return n.done?n:{done:!1,value:r.get(n.value)}},n},o.entries=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.entries()},n.next=function(){var n=t.next();if(n.done)return n;var e=r.get(n.value);return{done:!1,value:[n.value,e]}},n},o[V]=function(){return this.entries()},n}(),c=function(){function n(n,r){return this[Q]={i:3,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,g:!1,C:!1},this}r(n,Set);var t=n.prototype;return Object.defineProperty(t,\"size\",{get:function(){return p(this[Q]).size}}),t.has=function(n){var r=this[Q];return u(r),r.o?!!r.o.has(n)||!(!r.p.has(n)||!r.o.has(r.p.get(n))):r.t.has(n)},t.add=function(n){var r=this[Q];return u(r),this.has(n)||(o(r),k(r),r.o.add(n)),this},t.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),o(r),k(r),r.o.delete(n)||!!r.p.has(n)&&r.o.delete(r.p.get(n))},t.clear=function(){var n=this[Q];u(n),p(n).size&&(o(n),k(n),n.o.clear())},t.values=function(){var n=this[Q];return u(n),o(n),n.o.values()},t.entries=function(){var n=this[Q];return u(n),o(n),n.o.entries()},t.keys=function(){return this.values()},t[V]=function(){return this.values()},t.forEach=function(n,r){for(var t=this.values(),e=t.next();!e.done;)n.call(r,e.value,e.value,this),e=t.next()},n}();m(\"MapSet\",{N:function(n,r){return new f(n,r)},T:function(n,r){return new c(n,r)}})}function J(){N(),C(),T()}function K(n){return n}function $(n){return n}var G,U,W=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),X=\"undefined\"!=typeof Map,q=\"undefined\"!=typeof Set,B=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,H=W?Symbol.for(\"immer-nothing\"):((G={})[\"immer-nothing\"]=!0,G),L=W?Symbol.for(\"immer-draftable\"):\"__$immer_draftable\",Q=W?Symbol.for(\"immer-state\"):\"__$immer_state\",V=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",Y={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",21:function(n){return\"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '\"+n+\"'\"},22:function(n){return\"'current' expects a draft, got: \"+n},23:function(n){return\"'original' expects a draft, got: \"+n},24:\"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"},Z=\"\"+Object.prototype.constructor,nn=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(n){var r={};return nn(n).forEach((function(t){r[t]=Object.getOwnPropertyDescriptor(n,t)})),r},tn={},en={get:function(n,r){if(r===Q)return n;var e=p(n);if(!u(e,r))return function(n,r,t){var e,i=I(r,t);return i?\"value\"in i?i.value:null===(e=i.get)||void 0===e?void 0:e.call(n.k):void 0}(n,e,r);var i=e[r];return n.I||!t(i)?i:i===z(n.t,r)?(E(n),n.o[r]=R(n.A.h,i,n)):i},has:function(n,r){return r in p(n)},ownKeys:function(n){return Reflect.ownKeys(p(n))},set:function(n,r,t){var e=I(p(n),r);if(null==e?void 0:e.set)return e.set.call(n.k,t),!0;if(!n.P){var i=z(p(n),r),o=null==i?void 0:i[Q];if(o&&o.t===t)return n.o[r]=t,n.D[r]=!1,!0;if(c(t,i)&&(void 0!==t||u(n.t,r)))return!0;E(n),k(n)}return n.o[r]===t&&\"number\"!=typeof t||(n.o[r]=t,n.D[r]=!0,!0)},deleteProperty:function(n,r){return void 0!==z(n.t,r)||r in n.t?(n.D[r]=!1,E(n),k(n)):delete n.D[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var t=p(n),e=Reflect.getOwnPropertyDescriptor(t,r);return e?{writable:!0,configurable:1!==n.i||\"length\"!==r,enumerable:e.enumerable,value:t[r]}:e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(n,r){on[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}})),on.deleteProperty=function(r,t){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&n(13),en.deleteProperty.call(this,r[0],t)},on.set=function(r,t,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==t&&isNaN(parseInt(t))&&n(14),en.set.call(this,r[0],t,e,r[0])};var un=function(){function e(r){var e=this;this.O=B,this.F=!0,this.produce=function(r,i,o){if(\"function\"==typeof r&&\"function\"!=typeof i){var u=i;i=r;var a=e;return function(n){var r=this;void 0===n&&(n=u);for(var t=arguments.length,e=Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];return a.produce(n,(function(n){var t;return(t=i).call.apply(t,[r,n].concat(e))}))}}var f;if(\"function\"!=typeof i&&n(6),void 0!==o&&\"function\"!=typeof o&&n(7),t(r)){var c=w(e),s=R(e,r,void 0),v=!0;try{f=i(s),v=!1}finally{v?g(c):O(c)}return\"undefined\"!=typeof Promise&&f instanceof Promise?f.then((function(n){return j(c,o),P(n,c)}),(function(n){throw g(c),n})):(j(c,o),P(f,c))}if(!r||\"object\"!=typeof r){if((f=i(r))===H)return;return void 0===f&&(f=r),e.F&&d(f,!0),f}n(21,r)},this.produceWithPatches=function(n,r){return\"function\"==typeof n?function(r){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.produceWithPatches(r,(function(r){return n.apply(void 0,[r].concat(i))}))}:[e.produce(n,r,(function(n,r){t=n,i=r})),t,i];var t,i},\"boolean\"==typeof(null==r?void 0:r.useProxies)&&this.setUseProxies(r.useProxies),\"boolean\"==typeof(null==r?void 0:r.autoFreeze)&&this.setAutoFreeze(r.autoFreeze)}var i=e.prototype;return i.createDraft=function(e){t(e)||n(8),r(e)&&(e=D(e));var i=w(this),o=R(this,e,void 0);return o[Q].C=!0,O(i),o},i.finishDraft=function(r,t){var e=r&&r[Q];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return j(i,t),P(void 0,i)},i.setAutoFreeze=function(n){this.F=n},i.setUseProxies=function(r){r&&!B&&n(20),this.O=r},i.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var i=t[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}var o=b(\"Patches\").$;return r(n)?o(n,t):this.produce(n,(function(n){return o(n,t.slice(e+1))}))},e}(),an=new un,fn=an.produce,cn=an.produceWithPatches.bind(an),sn=an.setAutoFreeze.bind(an),vn=an.setUseProxies.bind(an),pn=an.applyPatches.bind(an),ln=an.createDraft.bind(an),dn=an.finishDraft.bind(an);export default fn;export{un as Immer,pn as applyPatches,K as castDraft,$ as castImmutable,ln as createDraft,D as current,J as enableAllPlugins,N as enableES5,C as enableMapSet,T as enablePatches,dn as finishDraft,d as freeze,L as immerable,r as isDraft,t as isDraftable,H as nothing,e as original,fn as produce,cn as produceWithPatches,sn as setAutoFreeze,vn as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n","let changes = [];\nlet currentIndex = -1;\nexport function undo() {\n  if (currentIndex < 0) {\n    console.log('nope undo');\n    return undefined;\n  }\n  let changeSet = changes[currentIndex].inversePatches;\n  currentIndex = Math.max(currentIndex - 1, 0);\n  return changeSet;\n}\n\nexport function redo() {\n  if (currentIndex >= changes.length) {\n    console.log('nope redo');\n    return undefined;\n  }\n  let changeSet = changes[currentIndex].patches;\n  currentIndex = Math.min(currentIndex + 1, changes.length - 1);\n  return changeSet;\n}\n\nexport function push(changeSet) {\n  if (currentIndex < changes.length) {\n    changes.length = currentIndex + 1;\n  }\n  changes.push(changeSet);\n  currentIndex++;\n}\n","let paths = new Set().add('clear');\nlet patches = {};\n\nexport default {\n  paths,\n  patches,\n  clear: () => {\n    paths.clear();\n    Object.keys(patches).forEach((p) => {\n      delete patches[p];\n    });\n  },\n};\n\nfunction addPatch(path, patch) {\n  if (patches[path] === undefined) {\n    patches[path] = [];\n  }\n  patches[path].push(patch);\n}\nexport function addChanges(changes) {\n  for (let item of changes) {\n    if (item.path[0] !== 'hoverCell' && item.path[0] !== 'isDragging') {\n      paths.add(item.path[0]);\n      addPatch(item.path[0], item);\n    }\n  }\n}\n","import { writable } from 'svelte/store';\nimport { produce, applyPatches } from 'immer';\nimport * as undo from './undo';\nimport changes from './Changes';\nimport { addChanges } from './Changes';\n\nlet draft = {};\nif (window.localStorage.getItem('draft')) {\n  draft = JSON.parse(localStorage.getItem('draft'));\n  if (draft.treadling !== undefined) {\n    draft.treadleOrder = draft.treadling;\n    delete draft.treadling;\n  }\n  if (draft.pickCount !== undefined) {\n    draft.weftCount = draft.pickCount;\n    delete draft.pickCount;\n  }\n  draft.warpColors = draft.warpColors.slice(0, draft.warpCount);\n  draft.weftColors = draft.weftColors.slice(0, draft.weftCount);\n  if (draft.yarn[0].id === undefined) {\n    for (let i = 0; i < draft.yarn.length; i++) {\n      draft.yarn[i].id = i;\n    }\n  }\n} else {\n  draft = {\n    treadleOrder: [],\n    threading: [],\n    warpColors: new Array(30).fill(1),\n    weftColors: new Array(30).fill(0),\n    tieup: [\n      [1, 0, 0, 1],\n      [0, 0, 1, 1],\n      [0, 1, 1, 0],\n      [1, 1, 0, 0],\n    ],\n    shaftCount: 4,\n    treadleCount: 4,\n    warpCount: 100,\n    weftCount: 100,\n    yarn: [\n      {\n        id: 0,\n        name: 'White yarn',\n        color: { r: 0.8, g: 0.8, b: 0.8 },\n      },\n      {\n        id: 1,\n        name: 'Black yarn',\n        color: { r: 0.72, g: 0.29, b: 0.13 },\n      },\n    ],\n  };\n\n  for (let i = 0; i < draft.warpCount; i++) {\n    draft.threading.push(i % 4);\n  }\n\n  for (let i = 0; i < draft.weftCount; i++) {\n    draft.treadleOrder.push(i % 4);\n  }\n}\n\nfunction undoDraft() {\n  let changes = undo.undo();\n  if (changes) {\n    let newDraft = applyPatches(draftSnapshot, changes);\n    addChanges(changes);\n    store.set(newDraft);\n  }\n}\n\nfunction redoDraft() {\n  let changes = undo.redo();\n  if (changes) {\n    let newDraft = applyPatches(draftSnapshot, changes);\n    addChanges(changes);\n    store.set(newDraft);\n  }\n}\n\nconst store = writable(draft);\nexport default {\n  draft: store,\n  update: function (func, storePatches = true) {\n    store.set(\n      produce(draftSnapshot, func, (patches, inversePatches) => {\n        if (storePatches) {\n          undo.push({ patches, inversePatches });\n        }\n        addChanges(patches);\n      })\n    );\n  },\n  set: function (newState) {\n    store.set(\n      produce(\n        draftSnapshot,\n        () => newState,\n        (patches, inversePatches) => {\n          undo.push({ patches, inversePatches });\n          changes.paths.add('clear');\n        }\n      )\n    );\n  },\n  subscribe: function (subscription) {\n    return store.subscribe(subscription);\n  },\n  undo: undoDraft,\n  redo: redoDraft,\n};\nlet draftSnapshot;\nstore.subscribe((value) => {\n  draftSnapshot = value;\n  window.data = draftSnapshot;\n  localStorage.setItem('draft', JSON.stringify(draftSnapshot));\n});\n\nwindow.drop = function () {\n  localStorage.removeItem('draft');\n};\n\nwindow.update = function () {\n  localStorage.setItem('draft', JSON.stringify(window.data));\n};\n\ndocument.body.addEventListener('keydown', (e) => {\n  if (e.ctrlKey === true && e.key === 'z') {\n    undoDraft();\n  } else if (e.ctrlKey === true && e.key === 'y') {\n    redoDraft();\n  }\n});\n","import { writable } from 'svelte/store';\nimport { produce } from 'immer';\nimport { addChanges } from './Changes';\n\nlet ui = {\n  selectedMenu: -1,\n  selectedColor: 0,\n  cellSize: 60,\n  scrollX: 0,\n  scrollY: 0,\n  xStepDistance: 8,\n  yStepDistance: 8,\n  showTreadleOrder: true,\n  showThreading: true,\n  selectTo: 0,\n  selectFrom: 0,\n  isDragging: false,\n  hoverCell: [0, 0],\n  disableScroll: false,\n  locale: '',\n};\nif (window.localStorage.getItem('ui')) {\n  let storedUI = JSON.parse(localStorage.getItem('ui'));\n  ui = { ...ui, ...storedUI };\n}\n\nconst store = writable(ui);\nlet prevStore = ui;\nstore.subscribe((s) => {\n  prevStore = s;\n});\n\nexport default {\n  ui: store,\n  update: function (func) {\n    store.set(produce(prevStore, func, (patches) => addChanges(patches)));\n  },\n  subscribe: function (subscription) {\n    return store.subscribe(subscription);\n  },\n};\n\nwindow.dropUi = function () {\n  localStorage.removeItem('ui');\n};\n\nstore.subscribe((value) => {\n  window.ui = value;\n  localStorage.setItem(\n    'ui',\n    JSON.stringify({\n      selectedColor: value.selectedColor,\n      cellSize: value.cellSize,\n    })\n  );\n});\n","export function updateShaftCount(draft, shaftCount) {\n  let oldLength = draft.tieup.length;\n  draft.tieup.length = shaftCount;\n  draft.tieup.fill([], oldLength);\n  draft.shaftCount = shaftCount;\n}\n\nexport function updateTreadleCount(draft, treadleCount) {\n  draft.tieup.forEach((t) => {\n    let oldLength = t.length;\n    t.length = treadleCount;\n    t.fill(0, oldLength);\n  });\n  draft.treadleCount = treadleCount;\n}\n\nexport function updateWarpCount(draft, warpCount) {\n  let amountToAdd = warpCount - draft.warpCount;\n  if (amountToAdd === 0) {\n    return draft;\n  }\n  draft.warpCount = warpCount;\n  changeArraySize(draft.warpColors, warpCount);\n  changeArraySize(draft.threading, warpCount);\n}\n\nexport function updateWeftCount(draft, weftCount) {\n  let amountToAdd = weftCount - draft.weftCount;\n  if (amountToAdd === 0) {\n    return draft;\n  }\n  draft.weftCount = weftCount;\n  changeArraySize(draft.weftColors, weftCount);\n  changeArraySize(draft.treadleOrder, weftCount);\n}\n\nexport function applyPattern(\n  draft,\n  pattern,\n  warpOrWeft,\n  mirroredRepeat,\n  start = 0,\n  end = warpOrWeft === 'warp' ? draft.warpCount : draft.weftCount\n) {\n  let array = draft[warpOrWeft === 'warp' ? 'threading' : 'treadleOrder'];\n\n  let offset = 0;\n  let length = Math.min(end - start, array.length - start);\n  for (let i = start; i < length; i++) {\n    if (mirroredRepeat && i !== 0 && i % (pattern.length - 1) === 0) {\n      offset += 1;\n    }\n    let j = i + offset;\n    let v = j % pattern.length;\n    if (mirroredRepeat && Math.floor(j / pattern.length) % 2 === 1) {\n      v = pattern.length - (j % pattern.length) - 1;\n    }\n    array[i] = pattern[v];\n  }\n}\n\nexport function changeArraySize(array, newSize) {\n  let amountToAdd = newSize - array.length;\n  if (amountToAdd > 0) {\n    let originalSize = array.length;\n    for (let i = 0; i < amountToAdd; i++) {\n      array.push(array[i % originalSize]);\n    }\n  } else {\n    array.splice(array.length + amountToAdd);\n  }\n}\n\nexport function applyColor(\n  draft,\n  colors,\n  warpOrWeft,\n  start = 0,\n  length = warpOrWeft === 'warp' ? draft.warpCount : draft.weftCount\n) {\n  let newColors = draft[warpOrWeft === 'warp' ? 'warpColors' : 'weftColors'];\n  for (let i = start; i < length; i++) {\n    newColors[i] = colors[i % colors.length];\n  }\n}\n\nexport function removeYarn(draft, yarnToRemoveId) {\n  let oldIndex = draft.yarn.findIndex((yarn) => yarn.id === yarnToRemoveId);\n  let newYarnId;\n  if (oldIndex === 0) {\n    newYarnId = draft.yarn[1].id;\n  } else {\n    newYarnId = draft.yarn[oldIndex - 1].id;\n  }\n\n  draft.yarn.splice(oldIndex, 1);\n\n  for (let i = 0; i < draft.warpColors.length; i++) {\n    let yarnIndex = draft.warpColors[i];\n    if (yarnIndex === yarnToRemoveId) {\n      draft.warpColors[i] = newYarnId;\n    }\n  }\n  for (let i = 0; i < draft.weftColors.length; i++) {\n    let yarnIndex = draft.weftColors[i];\n    if (yarnIndex === yarnToRemoveId) {\n      draft.weftColors[i] = newYarnId;\n    }\n  }\n}\n\nexport function newYarn(draft, yarn) {\n  let id = draft.yarn.map((a) => a.id).reduce((a, b) => Math.max(a, b)) + 1;\n  draft.yarn.push({ ...yarn, id });\n}\n","<script>\n  import NumberInput from 'components/NumberInput/NumberInput';\n  import draft from 'stores/Draft';\n  import ui from 'stores/UI';\n  import * as draftUtil from 'util/DraftUtil';\n  import { t } from 'precompile-intl-runtime';\n\n  let shaftCount = $draft.shaftCount;\n  let treadleCount = $draft.treadleCount;\n  let warpCount = $draft.warpCount;\n  let weftCount = $draft.weftCount;\n\n  function submit(event) {\n    event.preventDefault();\n    draft.update((temp) => {\n      if ($draft.shaftCount !== shaftCount) {\n        draftUtil.updateShaftCount(temp, shaftCount);\n      }\n      if ($draft.treadleCount !== treadleCount) {\n        draftUtil.updateTreadleCount(temp, treadleCount);\n      }\n      if ($draft.warpCount !== warpCount) {\n        draftUtil.updateWarpCount(temp, warpCount);\n      }\n      if ($draft.weftCount !== weftCount) {\n        draftUtil.updateWeftCount(temp, weftCount);\n      }\n    }, false);\n    ui.update((temp) => {\n      temp.selectedMenu = -1;\n    });\n  }\n</script>\n\n<form on:submit={submit}>\n  <NumberInput\n    label={$t('page.weave_settings.shaft_count')}\n    bind:value={shaftCount}\n    showArrows={true}\n  />\n  <NumberInput\n    label={$t('page.weave_settings.treadle_count')}\n    bind:value={treadleCount}\n    showArrows={true}\n  />\n  <NumberInput\n    label={$t('page.weave_settings.warp_count')}\n    bind:value={warpCount}\n  />\n  <NumberInput\n    label={$t('page.weave_settings.weft_count')}\n    bind:value={weftCount}\n  />\n\n  <button class=\"submit\">{$t('terms.save')}</button>\n</form>\n\n<style>\n  form {\n    display: flex;\n    flex-direction: column;\n  }\n\n  form > * {\n    margin: 8px 4px;\n  }\n</style>\n","<script>\n  export let value;\n  export let label;\n  export let disabled = false;\n</script>\n\n<label class:disabled\n  >{label}\n  <input\n    type=\"text\"\n    autocomplete=\"number\"\n    id=\"warp-count\"\n    on:input\n    bind:value\n    {disabled}\n  />\n</label>\n\n<style>\n  label {\n    margin-bottom: 4px;\n  }\n  input {\n    margin: 4px 0 0.5em 0;\n    box-sizing: border-box;\n    border-radius: 4px;\n    padding: 10px 8px;\n    background-color: white;\n    border: 1px solid transparent;\n    display: block;\n    width: 100%;\n    font-size: 16px;\n  }\n\n  label.disabled,\n  input:disabled {\n    color: #ccc;\n  }\n\n  input:not(:disabled):hover {\n    border: 1px solid var(--color-4);\n    cursor: pointer;\n  }\n</style>\n","<script>\n  import tinycolor from 'tinycolor2';\n  import TextInput from 'components/TextInput/TextInput';\n  import draft from 'stores/Draft';\n  import ui from 'stores/UI';\n  import * as draftUtil from 'util/DraftUtil';\n  import { t } from 'precompile-intl-runtime';\n  import { onMount, onDestroy } from 'svelte';\n  import { colorPickerStore } from '../../ColorPickerDialog/ColorPickerStore.js';\n\n  window.tinycolor = tinycolor;\n\n  let colors = [];\n  $: {\n    $draft.yarn.forEach((y) => {\n      colors[y.id] = tinycolor.fromRatio(y.color);\n    });\n  }\n  //let color = { r: 1.0, g: 0.0, b: 0.0 };\n  //let newYarnColor = color;\n  let colorListener;\n\n  $: yarnUnderModification = $ui.selectedColor;\n  $: selectedYarn = $draft.yarn.find((y) => yarnUnderModification === y.id);\n  $: selectedColor = tinycolor.fromRatio(selectedYarn?.color);\n  let showImport = false;\n  let importData;\n\n  function focus(elm) {\n    elm.focus();\n  }\n\n  onMount(() => {\n    colorListener = colorPickerStore.onColorChange((color) => {\n      if (yarnUnderModification !== -1) {\n        draft.update((temp) => {\n          temp.yarn.find((a) => a.id === yarnUnderModification).color = color;\n        });\n      }\n    });\n  });\n\n  onDestroy(() => {\n    colorPickerStore.removeListener(colorListener);\n  });\n\n  function createNewYarn(event) {\n    event.preventDefault();\n\n    let id = $draft.yarn.map((a) => a.id).reduce((a, b) => Math.max(a, b)) + 1;\n    draft.update((temp) => {\n      draftUtil.newYarn(temp, {\n        name: 'Yarn',\n        color: { r: 1.0, g: 1.0, b: 1.0 },\n      });\n    });\n    ui.update((temp) => {\n      temp.selectedColor = id;\n    });\n  }\n\n  function selectYarnForModification(event, i) {\n    ui.update((temp) => {\n      temp.selectedColor = i;\n    });\n  }\n\n  function changeName(newName, yarnId) {\n    draft.update((temp) => {\n      temp.yarn.find((a) => a.id === yarnId).name = newName;\n    });\n  }\n\n  function deleteColor(id) {\n    ui.update((temp) => {\n      let indexOf = $draft.yarn.findIndex((a) => a.id === id);\n      if (indexOf == 0) {\n        indexOf = 2;\n      }\n      temp.selectedColor = $draft.yarn[indexOf - 1].id;\n    });\n    draft.update((temp) => {\n      draftUtil.removeYarn(temp, id);\n    });\n  }\n\n  function showColorPicker(event) {\n    event.preventDefault();\n    colorPickerStore.showColorPicker(\n      event.pageX,\n      event.pageY,\n      selectedYarn.color\n    );\n  }\n\n  /*\n   CSV\n397367,63ccca,5da399,42858c,35393c\n\n   Array\n[\"397367\",\"63ccca\",\"5da399\",\"42858c\",\"35393c\"]\n\n Object\n{\"Hookers Green\":\"397367\",\"Medium Turquoise\":\"63ccca\",\"Polished Pine\":\"5da399\",\"Steel Teal\":\"42858c\",\"Onyx\":\"35393c\"}\n\n Extended Array \n[{\"name\":\"Hookers Green\",\"hex\":\"397367\",\"rgb\":[57,115,103],\"cmyk\":[50,0,10,55],\"hsb\":[168,50,45],\"hsl\":[168,34,34],\"lab\":[44,-22,1]},{\"name\":\"Medium Turquoise\",\"hex\":\"63ccca\",\"rgb\":[99,204,202],\"cmyk\":[51,0,1,20],\"hsb\":[179,51,80],\"hsl\":[179,51,59],\"lab\":[76,-31,-8]},{\"name\":\"Polished Pine\",\"hex\":\"5da399\",\"rgb\":[93,163,153],\"cmyk\":[43,0,6,36],\"hsb\":[171,43,64],\"hsl\":[171,28,50],\"lab\":[62,-25,-2]},{\"name\":\"Steel Teal\",\"hex\":\"42858c\",\"rgb\":[66,133,140],\"cmyk\":[53,5,0,45],\"hsb\":[186,53,55],\"hsl\":[186,36,40],\"lab\":[52,-19,-10]},{\"name\":\"Onyx\",\"hex\":\"35393c\",\"rgb\":[53,57,60],\"cmyk\":[12,5,0,76],\"hsb\":[206,12,24],\"hsl\":[206,6,22],\"lab\":[24,-1,-2]}]\n  */\n\n  function toRatio(color) {\n    return {\n      r: color.r / 255,\n      g: color.g / 255,\n      b: color.b / 255,\n    };\n  }\n\n  function addImportedColors(event) {\n    event.preventDefault();\n    console.log('Please import ' + importData);\n    let str = importData.trim();\n    let yarns = [];\n    try {\n      let json = JSON.parse(str);\n      if (json instanceof Array) {\n        if (json[0] instanceof Object) {\n          //It's an extended array\n          for (let item of json) {\n            let color = tinycolor(item.hex);\n            if (!color.isValid()) {\n              throw new Error('Invalid color', item);\n            }\n            yarns.push({\n              name: item.name,\n              color: toRatio(color.toRgb()),\n            });\n          }\n        } else {\n          //It's array of strings\n          for (let item of json) {\n            let color = tinycolor(item);\n            if (!color.isValid()) {\n              throw new Error('Invalid color', item);\n            }\n            yarns.push({\n              name: 'Yarn',\n              color: toRatio(color.toRgb()),\n            });\n          }\n        }\n      } else {\n        //It's an object of key-values\n        for (let item of Object.entries(json)) {\n          let color = tinycolor(item[1]);\n          if (!color.isValid()) {\n            throw new Error('Invalid color', item);\n          }\n          yarns.push({\n            name: item[0],\n            color: toRatio(color.toRgb()),\n          });\n        }\n      }\n    } catch (e) {\n      //Either it is an csv or a junk string\n      let arr = importData.split(',');\n      for (let item of arr) {\n        let color = tinycolor(item);\n        if (!color.isValid()) {\n          //It's a junk string\n          //Show error\n          console.error('Unable to import colors from string ' + importData, e);\n          showImport = false;\n          return;\n        }\n        yarns.push({\n          name: 'Yarn',\n          color: toRatio(color.toRgb()),\n        });\n      }\n    }\n\n    if (yarns.length > 0) {\n      draft.update((temp) => {\n        for (let y of yarns) {\n          draftUtil.newYarn(temp, y);\n        }\n      });\n    }\n\n    importData = '';\n    showImport = false;\n  }\n</script>\n\n<div class=\"yarn-settings\">\n  <div class=\"container\">\n    <div class=\"add-or-remove\">\n      <button class=\"add\" on:click={createNewYarn}>+</button>\n      <button\n        disabled={$draft.yarn.length <= 1 || undefined}\n        class=\"remove\"\n        on:click={() => deleteColor(yarnUnderModification)}>-</button\n      >\n    </div>\n    <div class=\"yarns\">\n      {#each $draft.yarn as yarn}\n        <button\n          class:selected={yarnUnderModification === yarn.id}\n          class=\"yarn\"\n          on:click={(e) => selectYarnForModification(e, yarn.id)}\n        >\n          <div\n            class=\"color\"\n            style={`background-color: ${colors[yarn.id].toHexString()};`}\n          />\n          <div class=\"name\">{yarn.name}</div>\n        </button>\n      {/each}\n    </div>\n  </div>\n  {#if !showImport}\n    <button on:click={() => (showImport = true)}>Paste</button>\n  {:else}\n    <form on:submit={addImportedColors}>\n      <input\n        type=\"text\"\n        bind:value={importData}\n        on:blur={() => (showImport = false)}\n        use:focus\n      />\n    </form>\n  {/if}\n  {#if yarnUnderModification !== -1}\n    <div>\n      <TextInput\n        label={$t('page.yarn_settings.name')}\n        value={selectedYarn?.name}\n        on:input={(e) => changeName(e.target.value, yarnUnderModification)}\n      />\n      <div>\n        <label for=\"newYarnColor\">{$t('terms.color')}</label>\n        <button\n          class=\"yarn-color-change\"\n          style={`background-color: ${selectedColor.toHexString()};`}\n          on:click={showColorPicker}\n        />\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .container {\n    display: flex;\n    align-items: start;\n  }\n\n  .add-or-remove {\n    margin-right: 5px;\n    text-align: center;\n    background-color: var(--color-2);\n    padding: 4px;\n    color: white;\n    border-radius: 4px;\n    border: 1px solid #535353;\n\n    display: flex;\n    flex-direction: column;\n  }\n\n  .add-or-remove button {\n    color: var(--color-1);\n    background: none;\n    border: none;\n    margin: 0;\n    padding: 0;\n    width: 2em;\n    height: 2em;\n  }\n\n  .add-or-remove button:disabled {\n    color: gray;\n  }\n\n  .yarn {\n    background: none;\n    border: none;\n\n    display: flex;\n    color: var(--color-1);\n    margin: 4px;\n    padding: 4px 0;\n    border-radius: 4px;\n  }\n\n  .yarn.selected {\n    color: var(--color-2);\n    background-color: var(--color-1);\n  }\n\n  .yarn:not(:first-child):before {\n  }\n\n  .name {\n    margin-left: 4px;\n  }\n\n  .color {\n    margin-left: 4px;\n    width: 1em;\n    height: 1em;\n    border: 1px solid var(--color-2);\n  }\n\n  .yarns {\n    background-color: var(--color-2);\n    min-width: 10em;\n    border-radius: 4px;\n    border: 1px solid #535353;\n\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n  }\n\n  .yarn-color-change {\n    width: 100%;\n    margin: 0;\n    padding: 8px;\n    border-radius: 4px;\n    border: 1px solid var(--color-2);\n  }\n</style>\n","<script>\n  export let checked;\n  export let label;\n  export let disabled = false;\n</script>\n\n<label class:disabled\n  >{label}\n  <input type=\"checkbox\" id=\"warp-count\" bind:checked {disabled} />\n</label>\n\n<style>\n  label {\n    margin-top: 4px;\n    margin-bottom: 4px;\n  }\n  label:not(:first-child) {\n    margin-bottom: 4px;\n  }\n  label:not(:last-child) {\n    margin-top: 4px;\n  }\n\n  label {\n    display: flex;\n    flex-direction: row-reverse;\n    justify-content: flex-end;\n    align-items: center;\n  }\n\n  input {\n    margin-right: 8px;\n    -webkit-appearance: none;\n    appearance: none;\n    background-color: white;\n  }\n\n  input[type='checkbox'] {\n    width: 1.2em;\n    height: 1.2em;\n    border: 1px solid gray;\n    vertical-align: -2px;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  input[type='checkbox']::before {\n    transition: opacity 100ms;\n    content: '✔';\n    position: absolute;\n    font-size: 1.5em;\n    opacity: 0;\n  }\n\n  input[type='checkbox']:checked::before {\n    opacity: 1;\n  }\n\n  input[type='checkbox']:disabled {\n    border-color: black;\n    background: #ddd;\n    color: gray;\n  }\n</style>\n","import { writable } from 'svelte/store';\nimport { produce } from 'immer';\n\nlet selection = {\n  isSelecting: false,\n  from: [0, 0],\n  to: [10, 10],\n  useThreading: false,\n  useWarpColors: false,\n  useTreadleOrder: false,\n  useWeftColors: false,\n};\n\nconst store = writable(selection);\nlet prevStore = selection;\n\nstore.subscribe((s) => {\n  prevStore = s;\n});\n\nexport default {\n  selection: store,\n  update: function (func) {\n    store.set(produce(prevStore, func));\n  },\n  subscribe: function (subscription) {\n    return store.subscribe(subscription);\n  },\n};\n","<script>\n  import NumberInput from 'components/NumberInput/NumberInput';\n  import CheckboxInput from 'components/CheckboxInput/CheckboxInput';\n  import { onMount, onDestroy } from 'svelte';\n  import draft from 'stores/Draft';\n  import selection from '../../Selection/SelectionStore';\n  import * as draftUtil from 'util/DraftUtil';\n  import ui from 'stores/UI';\n  import { t } from 'precompile-intl-runtime';\n\n  $: useThreading = $selection.useThreading;\n  $: useTreadleOrder = $selection.useTreadleOrder;\n  $: useWarpColors = $selection.useWarpColors;\n  $: useWeftColors = $selection.useWeftColors;\n  $: maxLength = Math.max($draft.warpCount, $draft.weftCount);\n  $: selectionFrom = $selection.from;\n  $: selectionTo = $selection.to;\n  $: targetFrom = 0;\n  $: targetTo = maxLength;\n  let fillAll = true;\n\n  $: {\n    selection.update((temp) => {\n      temp.useThreading = useThreading;\n    });\n  }\n\n  $: {\n    selection.update((temp) => {\n      temp.useTreadleOrder = useTreadleOrder;\n    });\n  }\n\n  $: {\n    selection.update((temp) => {\n      temp.useWarpColors = useWarpColors;\n    });\n  }\n\n  $: {\n    selection.update((temp) => {\n      temp.useWeftColors = useWeftColors;\n    });\n  }\n\n  onMount(() => {\n    selection.update((temp) => {\n      temp.isSelecting = true;\n    });\n  });\n\n  onDestroy(() => {\n    selection.update((temp) => {\n      temp.isSelecting = false;\n    });\n  });\n\n  function submit(event) {\n    event.preventDefault();\n    draft.update((temp) => {\n      if (useThreading) {\n        draftUtil.applyPattern(\n          temp,\n          $draft.threading.slice(selectionFrom[0], selectionTo[0]),\n          'warp',\n          false,\n          targetFrom,\n          targetTo\n        );\n      }\n\n      if (useWarpColors) {\n        draftUtil.applyColor(\n          temp,\n          $draft.warpColors.slice(selectionFrom[0], selectionTo[0]),\n          'warp'\n        );\n      }\n\n      if (useTreadleOrder) {\n        draftUtil.applyPattern(\n          temp,\n          $draft.treadleOrder.slice(selectionFrom[1], selectionTo[1]),\n          'weft',\n          false,\n          targetFrom,\n          targetTo\n        );\n      }\n\n      if (useWeftColors) {\n        draftUtil.applyColor(\n          temp,\n          $draft.weftColors.slice(selectionFrom[1], selectionTo[1]),\n          'weft'\n        );\n      }\n    });\n  }\n\n  function close() {\n    ui.update((temp) => {\n      temp.selectedMenu = -1;\n    });\n  }\n</script>\n\n<div>\n  <fieldset class=\"repeat-options\">\n    <legend>{$t('page.selection.title')}</legend>\n\n    <CheckboxInput label={$t('terms.threading')} bind:checked={useThreading} />\n    <CheckboxInput\n      label={$t('terms.treadleOrder')}\n      bind:checked={useTreadleOrder}\n    />\n    <CheckboxInput label={$t('terms.warp')} bind:checked={useWarpColors} />\n    <CheckboxInput label={$t('terms.weft')} bind:checked={useWeftColors} />\n  </fieldset>\n  <legend>Target</legend>\n  <fieldset class=\"to-from-inputs\">\n    <div>\n      <label for=\"fill-all\">{$t('page.selection.fillAll')}</label>\n      <input\n        name=\"fill-all\"\n        id=\"fill-all\"\n        type=\"checkbox\"\n        bind:checked={fillAll}\n      />\n    </div>\n\n    <NumberInput label=\"From\" min=\"0\" max={maxLength} bind:value={targetFrom} />\n    <NumberInput\n      label={$t('page.selection.to')}\n      min=\"0\"\n      max={maxLength}\n      disabled={fillAll}\n      bind:value={targetTo}\n    />\n  </fieldset>\n  <div class=\"buttons\">\n    <button class=\"submit\" on:click={submit}>Apply repetition</button>\n    <button class=\"submit\" on:click={close}>Close</button>\n  </div>\n</div>\n\n<!--\n<form on:submit={submit} class=\"controls\">\n</form>\n-->\n<style>\n  fieldset {\n    margin-bottom: 10px;\n    border: none;\n  }\n\n  fieldset > *:not(legend) {\n    margin-left: 12px;\n  }\n\n  legend {\n    font-size: 1.5rem;\n  }\n\n  label {\n    margin-right: 10px;\n    display: flex;\n    align-items: center;\n  }\n\n  .to-from-inputs input {\n    margin: 5px 0;\n    width: 5rem;\n  }\n\n  .repeat-options {\n    display: grid;\n    grid-template-columns: 1fr;\n  }\n\n  .buttons {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n</style>\n","export function line(x0, y0, x1, y1) {\n  let points = [];\n\n  let dx = Math.abs(x1 - x0);\n  let sx = x0 < x1 ? 1 : -1;\n  let dy = -Math.abs(y1 - y0);\n  let sy = y0 < y1 ? 1 : -1;\n  let err = dx + dy;\n  for(;;) {\n    points.push([x0, y0]);\n    if(x0 === x1 && y0 === y1) {\n      break;\n    }\n    let e2 = 2 * err;\n    if(e2 >= dy) {\n      err += dy;\n      x0 += sx;\n    }\n    if(e2 <= dx) {\n      err += dx;\n      y0 += sy;\n    }\n  }\n  return points;\n}\n\n","<script>\n  import { onMount, onDestroy } from 'svelte';\n  import { line } from '../../util/MathUtil';\n  import tinycolor from 'tinycolor2';\n  import { vec2 } from 'gl-matrix';\n  import ui from 'stores/UI';\n\n  export let xCount;\n  export let yCount;\n  export let toggleCell = () => false;\n  export let onClick = () => {};\n  export let onMouseDown = () => {};\n  export let onMouseUp = () => {};\n  export let onMouseMove = () => {};\n  export let disabled = false;\n  export let resizeX = false;\n  export let resizeY = false;\n\n  let canvas;\n  let ctx;\n  let borderSize = 2.5;\n  let cellSize = 25;\n  let rect;\n  let resizeObserver = new ResizeObserver(() => {\n    rect = canvas.getBoundingClientRect();\n  });\n  let resizeStartPos;\n  let isResizing = false;\n\n  $: {\n    if (ctx) {\n      syncCanvasDimensions(xCount, yCount);\n    }\n  }\n\n  $: {\n    if (ctx) {\n      drawForm(xCount, yCount, disabled);\n    }\n  }\n\n  onMount(() => {\n    ctx = canvas.getContext('2d');\n    rect = canvas.getBoundingClientRect();\n    resizeObserver.observe(canvas);\n  });\n\n  onDestroy(() => {\n    resizeObserver.unobserve(canvas);\n  });\n\n  function syncCanvasDimensions(xCount, yCount) {\n    canvas.width = cellSize * xCount + 2.0 * borderSize;\n    canvas.height = cellSize * yCount + 2.0 * borderSize;\n  }\n\n  function onCanvasMouseDown(event) {\n    if (!disabled && !isResizing) {\n      onMouseDown(event);\n    }\n  }\n\n  function onCanvasMouseMove(event) {\n    if (!disabled && !isResizing) {\n      onMouseMove(event);\n    }\n  }\n\n  function onCanvasMouseUp() {\n    if (!disabled && !isResizing) {\n      onMouseUp(event);\n    }\n  }\n\n  function onCanvasClick() {\n    if (!disabled && !isResizing) {\n      onClick(event);\n    }\n  }\n\n  export function getBoundingClientRect() {\n    return canvas.getBoundingClientRect();\n  }\n\n  export function getCellsBetweenPoints(from, to) {\n    let fromCell = this.getCellAtPos(from);\n    let toCell = this.getCellAtPos(to);\n    let linePoints = line(fromCell[0], fromCell[1], toCell[0], toCell[1]);\n    return linePoints.filter(\n      (p) => p[0] >= 0 && p[0] < xCount && p[1] >= 0 && p[1] < yCount\n    );\n  }\n\n  export function getCellAtPos(pos) {\n    let canvasSize = rect.width;\n    let size = (canvasSize - borderSize) / xCount;\n    let i = Math.floor(pos[0] / size);\n    let j = Math.floor(pos[1] / size);\n    return [i, j];\n  }\n\n  function fillBorders(width, height) {\n    ctx.fillRect(0, 0, borderSize, height);\n    ctx.fillRect(width, 0, borderSize, height);\n    ctx.fillRect(0, 0, width, borderSize);\n    ctx.fillRect(0, height, width + borderSize, borderSize);\n  }\n\n  export function drawForm(xCount, yCount, disabled) {\n    ctx.fillStyle = disabled ? '#ababab' : 'white';\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    ctx.fillStyle = disabled ? 'gray' : 'black';\n    if (disabled) {\n      ctx.fillStyle = 'gray';\n    } else {\n      ctx.fillStyle = 'black';\n    }\n\n    let width = cellSize * xCount + borderSize;\n    let height = cellSize * yCount + borderSize;\n    fillBorders(width, height);\n\n    for (let i = 1; i < xCount; i++) {\n      ctx.fillRect(i * cellSize + borderSize / 2.0, 0, borderSize, height);\n    }\n    for (let i = 1; i < yCount; i++) {\n      ctx.fillRect(0, i * cellSize + borderSize / 2.0, width, borderSize);\n    }\n\n    let innerCellMargin = 10;\n    for (let i = 0; i < xCount; i++) {\n      for (let j = 0; j < yCount; j++) {\n        let value = toggleCell(j, i);\n        if (value) {\n          if (value instanceof Object) {\n            ctx.fillStyle = tinycolor.fromRatio(value).toHexString();\n          } else {\n            ctx.fillStyle = 'black';\n          }\n          ctx.fillRect(\n            i * cellSize + innerCellMargin / 2.0 + borderSize,\n            j * cellSize + innerCellMargin / 2.0 + borderSize,\n            cellSize - innerCellMargin,\n            cellSize - innerCellMargin\n          );\n        }\n      }\n    }\n  }\n\n  function onResizeMouseDown(e) {\n    resizeStartPos = [e.pageX, e.pageY];\n    isResizing = true;\n    ui.update((temp) => {\n      temp.disableScroll = true;\n    });\n    document.body.addEventListener('pointermove', onResizeMouseMove);\n    document.body.addEventListener('pointerup', onBodyMouseUp);\n    document.body.addEventListener('pointercancel', () => {\n      console.log('cancel');\n    });\n    if (resizeX) {\n      document.body.style.cursor = 'col-resize';\n    } else if (resizeY) {\n      document.body.style.cursor = 'row-resize';\n    }\n  }\n\n  function onResizeMouseMove(e) {\n    console.log('pointermove');\n    if (e.buttons === 0) {\n      console.log('stop');\n      stopDrag();\n      return;\n    }\n    let endPos = [e.pageX, e.pageY];\n    let diff = vec2.sub(vec2.create(), endPos, resizeStartPos);\n    let d = diff[resizeX ? 0 : 1] / cellSize;\n    let numCells;\n    if (d > 0.0) {\n      numCells = Math.floor(d);\n    } else {\n      numCells = -Math.floor(Math.abs(d));\n    }\n    if (numCells !== 0) {\n      if (resizeX && xCount + numCells > 0) {\n        xCount += numCells;\n        resizeStartPos[0] = resizeStartPos[0] + numCells * cellSize;\n      } else if (resizeY && yCount + numCells > 0) {\n        yCount += numCells;\n        resizeStartPos[1] = resizeStartPos[1] + numCells * cellSize;\n      }\n    }\n  }\n\n  function onBodyMouseUp() {\n    stopDrag();\n  }\n\n  function stopDrag() {\n    console.log('stopdrag');\n    ui.update((temp) => {\n      temp.disableScroll = false;\n    });\n    document.body.removeEventListener('pointermove', onResizeMouseMove);\n    document.body.removeEventListener('pointerup', onBodyMouseUp);\n    document.body.style.cursor = '';\n    isResizing = false;\n  }\n</script>\n\n<div class:resizeX class:resizeY>\n  <canvas\n    on:click={onCanvasClick}\n    on:pointerup={onCanvasMouseUp}\n    on:pointerdown={onCanvasMouseDown}\n    on:pointermove={onCanvasMouseMove}\n    bind:this={canvas}\n    style={`\n    max-width: ${xCount * cellSize + 2.0 * borderSize}px;\n    max-height: ${yCount * cellSize + 2.0 * borderSize}px;\n    `}\n    width=\"1\"\n    height=\"1\"\n    class:disabled\n  />\n  {#if !disabled && (resizeX === true || resizeY === true)}\n    <button\n      class=\"resize-btn\"\n      class:disabled\n      class:resizeX\n      class:resizeY\n      on:pointerdown={onResizeMouseDown}\n    />\n  {/if}\n</div>\n\n<style>\n  div {\n    display: flex;\n    align-items: stretch;\n    touch-action: none;\n  }\n\n  div.resizeY {\n    flex-direction: column;\n  }\n\n  canvas {\n    image-rendering: crisp-edges;\n  }\n\n  canvas:not(.disabled) {\n    cursor: pointer;\n  }\n\n  .resize-btn {\n    border-radius: 15px;\n    border: 1px solid black;\n    margin: 0;\n    padding: 0;\n    background-color: black;\n    display: flex;\n    align-items: stretch;\n  }\n\n  .resize-btn.resizeX {\n    width: 8px;\n    margin-right: 2px;\n    cursor: col-resize;\n  }\n\n  .resize-btn.resizeY {\n    height: 8px;\n    margin: 2px;\n    cursor: row-resize;\n  }\n\n  .resize-btn:after {\n    content: '';\n    display: block;\n    background-color: white;\n    border-radius: 12px;\n    flex-grow: 1;\n  }\n\n  .resize-btn.resizeX:after {\n  }\n\n  .resize-btn.resizeY:after {\n  }\n\n  .disabled.resize-btn {\n    background-color: #ababab;\n  }\n</style>\n","<script>\n  import { onMount } from 'svelte';\n  import draft from 'stores/Draft';\n  import * as draftUtil from 'util/DraftUtil';\n  import Grid from 'components/Grid/Grid.svelte';\n  import { t } from 'precompile-intl-runtime';\n\n  export let warpOrWeft;\n  export let disabled = false;\n\n  let grid;\n  let mirroredRepeat = true;\n  let oldWarpOfWeft;\n\n  let isDragging = false;\n  let startPos = undefined;\n  let linePoints = [];\n\n  let xCount = 0;\n  let yCount = 0;\n  let cellData = [];\n\n  $: treadleCount = $draft.treadleCount;\n  $: shaftCount = $draft.shaftCount;\n\n  onMount(() => {\n    xCount = treadleCount;\n    yCount = shaftCount;\n    for (let i = 0; i < xCount; i++) {\n      cellData[i] = i;\n    }\n  });\n\n  $: {\n    if (oldWarpOfWeft !== warpOrWeft) {\n      [xCount, yCount] = [yCount, xCount];\n      if (warpOrWeft === 'weft') {\n        xCount = treadleCount;\n      } else if (warpOrWeft === 'warp') {\n        yCount = shaftCount;\n      }\n      oldWarpOfWeft = warpOrWeft;\n      normalizeCellData();\n    }\n  }\n\n  function normalizeCellData() {\n    cellData = cellData.map((v) => (v > xCount - 1 ? undefined : v));\n  }\n\n  export function apply() {\n    draft.update((temp) => {\n      let length = warpOrWeft === 'warp' ? xCount : yCount;\n      let cellDataSlice = [...cellData];\n      cellDataSlice.splice(length, cellData.length);\n      draftUtil.applyPattern(temp, cellDataSlice, warpOrWeft, mirroredRepeat);\n    });\n  }\n\n  function onGridMouseMove(event) {\n    event.stopPropagation();\n    if (event.buttons === 0) {\n      startPos = undefined;\n      isDragging = false;\n      return;\n    }\n    let rect = grid.getBoundingClientRect();\n    let pos = [event.clientX - rect.left, event.clientY - rect.top];\n    if (\n      isDragging === false &&\n      event.buttons & 1 &&\n      (event.movementX !== 0 || event.movementY !== 0)\n    ) {\n      isDragging = true;\n      startPos = pos;\n    }\n    if (isDragging) {\n      let lp = grid.getCellsBetweenPoints(startPos, pos);\n      linePoints = [];\n      lp.forEach((p) => {\n        if (warpOrWeft === 'weft') {\n          linePoints[p[1]] = p[0];\n        } else if (warpOrWeft === 'warp') {\n          linePoints[p[0]] = p[1];\n        }\n      });\n      linePoints = addArrays(linePoints, cellData);\n      grid.drawForm(xCount, yCount, false);\n    }\n  }\n\n  function onGridMouseUp(event) {\n    if (isDragging) {\n      cellData = addArrays(linePoints, cellData);\n      startPos = undefined;\n      linePoints = undefined;\n      isDragging = false;\n      document.body.removeEventListener('mousemove', onGridMouseMove);\n    } else {\n      let rect = grid.getBoundingClientRect();\n      let pos = [event.clientX - rect.left, event.clientY - rect.top];\n      let [i, j] = grid.getCellAtPos(pos);\n      if (warpOrWeft === 'warp') {\n        cellData[i] = cellData[i] === j ? undefined : j;\n      } else if (warpOrWeft === 'weft') {\n        cellData[j] = cellData[j] === i ? undefined : i;\n      }\n    }\n    grid.drawForm(xCount, yCount, false);\n  }\n\n  function addArrays(left, right) {\n    let ret = [...right];\n    for (let i = 0; i < left.length; i++) {\n      if (left[i] !== undefined) {\n        ret[i] = left[i];\n      }\n    }\n    return ret;\n  }\n\n  function toggleCell(i, j) {\n    let x, y;\n    if (warpOrWeft === 'warp') {\n      x = j;\n      y = i;\n    } else if (warpOrWeft === 'weft') {\n      x = i;\n      y = j;\n    }\n\n    if (isDragging) {\n      return linePoints[x] === y;\n    } else {\n      return cellData[x] === y;\n    }\n  }\n\n  function onGridMouseDown() {\n    document.body.addEventListener('mousemove', onGridMouseMove);\n  }\n</script>\n\n<div class=\"pattern-fill\">\n  {#if warpOrWeft !== undefined}\n    <div class={'canvas ' + warpOrWeft}>\n      <Grid\n        bind:this={grid}\n        bind:xCount\n        bind:yCount\n        resizeX={warpOrWeft === 'warp'}\n        resizeY={warpOrWeft === 'weft'}\n        {toggleCell}\n        onMouseDown={onGridMouseDown}\n        onMouseUp={onGridMouseUp}\n        {disabled}\n      />\n    </div>\n    <div class=\"controls\">\n      <fieldset>\n        <label for=\"mirrored-repeat\"\n          >{$t('page.pattern_fill.mirrored_repeat')}</label\n        >\n        <input\n          type=\"checkbox\"\n          bind:checked={mirroredRepeat}\n          name=\"mirrored-repeat\"\n          id=\"mirrored-repeat\"\n        />\n      </fieldset>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .pattern-fill {\n    display: flex;\n    flex-direction: column;\n  }\n  .canvas {\n    display: flex;\n  }\n\n  .canvas.weft {\n    flex-direction: column;\n  }\n\n  .canvas.warp {\n    flex-direction: row;\n  }\n\n  .canvas :global(canvas) {\n    flex-grow: 1;\n  }\n</style>\n","<script>\n  import { t } from 'precompile-intl-runtime';\n  import HeddleThreadingFill from './HeddleThreadingFill.svelte';\n  import gridIcon from 'icons/grid.svg';\n\n  let warpOrWeft = 'warp';\n  let heddleThreadFill;\n\n  function apply() {\n    heddleThreadFill.apply();\n  }\n</script>\n\n<div class=\"button-group\">\n  <div class=\"warp\">\n    <input\n      type=\"radio\"\n      id=\"warp\"\n      name=\"warp-or-weft\"\n      value=\"warp\"\n      class:notActive={warpOrWeft === undefined}\n      bind:group={warpOrWeft}\n    />\n    <label for=\"warp\">{@html gridIcon}</label>\n  </div>\n  <div class=\"weft\">\n    <input\n      type=\"radio\"\n      id=\"weft\"\n      name=\"warp-or-weft\"\n      value=\"weft\"\n      bind:group={warpOrWeft}\n    />\n    <label for=\"weft\">{@html gridIcon}</label>\n  </div>\n</div>\n<HeddleThreadingFill {warpOrWeft} bind:this={heddleThreadFill} />\n\n<button on:click={apply}>{$t('page.pattern_fill.apply')}</button>\n\n<style>\n  .warp label {\n    flex-direction: column;\n  }\n  :global(.weft svg) {\n    transform: rotateZ(90deg);\n  }\n\n  .button-group :global(svg) {\n    width: 50px;\n    stroke: var(--color-1);\n    fill: var(--color-1);\n  }\n\n  .button-group {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    margin: 12px 0px;\n  }\n\n  .button-group input {\n    display: none;\n  }\n\n  .button-group label {\n    padding: 4px;\n    height: 50px;\n    cursor: pointer;\n    border: 1px solid var(--color-2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: var(--color-2);\n    color: var(--color-1);\n  }\n\n  .button-group input:checked + label {\n    background-color: var(--color-1);\n    color: var(--color-2);\n  }\n\n  .button-group input:checked + label :global(svg) {\n    stroke: var(--color-2);\n    fill: var(--color-2);\n  }\n\n  .button-group div:first-child label {\n    border-radius: 8px 0 0 8px;\n    border-right: 2px solid rgba(0, 0, 0, 0.2);\n  }\n\n  .button-group div:last-child label {\n    border-left: 0;\n    border-radius: 0 8px 8px 0;\n  }\n\n  .button-group div {\n    border-radius: 8px;\n    flex-grow: 1;\n    text-align: center;\n    cursor: pointer;\n    background-color: white;\n  }\n</style>\n","<script>\n  import { afterUpdate } from 'svelte';\n  export let length;\n  export let repeats = [];\n  let elements = [];\n\n  $: repeatRows = [[]];\n  $: repeatTimesPerRow = [];\n\n  $: selectedRepeat = undefined;\n  $: amountOfNumberInputs = [];\n  $: {\n    amountOfNumberInputs = [];\n    for (let i = 0; i < repeatRows.length; i++) {\n      let ids = getIds(i);\n      amountOfNumberInputs[i] = [];\n      ids.forEach((id) => {\n        amountOfNumberInputs[i].push(id);\n      });\n    }\n    amountOfNumberInputs = [...amountOfNumberInputs];\n  }\n\n  $: {\n    repeats = [];\n    for (let i = 0; i < repeatRows.length; i++) {\n      let rep = getRepeats(repeatRows[i], repeatTimesPerRow[i]);\n      if (rep.length > 0) {\n        repeats[i] = rep;\n      }\n    }\n  }\n\n  let activeElement;\n  export function insertColumn(index) {\n    for (let i = 0; i < repeatRows.length; i++) {\n      if (index < repeatRows.length - 1) {\n        repeatRows[i].splice(index, 0, repeatRows[i][index]);\n      } else {\n        repeatRows[i].push(0);\n      }\n    }\n    repeatRows = [...repeatRows];\n  }\n\n  export function removeColumn(index) {\n    for (let i = 0; i < repeatRows.length; i++) {\n      repeatRows[i].splice(index, 1);\n      postChangeCheck(repeatRows[i]);\n    }\n    repeatRows = [...repeatRows];\n  }\n\n  let distanceBetweenPoints;\n  let fromRow;\n  let fromColumn;\n  let startX;\n  let startClientX;\n  let elementActive = false;\n  function dragStart(event, row, column) {\n    //elementActive = false;\n    fromRow = row;\n    fromColumn = column;\n    startX = event.target.getBoundingClientRect().x;\n    startClientX = event.clientX;\n\n    document.body.classList.add('dragging');\n    document.addEventListener('mousemove', dragMove);\n    document.addEventListener('pointerup', dragEnd, { once: true });\n  }\n\n  //let clickFromRow;\n  //let clickFromColumn;\n  let lastX;\n  let lastFromRow;\n  let lastFromColumn;\n  function dragEnd(event) {\n    let delta = event.clientX - startClientX;\n    if (delta < 8) {\n      //Set active element here for mouse clicking action (non-dragging)\n      if (elementActive) {\n        startX = lastX;\n        fromRow = lastFromRow;\n        fromColumn = lastFromColumn;\n        dragMove(event);\n        elementActive = false;\n      } else {\n        lastX = startX;\n        lastFromRow = fromRow;\n        lastFromColumn = fromColumn;\n        elementActive = true;\n      }\n    }\n    document.body.classList.remove('dragging');\n    document.removeEventListener('mousemove', dragMove);\n  }\n\n  function dragMove(event) {\n    let x = event.clientX;\n\n    let row = repeatRows[fromRow];\n    let delta = Math.round((x - startX) / distanceBetweenPoints);\n    if (\n      delta === 0 ||\n      fromColumn + delta < 0 ||\n      fromColumn + delta > length - 2\n    ) {\n      return;\n    }\n\n    let id = row[fromColumn];\n    if (delta !== 0) {\n      while (\n        delta !== 0 &&\n        encompassUnitInRowAbove(id, fromColumn, delta, fromRow)\n      ) {\n        let change = Math.sign(delta);\n        id = modifyRepeat(id, fromRow, change, fromColumn);\n        fromColumn += change;\n        startX += distanceBetweenPoints * change;\n        delta -= change;\n      }\n      postChangeCheck();\n      repeatRows[fromRow] = row;\n      repeatRows = [...repeatRows];\n    }\n  }\n\n  function isEndpoint(position, rowNum) {\n    let row = repeatRows[rowNum];\n    let id = row[position];\n    if (\n      row[position - 1] !== id ||\n      row[position + 1] !== id ||\n      position === 0 ||\n      position === row.length - 1\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  function encompassUnitInRowAbove(id, fromColumn, delta, fromRow) {\n    if (fromRow === 0) {\n      return true;\n    }\n\n    let row = repeatRows[fromRow - 1];\n    let currentRow = repeatRows[fromRow];\n    let repeats = getRepeats(row);\n    let target = fromColumn + delta;\n\n    if (target === 0) {\n      return true;\n    }\n    if (row[target] === 0 || target === row.length - 1) {\n      return true;\n    }\n    if (isEndpoint(target, fromRow) && currentRow[target] === id) {\n      return true;\n    }\n    for (let rep of repeats) {\n      if (currentRow[target] !== id || id === 0) {\n        if (delta > 0 && target === rep.to) {\n          return true;\n        }\n        if (delta < 0 && target === rep.from) {\n          return true;\n        }\n      } else {\n        if (delta > 0 && target === rep.from) {\n          return true;\n        }\n        if (delta < 0 && target === rep.to) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function getRepeats(row, repeatTimes = []) {\n    let lastValue = -1;\n    let repeats = [];\n    for (let i = 0; i < row.length; i++) {\n      if (lastValue !== row[i]) {\n        if (repeats.length > 0) {\n          repeats[repeats.length - 1].to = i - 1;\n        }\n        repeats.push({ from: i, times: repeatTimes[row[i]], id: row[i] });\n        lastValue = row[i];\n      }\n    }\n    if (repeats.length > 0 && repeats[repeats.length - 1].to === undefined) {\n      repeats[repeats.length - 1].to = row.length - 1;\n    }\n    return repeats.filter((r) => r.id !== 0);\n  }\n\n  function getIds(row) {\n    return new Set(repeatRows[row].filter((a) => a !== 0));\n  }\n\n  function generateId(row) {\n    return repeatRows[row].reduce((a, b) => Math.max(a, b)) + 1;\n  }\n\n  function modifyRepeat(id, rowNumber, delta, position) {\n    let row = repeatRows[rowNumber];\n    if (id === 0) {\n      id = generateId(fromRow);\n      row[position] = id;\n\n      if (repeatTimesPerRow[fromRow] === undefined) {\n        repeatTimesPerRow[fromRow] = [];\n      }\n      repeatTimesPerRow[fromRow][id] = 1;\n    }\n    if (row[position + delta] !== id) {\n      row[position + delta] = id;\n      for (let i = rowNumber + 1; i < repeatRows.length; i++) {\n        let subRow = repeatRows[i];\n        if (subRow[position] !== subRow[position + delta]) {\n          subRow[position + delta] = subRow[position];\n        }\n      }\n    } else {\n      row[position] = 0;\n      for (let i = rowNumber + 1; i < repeatRows.length; i++) {\n        let subRow = repeatRows[i];\n        if (subRow[position] !== subRow[position - delta]) {\n          subRow[position] = 0;\n        }\n      }\n    }\n\n    return id;\n  }\n\n  function postChangeCheck() {\n    for (let row of repeatRows) {\n      // Remove 1-length repeats\n      for (let i = 1; i < row.length - 1; i++) {\n        let pre = row[i - 1];\n        let id = row[i];\n        let post = row[i + 1];\n        if (pre !== id && post !== id) {\n          row[i] = 0;\n        }\n      }\n      //Remove 1-length from both ends\n      if (row[0] !== row[1]) {\n        row[0] = 0;\n      }\n      if (row[row.length - 1] !== row[row.length - 2]) {\n        row[row.length - 1] = 0;\n      }\n    }\n    let lastRow = repeatRows[repeatRows.length - 1];\n    //If last row has repeats, add row with zeroes\n    if (lastRow.some((v) => v !== 0)) {\n      repeatRows.push(Array(length - 1).fill(0));\n      repeatTimesPerRow.push([]);\n      //If two last rows are all zeroes, remove one.\n    }\n    if (repeatRows.length > 1) {\n      let secondToLastRow = repeatRows[repeatRows.length - 2];\n      if (\n        (lastRow.every((v) => v === 0) &&\n          secondToLastRow.every((v) => v === 0)) ||\n        (secondToLastRow[0] !== 0 &&\n          secondToLastRow.every((v) => v === secondToLastRow[0]))\n      ) {\n        repeatRows.length = repeatRows.length - 1;\n      }\n    }\n  }\n\n  function getPositionOfNumberInput(id, row) {\n    let elms = elements[row];\n    let buttons = elms.querySelectorAll('button');\n    let first;\n    let last;\n    for (let i = 0; i < buttons.length; i++) {\n      let item = Number(buttons[i].getAttribute('data-id'));\n      if (first === undefined && item === id) {\n        first = i;\n      }\n      if (first !== undefined && item !== id) {\n        last = i - 1;\n        break;\n      }\n    }\n    if (\n      last === undefined &&\n      Number(buttons[buttons.length - 1].getAttribute('data-id')) === id\n    ) {\n      last = buttons.length - 1;\n    }\n    let firstRect = buttons[first].getBoundingClientRect();\n    let lastRect = buttons[last].getBoundingClientRect();\n    let parentRect = elms.getBoundingClientRect();\n    return [\n      (firstRect.x + lastRect.x) / 2.0 - parentRect.x - firstRect.width / 2,\n      (firstRect.y + lastRect.y) / 2.0 - parentRect.y - 2,\n    ];\n  }\n\n  afterUpdate(() => {\n    elements\n      .filter((e) => e !== null)\n      .forEach((element) => {\n        let inputs = element.querySelectorAll('.times-input');\n        inputs.forEach((elm) => {\n          let pos = getPositionOfNumberInput(\n            Number(elm.getAttribute('data-id')),\n            Number(elm.getAttribute('data-row'))\n          );\n          elm.style.left = pos[0] + 'px';\n          elm.style.top = pos[1] + 'px';\n        });\n      });\n    if (\n      distanceBetweenPoints === undefined &&\n      elements !== undefined &&\n      elements[0] !== undefined\n    ) {\n      let buttons = elements[0].querySelectorAll('button');\n      if (buttons[0] !== undefined && buttons[1] !== undefined) {\n        let a = buttons[0].getBoundingClientRect();\n        let b = buttons[1].getBoundingClientRect();\n        distanceBetweenPoints = b.x - a.x;\n      }\n    }\n  });\n\n  function setRepeatTimes(id, row, value) {\n    repeatTimesPerRow[row][id] = value;\n    repeatTimesPerRow = [...repeatTimesPerRow];\n  }\n</script>\n\n{#if length > 2}\n  {#each repeatRows as repeatRow, row}\n    <tr class=\"repeat\" bind:this={elements[row]}>\n      {#each { length } as _, column}\n        <td>\n          <div class=\"repeat-container\">\n            {#if column !== 0}\n              <div\n                class=\"line left\"\n                class:visible={repeatRows[row][column - 1] !== 0 &&\n                  repeatRows[row][column - 2] !== 0 &&\n                  repeatRows[row][column - 1] === repeatRows[row][column - 2]}\n              />\n              {#if repeatRows[row][column - 2] !== repeatRows[row][column - 1] || repeatRows[row][column] !== repeatRows[row][column - 1] || repeatRows[row][column - 1] === 0 || (selectedRepeat !== undefined && (repeatRows[row][column - 1] === 0 || selectedRepeat.id === repeatRows[row][column - 1]))}\n                <button\n                  class:active={fromColumn === column - 1 &&\n                    fromRow === row &&\n                    elementActive}\n                  data-id={repeatRows[row][column - 1]}\n                  data-row={row}\n                  on:pointerdown={(event) => dragStart(event, row, column - 1)}\n                />\n              {/if}\n              <div\n                class=\"line right\"\n                class:visible={repeatRows[row][column - 1] !== 0 &&\n                  repeatRows[row][column] !== 0 &&\n                  repeatRows[row][column - 1] === repeatRows[row][column]}\n              />\n            {/if}\n          </div>\n        </td>\n      {/each}\n      <div>\n        {#each amountOfNumberInputs[row] as id}\n          <input\n            type=\"text\"\n            class=\"times-input\"\n            on:input={(e) => setRepeatTimes(id, row, Number(e.target.value))}\n            data-id={id}\n            data-row={row}\n            value={repeatTimesPerRow[row][id]}\n          />\n        {/each}\n      </div>\n    </tr>\n  {/each}\n{/if}\n\n<style>\n  .repeat td {\n    padding: 0;\n  }\n\n  .repeat {\n    position: relative;\n  }\n\n  .repeat-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-top: 4px;\n    margin-bottom: 8px;\n  }\n\n  .repeat-container .line {\n    flex-grow: 1;\n    background-color: black;\n    height: 4px;\n    visibility: hidden;\n  }\n\n  .repeat-container .line.visible {\n    visibility: visible;\n  }\n\n  .repeat .repeat-container button {\n    margin: 0;\n    padding: 0;\n    width: 15px;\n    height: 15px;\n    border-radius: 100%;\n    border: 4px solid black;\n    background-color: black;\n  }\n\n  .repeat .repeat-container button:hover,\n  .repeat .repeat-container button.active {\n    background-color: white;\n    cursor: -webkit-grab;\n    cursor: grab;\n  }\n\n  .repeat,\n  .repeat td {\n    border: 0;\n  }\n\n  .times-input {\n    position: absolute;\n    width: 2em;\n    margin: 0;\n    padding: 0;\n    text-align: center;\n    background-color: white;\n    border: 1px solid black;\n  }\n</style>\n","<script>\n  import draft from 'stores/Draft';\n  import tinycolor from 'tinycolor2';\n  export let selectedYarn = -1;\n  let color;\n  $: if (Number(selectedYarn) !== -1) {\n    let ratio = $draft.yarn.find((a) => a.id === Number(selectedYarn)).color;\n    color = tinycolor.fromRatio(ratio).toHexString();\n  }\n</script>\n\n<div class=\"color-dropdown\">\n  <select bind:value={selectedYarn} on:input>\n    <option value={-1}>Add new yarn</option>\n    {#each $draft.yarn as yarn}\n      <option value={yarn.id}>\n        {yarn.name}\n      </option>\n    {/each}\n  </select>\n  {#if selectedYarn !== -1}\n    <div class=\"color-marker\" style={`background-color: ${color}`} />\n  {/if}\n</div>\n\n<style>\n  select {\n    margin: 0;\n    padding: 0;\n  }\n\n  .color-dropdown {\n    display: flex;\n  }\n  .color-marker {\n    width: 1em;\n    border: 1px solid black;\n  }\n</style>\n","<script>\n  import { onMount } from 'svelte';\n  import Repeats from './Repeats';\n  import draft from 'stores/Draft';\n  import YarnDropDown from './YarnDropDown';\n  import NewIcon from 'icons/new.svg';\n\n  $: length = 1;\n  $: if (data[0] !== undefined && data[0].length > 0) {\n    length = data[0].length;\n  }\n\n  let repeats = [];\n\n  $: yarn = -1;\n  $: data = [];\n\n  $: if (yarn !== -1) {\n    data = [...data, [yarn, ...Array(getLength() - 1)]];\n    yarn = -1;\n  }\n\n  onMount(() => {\n    data = $draft.yarn.map((y) => [y.id]);\n  });\n\n  function getTableThreads() {\n    let threads = [];\n    if (data !== undefined && data.length > 0) {\n      for (let i = 1; i < data[0].length; i++) {\n        for (let j = 0; j < data.length; j++) {\n          if (data[j][i] !== undefined && threads[i - 1] === undefined) {\n            threads[i - 1] = { yarn: data[j][0], times: data[j][i] };\n          }\n        }\n      }\n    }\n    return threads;\n  }\n\n  function getLength() {\n    return length;\n  }\n\n  let repeatComponent;\n\n  function deleteRow(row) {\n    data = data.filter((v, i) => i !== row);\n  }\n\n  function setValue(column, row, value) {\n    for (let i = 0; i < data.length; i++) {\n      data[i][column] = undefined;\n    }\n    data[row][column] = value;\n    data = [...data];\n  }\n\n  function insertColumn(index) {\n    repeatComponent.insertColumn(index - 1);\n    data.forEach((row) => row.splice(index, 0, undefined));\n    data = [...data];\n  }\n\n  export function getThreads() {\n    let tableThreads = getTableThreads();\n    let threads = [...tableThreads];\n    for (let i = 0; i < repeats.length; i++) {\n      let repeatRow = repeats[i];\n      for (let j = repeatRow.length - 1; j >= 0; j--) {\n        let rep = repeatRow[j];\n        let part = threads.slice(rep.from, rep.to + 1);\n        for (let k = 0; k < rep.times - 1; k++) {\n          threads.splice(rep.from, 0, ...part);\n        }\n        let change = (rep.to - rep.from + 1) * (rep.times - 1);\n        // Adjust lower repeats after changed thread list length\n        for (let k = i + 1; k < repeats.length; k++) {\n          let lowerRow = repeats[k];\n          for (let l = 0; l < lowerRow.length; l++) {\n            let rep1 = lowerRow[l];\n            if (rep1.to >= rep.to) {\n              rep1.to += change;\n            }\n          }\n        }\n      }\n    }\n    let ret = [];\n    threads.forEach((th) => {\n      for (let i = 0; i < th.times; i++) {\n        ret.push(th.yarn);\n      }\n    });\n    ret.reverse();\n    return ret;\n  }\n\n  function onFocus(columnIndex) {\n    if (lastBlur !== undefined && columnIndex !== lastBlur) {\n      let column = lastBlur;\n      let removeColumn = true;\n      for (let i = 0; i < data.length; i++) {\n        if (\n          data[i][column] !== undefined &&\n          data[i][column] !== '' &&\n          data[i][column] !== 0\n        ) {\n          removeColumn = false;\n          break;\n        }\n      }\n      if (removeColumn) {\n        data.forEach((row) => row.splice(column, 1));\n        repeatComponent.removeColumn(column - 1);\n        data = [...data];\n      }\n    }\n  }\n\n  let lastBlur;\n  function onBlur(columnIndex) {\n    lastBlur = columnIndex;\n  }\n</script>\n\n<div class=\"top\">\n  <table>\n    <tbody>\n      {#each data as _, row}\n        <tr>\n          <td>\n            {#if row === 0}\n              <button class=\"add-button\" on:click={() => insertColumn(1)}>\n                {@html NewIcon}\n              </button>\n            {/if}\n            <YarnDropDown\n              selectedYarn={data[row][0]}\n              on:input={(e) => {\n                if (e.target.value === '-1') {\n                  deleteRow(row);\n                } else {\n                  data[row][0] = e.target.value;\n                }\n              }}\n            />\n          </td>\n          {#each { length: data[row].length - 1 } as _, column}\n            <td>\n              {#if row === 0}\n                <button\n                  class=\"add-button\"\n                  on:click={() => insertColumn(column + 2)}\n                >\n                  {@html NewIcon}\n                </button>\n              {/if}\n              <input\n                size=\"4\"\n                type=\"number\"\n                on:focus={() => onFocus(column + 1)}\n                on:blur={() => onBlur(column + 1)}\n                value={data[row][column + 1] !== undefined\n                  ? data[row][column + 1]\n                  : ''}\n                on:input={(e) =>\n                  setValue(column + 1, row, Number(e.target.value))}\n              />\n            </td>\n          {/each}\n        </tr>\n      {/each}\n      <tr>\n        <td>\n          <YarnDropDown bind:selectedYarn={yarn} />\n        </td>\n      </tr>\n\n      <Repeats bind:this={repeatComponent} bind:length bind:repeats />\n    </tbody>\n  </table>\n</div>\n\n<style>\n  table {\n    border-collapse: collapse;\n    border: 3px solid black;\n    background-color: white;\n    position: relative;\n  }\n\n  .top {\n    padding-top: 20px;\n  }\n\n  td {\n    border: 3px solid black;\n    min-width: 1.5rem;\n    text-align: center;\n    position: relative;\n  }\n\n  tr {\n    height: 1rem;\n  }\n\n  input {\n    margin: 0;\n    padding: 0;\n    width: 3em;\n    background: none;\n    border-radius: 0;\n  }\n\n  .add-button {\n    position: absolute;\n    right: 0;\n\n    width: 30px;\n    height: 30px;\n    margin: 0;\n    padding: 0;\n    float: right;\n    transform: translate(calc(50% + 2px), calc(-100% - 2px));\n    background-color: transparent;\n  }\n\n  .add-button:hover {\n    border: 0;\n  }\n\n  .add-button:active {\n    background: none;\n  }\n\n  .add-button:active :global(svg) {\n    fill: black;\n  }\n  .add-button:active :global(svg .plus) {\n    fill: white;\n    stroke: white;\n  }\n\n  .add-button :global(svg) {\n    fill: white;\n  }\n</style>\n","<script>\n  import { t } from 'precompile-intl-runtime';\n  import draft from 'stores/Draft';\n  import * as draftUtil from 'util/DraftUtil';\n  import YarnFillTable from 'components/YarnFillTable/YarnFillTable.svelte';\n  import CheckboxInput from 'components/CheckboxInput/CheckboxInput';\n\n  let yarnFillTable;\n  let useWarp;\n  let useWeft;\n\n  function apply() {\n    let threads = yarnFillTable.getThreads();\n    if (useWarp || useWeft) {\n      draft.update((temp) => {\n        if (useWeft) {\n          draftUtil.applyColor(temp, threads, 'weft');\n        }\n        if (useWarp) {\n          draftUtil.applyColor(temp, threads, 'warp');\n        }\n      });\n    }\n  }\n</script>\n\n<div>\n  <YarnFillTable bind:this={yarnFillTable} />\n  <CheckboxInput label=\"Apply on warp\" bind:checked={useWarp} />\n  <CheckboxInput label=\"Apply on weft\" bind:checked={useWeft} />\n</div>\n<button on:click={apply}>{$t('page.pattern_fill.apply')}</button>\n","import ScarfIcon from 'icons/scarf.svg';\nimport YarnIcon from 'icons/yarn.svg';\nimport PatternBucket from 'icons/pattern-bucket.svg';\nimport Repeat from 'icons/repeat.svg';\nimport RepetitionIcon from 'icons/repetition.svg';\n\nimport WeaveSettings from './WeaveSettings.svelte';\nimport YarnSettings from './YarnSettings.svelte';\nimport RepeatComponent from './Repeat.svelte';\nimport PatternFill from './PatternFill/PatternFill.svelte';\nimport WarpWeftFill from './WarpWeftFill.svelte';\n\nexport default [\n  {\n    icon: ScarfIcon,\n    name: 'weave_settings',\n    component: WeaveSettings,\n  },\n  {\n    icon: YarnIcon,\n    name: 'yarn_settings',\n    component: YarnSettings,\n  },\n  {\n    icon: PatternBucket,\n    name: 'pattern_fill',\n    component: PatternFill,\n  },\n  {\n    icon: RepetitionIcon,\n    name: 'repetition',\n    component: WarpWeftFill,\n  },\n  {\n    icon: Repeat,\n    name: 'selection',\n    component: RepeatComponent,\n  },\n];\n","<script>\n  import { t } from 'precompile-intl-runtime';\n  import Subcomponents from './Subcomponents';\n  import HelpIcon from 'icons/help.svg';\n\n  import ui from '../../../stores/UI';\n  import draft from '../../../stores/Draft';\n\n  $: selectedMenu = $ui.selectedMenu;\n  let sidebar;\n  export let open = false;\n\n  function selectMenu(index) {\n    open = false;\n    ui.update((draft) => {\n      draft.selectedMenu = draft.selectedMenu === index ? -1 : index;\n    });\n  }\n\n  function exportToFile() {\n    const blob = new Blob([JSON.stringify($draft)], {\n      type: 'text/json',\n    });\n    const link = document.createElement('a');\n\n    link.download = 'weave.json';\n    link.href = window.URL.createObjectURL(blob);\n    link.dataset.downloadurl = ['text/json', link.download, link.href].join(\n      ':'\n    );\n\n    const evt = new MouseEvent('click', {\n      view: window,\n      bubbles: true,\n      cancelable: true,\n    });\n\n    link.dispatchEvent(evt);\n  }\n\n  function importFromFile(e) {\n    let files = e.target.files;\n    if (files.length > 0) {\n      let file = files[0];\n      let reader = new FileReader();\n      reader.onload = (readFile) => {\n        try {\n          let newDraft = JSON.parse(readFile.target.result);\n          draft.set(newDraft);\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      reader.readAsText(file);\n    }\n  }\n</script>\n\n<div class=\"sidebar-container\">\n  {#if open}\n    <div class=\"sidebar\" bind:this={sidebar}>\n      {#each Subcomponents as item, i}\n        <button class=\"icon-button\" on:click={() => selectMenu(i)}>\n          <div class={'icon'}>\n            {@html item.icon}\n          </div>\n          <span>{$t(`page.${item.name}.title`)}</span>\n        </button>\n      {/each}\n      <button class=\"icon-button save-load\" on:click={exportToFile}>\n        <span>{$t('terms.save')}</span>\n      </button>\n\n      <div class=\"save-load\">\n        <input\n          type=\"file\"\n          name=\"upload\"\n          id=\"upload\"\n          on:input={importFromFile}\n        />\n        <label class=\"icon-button button\" for=\"upload\"\n          >{$t('terms.upload')}</label\n        >\n      </div>\n      <div class=\"help\">\n        <a href={`/weaver/docs_${$ui.locale}`}>\n          <div class=\"icon\">\n            {@html HelpIcon}\n          </div>\n        </a>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  input[type='file'] {\n    display: none;\n  }\n\n  .icon {\n    fill: var(--color-1);\n    stroke: var(--color-1);\n    width: 50px;\n    height: 50px;\n    margin: auto;\n    margin-bottom: 5px;\n  }\n\n  .icon-button {\n    background-color: var(--color-2);\n    border-radius: 4px;\n    border: 1px black;\n    color: var(--color-1);\n  }\n\n  .sidebar-container {\n    z-index: 10;\n    position: relative;\n  }\n\n  .sidebar {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n\n    background-color: #40362a;\n\n    padding: 10px 20px;\n    max-width: 150px;\n\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    overflow: auto;\n  }\n\n  .sidebar > * {\n    margin: 10px;\n  }\n\n  .help {\n    display: flex;\n    flex-direction: column-reverse;\n    flex-grow: 1;\n  }\n\n  .save-load {\n    height: 50px;\n    color: var(--color-1);\n    text-align: center;\n  }\n</style>\n","<script>\n  import tinycolor from 'tinycolor2';\n  import draft from '../../stores/Draft';\n  import ui from '../../stores/UI';\n  import downArrow from 'icons/down-arrow.svg';\n  import upArrow from 'icons/up-arrow.svg';\n\n  let isToggled = false;\n\n  $: selectedColorIndex = $ui.selectedColor;\n  let selectedColor;\n  $: selectedYarn = $draft.yarn.find((y) => y.id === selectedColorIndex);\n  $: selectedColor = tinycolor.fromRatio(selectedYarn?.color);\n  $: selectedColorBorder = selectedColor.isDark() ? 'white' : 'black';\n  $: yarns = $draft.yarn;\n\n  function setColor(index) {\n    ui.update((draft) => {\n      draft.selectedColor = index;\n    });\n    isToggled = false;\n  }\n</script>\n\n<div class=\"yarn-selector\">\n  <button\n    class=\"color-display\"\n    on:click={() => (isToggled = !isToggled)}\n    style={`background-color: ${selectedColor.toHexString()};`}\n  >\n    <span\n      class=\"arrow\"\n      style={`\n        stroke: ${selectedColor.isDark() ? 'black' : 'white'};\n        fill: ${selectedColor.isLight() ? 'black' : 'white'};\n        `}\n    >\n      {#if isToggled === true}\n        {@html upArrow}\n      {:else}\n        {@html downArrow}\n      {/if}\n    </span>\n  </button>\n  {#if isToggled === true}\n    <div class=\"color-dropdown\">\n      {#each yarns as yarn, i}\n        <button\n          class:selected={selectedColorIndex === i}\n          class=\"item\"\n          style={`background-color: ${tinycolor\n            .fromRatio(yarn.color)\n            .toHexString()};\n          `}\n          on:click={() => setColor(i)}\n        />\n      {/each}\n    </div>\n  {/if}\n</div>\n\n<style>\n  .yarn-selector {\n    padding: 4px;\n    border: 1px solid black;\n    position: relative;\n  }\n\n  .arrow {\n    position: absolute;\n    bottom: 2px;\n    right: 6px;\n  }\n\n  .yarn-selector :global(svg) {\n    width: 12px;\n  }\n\n  .color-display {\n    width: 2rem;\n    margin: 0;\n    height: 100%;\n  }\n\n  .color-dropdown {\n    position: absolute;\n    left: 0;\n    right: 0;\n\n    z-index: 5;\n    background-color: white;\n    margin: 0;\n    padding: 4px;\n    border: 1px solid black;\n\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n  }\n\n  .item:not(:first-child) {\n    margin-top: 4px;\n  }\n\n  .item {\n    display: block;\n    margin: 0;\n    padding: 0;\n    margin-top: 4px;\n    border: 1px solid black;\n    height: 1.5rem;\n    width: 1.5rem;\n  }\n\n  .item.selected {\n    margin: 0.25rem;\n    margin-top: calc(0.25rem + 4px);\n    height: 1.25rem;\n    width: 1.25rem;\n  }\n</style>\n","<script>\n  export let isToggled = false;\n  $: container = undefined;\n  $: height = 0;\n  $: if (container !== undefined && height === 0) {\n    height = container.firstChild.getBoundingClientRect().height;\n  }\n</script>\n\n<div class=\"dropdown\" bind:this={container}>\n  <button on:click={() => (isToggled = !isToggled)}>👁</button>\n  {#if isToggled}\n    <div class=\"dropdown-content\" style={`top: ${height}px`}>\n      <slot />\n    </div>\n  {/if}\n</div>\n\n<style>\n  .dropdown {\n    position: relative;\n  }\n  .dropdown-content {\n    top: 20px;\n    position: absolute;\n    background-color: white;\n    display: flex;\n    flex-direction: column;\n    width: max-content;\n    padding: 8px;\n  }\n</style>\n","<script>\n</script>\n\n<div class=\"dropdown-item\">\n  <slot />\n</div>\n\n<style>\n  .dropdown-item:not(:first-child) {\n    padding-top: 4px;\n  }\n\n  .dropdown-item:not(:last-child) {\n    padding-bottom: 4px;\n  }\n</style>\n","<script>\n  import { t } from 'precompile-intl-runtime';\n  import { onMount } from 'svelte';\n  import ui from 'stores/UI';\n  import draft from 'stores/Draft';\n  import YarnSelector from 'components/YarnSelector/YarnSelector.svelte';\n  import CheckboxInput from 'components/CheckboxInput/CheckboxInput';\n  import { Dropdown, DropdownItem } from 'components/Dropdown';\n\n  export let height = 0;\n  export let sidebarOpen;\n  $: cellSizeInput = $ui.cellSize;\n  let toolbarContainer;\n  $: toggleTreadleOrder = $ui.showTreadleOrder;\n  $: toggleThreading = $ui.showThreading;\n  $: {\n    ui.update((draft) => {\n      draft.showTreadleOrder = toggleTreadleOrder;\n    });\n  }\n\n  $: {\n    ui.update((draft) => {\n      draft.showThreading = toggleThreading;\n    });\n  }\n\n  onMount(() => {\n    height = toolbarContainer.clientHeight;\n  });\n\n  /*\n  function toggleTreadleOrder() {\n    ui.update((draft) => {\n      draft.showTreadleOrder = !draft.showTreadleOrder;\n    });\n  }\n\n  function toggleThreading() {\n    ui.update((draft) => {\n      draft.showThreading = !draft.showThreading;\n    });\n  }\n*/\n\n  function toggle() {\n    sidebarOpen = !sidebarOpen;\n    if (sidebarOpen === false) {\n      ui.update((temp) => {\n        temp.selectedMenu = -1;\n      });\n    }\n  }\n</script>\n\n<div class=\"tool-bar\" bind:this={toolbarContainer}>\n  <button class=\"hamberder\" on:click={toggle}\n    >{#if !sidebarOpen}≡{:else}x{/if}</button\n  >\n\n  <div>\n    <button on:click={draft.undo}>{$t('terms.undo')}</button>\n    <button on:click={draft.redo}>{$t('terms.redo')}</button>\n  </div>\n\n  <Dropdown>\n    <DropdownItem>\n      <CheckboxInput\n        bind:checked={toggleThreading}\n        label={$t('toolbar.showThreading')}\n      />\n    </DropdownItem>\n    <DropdownItem>\n      <CheckboxInput\n        bind:checked={toggleTreadleOrder}\n        label={$t('toolbar.showTreadleOrder')}\n      />\n    </DropdownItem>\n  </Dropdown>\n  <YarnSelector />\n</div>\n\n<style>\n  .tool-bar {\n    justify-content: space-between;\n    display: flex;\n    background-color: var(--color-1);\n    pointer-events: all;\n\n    grid-column: span 2;\n    z-index: 10;\n  }\n\n  .hamberder {\n    height: 100%;\n    min-width: 2em;\n  }\n</style>\n","import solidFrag from './glsl/solid.frag';\nimport weaveFrag from './glsl/weave.frag';\nimport textureFrag from './glsl/textureShader.frag';\nimport gridFrag from './glsl/grid.frag';\nimport tieupFrag from './glsl/tieup.frag';\nimport colorRowFrag from './glsl/colorRow.frag';\nimport genUV2D from './glsl/genUV2D.vert';\nimport Shader from './Shader';\n\nfunction buildShader(name) {\n  switch(name) {\n    case 'texture': return new Shader({ frag: textureFrag, vert: genUV2D });\n    case 'solid': return new Shader({ frag: solidFrag, vert: genUV2D });\n    case 'weave': return new Shader({ frag: weaveFrag, vert: genUV2D });\n    case 'grid': return new Shader({ frag: gridFrag, vert: genUV2D });\n    case 'tieup': return new Shader({ frag: tieupFrag, vert: genUV2D });\n    case 'colorRow': return new Shader({ frag: colorRowFrag, vert: genUV2D });\n    default: return undefined;\n  }\n}\n\nexport default class ShaderBuilder {\n  constructor(gl) {\n    this.gl = gl;\n    this.shaderCache = {};\n  }\n\n  getShader(shaderName) {\n    let shader = this.shaderCache[shaderName];\n    if(shader === undefined) {\n      shader = buildShader(shaderName);\n      if(shader === undefined) {\n        throw new Error(`Unknown shader name ${shaderName}`);\n      }\n      shader.compile(this.gl);\n      this.shaderCache[shaderName] = shader;\n    }\n    return shader;\n  }\n}\n","export default class Texture {\n  constructor(gl, width, height, data) {\n    this.gl = gl;\n    if (width === undefined || height === undefined) {\n      throw new Error('Undefined width/height of texture');\n    }\n    this.width = width;\n    this.height = height;\n\n    if (data instanceof Uint8Array) {\n      this.color = data;\n    } else {\n      this.color = new Uint8Array(data.length * 4);\n      for (let i = 0; i < data.length; i++) {\n        let d = data[i];\n        let n = i * 4;\n        this.color[n + 0] = d[0] * 255;\n        this.color[n + 1] = d[1] * 255;\n        this.color[n + 2] = d[2] * 255;\n        this.color[n + 3] = d[3] * 255;\n      }\n    }\n\n    this.compile(this.gl);\n  }\n\n  compile() {\n    this.texture = this.gl.createTexture();\n\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n    this.gl.texImage2D(\n      this.gl.TEXTURE_2D,\n      0,\n      this.gl.RGBA,\n      this.width,\n      this.height,\n      0,\n      this.gl.RGBA,\n      this.gl.UNSIGNED_BYTE,\n      this.color\n    );\n    this.gl.texParameteri(\n      this.gl.TEXTURE_2D,\n      this.gl.TEXTURE_MAG_FILTER,\n      this.gl.NEAREST\n    );\n    this.gl.texParameteri(\n      this.gl.TEXTURE_2D,\n      this.gl.TEXTURE_MIN_FILTER,\n      this.gl.NEAREST\n    );\n    this.gl.texParameteri(\n      this.gl.TEXTURE_2D,\n      this.gl.TEXTURE_WRAP_T,\n      this.gl.CLAMP_TO_EDGE\n    );\n    this.gl.texParameteri(\n      this.gl.TEXTURE_2D,\n      this.gl.TEXTURE_WRAP_S,\n      this.gl.CLAMP_TO_EDGE\n    );\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n\n  delete() {\n    this.gl.deleteTexture(this.texture);\n  }\n\n  bind(unit) {\n    this.gl.activeTexture(this.gl.TEXTURE0 + unit);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n  }\n\n  setColor(x, y, color) {\n    this.setColorArea(x, y, 1, 1, color);\n  }\n\n  setColorArea(x, y, width, height, color) {\n    this.color = new Uint8Array([\n      color[0] * 255,\n      color[1] * 255,\n      color[2] * 255,\n      color[3] * 255,\n    ]);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n    this.gl.texSubImage2D(\n      this.gl.TEXTURE_2D,\n      0,\n      x,\n      y,\n      width,\n      height,\n      this.gl.RGBA,\n      this.gl.UNSIGNED_BYTE,\n      this.color\n    );\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n\n  unbind() {\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n}\n","import VertexArray from '../VertexArray';\nimport { line } from '../../../../../util/MathUtil';\n\nexport default class RendererEventTarget {\n  clickListeners = [];\n  pointerMoveListeners = [];\n  pointerUpListeners = [];\n  pointerDownListeners = [];\n\n  constructor(gl, shaders, name) {\n    this.gl = gl;\n    this.name = name;\n    this.solidShader = shaders.getShader('solid');\n    this.centerQuad = new VertexArray(\n      this.gl,\n      [-0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5],\n      [1, 0, 2, 2, 0, 3],\n      [2]\n    );\n    this.quad = new VertexArray(\n      this.gl,\n      [0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0],\n      [1, 0, 2, 2, 0, 3],\n      [2]\n    );\n  }\n\n  prerender() {\n    let { cellSize, xCount, yCount } = this.values;\n    let [rX, rY] = this.rendererPos;\n    let w = this.gl.canvas.width;\n    let cH = cellSize / 2.0;\n    let margin = 2;\n\n    this.gl.scissor(\n      w - (rX + xCount) * cH - margin / 2.1,\n      rY * cH - margin / 2.1,\n      cH * xCount + margin,\n      cH * yCount + margin\n    );\n  }\n\n  isWithinGrid(pos) {\n    let { cellSize, xCount, yCount } = this.values;\n\n    let dpr = window.devicePixelRatio;\n    let w = this.gl.canvas.width / dpr;\n    let h = this.gl.canvas.height / dpr;\n    let cs = cellSize / dpr;\n\n    let x = ((w - pos[0]) / w) * 2.0;\n    let y = ((h - pos[1]) / h) * 2.0;\n    let gridX = this.rendererPos[0] * (cs / w);\n    let gridY = this.rendererPos[1] * (cs / h);\n    let gridW = (xCount * cs) / w;\n    let gridH = (yCount * cs) / h;\n    let ret = x > gridX && y > gridY && x < gridX + gridW && y < gridY + gridH;\n    return ret;\n  }\n\n  getCellAtPos(pos) {\n    let { cellSize, scrollX, scrollY } = this.values;\n    let shouldScrollX = this.shouldScrollX ? 1.0 : 0.0;\n    let shouldScrollY = this.shouldScrollY ? 1.0 : 0.0;\n\n    let dpr = window.devicePixelRatio;\n    let w = this.gl.canvas.width / dpr;\n    let h = this.gl.canvas.height / dpr;\n    let cs = cellSize / dpr;\n\n    let xOffset = shouldScrollX * (scrollX / cs);\n    let yOffset = shouldScrollY * (scrollY / cs);\n    let cellX = Math.floor((w - pos[0]) / (cs / 2.0) + xOffset);\n    let cellY = Math.floor((h - pos[1]) / (cs / 2.0) + yOffset);\n    let i = cellX - this.rendererPos[0];\n    let j = cellY - this.rendererPos[1];\n    return [i, j];\n  }\n\n  getCellsBetweenPoints(from, to) {\n    let fromCell = this.getCellAtPos(from);\n    let toCell = this.getCellAtPos(to);\n    let linePoints = line(fromCell[0], fromCell[1], toCell[0], toCell[1]);\n    let { xCount, yCount } = this.values;\n    return linePoints.filter(\n      (p) => p[0] >= 0 && p[0] < xCount && p[1] >= 0 && p[1] < yCount\n    );\n  }\n}\n","import { mat4 } from 'gl-matrix';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class TieupRenderer extends RendererEventTarget {\n  constructor(gl, shaders, name) {\n    super(gl, shaders, name);\n    this.shader = shaders.getShader('tieup');\n    this.mvp = mat4.create();\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [-1.0, 1.0, 1.0]);\n    mat4.translate(this.initialView, this.initialView, [-1.0, -1.0, 0.0]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  renderPoints(points) {\n    this.render();\n    let { xCount, yCount, cellSize } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.translate(view, view, [cw / 2.0, ch / 2.0, 1.0]);\n    mat4.scale(view, view, [cw, ch, 1.0]);\n    for (let i = 0; i < xCount; i++) {\n      for (let j = 0; j < yCount; j++) {\n        if (points.some((p) => p[0] === i && p[1] === j)) {\n          this.solidShader.setVec4('color', [1.0, 0.0, 0.0, 1.0]);\n        } else {\n          continue;\n        }\n        mat4.translate(mvp, view, [i, j, 0.0]);\n        mat4.scale(mvp, mvp, [0.8, 0.8, 1.0]);\n        this.solidShader.setMat4('mvp', mvp);\n        this.centerQuad.draw();\n      }\n    }\n    this.centerQuad.unbind();\n    this.solidShader.unbind();\n  }\n\n  handleEvent(event) {\n    let { cellSize, xCount, yCount } = this.values;\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let x = ((w - event.offsetX) / w) * 2.0;\n    let y = ((h - event.offsetY) / h) * 2.0;\n\n    let gridX = this.rendererPos[0] * (cellSize / w);\n    let gridY = this.rendererPos[1] * (cellSize / h);\n    let gridW = (xCount * cellSize) / w;\n    let gridH = (yCount * cellSize) / h;\n    if (x > gridX && y > gridY && x < gridX + gridW && y < gridY + gridH) {\n      let i = Math.floor(((x - gridX) / gridW) * xCount);\n      let j = Math.floor(((y - gridY) / gridH) * yCount);\n      return [i, j, event];\n    }\n    return undefined;\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(scrollPos) {\n    this.rendererPos = scrollPos;\n  }\n\n  setCellToggleTexture(cellToggleTexture) {\n    this.cellToggleTexture = cellToggleTexture;\n  }\n\n  render() {\n    this.prerender();\n    if (this.values === undefined) return;\n    let { xCount, yCount, cellSize } = this.values;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.scale(mvp, view, [\n      (cellSize * xCount) / w,\n      (cellSize * yCount) / h,\n      1.0,\n    ]);\n\n    this.cellToggleTexture.bind(0);\n    this.shader.setSampler2D('cellToggleSampler', 0);\n\n    this.shader.setVec2('scrollPos', [0, 0]);\n\n    this.shader.setVec2('cellSize', [cw / (cw * xCount), ch / (ch * yCount)]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import { mat4 } from 'gl-matrix';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class GridRenderer extends RendererEventTarget {\n  constructor(gl, shaders, vertical, shouldScrollX, shouldScrollY, name) {\n    super(gl, shaders, name);\n    this.gl = gl;\n    this.shader = shaders.getShader('grid');\n    this.vertical = vertical;\n    this.name = name;\n    this.shouldScrollX = shouldScrollX;\n    this.shouldScrollY = shouldScrollY;\n\n    this.mvp = mat4.create();\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [-1.0, 1.0, 1.0]);\n    mat4.translate(this.initialView, this.initialView, [-1.0, -1.0, 0.0]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(scrollPos) {\n    this.rendererPos = scrollPos;\n  }\n\n  setCellToggleTexture(cellToggleTexture) {\n    this.cellToggleTexture = cellToggleTexture;\n  }\n\n  renderPoints(points) {\n    this.render();\n    let { xCount, yCount, cellSize, scrollX, scrollY } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let shouldScrollX = this.shouldScrollX ? 1.0 : 0.0;\n    let shouldScrollY = this.shouldScrollY ? 1.0 : 0.0;\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.translate(view, view, [cw / 2.0, ch / 2.0, 1.0]);\n    mat4.scale(view, view, [cw, ch, 1.0]);\n    let minorSize = Math.min(xCount, yCount);\n    for (let i = 0; i < points.length; i++) {\n      for (let j = 0; j < minorSize; j++) {\n        let x, y;\n        if (yCount < xCount) {\n          x = i;\n          y = j;\n        } else {\n          x = j;\n          y = i;\n        }\n\n        let dpr = window.devicePixelRatio;\n        mat4.translate(mvp, view, [\n          (-scrollX / cellSize) * shouldScrollX * dpr,\n          (-scrollY / cellSize) * shouldScrollY * dpr,\n          0.0,\n        ]);\n        mat4.translate(mvp, mvp, [x, y, 0.0]);\n        if (points[i] === undefined) {\n          continue;\n        } else if (points[i] === j) {\n          this.solidShader.setVec4('color', [0.02, 0.4, 0.02, 1.0]);\n          mat4.scale(mvp, mvp, [0.62, 0.62, 1.0]);\n        } else {\n          this.solidShader.setVec4('color', [1.0, 1.0, 1.0, 1.0]);\n          mat4.scale(mvp, mvp, [0.8, 0.8, 1.0]);\n        }\n        this.solidShader.setMat4('mvp', mvp);\n        this.centerQuad.draw();\n      }\n    }\n    this.centerQuad.unbind();\n    this.solidShader.unbind();\n  }\n\n  render() {\n    this.prerender();\n    if (this.values === undefined) return;\n    let {\n      xCount,\n      yCount,\n      cellSize,\n      warpCount,\n      weftCount,\n      scrollX,\n      scrollY,\n      xStepDistance,\n      yStepDistance,\n    } = this.values;\n    let shouldScrollX = this.shouldScrollX ? 1.0 : 0.0;\n    let shouldScrollY = this.shouldScrollY ? 1.0 : 0.0;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.scale(mvp, view, [\n      (cellSize * xCount) / w,\n      (cellSize * yCount) / h,\n      1.0,\n    ]);\n\n    this.cellToggleTexture.bind(0);\n    this.shader.setSampler2D('cellToggleSampler', 0);\n    this.shader.setVec2('scrollPos', [\n      (scrollX / (warpCount * cellSize)) * devicePixelRatio * shouldScrollX,\n      (scrollY / (weftCount * cellSize)) * devicePixelRatio * shouldScrollY,\n    ]);\n\n    this.shader.setFloat('vert', yCount > xCount ? 1.0 : 0.0);\n    this.shader.setFloat(\n      'steps',\n      yCount > xCount ? yStepDistance : xStepDistance\n    );\n\n    this.shader.setVec2('cellSize', [cw / (cw * xCount), ch / (ch * yCount)]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import { mat4 } from 'gl-matrix';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class WeaveRenderer extends RendererEventTarget {\n  constructor(gl, shaders, name) {\n    super(gl, shaders, name);\n    this.gl = gl;\n    this.weaveShader = shaders.getShader('weave');\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [-1.0, 1.0, 1.0]);\n    mat4.translate(this.initialView, this.initialView, [-1.0, -1.0, 0.0]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setThreadingTexture(threading) {\n    this.threading = threading;\n  }\n\n  setTreadleOrderTexture(treadleOrder) {\n    this.treadleOrder = treadleOrder;\n  }\n\n  setTieupTexture(tieup) {\n    this.tieup = tieup;\n  }\n\n  setWarpTexture(warpTexture) {\n    this.warpTexture = warpTexture;\n  }\n\n  setWeftTexture(weftTexture) {\n    this.weftTexture = weftTexture;\n  }\n\n  setRendererPosition(scrollPos) {\n    this.rendererPos = scrollPos;\n  }\n\n  render() {\n    this.prerender();\n    if (this.values === undefined) return;\n    let {\n      xCount,\n      yCount,\n      scrollX,\n      scrollY,\n      cellSize,\n      shaftCount,\n      treadleCount,\n    } = this.values;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.scale(mvp, view, [\n      (cellSize * xCount) / w,\n      (cellSize * yCount) / h,\n      1.0,\n    ]);\n\n    this.weaveShader.bind();\n    this.quad.bind();\n    this.weaveShader.setMat4('mvp', mvp);\n\n    this.warpTexture.bind(0);\n    this.weaveShader.setSampler2D('warpSampler', 0);\n\n    this.weftTexture.bind(1);\n    this.weaveShader.setSampler2D('weftSampler', 1);\n\n    this.threading.bind(2);\n    this.weaveShader.setSampler2D('threading', 2);\n\n    this.treadleOrder.bind(3);\n    this.weaveShader.setSampler2D('treadleOrder', 3);\n\n    this.tieup.bind(4);\n    this.weaveShader.setSampler2D('tieup', 4);\n\n    this.weaveShader.setFloat('shaftCount', shaftCount);\n    this.weaveShader.setFloat('treadleCount', treadleCount);\n\n    this.weaveShader.setVec2('cellSize', [\n      cw / (cw * xCount),\n      ch / (ch * yCount),\n    ]);\n\n    let dpr = window.devicePixelRatio;\n    this.weaveShader.setVec2('scrollPos', [\n      (scrollX / (xCount * cellSize)) * dpr,\n      (scrollY / (yCount * cellSize)) * dpr,\n    ]);\n\n    this.quad.draw();\n    this.quad.unbind();\n    this.weaveShader.unbind();\n  }\n}\n","import { mat4 } from 'gl-matrix';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class ColorRowRenderer extends RendererEventTarget {\n  constructor(gl, shaders, shouldScrollX, shouldScrollY, name) {\n    super(gl, shaders, name);\n    this.shader = shaders.getShader('colorRow');\n    this.shouldScrollX = shouldScrollX;\n    this.shouldScrollY = shouldScrollY;\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [-1.0, 1.0, 1.0]);\n    mat4.translate(this.initialView, this.initialView, [-1.0, -1.0, 0.0]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  getCellsBetweenPoints(from, to) {\n    let fromCell = this.getCellAtPos(from);\n    let toCell = this.getCellAtPos(to);\n    let vert = this.values.yCount > this.values.xCount;\n    if (!vert) {\n      return [fromCell[0], toCell[0]];\n    } else {\n      return [fromCell[1], toCell[1]];\n    }\n  }\n\n  renderPoints(from, to, color) {\n    this.render();\n    let { xCount, yCount, cellSize, scrollX, scrollY } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    if (to < from) {\n      [from, to] = [to, from];\n    }\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let shouldScrollX = this.shouldScrollX ? 1.0 : 0.0;\n    let shouldScrollY = this.shouldScrollY ? 1.0 : 0.0;\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.translate(view, view, [cw / 2.0, ch / 2.0, 1.0]);\n    mat4.scale(view, view, [cw, ch, 1.0]);\n\n    for (let i = 0; i < to - from + 1; i++) {\n      let x, y;\n      if (xCount > yCount) {\n        x = from + i;\n        y = 0;\n      } else {\n        x = 0;\n        y = from + i;\n      }\n      this.solidShader.setVec4('color', [color.r, color.g, color.b, 1.0]);\n      let dpr = window.devicePixelRatio;\n      mat4.translate(mvp, view, [\n        (-scrollX / cellSize) * shouldScrollX * dpr,\n        (-scrollY / cellSize) * shouldScrollY * dpr,\n        0.0,\n      ]);\n      mat4.translate(mvp, mvp, [x, y, 0.0]);\n      mat4.scale(mvp, mvp, [0.61, 0.61, 1.0]);\n      this.solidShader.setMat4('mvp', mvp);\n      this.centerQuad.draw();\n    }\n    this.centerQuad.unbind();\n    this.solidShader.unbind();\n  }\n\n  handleEvent(event) {\n    let { cellSize, xCount, yCount, scrollX, scrollY } = this.values;\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let x = ((w - event.offsetX) / w) * 2.0;\n    let y = ((h - event.offsetY) / h) * 2.0;\n    let gridX = this.rendererPos[0] * (cellSize / w);\n    let gridY = this.rendererPos[1] * (cellSize / h);\n    let gridW = (xCount * cellSize) / w;\n    let gridH = (yCount * cellSize) / h;\n    if (x > gridX && y > gridY && x < gridX + gridW && y < gridY + gridH) {\n      let i = Math.floor(((x - gridX) / gridW) * xCount + scrollX / cellSize);\n      let j = Math.floor(((y - gridY) / gridH) * yCount + scrollY / cellSize);\n      return [i, j, event];\n    }\n    return undefined;\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(pos) {\n    this.rendererPos = pos;\n  }\n\n  setColorTexture(colorTexture) {\n    this.colorTexture = colorTexture;\n  }\n\n  render() {\n    this.prerender();\n    if (this.values === undefined) return;\n    let {\n      scrollX,\n      scrollY,\n      xCount,\n      yCount,\n      cellSize,\n      warpCount,\n      weftCount,\n      xStepDistance,\n      yStepDistance,\n    } = this.values;\n    let shouldScrollX = this.shouldScrollX ? 1.0 : 0.0;\n    let shouldScrollY = this.shouldScrollY ? 1.0 : 0.0;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n      this.rendererPos[0] * cw,\n      this.rendererPos[1] * ch,\n      0.0,\n    ]);\n    mat4.scale(mvp, view, [\n      (cellSize * xCount) / w,\n      (cellSize * yCount) / h,\n      1.0,\n    ]);\n\n    this.colorTexture.bind(0);\n    this.shader.setSampler2D('colorSampler', 0);\n    this.shader.setVec2('scrollPos', [\n      (scrollX / (warpCount * cellSize)) * devicePixelRatio * shouldScrollX,\n      (scrollY / (weftCount * cellSize)) * devicePixelRatio * shouldScrollY,\n    ]);\n\n    this.shader.setFloat('vert', yCount > xCount ? 1.0 : 0.0);\n    this.shader.setFloat(\n      'steps',\n      yCount > xCount ? yStepDistance : xStepDistance\n    );\n\n    this.shader.setVec2('cellSize', [cw / (cw * xCount), ch / (ch * yCount)]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import Texture from './Texture';\nexport function create1DGridTexture(gl, data, shafts, length) {\n  let gridTexture = new Uint8Array(length * 4);\n  for (let i = 0; i < length; i++) {\n    let n = i * 4;\n    let value = (data[i] / shafts) * 255;\n    let absence = 255;\n    if (data[i] === null || data[i] === undefined || data[i] === -1) {\n      absence = 0;\n    }\n    gridTexture[n + 0] = value;\n    gridTexture[n + 1] = absence;\n    gridTexture[n + 2] = value;\n    gridTexture[n + 3] = value;\n  }\n  return new Texture(gl, length, 1, gridTexture);\n}\n\nexport function update1DTexture(gl, texture, index, value, height) {\n  let data = new Uint8Array(value.length * 4);\n  for (let i = 0; i < value.length; i++) {\n    let n = i * 4;\n    let dv = (value[i] / height) * 255;\n    let absence = 255;\n    if (value[i] === null || value[i] === undefined || value[i] === -1) {\n      absence = 0;\n    }\n    data[n + 0] = dv;\n    data[n + 1] = absence;\n    data[n + 2] = dv;\n    data[n + 3] = dv;\n  }\n  gl.bindTexture(gl.TEXTURE_2D, texture.texture);\n  gl.texSubImage2D(\n    gl.TEXTURE_2D, // target\n    0, // level\n    index, // xoffset\n    0, // yoffset\n    value.length, // width\n    1, // height\n    gl.RGBA,\n    gl.UNSIGNED_BYTE,\n    data\n  );\n  gl.bindTexture(gl.TEXTURE_2D, null);\n}\n\nexport function createGridTexture(gl, data, width, height) {\n  let gridTexture = new Uint8Array(width * height * 4);\n  for (let i = 0; i < height; i++) {\n    for (let j = 0; j < width; j++) {\n      if (data[i][j] === 1) {\n        let n = (i * width + j) * 4;\n        gridTexture[n + 0] = 255;\n        gridTexture[n + 1] = 255;\n        gridTexture[n + 2] = 255;\n        gridTexture[n + 3] = 255;\n      }\n    }\n  }\n  return new Texture(gl, width, height, gridTexture);\n}\n\nexport function createColorTexture(gl, colors, w, yarns) {\n  let idToYarn = [];\n  for (let i = 0; i < yarns.length; i++) {\n    idToYarn[yarns[i].id] = yarns[i];\n  }\n  let data = new Uint8Array(colors.length * 4);\n  for (let i = 0; i < colors.length; i++) {\n    let n = i * 4;\n    let c = idToYarn[colors[i]].color;\n    data[n + 0] = c.r * 255;\n    data[n + 1] = c.g * 255;\n    data[n + 2] = c.b * 255;\n    data[n + 3] = 255;\n  }\n  return new Texture(gl, w, 1, data);\n}\n\n//export function update1DTexture(gl, texture, index, value, height) {\nexport function updateColorTexture(gl, texture, index, colors, yarns) {\n  let idToYarn = [];\n  for (let i = 0; i < yarns.length; i++) {\n    idToYarn[yarns[i].id] = yarns[i];\n  }\n  let data = new Uint8Array(colors.length * 4);\n  for (let i = 0; i < colors.length; i++) {\n    let n = i * 4;\n    let c = idToYarn[colors[i]].color;\n    data[n + 0] = c.r * 255;\n    data[n + 1] = c.g * 255;\n    data[n + 2] = c.b * 255;\n    data[n + 3] = 255;\n  }\n  gl.bindTexture(gl.TEXTURE_2D, texture.texture);\n  gl.texSubImage2D(\n    gl.TEXTURE_2D, // target\n    0, // level\n    index, // xoffset\n    0, // yoffset\n    colors.length, // width\n    1, // height\n    gl.RGBA,\n    gl.UNSIGNED_BYTE,\n    data\n  );\n  gl.bindTexture(gl.TEXTURE_2D, null);\n}\n","import ShaderBuilder from './shader/';\nimport Texture from './Texture';\n\nimport { TieupRenderer } from './renderers/TieupRenderer';\nimport { GridRenderer } from './renderers/GridRenderer';\nimport { WeaveRenderer } from './renderers/WeaveRenderer';\nimport { ColorRowRenderer } from './renderers/ColorRowRenderer';\n\nimport * as textureUtil from './TextureUtil';\n\nexport class Renderer {\n  showTreadleOrder = true;\n  showThreading = true;\n  renderNextFrame = false;\n  prevDraft = {};\n  prevUI = {};\n  dependencyGraph = {\n    treadleOrder: ['treadleOrder', 'weave'],\n    threading: ['threading', 'weave'],\n    warpColors: ['warpColors', 'weave'],\n    weftColors: ['weftColors', 'weave'],\n    tieup: ['tieup', 'weave'],\n    shaftCount: 'clear',\n    treadleCount: 'clear',\n    warpCount: ['threading', 'warpColors', 'weave'],\n    weftCount: ['treadleOrder', 'weftColors', 'weave'],\n    yarn: ['warpColors', 'weftColors', 'weave'],\n    cellSize: 'clear',\n    scrollX: ['warpColors', 'threading', 'weave'],\n    scrollY: ['weftColors', 'treadleOrder', 'weave'],\n  };\n\n  constructor(canvas, scrollContainer) {\n    this.scrollContainer = scrollContainer;\n    this.gl = canvas.getContext('webgl', {\n      premultipliedAlpha: true,\n      antialias: true,\n      preserveDrawingBuffer: true,\n    });\n    this.gl.clearColor(1, 1, 1, 1);\n    this.shaders = new ShaderBuilder(this.gl);\n    this.gl.disable(this.gl.DEPTH_TEST);\n    this.gl.enable(this.gl.SCISSOR_TEST);\n    this.startup = true;\n\n    let maxTextureSize = this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE);\n    console.log('Max texture size', maxTextureSize);\n\n    this.threadingTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n    this.treadleOrderTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n    this.tieupTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n    this.warpTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n    this.weftTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n\n    this.resizeCanvas();\n    window.addEventListener('beforeunload', () => {\n      let extension = this.gl.getExtension('WEBGL_lose_context');\n      if (extension) {\n        console.log('Trying to free webgl context');\n        extension.loseContext();\n      }\n    });\n\n    this.renderers = {\n      tieup: {\n        renderer: new TieupRenderer(this.gl, this.shaders, 'tieup'),\n        dirty: true,\n        enabled: true,\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: draft.treadleCount,\n          yCount: draft.shaftCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n        }),\n      },\n      threading: {\n        renderer: new GridRenderer(\n          this.gl,\n          this.shaders,\n          false,\n          true,\n          false,\n          'threading'\n        ),\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: draft.warpCount,\n          yCount: draft.shaftCount,\n          weftCount: draft.weftCount,\n          warpCount: draft.warpCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n          xStepDistance: ui.xStepDistance,\n        }),\n        dirty: true,\n        enabled: true,\n      },\n      treadleOrder: {\n        renderer: new GridRenderer(\n          this.gl,\n          this.shaders,\n          true,\n          false,\n          true,\n          'treadleOrder'\n        ),\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: draft.treadleCount,\n          yCount: draft.weftCount,\n          weftCount: draft.weftCount,\n          warpCount: draft.warpCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n          yStepDistance: ui.yStepDistance,\n        }),\n        dirty: true,\n        enabled: true,\n      },\n      warpColors: {\n        renderer: new ColorRowRenderer(\n          this.gl,\n          this.shaders,\n          true,\n          false,\n          'warpColors'\n        ),\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: draft.warpCount,\n          yCount: 1,\n          weftCount: draft.weftCount,\n          warpCount: draft.warpCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n          xStepDistance: ui.xStepDistance,\n        }),\n        dirty: true,\n        enabled: true,\n      },\n      weftColors: {\n        renderer: new ColorRowRenderer(\n          this.gl,\n          this.shaders,\n          false,\n          true,\n          'weftColors'\n        ),\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: 1,\n          yCount: draft.weftCount,\n          weftCount: draft.weftCount,\n          warpCount: draft.warpCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n          yStepDistance: ui.yStepDistance,\n        }),\n        dirty: true,\n        enabled: true,\n      },\n      weave: {\n        renderer: new WeaveRenderer(this.gl, this.shaders, 'weave'),\n        updateValues: function (draft, ui) {\n          this.renderer.updateValues(this.getValues(draft, ui));\n        },\n        getValues: (draft, ui) => ({\n          xCount: draft.warpCount,\n          yCount: draft.weftCount,\n          shaftCount: draft.shaftCount,\n          treadleCount: draft.treadleCount,\n          cellSize: ui.cellSize,\n          scrollX: ui.scrollX,\n          scrollY: ui.scrollY,\n        }),\n        dirty: true,\n        enabled: true,\n      },\n    };\n    this.names = Object.keys(this.renderers);\n\n    let listOfRenderers = Object.values(this.renderers);\n\n    // arggh\n    window.setTimeout(() => {\n      let render = () => {\n        if (this.renderNextFrame) {\n          for (let i = 0; i < listOfRenderers.length; i++) {\n            let r = listOfRenderers[i];\n            if (r.dirty && r.enabled) {\n              r.renderer.render();\n              r.dirty = false;\n            }\n          }\n          this.renderNextFrame = false;\n        }\n        requestAnimationFrame(render);\n      };\n      requestAnimationFrame(render);\n    });\n  }\n\n  setRendererPosition(draft, showTreadleOrder, showThreading) {\n    let treadleCount = draft.treadleCount;\n    let shaftCount = draft.shaftCount;\n    this.showTreadleOrder = showTreadleOrder;\n    this.showThreading = showThreading;\n\n    let to = Number(showTreadleOrder);\n    let th = Number(showThreading);\n\n    this.renderers.tieup.enabled = showTreadleOrder && showThreading;\n    this.renderers.tieup.renderer.setRendererPosition([3, 3]);\n\n    this.renderers.threading.enabled = showThreading;\n    this.renderers.threading.renderer.setRendererPosition([\n      to * (treadleCount + 3) + 1,\n      3,\n    ]);\n\n    this.renderers.treadleOrder.enabled = showTreadleOrder;\n    this.renderers.treadleOrder.renderer.setRendererPosition([\n      3,\n      th * (shaftCount + 3) + 1,\n    ]);\n\n    this.renderers.weftColors.renderer.setRendererPosition([\n      1,\n      th * (shaftCount + 3) + 1,\n    ]);\n    this.renderers.weftColors.enabled = showTreadleOrder;\n\n    this.renderers.warpColors.enabled = showThreading;\n    this.renderers.warpColors.renderer.setRendererPosition([\n      to * (treadleCount + 3) + 1,\n      1,\n    ]);\n    this.renderers.weave.renderer.setRendererPosition([\n      to * (treadleCount + 3) + 1,\n      th * (shaftCount + 3) + 1,\n    ]);\n\n    this.clear();\n  }\n\n  isDifferent(draft, prevDraft, ...args) {\n    return args.some((a) => {\n      return draft[a] !== prevDraft[a];\n    });\n  }\n\n  update(draft, ui, changes) {\n    if (changes.paths.size) {\n      this.updateTextures(draft, changes);\n\n      for (let c of changes.paths) {\n        let dependencies;\n        if (c === 'clear' || this.dependencyGraph[c] === 'clear') {\n          this.clearCanvas();\n          dependencies = this.names;\n        } else {\n          dependencies = this.dependencyGraph[c];\n        }\n        if (dependencies !== undefined) {\n          for (let j = 0; j < dependencies.length; j++) {\n            let r = this.renderers[dependencies[j]];\n            r.dirty = true;\n            r.updateValues(draft, ui);\n          }\n        }\n      }\n      changes.clear();\n    }\n    this.startup = false;\n  }\n\n  createThreadingTexture(draft) {\n    this.threadingTexture.delete();\n    this.threadingTexture = textureUtil.create1DGridTexture(\n      this.gl,\n      draft.threading,\n      draft.shaftCount,\n      draft.warpCount\n    );\n    this.renderers.threading.renderer.setCellToggleTexture(\n      this.threadingTexture\n    );\n    this.renderers.weave.renderer.setThreadingTexture(this.threadingTexture);\n  }\n\n  createTreadleOrderTexture(draft) {\n    this.treadleOrderTexture.delete();\n    this.treadleOrderTexture = textureUtil.create1DGridTexture(\n      this.gl,\n      draft.treadleOrder,\n      draft.treadleCount,\n      draft.weftCount\n    );\n    this.renderers.treadleOrder.renderer.setCellToggleTexture(\n      this.treadleOrderTexture\n    );\n    this.renderers.weave.renderer.setTreadleOrderTexture(\n      this.treadleOrderTexture\n    );\n  }\n\n  createTieupTexture(draft) {\n    this.tieupTexture.delete();\n    this.tieupTexture = textureUtil.createGridTexture(\n      this.gl,\n      draft.tieup,\n      draft.treadleCount,\n      draft.shaftCount\n    );\n    this.renderers.tieup.renderer.setCellToggleTexture(this.tieupTexture);\n    this.renderers.weave.renderer.setTieupTexture(this.tieupTexture);\n  }\n\n  createWarpTexture(draft) {\n    this.warpTexture.delete();\n    this.warpTexture = textureUtil.createColorTexture(\n      this.gl,\n      draft.warpColors,\n      draft.warpColors.length,\n      draft.yarn\n    );\n    this.renderers.warpColors.renderer.setColorTexture(this.warpTexture);\n    this.renderers.weave.renderer.setWarpTexture(this.warpTexture);\n  }\n\n  createWeftTexture(draft) {\n    this.weftTexture.delete();\n    this.weftTexture = textureUtil.createColorTexture(\n      this.gl,\n      draft.weftColors,\n      draft.weftColors.length,\n      draft.yarn\n    );\n    this.renderers.weftColors.renderer.setColorTexture(this.weftTexture);\n    this.renderers.weave.renderer.setWeftTexture(this.weftTexture);\n  }\n\n  getSpan(patches) {\n    return patches\n      .map((p) => p.path[1])\n      .reduce((x, y) => [Math.min(x[0], y), Math.max(x[1], y)], [\n        Number.MAX_VALUE,\n        Number.MIN_VALUE,\n      ]);\n  }\n\n  updateValuesInColorTexture(draft, changes, name, texture, height) {\n    let patch = changes.patches[name];\n    if (patch.every((p) => p.op === 'replace')) {\n      let span = this.getSpan(patch);\n      let data = draft[name].slice(span[0], span[1] + 1);\n      textureUtil.update1DTexture(this.gl, texture, span[0], data, height);\n    }\n  }\n\n  updateTextures(draft, changes) {\n    if (this.startup) {\n      this.createThreadingTexture(draft);\n      this.createTieupTexture(draft);\n      this.createTreadleOrderTexture(draft);\n      this.createWarpTexture(draft);\n      this.createWeftTexture(draft);\n      return;\n    }\n\n    if (changes.patches['tieup'] !== undefined) {\n      this.createTieupTexture(draft);\n    }\n\n    if (changes.patches['shaftCount'] !== undefined) {\n      this.createThreadingTexture(draft);\n      this.createTieupTexture(draft);\n    }\n\n    if (changes.patches['treadleCount'] !== undefined) {\n      this.createTreadleOrderTexture(draft);\n      this.createTieupTexture(draft);\n    }\n\n    if (changes.patches['warpCount'] !== undefined) {\n      this.createThreadingTexture(draft);\n      this.createWarpTexture(draft);\n    }\n\n    if (changes.patches['weftCount'] !== undefined) {\n      this.createTreadleOrderTexture(draft);\n      this.createWeftTexture(draft);\n    }\n\n    if (changes.patches['threading'] !== undefined) {\n      let patch = changes.patches.threading;\n      if (patch.every((p) => p.op === 'replace')) {\n        let span = this.getSpan(patch);\n        let data = draft.threading.slice(span[0], span[1] + 1);\n        textureUtil.update1DTexture(\n          this.gl,\n          this.threadingTexture,\n          span[0],\n          data,\n          draft.shaftCount\n        );\n      }\n    } else {\n      this.createThreadingTexture(draft);\n    }\n\n    if (changes.patches['treadleOrder'] !== undefined) {\n      let patch = changes.patches.treadleOrder;\n      if (patch.every((p) => p.op === 'replace')) {\n        let span = this.getSpan(patch);\n        let data = draft.treadleOrder.slice(span[0], span[1] + 1);\n        textureUtil.update1DTexture(\n          this.gl,\n          this.treadleOrderTexture,\n          span[0],\n          data,\n          draft.treadleCount\n        );\n      }\n    } else {\n      this.createTreadleOrderTexture(draft);\n    }\n\n    if (changes.patches['warpColors'] !== undefined) {\n      let patch = changes.patches.warpColors;\n      if (patch.every((p) => p.op === 'replace')) {\n        let span = this.getSpan(patch);\n        let data = draft.warpColors.slice(span[0], span[1] + 1);\n        textureUtil.updateColorTexture(\n          this.gl,\n          this.warpTexture,\n          span[0],\n          data,\n          draft.yarn\n        );\n      } else {\n        this.createWarpTexture(draft);\n      }\n    }\n\n    if (changes.patches['weftColors'] !== undefined) {\n      let patch = changes.patches.weftColors;\n      if (patch.every((p) => p.op === 'replace')) {\n        let span = this.getSpan(patch);\n        let data = draft.weftColors.slice(span[0], span[1] + 1);\n        textureUtil.updateColorTexture(\n          this.gl,\n          this.weftTexture,\n          span[0],\n          data,\n          draft.yarn\n        );\n      } else {\n        this.createWeftTexture(draft);\n      }\n    }\n\n    if (changes.patches['yarn'] !== undefined) {\n      this.createWarpTexture(draft);\n      this.createWeftTexture(draft);\n    }\n  }\n\n  getRenderer(name) {\n    return this.renderers[name].renderer;\n  }\n\n  getRendererByPos(pos) {\n    for (let i = 0; i < this.names.length; i++) {\n      let name = this.names[i];\n      if (\n        this.renderers[name].renderer.isWithinGrid(pos) &&\n        this.renderers[name].enabled\n      ) {\n        return this.renderers[name].renderer;\n      }\n    }\n    return undefined;\n  }\n\n  resizeCanvas() {\n    this.width = this.gl.canvas.width;\n    this.height = this.gl.canvas.height;\n    this.gl.viewport(0, 0, this.width, this.height);\n  }\n\n  addEventListener(name, func) {\n    this.scrollContainer.addEventListener(name, func);\n  }\n\n  render() {\n    this.renderNextFrame = true;\n  }\n\n  clearCanvas() {\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    this.gl.scissor(0, 0, w, h);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n  }\n\n  clear() {\n    this.clearCanvas();\n    Object.values(this.renderers).forEach((r) => (r.dirty = true));\n    this.render();\n  }\n}\n","<script>\n  import { onMount } from 'svelte';\n\n  import draft from 'stores/Draft';\n  import changes from 'stores/Changes';\n  import selection from '../Selection/SelectionStore';\n  import ui from 'stores/UI';\n  import { Renderer } from './gfx/Renderer';\n\n  export let scrollContainer;\n  let renderer;\n  let canvas;\n\n  let drag;\n  let linePoints;\n  let oldLinePoints = [];\n  let cancelled = false;\n  let oldP = [];\n  let mouseDownOriginator;\n\n  let startPos;\n  let endPos;\n  let startScroll;\n  $: scroll = [$ui.scrollX, $ui.scrollY];\n  $: selectedColor = $ui.selectedColor;\n  $: cellSize = $ui.cellSize;\n  $: isSelecting = $selection.isSelecting;\n  $: showTreadleOrder = $ui.showTreadleOrder;\n  $: showThreading = $ui.showThreading;\n  $: selectedMenu = $ui.selectedMenu;\n\n  $: {\n    if (renderer) {\n      renderer.setRendererPosition($draft, showTreadleOrder, showThreading);\n    }\n  }\n\n  $: {\n    if (renderer) {\n      renderer.update($draft, $ui, changes);\n      try {\n        renderer.render();\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }\n\n  $: {\n    if (\n      renderer !== undefined &&\n      drag !== undefined &&\n      (scroll[0] !== oldScroll[0] || scroll[1] !== oldScroll[1])\n    ) {\n      if (drag.includes('Color')) {\n        let color = $draft.yarn[selectedColor].color;\n        renderer.getRenderer(drag).renderPoints(...linePoints, color);\n      } else {\n        renderer.getRenderer(drag).renderPoints(linePoints);\n      }\n    }\n    oldScroll = scroll;\n  }\n\n  let oldScroll = [];\n  let dragMaybe;\n\n  function shouldStartDrag(event) {\n    let ret =\n      drag === undefined &&\n      event.buttons & (1 !== 0) &&\n      (event.movementX !== 0 || event.movementY !== 0) &&\n      dragMaybe &&\n      !isSelecting;\n    if (ret === true) {\n      dragMaybe = false;\n    }\n    return ret;\n  }\n\n  onMount(() => {\n    renderer = new Renderer(canvas, scrollContainer);\n    syncCanvasDimensions();\n    if (listenerQueue.length !== 0) {\n      for (let item of listenerQueue) {\n        renderer.addEventListener(item.name, item.func);\n      }\n      listenerQueue = [];\n    }\n\n    renderer.addEventListener('pointerdown', (e) => {\n      if (selectedMenu !== -1) {\n        return;\n      }\n      if (e.button === 2) {\n        e.preventDefault();\n        cancelled = true;\n        handleRightclick(e);\n      } else {\n        startPos = [e.offsetX, e.offsetY];\n        console.log(startPos);\n        startScroll = [...scroll];\n        dragMaybe = true;\n        mouseDownOriginator = renderer.getRendererByPos(startPos)?.name;\n        console.log('mouseDownOriginator', mouseDownOriginator);\n      }\n    });\n\n    renderer.addEventListener('pointermove', (e) => {\n      //console.log('pos', [e.offsetX, e.offsetY]);\n      setHover(e);\n\n      if (shouldStartDrag(e)) {\n        let rendererName = renderer.getRendererByPos(startPos)?.name;\n        console.log('rendererName', rendererName);\n        if (rendererName !== undefined && rendererName !== 'weave') {\n          drag = rendererName;\n          console.log('drag', drag);\n          ui.update((draft) => {\n            draft.isDragging = true;\n          });\n        }\n      }\n\n      if (drag !== undefined && drag !== 'weave') {\n        endPos = [e.offsetX, e.offsetY];\n        let startPosScroll = [\n          startPos[0] + (scroll[0] - startScroll[0]) / 2.0,\n          startPos[1] + (scroll[1] - startScroll[1]) / 2.0,\n        ];\n\n        linePoints = renderer\n          .getRenderer(drag)\n          .getCellsBetweenPoints(startPosScroll, endPos);\n        if (!drag.includes('Color')) {\n          if (drag === 'tieup') {\n            if (linePointsChanged(linePoints, oldLinePoints)) {\n              renderer.getRenderer(drag).renderPoints(linePoints);\n            }\n            oldLinePoints = linePoints;\n          } else {\n            let p = pointsToArray(linePoints);\n            if (linePointsChanged(p, oldP)) {\n              renderer.getRenderer(drag).renderPoints(p);\n            }\n            oldP = p;\n          }\n        } else {\n          if (linePointsChanged(linePoints, oldLinePoints)) {\n            let color = $draft.yarn.find((y) => y.id === selectedColor).color;\n            renderer.getRenderer(drag).renderPoints(...linePoints, color);\n          }\n          ui.update((draft) => {\n            draft.selectFrom = linePoints[0];\n            draft.selectTo = linePoints[1];\n          });\n          oldLinePoints = linePoints;\n        }\n      }\n    });\n\n    renderer.addEventListener('pointerup', (e) => {\n      if (drag !== undefined) {\n        switch (drag) {\n          case 'warpColors':\n          case 'weftColors':\n            updateColor(drag, linePoints[0], linePoints[1], $ui.selectedColor);\n            renderer.clear();\n            break;\n          case 'treadleOrder':\n          case 'threading': {\n            let lp = pointsToArray(linePoints);\n            updateListWithLine(drag, lp);\n            break;\n          }\n          case 'tieup':\n            updateTieupWithPoints(linePoints);\n            break;\n        }\n      } else if (!isSelecting && cancelled === false) {\n        // Regular click without drag\n        let pos = [e.offsetX, e.offsetY];\n        let name = renderer.getRendererByPos(pos)?.name;\n        if (name === undefined || name !== mouseDownOriginator) {\n          mouseDownOriginator = undefined;\n        } else {\n          let cell = renderer.getRenderer(name).getCellAtPos(pos);\n          switch (name) {\n            case 'warpColors':\n              updateColor(name, cell[0], cell[0], selectedColor);\n              break;\n            case 'weftColors':\n              updateColor(name, cell[1], cell[1], selectedColor);\n              break;\n            case 'threading':\n              updateGrid(name, cell[0], cell[1]);\n              break;\n            case 'treadleOrder':\n              updateGrid(name, cell[1], cell[0]);\n              break;\n            case 'tieup':\n              toggleTieup(cell[1], cell[0]);\n              break;\n          }\n        }\n      }\n      stopDrag();\n      cancelled = false;\n      mouseDownOriginator = undefined;\n    });\n\n    document.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape' && drag !== undefined) {\n        event.stopPropagation();\n        stopDrag();\n      }\n    });\n    document.addEventListener('visibilitychange', () => {\n      if (!document.hidden) {\n        renderer.clear();\n      }\n    });\n  });\n\n  function updateGrid(name, index, value) {\n    draft.update((temp) => {\n      temp[name][index] = temp[name][index] === value ? -1 : value;\n    });\n  }\n\n  function updateTieupWithPoints(linePoints) {\n    draft.update((temp) => {\n      linePoints.forEach((p) => {\n        temp.tieup[p[1]][p[0]] = 1;\n      });\n    });\n  }\n\n  function updateColor(name, colorStart, colorEnd, selectedColor) {\n    if (colorEnd < colorStart) {\n      [colorStart, colorEnd] = [colorEnd, colorStart];\n    }\n\n    draft.update((temp) => {\n      for (let i = 0; i < colorEnd - colorStart + 1; i++) {\n        temp[name][colorStart + i] = selectedColor;\n      }\n    });\n  }\n\n  function updateListWithLine(name, lp) {\n    draft.update((temp) => {\n      lp.forEach((p, i) => (temp[name][i] = p));\n    });\n  }\n\n  function toggleTieup(x, y) {\n    draft.update((temp) => {\n      temp.tieup[x][y] = temp.tieup[x][y] === 1 ? 0 : 1;\n    });\n  }\n\n  function linePointsChanged(left, right) {\n    if (left.length !== right.length) {\n      return true;\n    }\n    for (let i = 0; i < left.length; i++) {\n      if (left[i] !== right[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function pointsToArray(lp) {\n    let ret = [];\n    lp.forEach((p) => {\n      if (drag === 'treadleOrder') {\n        ret[p[1]] = p[0];\n      } else if (drag === 'threading') {\n        ret[p[0]] = p[1];\n      }\n    });\n    return ret;\n  }\n\n  function stopDrag() {\n    if (drag !== undefined) {\n      renderer.getRenderer(drag).render();\n      drag = undefined;\n      cancelled = true;\n      ui.update((draft) => {\n        draft.isDragging = false;\n      });\n    }\n  }\n\n  export function setHover(event) {\n    let pos = [event.offsetX, event.offsetY];\n    let r = renderer.getRendererByPos(pos);\n    if (r) {\n      let cell = r.getCellAtPos(pos);\n      if (cell[0] !== $ui.hoverCell[0] || cell[1] !== $ui.hoverCell[1]) {\n        ui.update((draft) => {\n          draft.hoverCell = cell;\n        });\n      }\n    }\n  }\n\n  function handleRightclick(event) {\n    let pos = [event.offsetX, event.offsetY];\n    let r = renderer.getRendererByPos(pos);\n    if (r) {\n      switch (r.name) {\n        case 'warpColors': {\n          let cell = r.getCellAtPos(pos);\n          let c = $draft[r.name][cell[0]];\n          console.log(c);\n          ui.update((draft) => {\n            draft.selectedColor = c;\n          });\n          break;\n        }\n        case 'weftColors': {\n          let cell = r.getCellAtPos(pos);\n          let c = $draft[r.name][cell[1]];\n          ui.update((draft) => {\n            draft.selectedColor = c;\n          });\n          break;\n        }\n        case 'threading':\n          break;\n        case 'treadleOrder':\n          break;\n        case 'tieup':\n          break;\n      }\n    }\n  }\n\n  export function syncCanvasDimensions() {\n    canvas.width = canvas.offsetWidth * window.devicePixelRatio;\n    canvas.height = canvas.offsetHeight * window.devicePixelRatio;\n    renderer.resizeCanvas();\n    renderer.clear();\n  }\n\n  let listenerQueue = [];\n  export function addEventListener(name, func) {\n    if (renderer !== undefined) {\n      renderer.addEventListener(name, func);\n    } else {\n      listenerQueue.push({ name, func });\n    }\n  }\n</script>\n\n<canvas class=\"weave-display\" bind:this={canvas} />\n\n<style>\n  .weave-display {\n    position: relative;\n    image-rendering: crisp-edges;\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>\n  import { vec2 } from 'gl-matrix';\n  import selection from './SelectionStore';\n  import ui from 'stores/UI';\n  import draft from 'stores/Draft';\n\n  export let weaveDisplay;\n\n  $: cellSize = $ui.cellSize / 2.0;\n  $: shaftCount = $draft.shaftCount;\n  $: treadleCount = $draft.treadleCount;\n\n  $: threadingPosition = [treadleCount + 4, 3];\n  $: treadleOrderPosition = [3, shaftCount + 4];\n  $: warpColorsPosition = [treadleCount + 4, 1];\n  $: weftColorsPosition = [1, shaftCount + 4];\n  $: weavePosition = [treadleCount + 4, shaftCount + 4];\n\n  $: isSelecting = $selection.isSelecting;\n  $: selectedThreading = $selection.threading;\n  $: to = $selection.to;\n  $: from = $selection.from;\n  $: appliedSelections = [];\n  $: hasLength =\n    $selection.to[0] - $selection.from[0] > 0 &&\n    $selection.to[1] - $selection.from[1] > 0;\n\n  $: useThreading = $selection.useThreading;\n  $: useTreadleOrder = $selection.useTreadleOrder;\n  $: useWarpColors = $selection.useWarpColors;\n  $: useWeftColors = $selection.useWeftColors;\n\n  $: scrollX = $ui.scrollX / 2.0;\n  $: scrollY = $ui.scrollY / 2.0;\n\n  $: showTreadleOrder = $ui.showTreadleOrder;\n  $: showThreading = $ui.showThreading;\n\n  $: dragSelection = { to: 0, from: 0 };\n  $: selections = [\n    {\n      name: 'useThreading',\n      canvasArea: {\n        left: 0,\n        right: `${threadingPosition[0] * cellSize}px`,\n        bottom: `${threadingPosition[1] * cellSize}px`,\n        height: `${shaftCount * cellSize}px`,\n      },\n      selectionArea: {\n        width: `${cellSize * (to[0] - from[0])}px`,\n        height: `${cellSize * shaftCount}px`,\n        right: `${from[0] * cellSize - scrollX}px`,\n        bottom: 0,\n      },\n      dragMarker: {\n        width: `${cellSize * (dragSelection.to[0] - dragSelection.from[0])}px`,\n        height: `${cellSize * shaftCount}px`,\n        right: `${dragSelection.from[0] * cellSize - scrollX}px`,\n        bottom: 0,\n      },\n    },\n    {\n      name: 'useTreadleOrder',\n      dir: 'vert',\n      canvasArea: {\n        top: 0,\n        right: `${treadleOrderPosition[0] * cellSize}px`,\n        bottom: `${treadleOrderPosition[1] * cellSize}px`,\n        width: `${treadleCount * cellSize}px`,\n      },\n      selectionArea: {\n        width: `${cellSize * treadleCount}px`,\n        height: `${(to[1] - from[1]) * cellSize}px`,\n        bottom: `${from[1] * cellSize - scrollY}px`,\n      },\n      dragMarker: {\n        width: `${cellSize * treadleCount}px`,\n        height: `${(dragSelection.to[1] - dragSelection.from[1]) * cellSize}px`,\n        bottom: `${dragSelection.from[1] * cellSize - scrollY}px`,\n      },\n    },\n    {\n      name: 'useWarpColors',\n      canvasArea: {\n        height: `${cellSize}px`,\n        right: `${warpColorsPosition[0] * cellSize}px`,\n        bottom: `${warpColorsPosition[1] * cellSize}px`,\n        left: 0,\n      },\n      selectionArea: {\n        width: `${(to[0] - from[0]) * cellSize}px`,\n        height: `${cellSize}px`,\n        right: `${from[0] * cellSize - scrollX}px`,\n      },\n      dragMarker: {\n        width: `${cellSize * (dragSelection.to[0] - dragSelection.from[0])}px`,\n        right: `${cellSize * dragSelection.from[0] - scrollX}px`,\n        height: `${cellSize}px`,\n      },\n    },\n    {\n      name: 'useWeftColors',\n      canvasArea: {\n        width: `${cellSize}px`,\n        right: `${weftColorsPosition[0] * cellSize}px`,\n        top: 0,\n        bottom: `${weftColorsPosition[1] * cellSize}px`,\n      },\n      selectionArea: {\n        width: `${cellSize}px`,\n        height: `${(to[1] - from[1]) * cellSize}px`,\n        right: 0,\n        bottom: `${from[1] * cellSize - scrollY}px`,\n      },\n      dragMarker: {\n        width: `${cellSize}px`,\n        height: `${(dragSelection.to[1] - dragSelection.from[1]) * cellSize}px`,\n        right: 0,\n        bottom: `${dragSelection.from[1] * cellSize - scrollY}px`,\n      },\n    },\n    {\n      name: 'weave',\n      canvasArea: {\n        left: 0,\n        right: `${weavePosition[0] * cellSize}px`,\n        top: 0,\n        bottom: `${weavePosition[1] * cellSize}px`,\n      },\n      selectionArea: {\n        width: `${cellSize * (to[0] - from[0])}px`,\n        height: `${cellSize * (to[1] - from[1])}px`,\n        right: `${from[0] * cellSize - scrollX}px`,\n        bottom: `${from[1] * cellSize - scrollY}px`,\n      },\n      dragMarker: {\n        width: `${(dragSelection.to[0] - dragSelection.from[0]) * cellSize}px`,\n        height: `${(dragSelection.to[1] - dragSelection.from[1]) * cellSize}px`,\n        right: `${dragSelection.from[0] * cellSize - scrollX}px`,\n        bottom: `${dragSelection.from[1] * cellSize - scrollY}px`,\n      },\n    },\n  ];\n\n  function routeMoveEvent(event) {\n    weaveDisplay.setHover(event);\n  }\n\n  function swap(a, b, i) {\n    if (a[i] > b[i]) {\n      let t = b[i];\n      b[i] = a[i];\n      a[i] = t;\n    }\n  }\n\n  function getSelection(fromCoord, toCoord) {\n    let origin = [0, 0];\n    if (fromCoord[0] > toCoord[0]) {\n      fromCoord = vec2.copy(vec2.create(), fromCoord);\n      toCoord = vec2.copy(vec2.create(), toCoord);\n      swap(fromCoord, toCoord, 0);\n    }\n    if (fromCoord[1] > toCoord[1]) {\n      fromCoord = vec2.copy(vec2.create(), fromCoord);\n      toCoord = vec2.copy(vec2.create(), toCoord);\n      swap(fromCoord, toCoord, 1);\n    }\n    if (vec2.dist(origin, fromCoord) > vec2.dist(origin, toCoord)) {\n      [fromCoord, toCoord] = [toCoord, fromCoord];\n    }\n    let fromOrigin = vec2.create();\n    vec2.sub(fromOrigin, fromCoord, origin);\n    vec2.scale(fromOrigin, fromOrigin, 1 / cellSize);\n    fromOrigin = fromOrigin.map((v) => Math.max(0, v)).map(Math.floor);\n\n    let toOrigin = vec2.create();\n    vec2.sub(toOrigin, toCoord, origin);\n    vec2.scale(toOrigin, toOrigin, 1 / cellSize);\n    toOrigin = toOrigin.map(Math.ceil);\n\n    return {\n      from: fromOrigin,\n      to: toOrigin,\n    };\n  }\n\n  let isDragging;\n  let containerFrom = [0, 0];\n  let currentSelection;\n  function containerMouseDown(event, name) {\n    let rect = event.target.getBoundingClientRect();\n    if (event.shiftKey) {\n      let containerTo = [\n        rect.width - event.offsetX + scrollX,\n        rect.height - event.offsetY + scrollY,\n      ];\n      let mouseOverElement = document.elementFromPoint(\n        event.pageX,\n        event.pageY\n      );\n      let selection = getSelection(containerFrom, containerTo);\n      let targetName = mouseOverElement.getAttribute('data-name');\n      updateSelection(selection, targetName);\n      return;\n    }\n    currentSelection = name;\n    containerFrom = [\n      rect.width - event.offsetX + scrollX,\n      rect.height - event.offsetY + scrollY,\n    ];\n    document.body.addEventListener('pointermove', containerMouseMove);\n    document.body.addEventListener('pointerup', containerMouseUp);\n  }\n\n  function containerMouseMove(event) {\n    let rect = event.target.getBoundingClientRect();\n    let containerTo = [\n      rect.width - event.offsetX + scrollX,\n      rect.height - event.offsetY + scrollY,\n    ];\n    isDragging = true;\n    dragSelection = getSelection(containerFrom, containerTo);\n  }\n\n  function containerMouseUp(event) {\n    let rect = event.target.getBoundingClientRect();\n    let containerTo = [\n      rect.width - event.offsetX + scrollX,\n      rect.height - event.offsetY + scrollY,\n    ];\n    let mouseOverElement = document.elementFromPoint(event.pageX, event.pageY);\n    let targetName = mouseOverElement.getAttribute('data-name');\n    let newSelection = getSelection(containerFrom, containerTo);\n    updateSelection(newSelection, targetName);\n    stopContainerDrag();\n  }\n\n  function updateSelection(newSelection, targetName) {\n    selection.update((temp) => {\n      temp.to = newSelection.to;\n      temp.from = newSelection.from;\n      if (targetName === 'weave') {\n        temp.useThreading = true;\n        temp.useWarpColors = true;\n        temp.useTreadleOrder = true;\n        temp.useWeftColors = true;\n      } else {\n        temp.useThreading = false;\n        temp.useWarpColors = false;\n        temp.useTreadleOrder = false;\n        temp.useWeftColors = false;\n        temp[currentSelection] = true;\n      }\n      if (targetName !== 'weave' && targetName !== currentSelection) {\n        temp[targetName] = true;\n      }\n    });\n  }\n\n  function toggleSelection(name) {\n    if (name !== 'weave') {\n      selection.update((temp) => {\n        temp[name] = !temp[name];\n      });\n    }\n  }\n\n  function stopContainerDrag() {\n    isDragging = false;\n    document.body.removeEventListener('pointermove', containerMouseMove);\n    document.body.removeEventListener('pointerup', containerMouseUp);\n  }\n\n  function toCssString(obj) {\n    return Object.entries(obj).reduce((a, b) => a + '; ' + b.join(': '), '');\n  }\n\n  function weaveApplied(name) {\n    return (\n      name === 'weave' &&\n      $selection.useThreading &&\n      $selection.useTreadleOrder &&\n      $selection.useWarpColors &&\n      $selection.useWeftColors\n    );\n  }\n</script>\n\n{#if isSelecting}\n  <div class=\"selections\" on:pointermove={routeMoveEvent}>\n    {#each selections as selectionItem}\n      <div\n        data-name={selectionItem.name}\n        class={'selection ' + selectionItem.name}\n        on:pointerdown={(e) => containerMouseDown(e, selectionItem.name)}\n        style={toCssString(selectionItem.canvasArea)}\n      >\n        {#if isDragging}\n          <div\n            style={toCssString(selectionItem.dragMarker)}\n            class=\"current-selection-marker\"\n          />\n        {/if}\n        {#if hasLength}\n          <div\n            class={'selection-overlay'}\n            class:applied={$selection[selectionItem.name] ||\n              weaveApplied(selectionItem.name)}\n            on:click={() => toggleSelection(selectionItem.name)}\n            style={toCssString(selectionItem.selectionArea)}\n          />\n        {/if}\n      </div>\n    {/each}\n  </div>\n{/if}\n\n<style>\n  .selection {\n    position: absolute;\n    overflow: hidden;\n    pointer-events: all;\n  }\n\n  .current-selection-marker {\n    position: absolute;\n    background-color: rgba(0, 0, 0, 0.5);\n    pointer-events: none;\n  }\n\n  .selection-overlay {\n    pointer-events: none;\n    position: absolute;\n    box-shadow: inset 0 0 1px 5px gray;\n    display: flex;\n    justify-content: space-between;\n  }\n  .applied {\n    box-shadow: inset 0 0 1px 5px green;\n  }\n</style>\n","<script>\n  import ui from 'stores/UI';\n  import draft from 'stores/Draft';\n\n  export let width = 0;\n  export let height = 0;\n  export let position;\n  export let stepCount;\n  export let distance;\n\n  let stepsContainerHeight;\n  let stepsContainerWidth;\n  let guideContainer;\n  let steps = [];\n  $: vertical = height > width;\n  $: cellSize = $ui.cellSize / window.devicePixelRatio;\n  $: ch = cellSize / 2.0;\n  $: containerPos = [position[0] * ch, position[1] * ch];\n\n  $: scrollPos = vertical ? $ui.scrollY : $ui.scrollX;\n  $: transform = `translate${vertical ? 'Y' : 'X'}(${scrollPos / 2.0}px)`;\n  $: shaftCount = $draft.shaftCount;\n  $: treadleCount = $draft.treadleCount;\n\n  $: {\n    if (vertical) {\n      stepsContainerHeight = height - ch * (shaftCount + 6) - 4;\n      stepsContainerWidth = ch;\n    } else {\n      stepsContainerHeight = ch;\n      stepsContainerWidth = width - ch * (treadleCount + 4) + 4;\n    }\n  }\n\n  $: {\n    steps = [];\n    for (let i = 0; i < stepCount / distance; i++) {\n      let step = i * distance;\n      let right = `${(step * cellSize) / 2}px`;\n      if (step > 10) {\n        right += ` - ${Math.floor(Math.log10(step))}em / 2`;\n      } else if (step > 0) {\n        right += ` - 0.5ex`;\n      }\n      right = `calc(${right})`;\n\n      steps.push([step, right]);\n    }\n  }\n</script>\n\n<div\n  bind:this={guideContainer}\n  class=\"steps-container\"\n  class:vertical\n  style={`\n  right: ${containerPos[0]}px;\n  bottom: ${containerPos[1]}px;\n  height: ${stepsContainerHeight}px;\n  width: ${stepsContainerWidth}px\n  `}\n>\n  <div\n    class=\"steps\"\n    style={`\n    height: ${ch}px;\n    font-size: ${cellSize / 5}pt;\n    transform: ${transform};\n    `}\n  >\n    {#each steps as step}\n      <span style={`${vertical ? 'bottom' : 'right'}: ${step[1]}`}\n        >{step[0]}</span\n      >\n    {/each}\n  </div>\n</div>\n\n<style>\n  .steps-container {\n    position: absolute;\n    overflow: hidden;\n  }\n\n  .steps {\n    display: flex;\n    align-items: center;\n    position: absolute;\n    right: 0px;\n    bottom: 4px;\n  }\n\n  .vertical {\n    right: calc(1em - 8px);\n    writing-mode: vertical-lr;\n  }\n\n  .vertical .steps {\n    right: 0.6em;\n    bottom: 0px;\n  }\n\n  .steps span {\n    position: absolute;\n    right: 0;\n  }\n</style>\n","<script>\n  import ui from 'stores/UI';\n  $: from = $ui.selectFrom;\n  $: to = $ui.selectTo;\n  $: length = to - from + 1;\n  $: isDragging = $ui.isDragging;\n  $: hoverCell = $ui.hoverCell;\n</script>\n\n<div class=\"info-bar\">\n  {#if isDragging}\n    <span>{`${from} → ${to} (${length})`}</span>\n  {:else}\n    <span>{`${hoverCell[0]}, ${hoverCell[1]}`}</span>\n  {/if}\n</div>\n\n<style>\n  .info-bar {\n    display: flex;\n    justify-content: end;\n    min-height: 20px;\n    width: 100%;\n    background-color: white;\n    pointer-events: all;\n    z-index: 5;\n    border-top: 1px solid black;\n    font-size: 125%;\n  }\n\n  .info-bar span {\n    margin-left: 1em;\n  }\n</style>\n","<script>\n  import { onMount } from 'svelte';\n  import ui from 'stores/UI';\n  import draft from 'stores/Draft';\n  import Subcomponents from './Subcomponents';\n\n  let dialogElement;\n  $: selectedMenu = $ui.selectedMenu;\n  onMount(() => {\n    document.body.addEventListener('pointerdown', onClick);\n  });\n\n  function onClick(event) {\n    if (dialogElement === null) {\n      document.body.removeEventListener('pointerdown', onClick);\n      return;\n    }\n    if (\n      selectedMenu !== -1 &&\n      //Disable click dismissal for select/repeat\n      selectedMenu !== 4 &&\n      !dialogElement.contains(event.target) &&\n      !event.target.classList.contains('color-input-canvas')\n    ) {\n      event.preventDefault();\n      ui.update((temp) => {\n        temp.selectedMenu = -1;\n      });\n      document.body.removeEventListener('pointerdown', onClick);\n    }\n  }\n</script>\n\n<div class=\"dialog\" bind:this={dialogElement}>\n  <svelte:component this={Subcomponents[selectedMenu].component} />\n</div>\n\n<style>\n  @media (min-width: 900px) {\n    .dialog {\n    }\n  }\n\n  @media (max-width: 900px) {\n    .dialog {\n      top: 0;\n      left: 0;\n      right: 0;\n    }\n  }\n\n  .dialog {\n    position: absolute;\n    overflow: auto;\n\n    z-index: 10;\n    background-color: var(--color-5);\n    padding: 20px;\n    border: 1px solid var(--color-4);\n\n    max-width: calc(100vw - 20px * 2);\n  }\n</style>\n","<script>\n  import { onMount, afterUpdate } from 'svelte';\n  import Sidebar from './Sidebar/Sidebar';\n  import Toolbar from './Toolbar';\n  import ui from 'stores/UI';\n  import draft from 'stores/Draft';\n  import WeaveDisplay from './WeaveDisplay/WeaveDisplay';\n  import Selection from './Selection/SelectionComponent';\n  import RulerBar from './RulerBar';\n  import InfoBar from './InfoBar';\n  import Dialog from 'pages/Editor/Sidebar/Dialog';\n\n  import { vec2 } from 'gl-matrix';\n\n  let infobarContainer;\n  let scrollContainer;\n  let canvasContainer;\n  let canvasWidth;\n  let canvasHeight;\n  let cellSizeInput = $ui.cellSize;\n  let hasChangedCellSize;\n  let scrollPercentage = [];\n\n  let infobarHeight = 0;\n  let toolbarHeight = 0;\n  let scrollbarWidth = 15;\n  let scrollbarHeight = 15;\n  let weaveDisplay;\n\n  let resizeObserver;\n\n  $: warpCount = $draft.warpCount;\n  $: weftCount = $draft.weftCount;\n  $: cellSize = $ui.cellSize / window.devicePixelRatio;\n  $: width = warpCount * cellSize;\n  $: height = weftCount * cellSize;\n  $: showThreading = $ui.showThreading;\n  $: showTreadleOrder = $ui.showTreadleOrder;\n  $: selectedMenu = $ui.selectedMenu;\n  $: disableScroll = $ui.disableScroll;\n\n  let sidebarOpen = true;\n\n  afterUpdate(() => {\n    if (hasChangedCellSize) {\n      hasChangedCellSize = false;\n      let [scrollLeftMax, scrollTopMax] = getBounds();\n      let x = (1.0 - scrollPercentage[0]) * scrollLeftMax;\n      let y = (1.0 - scrollPercentage[1]) * scrollTopMax;\n      scrollContainer.scrollTo(x, y);\n    }\n  });\n\n  onMount(() => {\n    let dpr = window.devicePixelRatio;\n    scrollbarWidth = scrollContainer.offsetWidth - scrollContainer.clientWidth;\n    scrollbarHeight =\n      scrollContainer.offsetHeight - scrollContainer.clientHeight;\n    infobarHeight = infobarContainer.clientHeight;\n\n    let scrollLeftMax =\n      scrollContainer.scrollWidth - scrollContainer.clientWidth;\n    let scrollTopMax =\n      scrollContainer.scrollHeight - scrollContainer.clientHeight;\n    scrollContainer.scrollTo(scrollLeftMax, scrollTopMax);\n    resizeObserver = new ResizeObserver(() => {\n      if (weaveDisplay !== undefined && weaveDisplay !== null) {\n        weaveDisplay.syncCanvasDimensions();\n      }\n    });\n    resizeObserver.observe(canvasContainer);\n\n    scrollContainer.addEventListener('contextmenu', (e) => {\n      e.preventDefault();\n      return false;\n    });\n\n    scrollContainer.addEventListener('wheel', (event) => {\n      if (event.ctrlKey) {\n        event.preventDefault();\n        cellSizeInput += event.deltaY * -0.03;\n        cellSizeInput = Math.max(5, Math.min(70, cellSizeInput));\n        changeCellSize();\n      }\n    });\n\n    let startScale;\n    scrollContainer.addEventListener('touchstart', (e) => {\n      let touches = e.targetTouches;\n      if (touches.length === 2) {\n        let t0 = touches[0];\n        let t1 = touches[1];\n        let p0 = vec2.fromValues(t0.clientX, t0.clientY);\n        let p1 = vec2.fromValues(t1.clientX, t1.clientY);\n        startScale = vec2.length(vec2.sub(vec2.create(), p0, p1));\n      }\n    });\n\n    scrollContainer.addEventListener('touchmove', (e) => {\n      let touches = e.targetTouches;\n      if (touches.length === 2) {\n        let t0 = touches[0];\n        let t1 = touches[1];\n        let p0 = vec2.fromValues(t0.clientX, t0.clientY);\n        let p1 = vec2.fromValues(t1.clientX, t1.clientY);\n        let newScale = vec2.length(vec2.sub(vec2.create(), p0, p1));\n        let scaleDiff = newScale / startScale;\n        cellSizeInput *= scaleDiff;\n        changeCellSize();\n        startScale = newScale;\n      }\n    });\n\n    scrollContainer.addEventListener('touchend', (e) => {\n      if (e.touches.length === 0 && startScale !== undefined) {\n        ui.update((draft) => {\n          draft.cellSize = draft.cellSize;\n        });\n        startScale = undefined;\n      }\n    });\n\n    let rect = canvasContainer.getBoundingClientRect();\n    canvasWidth = rect.width;\n    canvasHeight = rect.height;\n  });\n\n  function getBounds() {\n    let dpr = window.devicePixelRatio;\n    let scrollLeftMax =\n      scrollContainer.scrollWidth - scrollContainer.clientWidth;\n    let scrollTopMax =\n      scrollContainer.scrollHeight - scrollContainer.clientHeight;\n    return [scrollLeftMax * dpr, scrollTopMax * dpr];\n  }\n\n  function getPosition() {\n    let [scrollLeftMax, scrollTopMax] = getBounds();\n    let dpr = window.devicePixelRatio;\n    let x = scrollLeftMax - scrollContainer.scrollLeft * dpr;\n    let y = scrollTopMax - scrollContainer.scrollTop * dpr;\n    return [x, y];\n  }\n\n  function updatePosition() {\n    let pos = getPosition();\n    ui.update((draft) => {\n      draft.scrollX = pos[0];\n      draft.scrollY = pos[1];\n    });\n  }\n\n  function changeCellSize() {\n    let newCellSize = cellSizeInput;\n    let oldCellSize = $ui.cellSize;\n    if (newCellSize !== oldCellSize) {\n      hasChangedCellSize = true;\n      let [x, y] = getPosition();\n      let [scrollLeftMax, scrollTopMax] = getBounds();\n      scrollPercentage = [x / scrollLeftMax, y / scrollTopMax];\n      ui.update((draft) => {\n        draft.cellSize = newCellSize;\n      });\n    }\n  }\n</script>\n\n<Toolbar bind:height={toolbarHeight} bind:sidebarOpen />\n<Sidebar bind:open={sidebarOpen} />\n<div\n  on:scroll={updatePosition}\n  bind:this={scrollContainer}\n  class=\"container\"\n  tabindex=\"0\"\n>\n  {#if selectedMenu !== -1}\n    <Dialog />\n  {/if}\n  <div\n    class=\"scrollpane\"\n    style={`left: ${width / 2}px; top: ${height / 2}px;`}\n  />\n  <div\n    bind:this={canvasContainer}\n    class=\"fixed\"\n    style={`\n    top: ${toolbarHeight}px;\n    right: ${scrollbarWidth}px;\n    bottom: ${scrollbarWidth + infobarHeight}px\n    `}\n  >\n    <div class=\"weave-container\">\n      {#if scrollContainer !== undefined}\n        <WeaveDisplay bind:this={weaveDisplay} bind:scrollContainer />\n        <Selection {weaveDisplay} />\n        {#if $ui.showThreading}\n          <RulerBar\n            width={canvasWidth * window.devicePixelRatio}\n            stepCount={$draft.warpCount}\n            distance={$ui.xStepDistance}\n            position={[$draft.treadleCount + 4, 2]}\n          />\n        {/if}\n        {#if $ui.showTreadleOrder}\n          <RulerBar\n            height={canvasHeight * window.devicePixelRatio}\n            stepCount={$draft.weftCount}\n            distance={$ui.yStepDistance}\n            position={[2, $draft.shaftCount + 4]}\n          />\n        {/if}\n      {/if}\n    </div>\n  </div>\n  <div\n    class=\"infobarContainer-container\"\n    bind:this={infobarContainer}\n    style={`bottom: ${scrollbarHeight}px; right: ${scrollbarWidth}px`}\n  >\n    <InfoBar />\n  </div>\n</div>\n\n<style>\n  .container {\n    overflow: auto;\n    --left-menu-width: 0px;\n  }\n\n  .infobarContainer-container {\n    position: absolute;\n    bottom: 0;\n    left: var(--left-menu-width);\n  }\n  .fixed {\n    display: flex;\n    justify-content: stretch;\n    align-items: stretch;\n    flex-direction: column;\n\n    position: absolute;\n    right: 0;\n    left: var(--left-menu-width);\n    bottom: 0;\n    top: 0;\n\n    pointer-events: none;\n  }\n\n  .scrollpane {\n    background-color: #5959308f;\n    pointer-events: none;\n    position: relative;\n    width: 10px;\n    height: 10px;\n  }\n\n  .weave-container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>\n  import ColorPickerDialog from './pages/Editor/ColorPickerDialog/ColorPickerDialog.svelte';\n  import Editor from './pages/Editor/Editor.svelte';\n  import ui from '/stores/UI';\n  export let locale;\n  console.log('llocale', locale);\n  ui.update((t) => {\n    t.locale = locale;\n  });\n</script>\n\n<div class=\"application\">\n  <Editor />\n</div>\n<ColorPickerDialog />\n\n<style>\n  .application {\n    flex-grow: 1;\n    display: grid;\n    grid-template-rows: auto 1fr;\n    grid-template-columns: auto 1fr;\n\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    overflow: hidden;\n    touch-action: none;\n  }\n</style>\n","import tinycolor from 'tinycolor2';\nimport App from './App.svelte';\n//import 'i18n/i18n';\nimport {\n  addMessages,\n  init,\n  getLocaleFromNavigator,\n} from 'precompile-intl-runtime';\nimport en from '../messages/en.js';\nimport sv from '../messages/sv.js';\nimport { enablePatches } from 'immer';\n\naddMessages('en', en);\naddMessages('sv', sv);\n\nlet locale = getLocaleFromNavigator();\n//locale = 'en';\nlet queryParams = {};\nlocation.search\n  .split(/\\?|;/)\n  .filter((l) => l.length > 0)\n  .forEach((m) => {\n    let t = m.split('=');\n    queryParams[t[0]] = t[1];\n  });\n\nif (queryParams.lang !== undefined) {\n  locale = queryParams.lang;\n}\n\ninit({\n  fallbackLocale: 'en',\n  initialLocale: locale,\n});\n\n/*\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker\n    .register('serviceworker.js', { scope: './' })\n    .then((reg) => {\n      // registration worked\n      console.log('Registration succeeded. Scope is ' + reg.scope);\n    })\n    .catch((error) => {\n      // registration failed\n      console.log('Registration failed with ' + error);\n    });\n}\n*/\n\nenablePatches();\nwindow.process = { env: { NODE_ENV: 'production' } };\n\nconsole.log('lol', locale);\nconst app = new App({\n  target: document.body,\n  props: {\n    locale: locale.split('-')[0],\n  },\n});\n\nwindow.tinycolor = tinycolor;\nexport default app;\n","import { $locale } from './stores/locale';\nimport { getOptions } from './includes/utils';\nexport function init(opts) {\n    const { formats, ...rest } = opts;\n    const initialLocale = opts.initialLocale || opts.fallbackLocale;\n    const options = getOptions();\n    Object.assign(options, rest, { initialLocale });\n    if (formats) {\n        if ('number' in formats) {\n            Object.assign(options.formats.number, formats.number);\n        }\n        if ('date' in formats) {\n            Object.assign(options.formats.date, formats.date);\n        }\n        if ('time' in formats) {\n            Object.assign(options.formats.time, formats.time);\n        }\n    }\n    return $locale.set(initialLocale);\n}\n"],"names":["Math","trimLeft","trimRight","tinyCounter","mathRound","round","mathMin","min","mathMax","max","mathRandom","random","tinycolor","color","opts","this","rgb","r","g","b","a","s","v","l","ok","format","replace","toLowerCase","match","named","names","matchers","exec","rgba","hsl","h","hsla","hsv","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","rgbToRgb","String","substr","convertToPercentage","i","floor","f","p","q","t","mod","hsvToRgb","hue2rgb","hslToRgb","hasOwnProperty","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_a","_roundA","_format","_gradientType","gradientType","_ok","_tc_id","rgbToHsl","d","rgbToHsv","rgbToHex","allow3Char","hex","pad2","toString","charAt","join","rgbaToArgbHex","convertDecimalToHex","desaturate","amount","toHsl","clamp01","saturate","greyscale","lighten","brighten","toRgb","darken","spin","hue","complement","triad","tetrad","splitcomplement","analogous","results","slices","part","ret","push","monochromatic","toHsv","modification","prototype","isDark","getBrightness","isLight","isValid","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","pow","setAlpha","value","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","clone","_applyModification","fn","args","apply","concat","slice","call","arguments","_applyCombination","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","readability","c1","c2","isReadable","wcag2","wcag2Parms","out","parms","level","size","toUpperCase","validateWCAG2Parms","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","length","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","o","flipped","flip","parseFloat","isNaN","n","indexOf","isOnePointZero","processPercent","isPercentage","parseInt","abs","val","c","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","RegExp","module","exports","window","noop","run","blank_object","Object","create","run_all","fns","forEach","is_function","thing","not_equal","subscribe","store","callbacks","unsub","unsubscribe","component_subscribe","component","callback","$$","on_destroy","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","tar","src","k","assign","get_slot_changes","dirty","lets","undefined","merged","len","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","get_all_dirty_from_scope","null_to_empty","set_store_value","set","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","element","name","document","createElement","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","set_data","wholeText","set_input_value","input","select_option","select","option","__value","selected","selectedIndex","toggle_class","toggle","classList","HtmlTag","constructor","e","html","m","nodeName","innerHTML","Array","from","childNodes","current_component","set_current_component","get_current_component","Error","onMount","on_mount","afterUpdate","after_update","onDestroy","bubble","type","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","add_flush_callback","flushing","seen_callbacks","Set","flush","update","pop","has","add","clear","fragment","before_update","outroing","outros","group_outros","check_outros","transition_in","block","local","delete","transition_out","bind","index","props","bound","create_component","mount_component","customElement","new_on_destroy","map","filter","destroy_component","make_dirty","then","fill","init","instance","create_fragment","append_styles","parent_component","on_disconnect","context","Map","skip_bound","root","ready","rest","hydrate","nodes","children","intro","SvelteComponent","$destroy","$on","splice","$set","$$props","obj","$$set","keys","EPSILON","ARRAY_TYPE","Float32Array","glMatrix.ARRAY_TYPE","identity","translate","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","x","y","z","scale","fromRotationTranslationScale","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","fromValues","hypot","sqrt","setAxisAngle","axis","rad","sin","cos","vec","copy","distance","normalize","dot","transformMat4","vec3.create","vec3.fromValues","sub","mul","dist","VertexArray","gl","vertexData","indexData","attrs","drawMode","TRIANGLES","Uint16Array","initialize","vertBuf","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","indexBuf","ELEMENT_ARRAY_BUFFER","isInitialized","console","error","attrSum","reduce","pointer","vertexAttribPointer","FLOAT","enableVertexAttribArray","draw","drawElements","UNSIGNED_SHORT","unbind","disableVertexAttribArray","free","deleteBuffer","Shader","vert","frag","attributes","getAttributes","source","split","row","includes","substring","lastIndexOf","compiled","useProgram","program","compile","uniforms","vertProgram","compileShader","VERTEX_SHADER","fragProgram","FRAGMENT_SHADER","createShaderProgram","isCompiled","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","groupCollapsed","log","groupEnd","vertexShader","fragmentShader","shaderProgram","createProgram","attachShader","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","info","getProgramInfoLog","getUniformHandle","uniformName","handle","getUniformLocation","setBool","uniformHandle","uniform1i","setInt","setFloat","uniform1f","setVec2","uniform2fv","setVec3","uniform3fv","setVec4","uniform4fv","setMat3","uniformMatrix3fv","setMat4","uniformMatrix4fv","setSampler2D","Ring","points","innerRadius","geometry","numPoints","indices","PI","justify","generateGeometry","canvas","colorWheelShader","satValShader","solidShader","quad","triP","triPT","triangle","ring","triangleModel","body","mouseDown","colorWheelToggle","triangleToggle","state","onCanvasMouseDown","preventDefault","onCanvasMouseMove","rect","getBoundingClientRect","handleInput","clientX","width","clientY","height","saturation","updateColor","buttons","onCanvasMouseUp","coords","positionInWheel","vec2.distance","v1","v2","v1n","vec2.normalize","vec2.create","v2n","vec2.dot","det","atan2","getAngle","getPositionInWheel","positionInTriangle","getPositionInTriangle","pos","to","line","vec2.sub","vec2.len","vec2.scaleAndAdd","getClosestPointToTriangle","u","Number","fireEvent","setState","ratio","inColor","hexString","onChange","coord","render","COLOR_BUFFER_BIT","resolution","mat4Create","rot","hueRot","quatSetAxisAngle","quatCreate","mat4FromRotationTranslationScale","vec3Create","vec2.transformMat4","mvp2","mat4Translate","b00","b01","b02","b10","b11","b12","b20","b21","b22","glMatrix.EPSILON","mat4Rotate","mat4Scale","r1","vec2.mul","r2","res","vec2.add","getTriangleCoordinateFromColor","svMarkerColor","hueMarkerColor","hueMarkerMatrix","quatMat","yx","zx","zy","mat4FromQuat","a30","a31","a32","a33","b0","b1","b2","b3","mat4Multiply","newState","elm","getContext","premultipliedAlpha","preserveDrawingBuffer","clearColor","uv","initCanvas","str","subscriber_queue","writable","start","stop","subscribers","new_value","safe_not_equal","run_queue","subscriber","invalidate","derived","stores","initial_value","single","isArray","stores_array","auto","inited","values","pending","cleanup","sync","result","unsubscribers","listenersSnapshot","lastListenerId","listeners","isVisible","position","colorPickerStore","onColorChange","listener","id","removeListener","ls","showColorPicker","startColor","emit","realX","realY","colorPickerColor","$position","$isVisible","innerWidth","setPosition","centerX","centerY","distToCenter","contains","fallbackLocale","initialLocale","loadingDelay","formats","number","scientific","notation","engineering","compactLong","compactDisplay","compactShort","date","short","month","day","year","medium","long","full","weekday","time","hour","minute","second","timeZoneName","warnOnMissingMessages","currentLocale","dictionary","getCurrentLocale","getOptions","getSubLocales","refLocale","_","arr","reverse","getPossibleLocales","locales","$dictionary","hasLocaleDictionary","locale","getMessageFromDictionary","localeDictionary","getLocaleDictionary","ids","tmpDict","addMessages","partials","newDictionary","$isLoading","loaderQueue","getLocaleQueue","hasLocaleQueue","some","activeLocaleFlushes","queues","localeItem","queue","getLocalesQueues","setTimeout","all","loader","removeLocaleFromQueue","partial","default","clearTimeout","$locale","newLocale","documentElement","localeSet","relatedLocales","getClosestAvailableLocale","lookupCache","addToCache","path","message","formatMessage","optionsOrId","maybeOptions","defaultValue","lookup","sort","warn","$format","Mexp","parsed","math","isDegree","acos","asin","atan","acosh","asinh","atanh","C","pro","other","choice","fact","changeSign","toRadian","cosh","E","div","inverse","P","Pi","low","high","ex","postfixEval","pow10x","sigma","sum","sinh","tanh","sinha","cosha","Exception","inc","token","show","eva","preced","type0","type1","type1Asterick","type3Asterick","type6","newAr","str1","str2","addToken","tokens","temp","lex","inp","changeSignObj","pre","closingParObj","openingParObj","ptc","inpStr","allowed","bracToClose","asterick","prevKey","string","key","eval","precedence","tokenize","j","cToken","cType","cEv","cPre","cShow","hasDec","toPostfix","elem","popped","prep","ele","post","stack","flag","UserDefined","pop1","pop2","pop3","bool","unshift","toFixed","formulaEval","disp","label","disabled","showArrows","evalExpr","lastValidValue","mexp","process","env","NODE_ENV","Y","Q","getPrototypeOf","Function","Z","L","nn","get","X","rn","configurable","enumerable","freeze","isFrozen","tn","U","O","S","M","H","A","I","R","D","F","getOwnPropertyDescriptor","N","T","en","on","Proxy","revocable","revoke","proxy","J","K","G","W","Symbol","B","Reflect","for","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","getOwnPropertyDescriptors","deleteProperty","defineProperty","setPrototypeOf","un","produce","produceWithPatches","useProxies","setUseProxies","autoFreeze","setAutoFreeze","createDraft","finishDraft","applyPatches","op","$","an","pn","changes","currentIndex","changeSet","paths","patches","addChanges","item","patch","draft","localStorage","getItem","JSON","parse","treadling","treadleOrder","pickCount","weftCount","warpColors","warpCount","weftColors","yarn","threading","tieup","shaftCount","treadleCount","undoDraft","inversePatches","undo.undo","newDraft","draftSnapshot","redoDraft","undo.redo","func","storePatches","undo.push","subscription","undo","redo","setItem","stringify","drop","removeItem","ctrlKey","ui","selectedMenu","selectedColor","cellSize","scrollX","scrollY","xStepDistance","yStepDistance","showTreadleOrder","showThreading","selectTo","selectFrom","isDragging","hoverCell","disableScroll","storedUI","prevStore","applyPattern","pattern","warpOrWeft","mirroredRepeat","end","array","offset","changeArraySize","newSize","amountToAdd","originalSize","applyColor","colors","newColors","newYarn","$draft","oldLength","draftUtil.updateShaftCount","draftUtil.updateTreadleCount","draftUtil.updateWarpCount","draftUtil.updateWeftCount","dropUi","action_result","destroy","focus","toRatio","colorListener","importData","showImport","selectYarnForModification","changeName","newName","yarnId","find","deleteColor","findIndex","yarnToRemoveId","newYarnId","oldIndex","draftUtil.removeYarn","yarnUnderModification","$ui","selectedYarn","draftUtil.newYarn","pageX","pageY","trim","yarns","json","entries","checked","selection","isSelecting","useThreading","useWarpColors","useTreadleOrder","useWeftColors","fillAll","$selection","maxLength","selectionFrom","selectionTo","targetTo","targetFrom","draftUtil.applyPattern","draftUtil.applyColor","x0","y0","x1","y1","dx","dy","err","e2","borderSize","resizeStartPos","xCount","yCount","toggleCell","onClick","onMouseDown","onMouseUp","onMouseMove","resizeX","resizeY","resizeObserver","ResizeObserver","isResizing","drawForm","fillStyle","fillRect","fillBorders","innerCellMargin","onResizeMouseMove","stopDrag","numCells","endPos","onBodyMouseUp","style","cursor","observe","unobserve","syncCanvasDimensions","fromCell","getCellAtPos","toCell","addArrays","left","right","grid","oldWarpOfWeft","startPos","linePoints","cellData","onGridMouseMove","stopPropagation","top","movementX","movementY","lp","getCellsBetweenPoints","cellDataSlice","gridIcon","heddleThreadFill","getRepeats","repeatTimes","lastValue","repeats","times","distanceBetweenPoints","fromRow","fromColumn","startX","startClientX","elements","lastX","lastFromRow","lastFromColumn","elementActive","dragStart","column","dragMove","dragEnd","once","remove","repeatRows","delta","encompassUnitInRowAbove","change","sign","modifyRepeat","postChangeCheck","currentRow","rowNum","isEndpoint","rep","rowNumber","generateId","repeatTimesPerRow","subRow","lastRow","secondToLastRow","every","setRepeatTimes","querySelectorAll","first","last","elms","firstRect","lastRect","parentRect","getPositionOfNumberInput","amountOfNumberInputs","selectedRepeat","selected_option","querySelector","NewIcon","repeatComponent","lastBlur","deleteRow","setValue","insertColumn","onFocus","columnIndex","removeColumn","onBlur","tableThreads","threads","getTableThreads","repeatRow","lowerRow","rep1","th","yarnFillTable","useWarp","useWeft","getThreads","icon","Subcomponents","sidebar","open","selectMenu","blob","Blob","link","download","href","URL","createObjectURL","dataset","downloadurl","evt","MouseEvent","view","bubbles","cancelable","dispatchEvent","files","file","reader","FileReader","onload","readFile","readAsText","isToggled","setColor","selectedColorIndex","container","firstChild","toolbarContainer","sidebarOpen","clientHeight","toggleTreadleOrder","toggleThreading","ShaderBuilder","shaderCache","getShader","shaderName","genUV2D","buildShader","Texture","Uint8Array","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_T","CLAMP_TO_EDGE","TEXTURE_WRAP_S","deleteTexture","unit","activeTexture","TEXTURE0","setColorArea","texSubImage2D","RendererEventTarget","clickListeners","pointerMoveListeners","pointerUpListeners","pointerDownListeners","shaders","centerQuad","prerender","rX","rY","rendererPos","cH","scissor","isWithinGrid","dpr","devicePixelRatio","cs","gridX","gridY","shouldScrollX","shouldScrollY","xOffset","yOffset","cellX","cellY","TieupRenderer","super","mvp","mat4.create","initialView","mat4.scale","mat4.translate","renderPoints","cw","ch","mat4.identity","handleEvent","offsetX","offsetY","gridW","gridH","updateValues","setRendererPosition","scrollPos","setCellToggleTexture","cellToggleTexture","GridRenderer","vertical","minorSize","WeaveRenderer","weaveShader","setThreadingTexture","setTreadleOrderTexture","setTieupTexture","setWarpTexture","warpTexture","setWeftTexture","weftTexture","ColorRowRenderer","setColorTexture","colorTexture","create1DGridTexture","shafts","gridTexture","absence","update1DTexture","dv","createColorTexture","idToYarn","updateColorTexture","Renderer","renderNextFrame","prevDraft","prevUI","dependencyGraph","scrollContainer","antialias","disable","DEPTH_TEST","enable","SCISSOR_TEST","startup","maxTextureSize","getParameter","MAX_TEXTURE_SIZE","threadingTexture","treadleOrderTexture","tieupTexture","resizeCanvas","extension","getExtension","loseContext","renderers","renderer","enabled","getValues","weave","listOfRenderers","requestAnimationFrame","isDifferent","updateTextures","dependencies","clearCanvas","createThreadingTexture","textureUtil.create1DGridTexture","createTreadleOrderTexture","createTieupTexture","textureUtil.createGridTexture","createWarpTexture","textureUtil.createColorTexture","createWeftTexture","getSpan","MAX_VALUE","MIN_VALUE","updateValuesInColorTexture","span","textureUtil.update1DTexture","textureUtil.updateColorTexture","getRenderer","getRendererByPos","viewport","linePointsChanged","drag","mouseDownOriginator","startScroll","dragMaybe","oldLinePoints","cancelled","oldP","oldScroll","updateGrid","colorStart","colorEnd","pointsToArray","setHover","cell","offsetWidth","offsetHeight","listenerQueue","button","handleRightclick","scroll","shouldStartDrag","rendererName","startPosScroll","updateListWithLine","updateTieupWithPoints","toggleTieup","hidden","toCssString","dragMarker","selectionArea","canvasArea","swap","weaveDisplay","getSelection","fromCoord","toCoord","origin","vec2.copy","vec2.dist","fromOrigin","vec2.scale","toOrigin","ceil","currentSelection","containerFrom","containerMouseDown","shiftKey","containerTo","mouseOverElement","elementFromPoint","updateSelection","containerMouseMove","containerMouseUp","dragSelection","targetName","newSelection","toggleSelection","threadingPosition","treadleOrderPosition","warpColorsPosition","weftColorsPosition","weavePosition","hasLength","selections","bottom","dir","selectionItem","stepsContainerHeight","stepsContainerWidth","guideContainer","stepCount","steps","containerPos","transform","step","log10","dialogElement","infobarContainer","canvasContainer","canvasWidth","canvasHeight","hasChangedCellSize","cellSizeInput","scrollPercentage","infobarHeight","toolbarHeight","scrollbarWidth","scrollbarHeight","getBounds","scrollWidth","clientWidth","scrollHeight","getPosition","scrollLeftMax","scrollTopMax","scrollLeft","scrollTop","changeCellSize","newCellSize","oldCellSize","scrollTo","startScale","deltaY","touches","targetTouches","t0","t1","p0","vec2.fromValues","p1","vec2.length","newScale","ssrDefault","navigator","language","languages","queryParams","location","search","lang","app"],"mappings":"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"}