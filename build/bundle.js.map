{"version":3,"file":"bundle.js","sources":["../../node_modules/tinycolor2/tinycolor.js","../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte-navigator/src/utils.js","../../node_modules/svelte/store/index.mjs","../../node_modules/svelte-navigator/src/contexts.js","../../node_modules/svelte-navigator/src/paths.js","../../node_modules/svelte-navigator/src/warning.js","../../node_modules/svelte-navigator/src/routes.js","../../node_modules/svelte-navigator/src/history.js","../../node_modules/svelte-navigator/src/a11y.js","../../node_modules/svelte-navigator/src/Router.svelte","../../node_modules/svelte-navigator/src/hooks.js","../../node_modules/svelte-navigator/src/Route.svelte","../../node_modules/svelte-navigator/src/actions.js","../../node_modules/immutable/dist/immutable.es.js","../../src/stores/UI.js","../../src/components/Grid/Grid.svelte","../../src/stores/Draft.js","../../src/util/DraftUtil.js","../../src/components/Sidebar/pages/WeaveSettings.svelte","../../src/components/WeaveDisplay/gfx/VertexArray.js","../../src/components/WeaveDisplay/gfx/shader/Shader.js","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/gl-matrix/esm/quat.js","../../node_modules/gl-matrix/esm/mat3.js","../../node_modules/gl-matrix/esm/vec2.js","../../src/components/ColorPicker/ColorPicker.svelte","../../src/components/ColorPicker/Ring.js","../../src/components/WeaveDisplay/gfx/geometry/Geometry.js","../../src/components/ColorPicker/util.js","../../src/components/Sidebar/pages/YarnSettings.svelte","../../src/util/MathUtil.js","../../src/components/Sidebar/pages/PatternFill.svelte","../../src/components/Sidebar/Sidebar.svelte","../../src/components/WeaveDisplay/gfx/shader/index.js","../../src/components/WeaveDisplay/gfx/Texture.js","../../src/components/WeaveDisplay/gfx/renderers/RendererEventTarget.js","../../src/components/WeaveDisplay/gfx/renderers/TieupRenderer.js","../../src/components/WeaveDisplay/gfx/renderers/GridRenderer.js","../../src/components/WeaveDisplay/gfx/renderers/WeaveRenderer.js","../../src/components/WeaveDisplay/gfx/renderers/ColorRowRenderer.js","../../src/components/WeaveDisplay/gfx/TextureUtil.js","../../src/components/WeaveDisplay/gfx/Renderer.js","../../src/components/ScrollPane/ScrollPane.svelte","../../src/components/WeaveDisplay/WeaveDisplay.svelte","../../src/components/YarnSelector/YarnSelector.svelte","../../src/pages/Editor.svelte","../../src/pages/Help.svelte","../../src/App.svelte","../../src/main.js"],"sourcesContent":["// TinyColor v1.4.2\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\n(function(Math) {\n\nvar trimLeft = /^\\s+/,\n    trimRight = /\\s+$/,\n    tinyCounter = 0,\n    mathRound = Math.round,\n    mathMin = Math.min,\n    mathMax = Math.max,\n    mathRandom = Math.random;\n\nfunction tinycolor (color, opts) {\n\n    color = (color) ? color : '';\n    opts = opts || { };\n\n    // If input is already a tinycolor, return itself\n    if (color instanceof tinycolor) {\n       return color;\n    }\n    // If we are called as a function, call using new instead\n    if (!(this instanceof tinycolor)) {\n        return new tinycolor(color, opts);\n    }\n\n    var rgb = inputToRGB(color);\n    this._originalInput = color,\n    this._r = rgb.r,\n    this._g = rgb.g,\n    this._b = rgb.b,\n    this._a = rgb.a,\n    this._roundA = mathRound(100*this._a) / 100,\n    this._format = opts.format || rgb.format;\n    this._gradientType = opts.gradientType;\n\n    // Don't let the range of [0,255] come back in [0,1].\n    // Potentially lose a little bit of precision here, but will fix issues where\n    // .5 gets interpreted as half of the total, instead of half of 1\n    // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n    if (this._r < 1) { this._r = mathRound(this._r); }\n    if (this._g < 1) { this._g = mathRound(this._g); }\n    if (this._b < 1) { this._b = mathRound(this._b); }\n\n    this._ok = rgb.ok;\n    this._tc_id = tinyCounter++;\n}\n\ntinycolor.prototype = {\n    isDark: function() {\n        return this.getBrightness() < 128;\n    },\n    isLight: function() {\n        return !this.isDark();\n    },\n    isValid: function() {\n        return this._ok;\n    },\n    getOriginalInput: function() {\n      return this._originalInput;\n    },\n    getFormat: function() {\n        return this._format;\n    },\n    getAlpha: function() {\n        return this._a;\n    },\n    getBrightness: function() {\n        //http://www.w3.org/TR/AERT#color-contrast\n        var rgb = this.toRgb();\n        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n    },\n    getLuminance: function() {\n        //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        var rgb = this.toRgb();\n        var RsRGB, GsRGB, BsRGB, R, G, B;\n        RsRGB = rgb.r/255;\n        GsRGB = rgb.g/255;\n        BsRGB = rgb.b/255;\n\n        if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}\n        if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}\n        if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}\n        return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);\n    },\n    setAlpha: function(value) {\n        this._a = boundAlpha(value);\n        this._roundA = mathRound(100*this._a) / 100;\n        return this;\n    },\n    toHsv: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\n    },\n    toHsvString: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\n        return (this._a == 1) ?\n          \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\n          \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\n    },\n    toHsl: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\n    },\n    toHslString: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\n        return (this._a == 1) ?\n          \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\n          \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\n    },\n    toHex: function(allow3Char) {\n        return rgbToHex(this._r, this._g, this._b, allow3Char);\n    },\n    toHexString: function(allow3Char) {\n        return '#' + this.toHex(allow3Char);\n    },\n    toHex8: function(allow4Char) {\n        return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n    },\n    toHex8String: function(allow4Char) {\n        return '#' + this.toHex8(allow4Char);\n    },\n    toRgb: function() {\n        return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\n    },\n    toRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\n          \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\n    },\n    toPercentageRgb: function() {\n        return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\n    },\n    toPercentageRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\n          \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n    },\n    toName: function() {\n        if (this._a === 0) {\n            return \"transparent\";\n        }\n\n        if (this._a < 1) {\n            return false;\n        }\n\n        return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n    },\n    toFilter: function(secondColor) {\n        var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n        var secondHex8String = hex8String;\n        var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n\n        if (secondColor) {\n            var s = tinycolor(secondColor);\n            secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n        }\n\n        return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\n    },\n    toString: function(format) {\n        var formatSet = !!format;\n        format = format || this._format;\n\n        var formattedString = false;\n        var hasAlpha = this._a < 1 && this._a >= 0;\n        var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n\n        if (needsAlphaFormat) {\n            // Special case for \"transparent\", all other non-alpha formats\n            // will return rgba when there is transparency.\n            if (format === \"name\" && this._a === 0) {\n                return this.toName();\n            }\n            return this.toRgbString();\n        }\n        if (format === \"rgb\") {\n            formattedString = this.toRgbString();\n        }\n        if (format === \"prgb\") {\n            formattedString = this.toPercentageRgbString();\n        }\n        if (format === \"hex\" || format === \"hex6\") {\n            formattedString = this.toHexString();\n        }\n        if (format === \"hex3\") {\n            formattedString = this.toHexString(true);\n        }\n        if (format === \"hex4\") {\n            formattedString = this.toHex8String(true);\n        }\n        if (format === \"hex8\") {\n            formattedString = this.toHex8String();\n        }\n        if (format === \"name\") {\n            formattedString = this.toName();\n        }\n        if (format === \"hsl\") {\n            formattedString = this.toHslString();\n        }\n        if (format === \"hsv\") {\n            formattedString = this.toHsvString();\n        }\n\n        return formattedString || this.toHexString();\n    },\n    clone: function() {\n        return tinycolor(this.toString());\n    },\n\n    _applyModification: function(fn, args) {\n        var color = fn.apply(null, [this].concat([].slice.call(args)));\n        this._r = color._r;\n        this._g = color._g;\n        this._b = color._b;\n        this.setAlpha(color._a);\n        return this;\n    },\n    lighten: function() {\n        return this._applyModification(lighten, arguments);\n    },\n    brighten: function() {\n        return this._applyModification(brighten, arguments);\n    },\n    darken: function() {\n        return this._applyModification(darken, arguments);\n    },\n    desaturate: function() {\n        return this._applyModification(desaturate, arguments);\n    },\n    saturate: function() {\n        return this._applyModification(saturate, arguments);\n    },\n    greyscale: function() {\n        return this._applyModification(greyscale, arguments);\n    },\n    spin: function() {\n        return this._applyModification(spin, arguments);\n    },\n\n    _applyCombination: function(fn, args) {\n        return fn.apply(null, [this].concat([].slice.call(args)));\n    },\n    analogous: function() {\n        return this._applyCombination(analogous, arguments);\n    },\n    complement: function() {\n        return this._applyCombination(complement, arguments);\n    },\n    monochromatic: function() {\n        return this._applyCombination(monochromatic, arguments);\n    },\n    splitcomplement: function() {\n        return this._applyCombination(splitcomplement, arguments);\n    },\n    triad: function() {\n        return this._applyCombination(triad, arguments);\n    },\n    tetrad: function() {\n        return this._applyCombination(tetrad, arguments);\n    }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function(color, opts) {\n    if (typeof color == \"object\") {\n        var newColor = {};\n        for (var i in color) {\n            if (color.hasOwnProperty(i)) {\n                if (i === \"a\") {\n                    newColor[i] = color[i];\n                }\n                else {\n                    newColor[i] = convertToPercentage(color[i]);\n                }\n            }\n        }\n        color = newColor;\n    }\n\n    return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n\n    var rgb = { r: 0, g: 0, b: 0 };\n    var a = 1;\n    var s = null;\n    var v = null;\n    var l = null;\n    var ok = false;\n    var format = false;\n\n    if (typeof color == \"string\") {\n        color = stringInputToObject(color);\n    }\n\n    if (typeof color == \"object\") {\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n            rgb = rgbToRgb(color.r, color.g, color.b);\n            ok = true;\n            format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n            s = convertToPercentage(color.s);\n            v = convertToPercentage(color.v);\n            rgb = hsvToRgb(color.h, s, v);\n            ok = true;\n            format = \"hsv\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n            s = convertToPercentage(color.s);\n            l = convertToPercentage(color.l);\n            rgb = hslToRgb(color.h, s, l);\n            ok = true;\n            format = \"hsl\";\n        }\n\n        if (color.hasOwnProperty(\"a\")) {\n            a = color.a;\n        }\n    }\n\n    a = boundAlpha(a);\n\n    return {\n        ok: ok,\n        format: color.format || format,\n        r: mathMin(255, mathMax(rgb.r, 0)),\n        g: mathMin(255, mathMax(rgb.g, 0)),\n        b: mathMin(255, mathMax(rgb.b, 0)),\n        a: a\n    };\n}\n\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b){\n    return {\n        r: bound01(r, 255) * 255,\n        g: bound01(g, 255) * 255,\n        b: bound01(b, 255) * 255\n    };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if(max == min) {\n        h = s = 0; // achromatic\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n\n        h /= 6;\n    }\n\n    return { h: h, s: s, l: l };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n    var r, g, b;\n\n    h = bound01(h, 360);\n    s = bound01(s, 100);\n    l = bound01(l, 100);\n\n    function hue2rgb(p, q, t) {\n        if(t < 0) t += 1;\n        if(t > 1) t -= 1;\n        if(t < 1/6) return p + (q - p) * 6 * t;\n        if(t < 1/2) return q;\n        if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n        return p;\n    }\n\n    if(s === 0) {\n        r = g = b = l; // achromatic\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1/3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1/3);\n    }\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, v = max;\n\n    var d = max - min;\n    s = max === 0 ? 0 : d / max;\n\n    if(max == min) {\n        h = 0; // achromatic\n    }\n    else {\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, v: v };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\n function hsvToRgb(h, s, v) {\n\n    h = bound01(h, 360) * 6;\n    s = bound01(s, 100);\n    v = bound01(v, 100);\n\n    var i = Math.floor(h),\n        f = h - i,\n        p = v * (1 - s),\n        q = v * (1 - f * s),\n        t = v * (1 - (1 - f) * s),\n        mod = i % 6,\n        r = [v, q, p, p, t, v][mod],\n        g = [t, v, v, q, p, p][mod],\n        b = [p, p, t, v, v, q][mod];\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    // Return a 3 character hex if possible\n    if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16)),\n        pad2(convertDecimalToHex(a))\n    ];\n\n    // Return a 4 character hex if possible\n    if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n\n    var hex = [\n        pad2(convertDecimalToHex(a)),\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n    if (!color1 || !color2) { return false; }\n    return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\n\ntinycolor.random = function() {\n    return tinycolor.fromRatio({\n        r: mathRandom(),\n        g: mathRandom(),\n        b: mathRandom()\n    });\n};\n\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction desaturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s -= amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction saturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s += amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction greyscale(color) {\n    return tinycolor(color).desaturate(100);\n}\n\nfunction lighten (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l += amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\nfunction brighten(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var rgb = tinycolor(color).toRgb();\n    rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\n    rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\n    rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\n    return tinycolor(rgb);\n}\n\nfunction darken (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l -= amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction spin(color, amount) {\n    var hsl = tinycolor(color).toHsl();\n    var hue = (hsl.h + amount) % 360;\n    hsl.h = hue < 0 ? 360 + hue : hue;\n    return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction complement(color) {\n    var hsl = tinycolor(color).toHsl();\n    hsl.h = (hsl.h + 180) % 360;\n    return tinycolor(hsl);\n}\n\nfunction triad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction tetrad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction splitcomplement(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\n        tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\n    ];\n}\n\nfunction analogous(color, results, slices) {\n    results = results || 6;\n    slices = slices || 30;\n\n    var hsl = tinycolor(color).toHsl();\n    var part = 360 / slices;\n    var ret = [tinycolor(color)];\n\n    for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\n        hsl.h = (hsl.h + part) % 360;\n        ret.push(tinycolor(hsl));\n    }\n    return ret;\n}\n\nfunction monochromatic(color, results) {\n    results = results || 6;\n    var hsv = tinycolor(color).toHsv();\n    var h = hsv.h, s = hsv.s, v = hsv.v;\n    var ret = [];\n    var modification = 1 / results;\n\n    while (results--) {\n        ret.push(tinycolor({ h: h, s: s, v: v}));\n        v = (v + modification) % 1;\n    }\n\n    return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function(color1, color2, amount) {\n    amount = (amount === 0) ? 0 : (amount || 50);\n\n    var rgb1 = tinycolor(color1).toRgb();\n    var rgb2 = tinycolor(color2).toRgb();\n\n    var p = amount / 100;\n\n    var rgba = {\n        r: ((rgb2.r - rgb1.r) * p) + rgb1.r,\n        g: ((rgb2.g - rgb1.g) * p) + rgb1.g,\n        b: ((rgb2.b - rgb1.b) * p) + rgb1.b,\n        a: ((rgb2.a - rgb1.a) * p) + rgb1.a\n    };\n\n    return tinycolor(rgba);\n};\n\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function(color1, color2) {\n    var c1 = tinycolor(color1);\n    var c2 = tinycolor(color2);\n    return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function(color1, color2, wcag2) {\n    var readability = tinycolor.readability(color1, color2);\n    var wcag2Parms, out;\n\n    out = false;\n\n    wcag2Parms = validateWCAG2Parms(wcag2);\n    switch (wcag2Parms.level + wcag2Parms.size) {\n        case \"AAsmall\":\n        case \"AAAlarge\":\n            out = readability >= 4.5;\n            break;\n        case \"AAlarge\":\n            out = readability >= 3;\n            break;\n        case \"AAAsmall\":\n            out = readability >= 7;\n            break;\n    }\n    return out;\n\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function(baseColor, colorList, args) {\n    var bestColor = null;\n    var bestScore = 0;\n    var readability;\n    var includeFallbackColors, level, size ;\n    args = args || {};\n    includeFallbackColors = args.includeFallbackColors ;\n    level = args.level;\n    size = args.size;\n\n    for (var i= 0; i < colorList.length ; i++) {\n        readability = tinycolor.readability(baseColor, colorList[i]);\n        if (readability > bestScore) {\n            bestScore = readability;\n            bestColor = tinycolor(colorList[i]);\n        }\n    }\n\n    if (tinycolor.isReadable(baseColor, bestColor, {\"level\":level,\"size\":size}) || !includeFallbackColors) {\n        return bestColor;\n    }\n    else {\n        args.includeFallbackColors=false;\n        return tinycolor.mostReadable(baseColor,[\"#fff\", \"#000\"],args);\n    }\n};\n\n\n// Big List of Colors\n// ------------------\n// <http://www.w3.org/TR/css3-color/#svg-color>\nvar names = tinycolor.names = {\n    aliceblue: \"f0f8ff\",\n    antiquewhite: \"faebd7\",\n    aqua: \"0ff\",\n    aquamarine: \"7fffd4\",\n    azure: \"f0ffff\",\n    beige: \"f5f5dc\",\n    bisque: \"ffe4c4\",\n    black: \"000\",\n    blanchedalmond: \"ffebcd\",\n    blue: \"00f\",\n    blueviolet: \"8a2be2\",\n    brown: \"a52a2a\",\n    burlywood: \"deb887\",\n    burntsienna: \"ea7e5d\",\n    cadetblue: \"5f9ea0\",\n    chartreuse: \"7fff00\",\n    chocolate: \"d2691e\",\n    coral: \"ff7f50\",\n    cornflowerblue: \"6495ed\",\n    cornsilk: \"fff8dc\",\n    crimson: \"dc143c\",\n    cyan: \"0ff\",\n    darkblue: \"00008b\",\n    darkcyan: \"008b8b\",\n    darkgoldenrod: \"b8860b\",\n    darkgray: \"a9a9a9\",\n    darkgreen: \"006400\",\n    darkgrey: \"a9a9a9\",\n    darkkhaki: \"bdb76b\",\n    darkmagenta: \"8b008b\",\n    darkolivegreen: \"556b2f\",\n    darkorange: \"ff8c00\",\n    darkorchid: \"9932cc\",\n    darkred: \"8b0000\",\n    darksalmon: \"e9967a\",\n    darkseagreen: \"8fbc8f\",\n    darkslateblue: \"483d8b\",\n    darkslategray: \"2f4f4f\",\n    darkslategrey: \"2f4f4f\",\n    darkturquoise: \"00ced1\",\n    darkviolet: \"9400d3\",\n    deeppink: \"ff1493\",\n    deepskyblue: \"00bfff\",\n    dimgray: \"696969\",\n    dimgrey: \"696969\",\n    dodgerblue: \"1e90ff\",\n    firebrick: \"b22222\",\n    floralwhite: \"fffaf0\",\n    forestgreen: \"228b22\",\n    fuchsia: \"f0f\",\n    gainsboro: \"dcdcdc\",\n    ghostwhite: \"f8f8ff\",\n    gold: \"ffd700\",\n    goldenrod: \"daa520\",\n    gray: \"808080\",\n    green: \"008000\",\n    greenyellow: \"adff2f\",\n    grey: \"808080\",\n    honeydew: \"f0fff0\",\n    hotpink: \"ff69b4\",\n    indianred: \"cd5c5c\",\n    indigo: \"4b0082\",\n    ivory: \"fffff0\",\n    khaki: \"f0e68c\",\n    lavender: \"e6e6fa\",\n    lavenderblush: \"fff0f5\",\n    lawngreen: \"7cfc00\",\n    lemonchiffon: \"fffacd\",\n    lightblue: \"add8e6\",\n    lightcoral: \"f08080\",\n    lightcyan: \"e0ffff\",\n    lightgoldenrodyellow: \"fafad2\",\n    lightgray: \"d3d3d3\",\n    lightgreen: \"90ee90\",\n    lightgrey: \"d3d3d3\",\n    lightpink: \"ffb6c1\",\n    lightsalmon: \"ffa07a\",\n    lightseagreen: \"20b2aa\",\n    lightskyblue: \"87cefa\",\n    lightslategray: \"789\",\n    lightslategrey: \"789\",\n    lightsteelblue: \"b0c4de\",\n    lightyellow: \"ffffe0\",\n    lime: \"0f0\",\n    limegreen: \"32cd32\",\n    linen: \"faf0e6\",\n    magenta: \"f0f\",\n    maroon: \"800000\",\n    mediumaquamarine: \"66cdaa\",\n    mediumblue: \"0000cd\",\n    mediumorchid: \"ba55d3\",\n    mediumpurple: \"9370db\",\n    mediumseagreen: \"3cb371\",\n    mediumslateblue: \"7b68ee\",\n    mediumspringgreen: \"00fa9a\",\n    mediumturquoise: \"48d1cc\",\n    mediumvioletred: \"c71585\",\n    midnightblue: \"191970\",\n    mintcream: \"f5fffa\",\n    mistyrose: \"ffe4e1\",\n    moccasin: \"ffe4b5\",\n    navajowhite: \"ffdead\",\n    navy: \"000080\",\n    oldlace: \"fdf5e6\",\n    olive: \"808000\",\n    olivedrab: \"6b8e23\",\n    orange: \"ffa500\",\n    orangered: \"ff4500\",\n    orchid: \"da70d6\",\n    palegoldenrod: \"eee8aa\",\n    palegreen: \"98fb98\",\n    paleturquoise: \"afeeee\",\n    palevioletred: \"db7093\",\n    papayawhip: \"ffefd5\",\n    peachpuff: \"ffdab9\",\n    peru: \"cd853f\",\n    pink: \"ffc0cb\",\n    plum: \"dda0dd\",\n    powderblue: \"b0e0e6\",\n    purple: \"800080\",\n    rebeccapurple: \"663399\",\n    red: \"f00\",\n    rosybrown: \"bc8f8f\",\n    royalblue: \"4169e1\",\n    saddlebrown: \"8b4513\",\n    salmon: \"fa8072\",\n    sandybrown: \"f4a460\",\n    seagreen: \"2e8b57\",\n    seashell: \"fff5ee\",\n    sienna: \"a0522d\",\n    silver: \"c0c0c0\",\n    skyblue: \"87ceeb\",\n    slateblue: \"6a5acd\",\n    slategray: \"708090\",\n    slategrey: \"708090\",\n    snow: \"fffafa\",\n    springgreen: \"00ff7f\",\n    steelblue: \"4682b4\",\n    tan: \"d2b48c\",\n    teal: \"008080\",\n    thistle: \"d8bfd8\",\n    tomato: \"ff6347\",\n    turquoise: \"40e0d0\",\n    violet: \"ee82ee\",\n    wheat: \"f5deb3\",\n    white: \"fff\",\n    whitesmoke: \"f5f5f5\",\n    yellow: \"ff0\",\n    yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n    var flipped = { };\n    for (var i in o) {\n        if (o.hasOwnProperty(i)) {\n            flipped[o[i]] = i;\n        }\n    }\n    return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n    a = parseFloat(a);\n\n    if (isNaN(a) || a < 0 || a > 1) {\n        a = 1;\n    }\n\n    return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n    if (isOnePointZero(n)) { n = \"100%\"; }\n\n    var processPercent = isPercentage(n);\n    n = mathMin(max, mathMax(0, parseFloat(n)));\n\n    // Automatically convert percentage into number\n    if (processPercent) {\n        n = parseInt(n * max, 10) / 100;\n    }\n\n    // Handle floating point rounding errors\n    if ((Math.abs(n - max) < 0.000001)) {\n        return 1;\n    }\n\n    // Convert into [0, 1] range if it isn't already\n    return (n % max) / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n    return mathMin(1, mathMax(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n    return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n    return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n    return typeof n === \"string\" && n.indexOf('%') != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n    return c.length == 1 ? '0' + c : '' + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n    if (n <= 1) {\n        n = (n * 100) + \"%\";\n    }\n\n    return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n    return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n    return (parseIntFromHex(h) / 255);\n}\n\nvar matchers = (function() {\n\n    // <http://www.w3.org/TR/css3-values/#integers>\n    var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n    // <http://www.w3.org/TR/css3-values/#number-value>\n    var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n    // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n    var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n    // Actual matching.\n    // Parentheses and commas are optional, but not required.\n    // Whitespace can take the place of commas or opening paren\n    var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n    var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n\n    return {\n        CSS_UNIT: new RegExp(CSS_UNIT),\n        rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n        rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n        hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n        hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n        hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n        hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n    };\n})();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n    return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n\n    color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\n    var named = false;\n    if (names[color]) {\n        color = names[color];\n        named = true;\n    }\n    else if (color == 'transparent') {\n        return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\n    }\n\n    // Try to match string input using regular expressions.\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n    // Just return an object and let the conversion functions handle that.\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\n    var match;\n    if ((match = matchers.rgb.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3] };\n    }\n    if ((match = matchers.rgba.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsl.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3] };\n    }\n    if ((match = matchers.hsla.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsv.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3] };\n    }\n    if ((match = matchers.hsva.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\n    }\n    if ((match = matchers.hex8.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            a: convertHexToDecimal(match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex6.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n    if ((match = matchers.hex4.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            a: convertHexToDecimal(match[4] + '' + match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex3.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n\n    return false;\n}\n\nfunction validateWCAG2Parms(parms) {\n    // return valid WCAG2 parms for isReadable.\n    // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n    var level, size;\n    parms = parms || {\"level\":\"AA\", \"size\":\"small\"};\n    level = (parms.level || \"AA\").toUpperCase();\n    size = (parms.size || \"small\").toLowerCase();\n    if (level !== \"AA\" && level !== \"AAA\") {\n        level = \"AA\";\n    }\n    if (size !== \"small\" && size !== \"large\") {\n        size = \"small\";\n    }\n    return {\"level\":level, \"size\":size};\n}\n\n// Node: Export function\nif (typeof module !== \"undefined\" && module.exports) {\n    module.exports = tinycolor;\n}\n// AMD/requirejs: Define the module\nelse if (typeof define === 'function' && define.amd) {\n    define(function () {return tinycolor;});\n}\n// Browser: Expose to window\nelse {\n    window.tinycolor = tinycolor;\n}\n\n})(Math);\n","function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot_spread(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_spread_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_spread_changes_fn(dirty) | get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.31.2' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to seperate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_custom_elements_slots, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, update_slot_spread, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","/*\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/utils.js\n *\n * https://github.com/reach/router/blob/master/LICENSE\n */\n\nexport const isUndefined = value => typeof value === \"undefined\";\n\nexport const isFunction = value => typeof value === \"function\";\n\nexport const isNumber = value => typeof value === \"number\";\n\n/**\n * Decides whether a given `event` should result in a navigation or not.\n * @param {object} event\n */\nexport function shouldNavigate(event) {\n\treturn (\n\t\t!event.defaultPrevented &&\n\t\tevent.button === 0 &&\n\t\t!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey)\n\t);\n}\n\nexport function createCounter() {\n\tlet i = 0;\n\t/**\n\t * Returns an id and increments the internal state\n\t * @returns {number}\n\t */\n\treturn () => i++;\n}\n\n/**\n * Create a globally unique id\n *\n * @returns {string} An id\n */\nexport function createGlobalId() {\n\treturn Math.random().toString(36).substring(2);\n}\n\nexport function findClosest(tagName, element) {\n\twhile (element && element.tagName !== tagName) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\telement = element.parentNode;\n\t}\n\treturn element;\n}\n\nexport const isSSR = typeof window === \"undefined\";\n\nexport function addListener(target, type, handler) {\n\ttarget.addEventListener(type, handler);\n\treturn () => target.removeEventListener(type, handler);\n}\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","/*\n * Adapted from https://github.com/EmilTholin/svelte-routing\n *\n * https://github.com/EmilTholin/svelte-routing/blob/master/LICENSE\n */\n\nconst createKey = ctxName => `@@svnav-ctx__${ctxName}`;\n\n// Use strings instead of objects, so different versions of\n// svelte-navigator can potentially still work together\nexport const LOCATION = createKey(\"LOCATION\");\nexport const ROUTER = createKey(\"ROUTER\");\nexport const ROUTE = createKey(\"ROUTE\");\nexport const ROUTE_PARAMS = createKey(\"ROUTE_PARAMS\");\nexport const FOCUS_ELEM = createKey(\"FOCUS_ELEM\");\n","export const paramRegex = /^:(.+)/;\n\n/**\n * Check if `string` starts with `search`\n * @param {string} string\n * @param {string} search\n * @return {boolean}\n */\nexport const startsWith = (string, search) =>\n\tstring.substr(0, search.length) === search;\n\n/**\n * Check if `segment` is a root segment\n * @param {string} segment\n * @return {boolean}\n */\nexport const isRootSegment = segment => segment === \"\";\n\n/**\n * Check if `segment` is a dynamic segment\n * @param {string} segment\n * @return {boolean}\n */\nexport const isDynamic = segment => paramRegex.test(segment);\n\n/**\n * Check if `segment` is a splat\n * @param {string} segment\n * @return {boolean}\n */\nexport const isSplat = segment => segment[0] === \"*\";\n\n/**\n * Strip potention splat and splatname of the end of a path\n * @param {string} str\n * @return {string}\n */\nexport const stripSplat = str => str.replace(/\\*.*$/, \"\");\n\n/**\n * Strip `str` of potential start and end `/`\n * @param {string} str\n * @return {string}\n */\nexport const stripSlashes = str => str.replace(/(^\\/+|\\/+$)/g, \"\");\n\n/**\n * Split up the URI into segments delimited by `/`\n * @param {string} uri\n * @return {string[]}\n */\nexport function segmentize(uri, filterFalsy = false) {\n\tconst segments = stripSlashes(uri).split(\"/\");\n\treturn filterFalsy ? segments.filter(Boolean) : segments;\n}\n\n/**\n * Add the query to the pathname if a query is given\n * @param {string} pathname\n * @param {string} [query]\n * @return {string}\n */\nexport const addQuery = (pathname, query) =>\n\tpathname + (query ? `?${query}` : \"\");\n\n/**\n * Combines the `basepath` and the `path` into one path.\n * @param {string} basepath\n * @param {string} path\n */\nexport function combinePaths(basepath, path) {\n\tconst barePath =\n\t\tpath === \"/\" ? basepath : `${stripSlashes(basepath)}/${stripSlashes(path)}`;\n\treturn `${stripSlashes(barePath)}/`;\n}\n\n/**\n * Normalizes a basepath\n *\n * @param {string} path\n * @returns {string}\n *\n * @example\n * normalizePath(\"base/path/\") // -> \"/base/path\"\n */\nexport const normalizePath = path => `/${stripSlashes(path)}`;\n\n/**\n * Joins and normalizes multiple path fragments\n *\n * @param {...string} pathFragments\n * @returns {string}\n */\nexport function join(...pathFragments) {\n\tconst joinFragment = fragment => segmentize(fragment, true).join(\"/\");\n\tconst joinedSegments = pathFragments.map(joinFragment).join(\"/\");\n\treturn normalizePath(joinedSegments);\n}\n","import { isFunction } from \"./utils\";\n\n// We start from 1 here, so we can check if an origin id has been passed\n// by using `originId || <fallback>`\nexport const LINK_ID = 1;\nexport const ROUTE_ID = 2;\nexport const ROUTER_ID = 3;\nexport const USE_FOCUS_ID = 4;\nexport const USE_LOCATION_ID = 5;\nexport const USE_MATCH_ID = 6;\nexport const USE_NAVIGATE_ID = 7;\nexport const USE_PARAMS_ID = 8;\nexport const USE_RESOLVABLE_ID = 9;\nexport const USE_RESOLVE_ID = 10;\nexport const NAVIGATE_ID = 11;\n\nconst labels = {\n\t[LINK_ID]: \"Link\",\n\t[ROUTE_ID]: \"Route\",\n\t[ROUTER_ID]: \"Router\",\n\t[USE_FOCUS_ID]: \"useFocus\",\n\t[USE_LOCATION_ID]: \"useLocation\",\n\t[USE_MATCH_ID]: \"useMatch\",\n\t[USE_NAVIGATE_ID]: \"useNavigate\",\n\t[USE_PARAMS_ID]: \"useParams\",\n\t[USE_RESOLVABLE_ID]: \"useResolvable\",\n\t[USE_RESOLVE_ID]: \"useResolve\",\n\t[NAVIGATE_ID]: \"navigate\",\n};\n\nexport const createLabel = labelId => labels[labelId];\n\nexport function createIdentifier(labelId, props) {\n\tlet attr;\n\tif (labelId === ROUTE_ID) {\n\t\tattr = props.path ? `path=\"${props.path}\"` : \"default\";\n\t} else if (labelId === LINK_ID) {\n\t\tattr = `to=\"${props.to}\"`;\n\t} else if (labelId === ROUTER_ID) {\n\t\tattr = `basepath=\"${props.basepath || \"\"}\"`;\n\t}\n\treturn `<${createLabel(labelId)} ${attr || \"\"} />`;\n}\n\nexport function createMessage(labelId, message, props, originId) {\n\tconst origin = props && createIdentifier(originId || labelId, props);\n\tconst originMsg = origin ? `\\n\\nOccurred in: ${origin}` : \"\";\n\tconst label = createLabel(labelId);\n\tconst msg = isFunction(message) ? message(label) : message;\n\treturn `<${label}> ${msg}${originMsg}`;\n}\n\nexport const createMessageHandler = handler => (...args) =>\n\thandler(createMessage(...args));\n\nexport const fail = createMessageHandler(message => {\n\tthrow new Error(message);\n});\n\n// eslint-disable-next-line no-console\nexport const warn = createMessageHandler(console.warn);\n","import {\n\tsegmentize,\n\tjoin,\n\taddQuery,\n\tstartsWith,\n\tparamRegex,\n\tisSplat,\n\tisRootSegment,\n\tisDynamic,\n\tstripSplat,\n\tnormalizePath,\n} from \"./paths\";\nimport { ROUTER_ID, fail } from \"./warning\";\nimport { isUndefined } from \"./utils\";\n\nconst SEGMENT_POINTS = 4;\nconst STATIC_POINTS = 3;\nconst DYNAMIC_POINTS = 2;\nconst SPLAT_PENALTY = 1;\nconst ROOT_POINTS = 1;\n\n/**\n * Score a route depending on how its individual segments look\n * @param {object} route\n * @param {number} index\n * @return {object}\n */\nexport function rankRoute(route, index) {\n\tconst score = route.default\n\t\t? 0\n\t\t: segmentize(route.fullPath).reduce((acc, segment) => {\n\t\t\t\tlet nextScore = acc;\n\t\t\t\tnextScore += SEGMENT_POINTS;\n\n\t\t\t\tif (isRootSegment(segment)) {\n\t\t\t\t\tnextScore += ROOT_POINTS;\n\t\t\t\t} else if (isDynamic(segment)) {\n\t\t\t\t\tnextScore += DYNAMIC_POINTS;\n\t\t\t\t} else if (isSplat(segment)) {\n\t\t\t\t\tnextScore -= SEGMENT_POINTS + SPLAT_PENALTY;\n\t\t\t\t} else {\n\t\t\t\t\tnextScore += STATIC_POINTS;\n\t\t\t\t}\n\n\t\t\t\treturn nextScore;\n\t\t  }, 0);\n\n\treturn { route, score, index };\n}\n\n/**\n * Give a score to all routes and sort them on that\n * @param {object[]} routes\n * @return {object[]}\n */\nexport function rankRoutes(routes) {\n\treturn (\n\t\troutes\n\t\t\t.map(rankRoute)\n\t\t\t// If two routes have the exact same score, we go by index instead\n\t\t\t.sort((a, b) => {\n\t\t\t\tif (a.score < b.score) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a.score > b.score) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn a.index - b.index;\n\t\t\t})\n\t);\n}\n\n/**\n * Ranks and picks the best route to match. Each segment gets the highest\n * amount of points, then the type of segment gets an additional amount of\n * points where\n *\n *  static > dynamic > splat > root\n *\n * This way we don't have to worry about the order of our routes, let the\n * computers do it.\n *\n * A route looks like this\n *\n *  { fullPath, default, value }\n *\n * And a returned match looks like:\n *\n *  { route, params, uri }\n *\n * @param {object[]} routes\n * @param {string} uri\n * @return {?object}\n */\nexport function pick(routes, uri) {\n\tlet bestMatch;\n\tlet defaultMatch;\n\n\tconst [uriPathname] = uri.split(\"?\");\n\tconst uriSegments = segmentize(uriPathname);\n\tconst isRootUri = uriSegments[0] === \"\";\n\tconst ranked = rankRoutes(routes);\n\n\tfor (let i = 0, l = ranked.length; i < l; i++) {\n\t\tconst { route } = ranked[i];\n\t\tlet missed = false;\n\t\tconst params = {};\n\n\t\t// eslint-disable-next-line no-shadow\n\t\tconst createMatch = uri => ({ ...route, params, uri });\n\n\t\tif (route.default) {\n\t\t\tdefaultMatch = createMatch(uri);\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst routeSegments = segmentize(route.fullPath);\n\t\tconst max = Math.max(uriSegments.length, routeSegments.length);\n\t\tlet index = 0;\n\n\t\tfor (; index < max; index++) {\n\t\t\tconst routeSegment = routeSegments[index];\n\t\t\tconst uriSegment = uriSegments[index];\n\n\t\t\tif (!isUndefined(routeSegment) && isSplat(routeSegment)) {\n\t\t\t\t// Hit a splat, just grab the rest, and return a match\n\t\t\t\t// uri:   /files/documents/work\n\t\t\t\t// route: /files/* or /files/*splatname\n\t\t\t\tconst splatName = routeSegment === \"*\" ? \"*\" : routeSegment.slice(1);\n\n\t\t\t\tparams[splatName] = uriSegments\n\t\t\t\t\t.slice(index)\n\t\t\t\t\t.map(decodeURIComponent)\n\t\t\t\t\t.join(\"/\");\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (isUndefined(uriSegment)) {\n\t\t\t\t// URI is shorter than the route, no match\n\t\t\t\t// uri:   /users\n\t\t\t\t// route: /users/:userId\n\t\t\t\tmissed = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst dynamicMatch = paramRegex.exec(routeSegment);\n\n\t\t\tif (dynamicMatch && !isRootUri) {\n\t\t\t\tconst value = decodeURIComponent(uriSegment);\n\t\t\t\tparams[dynamicMatch[1]] = value;\n\t\t\t} else if (routeSegment !== uriSegment) {\n\t\t\t\t// Current segments don't match, not dynamic, not splat, so no match\n\t\t\t\t// uri:   /users/123/settings\n\t\t\t\t// route: /users/:id/profile\n\t\t\t\tmissed = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!missed) {\n\t\t\tbestMatch = createMatch(join(...uriSegments.slice(0, index)));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn bestMatch || defaultMatch || null;\n}\n\n/**\n * Check if the `route.fullPath` matches the `uri`.\n * @param {Object} route\n * @param {string} uri\n * @return {?object}\n */\nexport function match(route, uri) {\n\treturn pick([route], uri);\n}\n\n/**\n * Resolve URIs as though every path is a directory, no files. Relative URIs\n * in the browser can feel awkward because not only can you be \"in a directory\",\n * you can be \"at a file\", too. For example:\n *\n *  browserSpecResolve('foo', '/bar/') => /bar/foo\n *  browserSpecResolve('foo', '/bar') => /foo\n *\n * But on the command line of a file system, it's not as complicated. You can't\n * `cd` from a file, only directories. This way, links have to know less about\n * their current path. To go deeper you can do this:\n *\n *  <Link to=\"deeper\"/>\n *  // instead of\n *  <Link to=`{${props.uri}/deeper}`/>\n *\n * Just like `cd`, if you want to go deeper from the command line, you do this:\n *\n *  cd deeper\n *  # not\n *  cd $(pwd)/deeper\n *\n * By treating every path as a directory, linking to relative paths should\n * require less contextual information and (fingers crossed) be more intuitive.\n * @param {string} to\n * @param {string} base\n * @return {string}\n */\nexport function resolve(to, base) {\n\t// /foo/bar, /baz/qux => /foo/bar\n\tif (startsWith(to, \"/\")) {\n\t\treturn to;\n\t}\n\n\tconst [toPathname, toQuery] = to.split(\"?\");\n\tconst [basePathname] = base.split(\"?\");\n\tconst toSegments = segmentize(toPathname);\n\tconst baseSegments = segmentize(basePathname);\n\n\t// ?a=b, /users?b=c => /users?a=b\n\tif (toSegments[0] === \"\") {\n\t\treturn addQuery(basePathname, toQuery);\n\t}\n\n\t// profile, /users/789 => /users/789/profile\n\tif (!startsWith(toSegments[0], \".\")) {\n\t\tconst pathname = baseSegments.concat(toSegments).join(\"/\");\n\t\treturn addQuery((basePathname === \"/\" ? \"\" : \"/\") + pathname, toQuery);\n\t}\n\n\t// ./       , /users/123 => /users/123\n\t// ../      , /users/123 => /users\n\t// ../..    , /users/123 => /\n\t// ../../one, /a/b/c/d   => /a/b/one\n\t// .././one , /a/b/c/d   => /a/b/c/one\n\tconst allSegments = baseSegments.concat(toSegments);\n\tconst segments = [];\n\n\tallSegments.forEach(segment => {\n\t\tif (segment === \"..\") {\n\t\t\tsegments.pop();\n\t\t} else if (segment !== \".\") {\n\t\t\tsegments.push(segment);\n\t\t}\n\t});\n\n\treturn addQuery(`/${segments.join(\"/\")}`, toQuery);\n}\n\n/**\n * Normalizes a location for consumption by `Route` children and the `Router`.\n * It removes the apps basepath from the pathname\n * and sets default values for `search` and `hash` properties.\n *\n * @param {Object} location The current global location supplied by the history component\n * @param {string} basepath The applications basepath (i.e. when serving from a subdirectory)\n *\n * @returns The normalized location\n */\nexport function normalizeLocation(location, basepath) {\n\tconst { pathname, hash = \"\", search = \"\", state } = location;\n\tconst baseSegments = segmentize(basepath, true);\n\tconst pathSegments = segmentize(pathname, true);\n\twhile (baseSegments.length) {\n\t\tif (baseSegments[0] !== pathSegments[0]) {\n\t\t\tfail(\n\t\t\t\tROUTER_ID,\n\t\t\t\t`Invalid state: All locations must begin with the basepath \"${basepath}\", found \"${pathname}\"`,\n\t\t\t);\n\t\t}\n\t\tbaseSegments.shift();\n\t\tpathSegments.shift();\n\t}\n\treturn {\n\t\tpathname: join(...pathSegments),\n\t\thash,\n\t\tsearch,\n\t\tstate,\n\t};\n}\n\nconst normalizeUrlFragment = frag => (frag.length === 1 ? \"\" : frag);\n\n/**\n * Creates a location object from an url.\n * It is used to create a location from the url prop used in SSR\n *\n * @param {string} url The url string (e.g. \"/path/to/somewhere\")\n *\n * @returns {{ pathname: string; search: string; hash: string }} The location\n */\nexport function createLocation(url) {\n\tconst searchIndex = url.indexOf(\"?\");\n\tconst hashIndex = url.indexOf(\"#\");\n\tconst hasSearchIndex = searchIndex !== -1;\n\tconst hasHashIndex = hashIndex !== -1;\n\tconst hash = hasHashIndex ? normalizeUrlFragment(url.substr(hashIndex)) : \"\";\n\tconst pathnameAndSearch = hasHashIndex ? url.substr(0, hashIndex) : url;\n\tconst search = hasSearchIndex\n\t\t? normalizeUrlFragment(pathnameAndSearch.substr(searchIndex))\n\t\t: \"\";\n\tconst pathname = hasSearchIndex\n\t\t? pathnameAndSearch.substr(0, searchIndex)\n\t\t: pathnameAndSearch;\n\treturn { pathname, search, hash };\n}\n\n/**\n * Resolves a link relative to the parent Route and the Routers basepath.\n *\n * @param {string} path The given path, that will be resolved\n * @param {string} routeBase The current Routes base path\n * @param {string} appBase The basepath of the app. Used, when serving from a subdirectory\n * @returns {string} The resolved path\n *\n * @example\n * resolveLink(\"relative\", \"/routeBase\", \"/\") // -> \"/routeBase/relative\"\n * resolveLink(\"/absolute\", \"/routeBase\", \"/\") // -> \"/absolute\"\n * resolveLink(\"relative\", \"/routeBase\", \"/base\") // -> \"/base/routeBase/relative\"\n * resolveLink(\"/absolute\", \"/routeBase\", \"/base\") // -> \"/base/absolute\"\n */\nexport function resolveLink(path, routeBase, appBase) {\n\treturn join(appBase, resolve(path, routeBase));\n}\n\n/**\n * Get the uri for a Route, by matching it against the current location.\n *\n * @param {string} routePath The Routes resolved path\n * @param {string} pathname The current locations pathname\n */\nexport function extractBaseUri(routePath, pathname) {\n\tconst fullPath = normalizePath(stripSplat(routePath));\n\tconst baseSegments = segmentize(fullPath, true);\n\tconst pathSegments = segmentize(pathname, true).slice(0, baseSegments.length);\n\tconst routeMatch = match({ fullPath }, join(...pathSegments));\n\treturn routeMatch && routeMatch.uri;\n}\n","/*\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/history.js\n *\n * https://github.com/reach/router/blob/master/LICENSE\n */\n\nimport { createLocation } from \"./routes\";\nimport { createGlobalId, isSSR, isNumber, addListener } from \"./utils\";\nimport { warn, NAVIGATE_ID } from \"./warning\";\n\nconst POP = \"POP\";\nconst PUSH = \"PUSH\";\nconst REPLACE = \"REPLACE\";\n\nfunction getLocation(source) {\n\treturn {\n\t\t...source.location,\n\t\tpathname: encodeURI(decodeURI(source.location.pathname)),\n\t\tstate: source.history.state,\n\t\t_key: (source.history.state && source.history.state._key) || \"initial\",\n\t};\n}\n\nfunction createHistory(source) {\n\tlet listeners = [];\n\tlet location = getLocation(source);\n\tlet action = POP;\n\n\tconst notifyListeners = (listenerFns = listeners) =>\n\t\tlistenerFns.forEach(listener => listener({ location, action }));\n\n\treturn {\n\t\tget location() {\n\t\t\treturn location;\n\t\t},\n\t\tlisten(listener) {\n\t\t\tlisteners.push(listener);\n\n\t\t\tconst popstateListener = () => {\n\t\t\t\tlocation = getLocation(source);\n\t\t\t\taction = POP;\n\t\t\t\tnotifyListeners([listener]);\n\t\t\t};\n\n\t\t\t// Call listener when it is registered\n\t\t\tnotifyListeners([listener]);\n\n\t\t\tconst unlisten = addListener(source, \"popstate\", popstateListener);\n\t\t\treturn () => {\n\t\t\t\tunlisten();\n\t\t\t\tlisteners = listeners.filter(fn => fn !== listener);\n\t\t\t};\n\t\t},\n\t\t/**\n\t\t * Navigate to a new absolute route.\n\t\t *\n\t\t * @param {string|number} to The path to navigate to.\n\t\t *\n\t\t * If `to` is a number we will navigate to the stack entry index + `to`\n\t\t * (-> `navigate(-1)`, is equivalent to hitting the back button of the browser)\n\t\t * @param {Object} options\n\t\t * @param {*} [options.state] The state will be accessible through `location.state`\n\t\t * @param {boolean} [options.replace=false] Replace the current entry in the history\n\t\t * stack, instead of pushing on a new one\n\t\t */\n\t\tnavigate(to, options) {\n\t\t\tconst { state = {}, replace = false } = options || {};\n\t\t\taction = replace ? REPLACE : PUSH;\n\t\t\tif (isNumber(to)) {\n\t\t\t\tif (options) {\n\t\t\t\t\twarn(\n\t\t\t\t\t\tNAVIGATE_ID,\n\t\t\t\t\t\t\"Navigation options (state or replace) are not supported, \" +\n\t\t\t\t\t\t\t\"when passing a number as the first argument to navigate. \" +\n\t\t\t\t\t\t\t\"They are ignored.\",\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\taction = POP;\n\t\t\t\tsource.history.go(to);\n\t\t\t} else {\n\t\t\t\tconst keyedState = { ...state, _key: createGlobalId() };\n\t\t\t\t// try...catch iOS Safari limits to 100 pushState calls\n\t\t\t\ttry {\n\t\t\t\t\tsource.history[replace ? \"replaceState\" : \"pushState\"](\n\t\t\t\t\t\tkeyedState,\n\t\t\t\t\t\t\"\",\n\t\t\t\t\t\tto,\n\t\t\t\t\t);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tsource.location[replace ? \"replace\" : \"assign\"](to);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlocation = getLocation(source);\n\t\t\tnotifyListeners();\n\t\t},\n\t};\n}\n\nfunction createStackFrame(state, uri) {\n\treturn { ...createLocation(uri), state };\n}\n\n// Stores history entries in memory for testing or other platforms like Native\nfunction createMemorySource(initialPathname = \"/\") {\n\tlet index = 0;\n\tlet stack = [createStackFrame(null, initialPathname)];\n\n\treturn {\n\t\t// This is just for testing...\n\t\tget entries() {\n\t\t\treturn stack;\n\t\t},\n\t\tget location() {\n\t\t\treturn stack[index];\n\t\t},\n\t\taddEventListener() {},\n\t\tremoveEventListener() {},\n\t\thistory: {\n\t\t\tget state() {\n\t\t\t\treturn stack[index].state;\n\t\t\t},\n\t\t\tpushState(state, title, uri) {\n\t\t\t\tindex++;\n\t\t\t\t// Throw away anything in the stack with an index greater than the current index.\n\t\t\t\t// This happens, when we go back using `go(-n)`. The index is now less than `stack.length`.\n\t\t\t\t// If we call `go(+n)` the stack entries with an index greater than the current index can\n\t\t\t\t// be reused.\n\t\t\t\t// However, if we navigate to a path, instead of a number, we want to create a new branch\n\t\t\t\t// of navigation.\n\t\t\t\tstack = stack.slice(0, index);\n\t\t\t\tstack.push(createStackFrame(state, uri));\n\t\t\t},\n\t\t\treplaceState(state, title, uri) {\n\t\t\t\tstack[index] = createStackFrame(state, uri);\n\t\t\t},\n\t\t\tgo(to) {\n\t\t\t\tconst newIndex = index + to;\n\t\t\t\tif (newIndex < 0 || newIndex > stack.length - 1) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tindex = newIndex;\n\t\t\t},\n\t\t},\n\t};\n}\n\n// Global history uses window.history as the source if available,\n// otherwise a memory history\nconst canUseDOM = !!(\n\t!isSSR &&\n\twindow.document &&\n\twindow.document.createElement\n);\n// Use memory history in iframes (for example in Svelte REPL)\nconst isEmbeddedPage = !isSSR && window.location.origin === \"null\";\nconst globalHistory = createHistory(\n\tcanUseDOM && !isEmbeddedPage ? window : createMemorySource(),\n);\nconst { navigate } = globalHistory;\n\nexport { globalHistory, navigate, createHistory, createMemorySource };\n","import { get } from \"svelte/store\";\nimport { tick } from \"svelte\";\nimport { warn, ROUTER_ID, ROUTE_ID } from \"./warning\";\nimport { addListener } from \"./utils\";\n\n// We need to keep the focus candidate in a separate file, so svelte does\n// not update, when we mutate it.\n// Also, we need a single global reference, because taking focus needs to\n// work globally, even if we have multiple top level routers\n// eslint-disable-next-line import/no-mutable-exports\nexport let focusCandidate = null;\n\n// eslint-disable-next-line import/no-mutable-exports\nexport let initialNavigation = true;\n\n/**\n * Check if RouterA is above RouterB in the document\n * @param {number} routerIdA The first Routers id\n * @param {number} routerIdB The second Routers id\n */\nfunction isAbove(routerIdA, routerIdB) {\n\tconst routerMarkers = document.querySelectorAll(\"[data-svnav-router]\");\n\tfor (let i = 0; i < routerMarkers.length; i++) {\n\t\tconst node = routerMarkers[i];\n\t\tconst currentId = Number(node.dataset.svnavRouter);\n\t\tif (currentId === routerIdA) return true;\n\t\tif (currentId === routerIdB) return false;\n\t}\n\treturn false;\n}\n\n/**\n * Check if a Route candidate is the best choice to move focus to,\n * and store the best match.\n * @param {{\n     level: number;\n     routerId: number;\n     route: {\n       id: number;\n       focusElement: import(\"svelte/store\").Readable<Promise<Element>|null>;\n     }\n   }} item A Route candidate, that updated and is visible after a navigation\n */\nexport function pushFocusCandidate(item) {\n\tif (\n\t\t// Best candidate if it's the only candidate...\n\t\t!focusCandidate ||\n\t\t// Route is nested deeper, than previous candidate\n\t\t// -> Route change was triggered in the deepest affected\n\t\t// Route, so that's were focus should move to\n\t\titem.level > focusCandidate.level ||\n\t\t// If the level is identical, we want to focus the first Route in the document,\n\t\t// so we pick the first Router lookin from page top to page bottom.\n\t\t(item.level === focusCandidate.level &&\n\t\t\tisAbove(item.routerId, focusCandidate.routerId))\n\t) {\n\t\tfocusCandidate = item;\n\t}\n}\n\n/**\n * Reset the focus candidate.\n */\nexport function clearFocusCandidate() {\n\tfocusCandidate = null;\n}\n\nexport function initialNavigationOccurred() {\n\tinitialNavigation = false;\n}\n\n/*\n * `focus` Adapted from https://github.com/oaf-project/oaf-side-effects/blob/master/src/index.ts\n *\n * https://github.com/oaf-project/oaf-side-effects/blob/master/LICENSE\n */\nexport function focus(elem) {\n\tif (!elem) return false;\n\tconst TABINDEX = \"tabindex\";\n\ttry {\n\t\tif (!elem.hasAttribute(TABINDEX)) {\n\t\t\telem.setAttribute(TABINDEX, \"-1\");\n\t\t\tlet unlisten;\n\t\t\t// We remove tabindex after blur to avoid weird browser behavior\n\t\t\t// where a mouse click can activate elements with tabindex=\"-1\".\n\t\t\tconst blurListener = () => {\n\t\t\t\telem.removeAttribute(TABINDEX);\n\t\t\t\tunlisten();\n\t\t\t};\n\t\t\tunlisten = addListener(elem, \"blur\", blurListener);\n\t\t}\n\t\telem.focus();\n\t\treturn document.activeElement === elem;\n\t} catch (e) {\n\t\t// Apparently trying to focus a disabled element in IE can throw.\n\t\t// See https://stackoverflow.com/a/1600194/2476884\n\t\treturn false;\n\t}\n}\n\nexport function isEndMarker(elem, id) {\n\treturn Number(elem.dataset.svnavRouteEnd) === id;\n}\n\nexport function isHeading(elem) {\n\treturn /^H[1-6]$/i.test(elem.tagName);\n}\n\nfunction query(selector, parent = document) {\n\treturn parent.querySelector(selector);\n}\n\nexport function queryHeading(id) {\n\tconst marker = query(`[data-svnav-route-start=\"${id}\"]`);\n\tlet current = marker.nextElementSibling;\n\twhile (!isEndMarker(current, id)) {\n\t\tif (isHeading(current)) {\n\t\t\treturn current;\n\t\t}\n\t\tconst heading = query(\"h1,h2,h3,h4,h5,h6\", current);\n\t\tif (heading) {\n\t\t\treturn heading;\n\t\t}\n\t\tcurrent = current.nextElementSibling;\n\t}\n\treturn null;\n}\n\nexport function handleFocus(route) {\n\tPromise.resolve(get(route.focusElement)).then(elem => {\n\t\tconst focusElement = elem || queryHeading(route.id);\n\t\tif (!focusElement) {\n\t\t\twarn(\n\t\t\t\tROUTER_ID,\n\t\t\t\t\"Could not find an element to focus. \" +\n\t\t\t\t\t\"You should always render a header for accessibility reasons, \" +\n\t\t\t\t\t'or set a custom focus element via the \"useFocus\" hook. ' +\n\t\t\t\t\t\"If you don't want this Route or Router to manage focus, \" +\n\t\t\t\t\t'pass \"primary={false}\" to it.',\n\t\t\t\troute,\n\t\t\t\tROUTE_ID,\n\t\t\t);\n\t\t}\n\t\tconst headingFocused = focus(focusElement);\n\t\tif (headingFocused) return;\n\t\tfocus(document.documentElement);\n\t});\n}\n\nexport const createTriggerFocus = (a11yConfig, announcementText, location) => (\n\tmanageFocus,\n\tannounceNavigation,\n) =>\n\t// Wait until the dom is updated, so we can look for headings\n\ttick().then(() => {\n\t\tif (!focusCandidate || initialNavigation) {\n\t\t\tinitialNavigationOccurred();\n\t\t\treturn;\n\t\t}\n\t\tif (manageFocus) {\n\t\t\thandleFocus(focusCandidate.route);\n\t\t}\n\t\tif (a11yConfig.announcements && announceNavigation) {\n\t\t\tconst { path, fullPath, meta, params, uri } = focusCandidate.route;\n\t\t\tconst announcementMessage = a11yConfig.createAnnouncement(\n\t\t\t\t{ path, fullPath, meta, params, uri },\n\t\t\t\tget(location),\n\t\t\t);\n\t\t\tPromise.resolve(announcementMessage).then(message => {\n\t\t\t\tannouncementText.set(message);\n\t\t\t});\n\t\t}\n\t\tclearFocusCandidate();\n\t});\n\nexport const visuallyHiddenStyle =\n\t\"position:absolute;\" +\n\t\"width:1px;\" +\n\t\"height:1px;\" +\n\t\"padding:0;\" +\n\t\"overflow:hidden;\" +\n\t\"clip:rect(0,0,0,0);\" +\n\t\"white-space:nowrap;\" +\n\t\"border:0;\";\n","<script context=\"module\">\n\t// eslint-disable-next-line import/order\n\timport { createCounter } from \"./utils\";\n\n\tconst createId = createCounter();\n</script>\n\n<script>\n\t/*\n\t * Adapted from https://github.com/EmilTholin/svelte-routing\n\t *\n\t * https://github.com/EmilTholin/svelte-routing/blob/master/LICENSE\n\t */\n\n\timport { getContext, setContext, onMount } from \"svelte\";\n\timport { writable } from \"svelte/store\";\n\timport { LOCATION, ROUTER } from \"./contexts\";\n\timport { globalHistory } from \"./history\";\n\timport { normalizePath } from \"./paths\";\n\timport { pick, match, normalizeLocation, createLocation } from \"./routes\";\n\timport { isSSR } from \"./utils\";\n\timport { warn, ROUTER_ID } from \"./warning\";\n\timport {\n\t\tpushFocusCandidate,\n\t\tvisuallyHiddenStyle,\n\t\tcreateTriggerFocus,\n\t} from \"./a11y\";\n\n\tconst defaultBasepath = \"/\";\n\n\texport let basepath = defaultBasepath;\n\texport let url = null;\n\texport let history = globalHistory;\n\texport let primary = true;\n\texport let a11y = {};\n\n\tconst a11yConfig = {\n\t\tcreateAnnouncement: route => `Navigated to ${route.uri}`,\n\t\tannouncements: true,\n\t\t...a11y,\n\t};\n\n\t// Remember the initial `basepath`, so we can fire a warning\n\t// when the user changes it later\n\tconst initialBasepath = basepath;\n\tconst normalizedBasepath = normalizePath(basepath);\n\n\tconst locationContext = getContext(LOCATION);\n\tconst routerContext = getContext(ROUTER);\n\n\tconst isTopLevelRouter = !locationContext;\n\tconst routerId = createId();\n\n\tconst manageFocus = primary && !(routerContext && !routerContext.manageFocus);\n\tconst announcementText = writable(\"\");\n\n\tconst routes = writable([]);\n\tconst activeRoute = writable(null);\n\t// Used in SSR to synchronously set that a Route is active.\n\tlet hasActiveRoute = false;\n\n\t// Nesting level of router.\n\t// We will need this to identify sibling routers, when moving\n\t// focus on navigation, so we can focus the first possible router\n\tconst level = isTopLevelRouter ? 0 : routerContext.level + 1;\n\n\t// If we're running an SSR we force the location to the `url` prop\n\tconst getInitialLocation = () =>\n\t\tnormalizeLocation(\n\t\t\tisSSR ? createLocation(url) : history.location,\n\t\t\tnormalizedBasepath,\n\t\t);\n\tconst location = isTopLevelRouter\n\t\t? writable(getInitialLocation())\n\t\t: locationContext;\n\tconst prevLocation = writable($location);\n\n\tconst triggerFocus = createTriggerFocus(\n\t\ta11yConfig,\n\t\tannouncementText,\n\t\tlocation,\n\t);\n\n\tconst createRouteFilter = routeId => routeList =>\n\t\trouteList.filter(routeItem => routeItem.id !== routeId);\n\n\tfunction registerRoute(route) {\n\t\tif (isSSR) {\n\t\t\t// In SSR we should set the activeRoute immediately if it is a match.\n\t\t\t// If there are more Routes being registered after a match is found,\n\t\t\t// we just skip them.\n\t\t\tif (hasActiveRoute) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst matchingRoute = match(route, $location.pathname);\n\t\t\tif (matchingRoute) {\n\t\t\t\thasActiveRoute = true;\n\t\t\t\t// Return the match in SSR mode, so the matched Route can use it immediatly.\n\t\t\t\t// Waiting for activeRoute to update does not work, because it updates\n\t\t\t\t// after the Route is initialized\n\t\t\t\treturn matchingRoute; // eslint-disable-line consistent-return\n\t\t\t}\n\t\t} else {\n\t\t\troutes.update(prevRoutes => {\n\t\t\t\t// Remove an old version of the updated route,\n\t\t\t\t// before pushing the new version\n\t\t\t\tconst nextRoutes = createRouteFilter(route.id)(prevRoutes);\n\t\t\t\tnextRoutes.push(route);\n\t\t\t\treturn nextRoutes;\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction unregisterRoute(routeId) {\n\t\troutes.update(createRouteFilter(routeId));\n\t}\n\n\tif (!isTopLevelRouter && basepath !== defaultBasepath) {\n\t\twarn(\n\t\t\tROUTER_ID,\n\t\t\t'Only top-level Routers can have a \"basepath\" prop. It is ignored.',\n\t\t\t{ basepath },\n\t\t);\n\t}\n\t$: if (basepath !== initialBasepath) {\n\t\twarn(ROUTER_ID, 'You cannot change the \"basepath\" prop. It is ignored.');\n\t}\n\n\t// This reactive statement will be run when the Router is created\n\t// when there are no Routes and then again the following tick, so it\n\t// will not find an active Route in SSR and in the browser it will only\n\t// pick an active Route after all Routes have been registered.\n\t$: {\n\t\tconst bestMatch = pick($routes, $location.pathname);\n\t\tactiveRoute.set(bestMatch);\n\t}\n\n\t// Manage focus and announce navigation to screen reader users\n\t$: {\n\t\tif (isTopLevelRouter) {\n\t\t\tconst hasHash = !!$location.hash;\n\t\t\t// When a hash is present in the url, we skip focus management, because\n\t\t\t// focusing a different element will prevent in-page jumps (See #3)\n\t\t\tconst shouldManageFocus = !hasHash && manageFocus;\n\t\t\t// We don't want to make an announcement, when the hash changes,\n\t\t\t// but the active route stays the same\n\t\t\tconst announceNavigation =\n\t\t\t\t!hasHash || $location.pathname !== $prevLocation.pathname;\n\t\t\ttriggerFocus(shouldManageFocus, announceNavigation);\n\t\t}\n\t}\n\n\t// Queue matched Route, so top level Router can decide which Route to focus.\n\t// Non primary Routers should just be ignored\n\t$: if (manageFocus && $activeRoute && $activeRoute.primary) {\n\t\tpushFocusCandidate({ level, routerId, route: $activeRoute });\n\t}\n\n\tif (isTopLevelRouter) {\n\t\t// The topmost Router in the tree is responsible for updating\n\t\t// the location store and supplying it through context.\n\t\tonMount(() => {\n\t\t\tconst unlisten = history.listen(changedHistory => {\n\t\t\t\tconst normalizedLocation = normalizeLocation(\n\t\t\t\t\tchangedHistory.location,\n\t\t\t\t\tnormalizedBasepath,\n\t\t\t\t);\n\t\t\t\tprevLocation.set($location);\n\t\t\t\tlocation.set(normalizedLocation);\n\t\t\t});\n\n\t\t\treturn unlisten;\n\t\t});\n\n\t\tsetContext(LOCATION, location);\n\t}\n\n\tsetContext(ROUTER, {\n\t\tactiveRoute,\n\t\tregisterRoute,\n\t\tunregisterRoute,\n\t\tmanageFocus,\n\t\tlevel,\n\t\tid: routerId,\n\t\thistory: isTopLevelRouter ? history : routerContext.history,\n\t\tbasepath: isTopLevelRouter ? normalizedBasepath : routerContext.basepath,\n\t});\n</script>\n\n<div style=\"display:none;\" aria-hidden=\"true\" data-svnav-router={routerId} />\n\n<slot />\n\n{#if isTopLevelRouter && manageFocus && a11yConfig.announcements}\n\t<div\n\t\trole=\"status\"\n\t\taria-atomic=\"true\"\n\t\taria-live=\"polite\"\n\t\tstyle={visuallyHiddenStyle}\n\t>\n\t\t{$announcementText}\n\t</div>\n{/if}\n","import { getContext, onDestroy, tick } from \"svelte\";\nimport { derived, get, writable } from \"svelte/store\";\nimport { LOCATION, ROUTER, ROUTE, ROUTE_PARAMS, FOCUS_ELEM } from \"./contexts\";\nimport { resolveLink, match, normalizeLocation } from \"./routes\";\nimport { isNumber } from \"./utils\";\nimport {\n\tfail,\n\tcreateLabel,\n\tUSE_FOCUS_ID,\n\tROUTER_ID,\n\tUSE_LOCATION_ID,\n\tROUTE_ID,\n\tUSE_RESOLVE_ID,\n\tUSE_RESOLVABLE_ID,\n\tUSE_NAVIGATE_ID,\n\tUSE_MATCH_ID,\n\tUSE_PARAMS_ID,\n} from \"./warning\";\n\n/**\n * Check if a component or hook have been created outside of a\n * context providing component\n * @param {number} componentId\n * @param {*} props\n * @param {string?} ctxKey\n * @param {number?} ctxProviderId\n */\nexport function usePreflightCheck(\n\tcomponentId,\n\tprops,\n\tctxKey = ROUTER,\n\tctxProviderId = ROUTER_ID,\n) {\n\tconst ctx = getContext(ctxKey);\n\tif (!ctx) {\n\t\tfail(\n\t\t\tcomponentId,\n\t\t\tlabel =>\n\t\t\t\t`You cannot use ${label} outside of a ${createLabel(ctxProviderId)}.`,\n\t\t\tprops,\n\t\t);\n\t}\n}\n\nconst toReadonly = ctx => {\n\tconst { subscribe } = getContext(ctx);\n\treturn { subscribe };\n};\n\n/**\n * Access the current location via a readable store.\n * @returns {import(\"svelte/store\").Readable<{\n    pathname: string;\n    search: string;\n    hash: string;\n    state: {};\n  }>}\n *\n * @example\n  ```html\n  <script>\n    import { useLocation } from \"svelte-navigator\";\n\n    const location = useLocation();\n\n    $: console.log($location);\n    // {\n    //   pathname: \"/blog\",\n    //   search: \"?id=123\",\n    //   hash: \"#comments\",\n    //   state: {}\n    // }\n  </script>\n  ```\n */\nexport function useLocation() {\n\tusePreflightCheck(USE_LOCATION_ID);\n\treturn toReadonly(LOCATION);\n}\n\n/**\n * @typedef {{\n    path: string;\n    fullPath: string;\n    uri: string;\n    params: {};\n  }} RouteMatch\n */\n\n/**\n * @typedef {import(\"svelte/store\").Readable<RouteMatch|null>} RouteMatchStore\n */\n\n/**\n * Access the history of top level Router.\n */\nexport function useHistory() {\n\tconst { history } = getContext(ROUTER);\n\treturn history;\n}\n\n/**\n * Access the base of the parent Route.\n */\nexport function useRouteBase() {\n\tconst route = getContext(ROUTE);\n\treturn route ? derived(route, _route => _route.base) : writable(\"/\");\n}\n\n/**\n * Resolve a given link relative to the current `Route` and the `Router`s `basepath`.\n * It is used under the hood in `Link` and `useNavigate`.\n * You can use it to manually resolve links, when using the `link` or `links` actions.\n *\n * @returns {(path: string) => string}\n *\n * @example\n  ```html\n  <script>\n    import { link, useResolve } from \"svelte-navigator\";\n\n    const resolve = useResolve();\n    // `resolvedLink` will be resolved relative to its parent Route\n    // and the Routers `basepath`\n    const resolvedLink = resolve(\"relativePath\");\n  </script>\n\n  <a href={resolvedLink} use:link>Relative link</a>\n  ```\n */\nexport function useResolve() {\n\tusePreflightCheck(USE_RESOLVE_ID);\n\tconst routeBase = useRouteBase();\n\tconst { basepath: appBase } = getContext(ROUTER);\n\t/**\n\t * Resolves the path relative to the current route and basepath.\n\t *\n\t * @param {string} path The path to resolve\n\t * @returns {string} The resolved path\n\t */\n\tconst resolve = path => resolveLink(path, get(routeBase), appBase);\n\treturn resolve;\n}\n\n/**\n * Resolve a given link relative to the current `Route` and the `Router`s `basepath`.\n * It is used under the hood in `Link` and `useNavigate`.\n * You can use it to manually resolve links, when using the `link` or `links` actions.\n *\n * @returns {import(\"svelte/store\").Readable<string>}\n *\n * @example\n  ```html\n  <script>\n    import { link, useResolvable } from \"svelte-navigator\";\n\n    // `resolvedLink` will be resolved relative to its parent Route\n    // and the Routers `basepath`.\n    const resolvedLink = useResolvable(\"relativePath\");\n  </script>\n\n  <a href={$resolvedLink} use:link>Relative link</a>\n  ```\n */\nexport function useResolvable(path) {\n\tusePreflightCheck(USE_RESOLVABLE_ID);\n\tconst routeBase = useRouteBase();\n\tconst { basepath: appBase } = getContext(ROUTER);\n\treturn derived(routeBase, _routeBase =>\n\t\tresolveLink(path, _routeBase, appBase),\n\t);\n}\n\n/**\n * A hook, that returns a context-aware version of `navigate`.\n * It will automatically resolve the given link relative to the current Route.\n * It will also resolve a link against the `basepath` of the Router.\n *\n * @example\n  ```html\n  <!-- App.svelte -->\n  <script>\n    import { link, Route } from \"svelte-navigator\";\n    import RouteComponent from \"./RouteComponent.svelte\";\n  </script>\n\n  <Router>\n    <Route path=\"route1\">\n      <RouteComponent />\n    </Route>\n    <!-- ... -->\n  </Router>\n\n  <!-- RouteComponent.svelte -->\n  <script>\n    import { useNavigate } from \"svelte-navigator\";\n\n    const navigate = useNavigate();\n  </script>\n\n  <button on:click=\"{() => navigate('relativePath')}\">\n    go to /route1/relativePath\n  </button>\n  <button on:click=\"{() => navigate('/absolutePath')}\">\n    go to /absolutePath\n  </button>\n  ```\n  *\n  * @example\n  ```html\n  <!-- App.svelte -->\n  <script>\n    import { link, Route } from \"svelte-navigator\";\n    import RouteComponent from \"./RouteComponent.svelte\";\n  </script>\n\n  <Router basepath=\"/base\">\n    <Route path=\"route1\">\n      <RouteComponent />\n    </Route>\n    <!-- ... -->\n  </Router>\n\n  <!-- RouteComponent.svelte -->\n  <script>\n    import { useNavigate } from \"svelte-navigator\";\n\n    const navigate = useNavigate();\n  </script>\n\n  <button on:click=\"{() => navigate('relativePath')}\">\n    go to /base/route1/relativePath\n  </button>\n  <button on:click=\"{() => navigate('/absolutePath')}\">\n    go to /base/absolutePath\n  </button>\n  ```\n */\nexport function useNavigate() {\n\tusePreflightCheck(USE_NAVIGATE_ID);\n\tconst resolve = useResolve();\n\tconst { navigate } = useHistory();\n\t/**\n\t * Navigate to a new route.\n\t * Resolves the link relative to the current route and basepath.\n\t *\n\t * @param {string|number} to The path to navigate to.\n\t *\n\t * If `to` is a number we will navigate to the stack entry index + `to`\n\t * (-> `navigate(-1)`, is equivalent to hitting the back button of the browser)\n\t * @param {Object} options\n\t * @param {*} [options.state]\n\t * @param {boolean} [options.replace=false]\n\t */\n\tconst navigateRelative = (to, options) => {\n\t\t// If to is a number, we navigate to the target stack entry via `history.go`.\n\t\t// Otherwise resolve the link\n\t\tconst target = isNumber(to) ? to : resolve(to);\n\t\treturn navigate(target, options);\n\t};\n\treturn navigateRelative;\n}\n\n/**\n * Use Svelte Navigators matching without needing to use a Route.\n * Returns a readable store with the potential match,\n * that changes, when the location changes.\n *\n * The provided path will be resolved relatively,\n * as you're used to with all paths in Svelte Navigator\n *\n * @param {string} path The path, to match against.\n * It works just like a Route path\n * @returns {RouteMatchStore} The matched route.\n * Returns `null`, when nothing could be matched\n *\n * @example\n  ```html\n  <script>\n    import { useMatch } from \"svelte-navigator\";\n\n    const relativeMatch = useMatch(\"relative/path/:to/*somewhere\");\n    const absoluteMatch = useMatch(\"/absolute/path/:to/*somewhere\");\n\n    $: console.log($relativeMatch.params.to);\n    $: console.log($absoluteMatch.params.somewhere);\n  </script>\n  ```\n */\nexport function useMatch(path) {\n\tusePreflightCheck(USE_MATCH_ID);\n\tconst location = useLocation();\n\tconst resolve = useResolve();\n\tconst { basepath: appBase } = getContext(ROUTER);\n\tconst resolvedPath = resolve(path);\n\tconst { pathname: fullPath } = normalizeLocation(\n\t\t{ pathname: resolvedPath },\n\t\tappBase,\n\t);\n\treturn derived(location, loc => match({ fullPath, path }, loc.pathname));\n}\n\n/**\n * Access the parent Routes matched params and wildcards\n * @returns {import(\"svelte/store\").Readable<{\n     [param: string]: any;\n   }>} A readable store containing the matched parameters and wildcards\n *\n * @example\n  ```html\n  <!--\n    Somewhere inside <Route path=\"user/:id/*splat\" />\n    with a current url of \"/myApp/user/123/pauls-profile\"\n  -->\n  <script>\n    import { useParams } from \"svelte-navigator\";\n\n    const params = useParams();\n\n    $: console.log($params); // -> { id: \"123\", splat: \"pauls-profile\" }\n  </script>\n\n  <h3>Welcome user {$params.id}! bleep bloop...</h3>\n  ```\n */\nexport function useParams() {\n\tusePreflightCheck(USE_PARAMS_ID, null, ROUTE, ROUTE_ID);\n\treturn toReadonly(ROUTE_PARAMS);\n}\n\n/**\n * Provide a custom element to focus, when the parent route is visited.\n * It returns the `registerFocus` function you can call manually with an\n * Element or use as a Svelte action via the `use` directive.\n *\n * @example\n  ```html\n  <!-- Using `registerFocus` as a Svelte action: -->\n  <!-- Somewhere inside a Route -->\n  <script>\n    import { useFocus } from \"svelte-navigator\";\n\n    const registerFocus = useFocus();\n  </script>\n\n  <h1>Don't worry about me...</h1>\n  <p use:registerFocus>Here, look at me!</p>\n  ```\n  * @example\n  ```html\n  <!-- Calling `registerFocus` manually: -->\n  <!-- Somewhere inside a Route -->\n  <script>\n    import { onMount } from \"svelte\";\n    import { useFocus } from \"svelte-navigator\";\n\n    const registerFocus = useFocus();\n\n    let focusElement;\n\n    onMount(() => registerFocus(focusElement))\n  </script>\n\n  <h1>Don't worry about me...</h1>\n  <p bind:this={focusElement}>Here, look at me!</p>\n  ```\n  * @example\n  ```html\n  <!-- Using `registerFocus` asyncronously: -->\n  <!-- Somewhere inside a Route -->\n  <script>\n    import { onMount } from \"svelte\";\n    import { useFocus } from \"svelte-navigator\";\n\n    const registerFocus = useFocus();\n\n    const lazyImport = import(\"./MyComponent.svelte\").then(module => module.default);\n  </script>\n\n  {#await lazyImport then MyComponent}\n    <MyComponent {registerFocus} />\n  {/await}\n\n  <!-- MyComponent.svelte -->\n  <script>\n    export let registerFocus;\n  </script>\n\n  <h1 use:registerFocus>Hi there!</h1>\n  ```\n */\nexport function useFocus() {\n\tusePreflightCheck(USE_FOCUS_ID, null, ROUTE, ROUTE_ID);\n\tconst location = useLocation();\n\tconst focusElement = getContext(FOCUS_ELEM);\n\n\tlet resolve;\n\tconst unsubscribe = location.subscribe(() => {\n\t\tconst lazyElement = new Promise(_resolve => {\n\t\t\tresolve = _resolve;\n\t\t});\n\t\tfocusElement.set(lazyElement);\n\t});\n\n\tonDestroy(unsubscribe);\n\n\treturn node => {\n\t\tlet unmounted = false;\n\t\tconst innerUnsubscribe = location.subscribe(() => {\n\t\t\ttick().then(() => {\n\t\t\t\tif (!unmounted) {\n\t\t\t\t\tresolve(node);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tunmounted = true;\n\t\t\t\tinnerUnsubscribe();\n\t\t\t},\n\t\t};\n\t};\n}\n","<script context=\"module\">\n\t// eslint-disable-next-line import/order\n\timport { createCounter } from \"./utils\";\n\n\tconst createId = createCounter();\n</script>\n\n<script>\n\t/*\n\t * Adapted from https://github.com/EmilTholin/svelte-routing\n\t *\n\t * https://github.com/EmilTholin/svelte-routing/blob/master/LICENSE\n\t */\n\n\timport { getContext, onDestroy, setContext } from \"svelte\";\n\timport { writable, get } from \"svelte/store\";\n\timport Router from \"./Router.svelte\";\n\timport { ROUTER, ROUTE, ROUTE_PARAMS, FOCUS_ELEM } from \"./contexts\";\n\timport {\n\t\tuseLocation,\n\t\tuseNavigate,\n\t\tuseRouteBase,\n\t\tusePreflightCheck,\n\t} from \"./hooks\";\n\timport { isSSR } from \"./utils\";\n\timport { extractBaseUri } from \"./routes\";\n\timport { join } from \"./paths\";\n\timport { ROUTE_ID } from \"./warning\";\n\n\texport let path = \"\";\n\texport let component = null;\n\texport let meta = {};\n\texport let primary = true;\n\n\tusePreflightCheck(ROUTE_ID, $$props);\n\n\tconst id = createId();\n\n\tconst { registerRoute, unregisterRoute, activeRoute } = getContext(ROUTER);\n\tconst parentBase = useRouteBase();\n\tconst location = useLocation();\n\tconst focusElement = writable(null);\n\n\t// In SSR we cannot wait for $activeRoute to update,\n\t// so we use the match returned from `registerRoute` instead\n\tlet ssrMatch;\n\n\tconst route = writable();\n\t$: {\n\t\t// The route store will be re-computed whenever props, location or parentBase change\n\t\tconst isDefault = path === \"\";\n\t\tconst rawBase = join($parentBase, path);\n\t\tconst updatedRoute = {\n\t\t\tid,\n\t\t\tpath,\n\t\t\tmeta,\n\t\t\t// If no path prop is given, this Route will act as the default Route\n\t\t\t// that is rendered if no other Route in the Router is a match\n\t\t\tdefault: isDefault,\n\t\t\tfullPath: isDefault ? \"\" : rawBase,\n\t\t\tbase: isDefault\n\t\t\t\t? $parentBase\n\t\t\t\t: extractBaseUri(rawBase, $location.pathname),\n\t\t\tprimary,\n\t\t\tfocusElement,\n\t\t};\n\t\troute.set(updatedRoute);\n\t\t// If we're in SSR mode and the Route matches,\n\t\t// `registerRoute` will return the match\n\t\tssrMatch = registerRoute(updatedRoute);\n\t}\n\n\t$: isActive = !!(ssrMatch || ($activeRoute && $activeRoute.id === id));\n\n\tconst params = writable({});\n\t$: if (isActive) {\n\t\tconst { params: activeParams } = ssrMatch || $activeRoute;\n\t\tparams.set(activeParams);\n\t}\n\n\tsetContext(ROUTE, route);\n\tsetContext(ROUTE_PARAMS, params);\n\tsetContext(FOCUS_ELEM, focusElement);\n\n\t// We need to call useNavigate after the route is set,\n\t// so we can use the routes path for link resolution\n\tconst navigate = useNavigate();\n\n\t// There is no need to unregister Routes in SSR since it will all be\n\t// thrown away anyway\n\tif (!isSSR) {\n\t\tonDestroy(() => unregisterRoute(id));\n\t}\n</script>\n\n<div style=\"display:none;\" aria-hidden=\"true\" data-svnav-route-start={id} />\n{#if isActive}\n\t<Router {primary}>\n\t\t<!--\n      `$params` always returns `{}` in SSR in Route, because it will\n      update after component initialisation has already happend.\n      `get(params)` always works, but is not reactive, so we can't\n      use it in client rendered mode\n    -->\n\t\t{#if component !== null}\n\t\t\t<svelte:component\n\t\t\t\tthis={component}\n\t\t\t\tlocation={$location}\n\t\t\t\t{navigate}\n\t\t\t\t{...isSSR ? get(params) : $params}\n\t\t\t\t{...$$restProps}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<slot\n\t\t\t\tparams={isSSR ? get(params) : $params}\n\t\t\t\tlocation={$location}\n\t\t\t\t{navigate}\n\t\t\t/>\n\t\t{/if}\n\t</Router>\n{/if}\n<div style=\"display:none;\" aria-hidden=\"true\" data-svnav-route-end={id} />\n","/*\n * Adapted from https://github.com/EmilTholin/svelte-routing\n *\n * https://github.com/EmilTholin/svelte-routing/blob/master/LICENSE\n */\n\nimport { navigate as defaultNavigate } from \"./history\";\nimport { shouldNavigate, findClosest, addListener, isFunction } from \"./utils\";\n\nconst createAction = getAnchor => (node, navigate = defaultNavigate) => {\n\tconst handleClick = event => {\n\t\tconst anchor = getAnchor(event);\n\t\tif (anchor && anchor.target === \"\" && shouldNavigate(event)) {\n\t\t\tevent.preventDefault();\n\t\t\tconst to = anchor.pathname + anchor.search + anchor.hash;\n\t\t\tnavigate(to, { replace: anchor.hasAttribute(\"replace\") });\n\t\t}\n\t};\n\tconst unlisten = addListener(node, \"click\", handleClick);\n\treturn { destroy: unlisten };\n};\n\n// prettier-ignore\n/**\n * A link action that can be added to <a href=\"\"> tags rather\n * than using the <Link> component.\n *\n * Example:\n * ```html\n * <a href=\"/post/{postId}\" use:link>{post.title}</a>\n * ```\n */\nexport const link = /*#__PURE__*/createAction(event => event.currentTarget); // eslint-disable-line spaced-comment, max-len\n\n// prettier-ignore\n/**\n * An action to be added at a root element of your application to\n * capture all relative links and push them onto the history stack.\n *\n * Example:\n * ```html\n * <div use:links>\n *   <Router>\n *     <Route path=\"/\" component={Home} />\n *     <Route path=\"/p/:projectId/:docId\" component={ProjectScreen} />\n *     {#each projects as project}\n *       <a href=\"/p/{project.id}\">{project.title}</a>\n *     {/each}\n *   </Router>\n * </div>\n * ```\n */\nexport const links = /*#__PURE__*/createAction(event => { // eslint-disable-line spaced-comment\n  const anchor = findClosest(\"A\", event.target);\n  if (\n    anchor &&\n    isFunction(anchor.hasAttribute) &&\n    !anchor.hasAttribute(\"noroute\")\n  ) {\n    return anchor;\n  }\n  return null;\n});\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// Used for setting prototype methods that IE8 chokes on.\nvar DELETE = 'delete';\n\n// Constants describing the size of trie nodes.\nvar SHIFT = 5; // Resulted in best performance after ______?\nvar SIZE = 1 << SHIFT;\nvar MASK = SIZE - 1;\n\n// A consistent shared value representing \"not set\" which equals nothing other\n// than itself, and nothing that could be provided externally.\nvar NOT_SET = {};\n\n// Boolean references, Rough equivalent of `bool &`.\nfunction MakeRef() {\n  return { value: false };\n}\n\nfunction SetRef(ref) {\n  if (ref) {\n    ref.value = true;\n  }\n}\n\n// A function which returns a value representing an \"owner\" for transient writes\n// to tries. The return value will only ever equal itself, and will not equal\n// the return of any subsequent call of this function.\nfunction OwnerID() {}\n\nfunction ensureSize(iter) {\n  if (iter.size === undefined) {\n    iter.size = iter.__iterate(returnTrue);\n  }\n  return iter.size;\n}\n\nfunction wrapIndex(iter, index) {\n  // This implements \"is array index\" which the ECMAString spec defines as:\n  //\n  //     A String property name P is an array index if and only if\n  //     ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal\n  //     to 2^32−1.\n  //\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects\n  if (typeof index !== 'number') {\n    var uint32Index = index >>> 0; // N >>> 0 is shorthand for ToUint32\n    if ('' + uint32Index !== index || uint32Index === 4294967295) {\n      return NaN;\n    }\n    index = uint32Index;\n  }\n  return index < 0 ? ensureSize(iter) + index : index;\n}\n\nfunction returnTrue() {\n  return true;\n}\n\nfunction wholeSlice(begin, end, size) {\n  return (\n    ((begin === 0 && !isNeg(begin)) ||\n      (size !== undefined && begin <= -size)) &&\n    (end === undefined || (size !== undefined && end >= size))\n  );\n}\n\nfunction resolveBegin(begin, size) {\n  return resolveIndex(begin, size, 0);\n}\n\nfunction resolveEnd(end, size) {\n  return resolveIndex(end, size, size);\n}\n\nfunction resolveIndex(index, size, defaultIndex) {\n  // Sanitize indices using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  return index === undefined\n    ? defaultIndex\n    : isNeg(index)\n      ? size === Infinity\n        ? size\n        : Math.max(0, size + index) | 0\n      : size === undefined || size === index\n        ? index\n        : Math.min(size, index) | 0;\n}\n\nfunction isNeg(value) {\n  // Account for -0 which is negative, but not less than 0.\n  return value < 0 || (value === 0 && 1 / value === -Infinity);\n}\n\n// Note: value is unchanged to not break immutable-devtools.\nvar IS_COLLECTION_SYMBOL = '@@__IMMUTABLE_ITERABLE__@@';\n\nfunction isCollection(maybeCollection) {\n  return Boolean(maybeCollection && maybeCollection[IS_COLLECTION_SYMBOL]);\n}\n\nvar IS_KEYED_SYMBOL = '@@__IMMUTABLE_KEYED__@@';\n\nfunction isKeyed(maybeKeyed) {\n  return Boolean(maybeKeyed && maybeKeyed[IS_KEYED_SYMBOL]);\n}\n\nvar IS_INDEXED_SYMBOL = '@@__IMMUTABLE_INDEXED__@@';\n\nfunction isIndexed(maybeIndexed) {\n  return Boolean(maybeIndexed && maybeIndexed[IS_INDEXED_SYMBOL]);\n}\n\nfunction isAssociative(maybeAssociative) {\n  return isKeyed(maybeAssociative) || isIndexed(maybeAssociative);\n}\n\nvar Collection = function Collection(value) {\n  return isCollection(value) ? value : Seq(value);\n};\n\nvar KeyedCollection = /*@__PURE__*/(function (Collection) {\n  function KeyedCollection(value) {\n    return isKeyed(value) ? value : KeyedSeq(value);\n  }\n\n  if ( Collection ) KeyedCollection.__proto__ = Collection;\n  KeyedCollection.prototype = Object.create( Collection && Collection.prototype );\n  KeyedCollection.prototype.constructor = KeyedCollection;\n\n  return KeyedCollection;\n}(Collection));\n\nvar IndexedCollection = /*@__PURE__*/(function (Collection) {\n  function IndexedCollection(value) {\n    return isIndexed(value) ? value : IndexedSeq(value);\n  }\n\n  if ( Collection ) IndexedCollection.__proto__ = Collection;\n  IndexedCollection.prototype = Object.create( Collection && Collection.prototype );\n  IndexedCollection.prototype.constructor = IndexedCollection;\n\n  return IndexedCollection;\n}(Collection));\n\nvar SetCollection = /*@__PURE__*/(function (Collection) {\n  function SetCollection(value) {\n    return isCollection(value) && !isAssociative(value) ? value : SetSeq(value);\n  }\n\n  if ( Collection ) SetCollection.__proto__ = Collection;\n  SetCollection.prototype = Object.create( Collection && Collection.prototype );\n  SetCollection.prototype.constructor = SetCollection;\n\n  return SetCollection;\n}(Collection));\n\nCollection.Keyed = KeyedCollection;\nCollection.Indexed = IndexedCollection;\nCollection.Set = SetCollection;\n\nvar IS_SEQ_SYMBOL = '@@__IMMUTABLE_SEQ__@@';\n\nfunction isSeq(maybeSeq) {\n  return Boolean(maybeSeq && maybeSeq[IS_SEQ_SYMBOL]);\n}\n\nvar IS_RECORD_SYMBOL = '@@__IMMUTABLE_RECORD__@@';\n\nfunction isRecord(maybeRecord) {\n  return Boolean(maybeRecord && maybeRecord[IS_RECORD_SYMBOL]);\n}\n\nfunction isImmutable(maybeImmutable) {\n  return isCollection(maybeImmutable) || isRecord(maybeImmutable);\n}\n\nvar IS_ORDERED_SYMBOL = '@@__IMMUTABLE_ORDERED__@@';\n\nfunction isOrdered(maybeOrdered) {\n  return Boolean(maybeOrdered && maybeOrdered[IS_ORDERED_SYMBOL]);\n}\n\nvar ITERATE_KEYS = 0;\nvar ITERATE_VALUES = 1;\nvar ITERATE_ENTRIES = 2;\n\nvar REAL_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nvar FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nvar ITERATOR_SYMBOL = REAL_ITERATOR_SYMBOL || FAUX_ITERATOR_SYMBOL;\n\nvar Iterator = function Iterator(next) {\n  this.next = next;\n};\n\nIterator.prototype.toString = function toString () {\n  return '[Iterator]';\n};\n\nIterator.KEYS = ITERATE_KEYS;\nIterator.VALUES = ITERATE_VALUES;\nIterator.ENTRIES = ITERATE_ENTRIES;\n\nIterator.prototype.inspect = Iterator.prototype.toSource = function() {\n  return this.toString();\n};\nIterator.prototype[ITERATOR_SYMBOL] = function() {\n  return this;\n};\n\nfunction iteratorValue(type, k, v, iteratorResult) {\n  var value = type === 0 ? k : type === 1 ? v : [k, v];\n  iteratorResult\n    ? (iteratorResult.value = value)\n    : (iteratorResult = {\n        value: value,\n        done: false,\n      });\n  return iteratorResult;\n}\n\nfunction iteratorDone() {\n  return { value: undefined, done: true };\n}\n\nfunction hasIterator(maybeIterable) {\n  return !!getIteratorFn(maybeIterable);\n}\n\nfunction isIterator(maybeIterator) {\n  return maybeIterator && typeof maybeIterator.next === 'function';\n}\n\nfunction getIterator(iterable) {\n  var iteratorFn = getIteratorFn(iterable);\n  return iteratorFn && iteratorFn.call(iterable);\n}\n\nfunction getIteratorFn(iterable) {\n  var iteratorFn =\n    iterable &&\n    ((REAL_ITERATOR_SYMBOL && iterable[REAL_ITERATOR_SYMBOL]) ||\n      iterable[FAUX_ITERATOR_SYMBOL]);\n  if (typeof iteratorFn === 'function') {\n    return iteratorFn;\n  }\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isArrayLike(value) {\n  if (Array.isArray(value) || typeof value === 'string') {\n    return true;\n  }\n\n  return (\n    value &&\n    typeof value === 'object' &&\n    Number.isInteger(value.length) &&\n    value.length >= 0 &&\n    (value.length === 0\n      ? // Only {length: 0} is considered Array-like.\n        Object.keys(value).length === 1\n      : // An object is only Array-like if it has a property where the last value\n        // in the array-like may be found (which could be undefined).\n        value.hasOwnProperty(value.length - 1))\n  );\n}\n\nvar Seq = /*@__PURE__*/(function (Collection$$1) {\n  function Seq(value) {\n    return value === null || value === undefined\n      ? emptySequence()\n      : isImmutable(value)\n        ? value.toSeq()\n        : seqFromValue(value);\n  }\n\n  if ( Collection$$1 ) Seq.__proto__ = Collection$$1;\n  Seq.prototype = Object.create( Collection$$1 && Collection$$1.prototype );\n  Seq.prototype.constructor = Seq;\n\n  Seq.prototype.toSeq = function toSeq () {\n    return this;\n  };\n\n  Seq.prototype.toString = function toString () {\n    return this.__toString('Seq {', '}');\n  };\n\n  Seq.prototype.cacheResult = function cacheResult () {\n    if (!this._cache && this.__iterateUncached) {\n      this._cache = this.entrySeq().toArray();\n      this.size = this._cache.length;\n    }\n    return this;\n  };\n\n  // abstract __iterateUncached(fn, reverse)\n\n  Seq.prototype.__iterate = function __iterate (fn, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      while (i !== size) {\n        var entry = cache[reverse ? size - ++i : i++];\n        if (fn(entry[1], entry[0], this) === false) {\n          break;\n        }\n      }\n      return i;\n    }\n    return this.__iterateUncached(fn, reverse);\n  };\n\n  // abstract __iteratorUncached(type, reverse)\n\n  Seq.prototype.__iterator = function __iterator (type, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      return new Iterator(function () {\n        if (i === size) {\n          return iteratorDone();\n        }\n        var entry = cache[reverse ? size - ++i : i++];\n        return iteratorValue(type, entry[0], entry[1]);\n      });\n    }\n    return this.__iteratorUncached(type, reverse);\n  };\n\n  return Seq;\n}(Collection));\n\nvar KeyedSeq = /*@__PURE__*/(function (Seq) {\n  function KeyedSeq(value) {\n    return value === null || value === undefined\n      ? emptySequence().toKeyedSeq()\n      : isCollection(value)\n        ? isKeyed(value)\n          ? value.toSeq()\n          : value.fromEntrySeq()\n        : isRecord(value)\n          ? value.toSeq()\n          : keyedSeqFromValue(value);\n  }\n\n  if ( Seq ) KeyedSeq.__proto__ = Seq;\n  KeyedSeq.prototype = Object.create( Seq && Seq.prototype );\n  KeyedSeq.prototype.constructor = KeyedSeq;\n\n  KeyedSeq.prototype.toKeyedSeq = function toKeyedSeq () {\n    return this;\n  };\n\n  return KeyedSeq;\n}(Seq));\n\nvar IndexedSeq = /*@__PURE__*/(function (Seq) {\n  function IndexedSeq(value) {\n    return value === null || value === undefined\n      ? emptySequence()\n      : isCollection(value)\n        ? isKeyed(value)\n          ? value.entrySeq()\n          : value.toIndexedSeq()\n        : isRecord(value)\n          ? value.toSeq().entrySeq()\n          : indexedSeqFromValue(value);\n  }\n\n  if ( Seq ) IndexedSeq.__proto__ = Seq;\n  IndexedSeq.prototype = Object.create( Seq && Seq.prototype );\n  IndexedSeq.prototype.constructor = IndexedSeq;\n\n  IndexedSeq.of = function of (/*...values*/) {\n    return IndexedSeq(arguments);\n  };\n\n  IndexedSeq.prototype.toIndexedSeq = function toIndexedSeq () {\n    return this;\n  };\n\n  IndexedSeq.prototype.toString = function toString () {\n    return this.__toString('Seq [', ']');\n  };\n\n  return IndexedSeq;\n}(Seq));\n\nvar SetSeq = /*@__PURE__*/(function (Seq) {\n  function SetSeq(value) {\n    return (isCollection(value) && !isAssociative(value)\n      ? value\n      : IndexedSeq(value)\n    ).toSetSeq();\n  }\n\n  if ( Seq ) SetSeq.__proto__ = Seq;\n  SetSeq.prototype = Object.create( Seq && Seq.prototype );\n  SetSeq.prototype.constructor = SetSeq;\n\n  SetSeq.of = function of (/*...values*/) {\n    return SetSeq(arguments);\n  };\n\n  SetSeq.prototype.toSetSeq = function toSetSeq () {\n    return this;\n  };\n\n  return SetSeq;\n}(Seq));\n\nSeq.isSeq = isSeq;\nSeq.Keyed = KeyedSeq;\nSeq.Set = SetSeq;\nSeq.Indexed = IndexedSeq;\n\nSeq.prototype[IS_SEQ_SYMBOL] = true;\n\n// #pragma Root Sequences\n\nvar ArraySeq = /*@__PURE__*/(function (IndexedSeq) {\n  function ArraySeq(array) {\n    this._array = array;\n    this.size = array.length;\n  }\n\n  if ( IndexedSeq ) ArraySeq.__proto__ = IndexedSeq;\n  ArraySeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  ArraySeq.prototype.constructor = ArraySeq;\n\n  ArraySeq.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._array[wrapIndex(this, index)] : notSetValue;\n  };\n\n  ArraySeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    while (i !== size) {\n      var ii = reverse ? size - ++i : i++;\n      if (fn(array[ii], ii, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ArraySeq.prototype.__iterator = function __iterator (type, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var ii = reverse ? size - ++i : i++;\n      return iteratorValue(type, ii, array[ii]);\n    });\n  };\n\n  return ArraySeq;\n}(IndexedSeq));\n\nvar ObjectSeq = /*@__PURE__*/(function (KeyedSeq) {\n  function ObjectSeq(object) {\n    var keys = Object.keys(object);\n    this._object = object;\n    this._keys = keys;\n    this.size = keys.length;\n  }\n\n  if ( KeyedSeq ) ObjectSeq.__proto__ = KeyedSeq;\n  ObjectSeq.prototype = Object.create( KeyedSeq && KeyedSeq.prototype );\n  ObjectSeq.prototype.constructor = ObjectSeq;\n\n  ObjectSeq.prototype.get = function get (key, notSetValue) {\n    if (notSetValue !== undefined && !this.has(key)) {\n      return notSetValue;\n    }\n    return this._object[key];\n  };\n\n  ObjectSeq.prototype.has = function has (key) {\n    return hasOwnProperty.call(this._object, key);\n  };\n\n  ObjectSeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    while (i !== size) {\n      var key = keys[reverse ? size - ++i : i++];\n      if (fn(object[key], key, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ObjectSeq.prototype.__iterator = function __iterator (type, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var key = keys[reverse ? size - ++i : i++];\n      return iteratorValue(type, key, object[key]);\n    });\n  };\n\n  return ObjectSeq;\n}(KeyedSeq));\nObjectSeq.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar CollectionSeq = /*@__PURE__*/(function (IndexedSeq) {\n  function CollectionSeq(collection) {\n    this._collection = collection;\n    this.size = collection.length || collection.size;\n  }\n\n  if ( IndexedSeq ) CollectionSeq.__proto__ = IndexedSeq;\n  CollectionSeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  CollectionSeq.prototype.constructor = CollectionSeq;\n\n  CollectionSeq.prototype.__iterateUncached = function __iterateUncached (fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    var iterations = 0;\n    if (isIterator(iterator)) {\n      var step;\n      while (!(step = iterator.next()).done) {\n        if (fn(step.value, iterations++, this) === false) {\n          break;\n        }\n      }\n    }\n    return iterations;\n  };\n\n  CollectionSeq.prototype.__iteratorUncached = function __iteratorUncached (type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    if (!isIterator(iterator)) {\n      return new Iterator(iteratorDone);\n    }\n    var iterations = 0;\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done ? step : iteratorValue(type, iterations++, step.value);\n    });\n  };\n\n  return CollectionSeq;\n}(IndexedSeq));\n\n// # pragma Helper functions\n\nvar EMPTY_SEQ;\n\nfunction emptySequence() {\n  return EMPTY_SEQ || (EMPTY_SEQ = new ArraySeq([]));\n}\n\nfunction keyedSeqFromValue(value) {\n  var seq = Array.isArray(value)\n    ? new ArraySeq(value)\n    : hasIterator(value)\n      ? new CollectionSeq(value)\n      : undefined;\n  if (seq) {\n    return seq.fromEntrySeq();\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of [k, v] entries, or keyed object: ' +\n      value\n  );\n}\n\nfunction indexedSeqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq;\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values: ' + value\n  );\n}\n\nfunction seqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq;\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values, or keyed object: ' + value\n  );\n}\n\nfunction maybeIndexedSeqFromValue(value) {\n  return isArrayLike(value)\n    ? new ArraySeq(value)\n    : hasIterator(value)\n      ? new CollectionSeq(value)\n      : undefined;\n}\n\nvar IS_MAP_SYMBOL = '@@__IMMUTABLE_MAP__@@';\n\nfunction isMap(maybeMap) {\n  return Boolean(maybeMap && maybeMap[IS_MAP_SYMBOL]);\n}\n\nfunction isOrderedMap(maybeOrderedMap) {\n  return isMap(maybeOrderedMap) && isOrdered(maybeOrderedMap);\n}\n\nfunction isValueObject(maybeValue) {\n  return Boolean(\n    maybeValue &&\n      typeof maybeValue.equals === 'function' &&\n      typeof maybeValue.hashCode === 'function'\n  );\n}\n\n/**\n * An extension of the \"same-value\" algorithm as [described for use by ES6 Map\n * and Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)\n *\n * NaN is considered the same as NaN, however -0 and 0 are considered the same\n * value, which is different from the algorithm described by\n * [`Object.is`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).\n *\n * This is extended further to allow Objects to describe the values they\n * represent, by way of `valueOf` or `equals` (and `hashCode`).\n *\n * Note: because of this extension, the key equality of Immutable.Map and the\n * value equality of Immutable.Set will differ from ES6 Map and Set.\n *\n * ### Defining custom values\n *\n * The easiest way to describe the value an object represents is by implementing\n * `valueOf`. For example, `Date` represents a value by returning a unix\n * timestamp for `valueOf`:\n *\n *     var date1 = new Date(1234567890000); // Fri Feb 13 2009 ...\n *     var date2 = new Date(1234567890000);\n *     date1.valueOf(); // 1234567890000\n *     assert( date1 !== date2 );\n *     assert( Immutable.is( date1, date2 ) );\n *\n * Note: overriding `valueOf` may have other implications if you use this object\n * where JavaScript expects a primitive, such as implicit string coercion.\n *\n * For more complex types, especially collections, implementing `valueOf` may\n * not be performant. An alternative is to implement `equals` and `hashCode`.\n *\n * `equals` takes another object, presumably of similar type, and returns true\n * if it is equal. Equality is symmetrical, so the same result should be\n * returned if this and the argument are flipped.\n *\n *     assert( a.equals(b) === b.equals(a) );\n *\n * `hashCode` returns a 32bit integer number representing the object which will\n * be used to determine how to store the value object in a Map or Set. You must\n * provide both or neither methods, one must not exist without the other.\n *\n * Also, an important relationship between these methods must be upheld: if two\n * values are equal, they *must* return the same hashCode. If the values are not\n * equal, they might have the same hashCode; this is called a hash collision,\n * and while undesirable for performance reasons, it is acceptable.\n *\n *     if (a.equals(b)) {\n *       assert( a.hashCode() === b.hashCode() );\n *     }\n *\n * All Immutable collections are Value Objects: they implement `equals()`\n * and `hashCode()`.\n */\nfunction is(valueA, valueB) {\n  if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n    return true;\n  }\n  if (!valueA || !valueB) {\n    return false;\n  }\n  if (\n    typeof valueA.valueOf === 'function' &&\n    typeof valueB.valueOf === 'function'\n  ) {\n    valueA = valueA.valueOf();\n    valueB = valueB.valueOf();\n    if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n      return true;\n    }\n    if (!valueA || !valueB) {\n      return false;\n    }\n  }\n  return !!(\n    isValueObject(valueA) &&\n    isValueObject(valueB) &&\n    valueA.equals(valueB)\n  );\n}\n\nvar imul =\n  typeof Math.imul === 'function' && Math.imul(0xffffffff, 2) === -2\n    ? Math.imul\n    : function imul(a, b) {\n        a |= 0; // int\n        b |= 0; // int\n        var c = a & 0xffff;\n        var d = b & 0xffff;\n        // Shift by 0 fixes the sign on the high part.\n        return (c * d + ((((a >>> 16) * d + c * (b >>> 16)) << 16) >>> 0)) | 0; // int\n      };\n\n// v8 has an optimization for storing 31-bit signed numbers.\n// Values which have either 00 or 11 as the high order bits qualify.\n// This function drops the highest order bit in a signed number, maintaining\n// the sign bit.\nfunction smi(i32) {\n  return ((i32 >>> 1) & 0x40000000) | (i32 & 0xbfffffff);\n}\n\nvar defaultValueOf = Object.prototype.valueOf;\n\nfunction hash(o) {\n  switch (typeof o) {\n    case 'boolean':\n      // The hash values for built-in constants are a 1 value for each 5-byte\n      // shift region expect for the first, which encodes the value. This\n      // reduces the odds of a hash collision for these common values.\n      return o ? 0x42108421 : 0x42108420;\n    case 'number':\n      return hashNumber(o);\n    case 'string':\n      return o.length > STRING_HASH_CACHE_MIN_STRLEN\n        ? cachedHashString(o)\n        : hashString(o);\n    case 'object':\n    case 'function':\n      if (o === null) {\n        return 0x42108422;\n      }\n      if (typeof o.hashCode === 'function') {\n        // Drop any high bits from accidentally long hash codes.\n        return smi(o.hashCode(o));\n      }\n      if (o.valueOf !== defaultValueOf && typeof o.valueOf === 'function') {\n        o = o.valueOf(o);\n      }\n      return hashJSObj(o);\n    case 'undefined':\n      return 0x42108423;\n    default:\n      if (typeof o.toString === 'function') {\n        return hashString(o.toString());\n      }\n      throw new Error('Value type ' + typeof o + ' cannot be hashed.');\n  }\n}\n\n// Compress arbitrarily large numbers into smi hashes.\nfunction hashNumber(n) {\n  if (n !== n || n === Infinity) {\n    return 0;\n  }\n  var hash = n | 0;\n  if (hash !== n) {\n    hash ^= n * 0xffffffff;\n  }\n  while (n > 0xffffffff) {\n    n /= 0xffffffff;\n    hash ^= n;\n  }\n  return smi(hash);\n}\n\nfunction cachedHashString(string) {\n  var hashed = stringHashCache[string];\n  if (hashed === undefined) {\n    hashed = hashString(string);\n    if (STRING_HASH_CACHE_SIZE === STRING_HASH_CACHE_MAX_SIZE) {\n      STRING_HASH_CACHE_SIZE = 0;\n      stringHashCache = {};\n    }\n    STRING_HASH_CACHE_SIZE++;\n    stringHashCache[string] = hashed;\n  }\n  return hashed;\n}\n\n// http://jsperf.com/hashing-strings\nfunction hashString(string) {\n  // This is the hash from JVM\n  // The hash code for a string is computed as\n  // s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n  // where s[i] is the ith character of the string and n is the length of\n  // the string. We \"mod\" the result to make it between 0 (inclusive) and 2^31\n  // (exclusive) by dropping high bits.\n  var hashed = 0;\n  for (var ii = 0; ii < string.length; ii++) {\n    hashed = (31 * hashed + string.charCodeAt(ii)) | 0;\n  }\n  return smi(hashed);\n}\n\nfunction hashJSObj(obj) {\n  var hashed;\n  if (usingWeakMap) {\n    hashed = weakMap.get(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = obj[UID_HASH_KEY];\n  if (hashed !== undefined) {\n    return hashed;\n  }\n\n  if (!canDefineProperty) {\n    hashed = obj.propertyIsEnumerable && obj.propertyIsEnumerable[UID_HASH_KEY];\n    if (hashed !== undefined) {\n      return hashed;\n    }\n\n    hashed = getIENodeHash(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = ++objHashUID;\n  if (objHashUID & 0x40000000) {\n    objHashUID = 0;\n  }\n\n  if (usingWeakMap) {\n    weakMap.set(obj, hashed);\n  } else if (isExtensible !== undefined && isExtensible(obj) === false) {\n    throw new Error('Non-extensible objects are not allowed as keys.');\n  } else if (canDefineProperty) {\n    Object.defineProperty(obj, UID_HASH_KEY, {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: hashed,\n    });\n  } else if (\n    obj.propertyIsEnumerable !== undefined &&\n    obj.propertyIsEnumerable === obj.constructor.prototype.propertyIsEnumerable\n  ) {\n    // Since we can't define a non-enumerable property on the object\n    // we'll hijack one of the less-used non-enumerable properties to\n    // save our hash on it. Since this is a function it will not show up in\n    // `JSON.stringify` which is what we want.\n    obj.propertyIsEnumerable = function() {\n      return this.constructor.prototype.propertyIsEnumerable.apply(\n        this,\n        arguments\n      );\n    };\n    obj.propertyIsEnumerable[UID_HASH_KEY] = hashed;\n  } else if (obj.nodeType !== undefined) {\n    // At this point we couldn't get the IE `uniqueID` to use as a hash\n    // and we couldn't use a non-enumerable property to exploit the\n    // dontEnum bug so we simply add the `UID_HASH_KEY` on the node\n    // itself.\n    obj[UID_HASH_KEY] = hashed;\n  } else {\n    throw new Error('Unable to set a non-enumerable property on object.');\n  }\n\n  return hashed;\n}\n\n// Get references to ES5 object methods.\nvar isExtensible = Object.isExtensible;\n\n// True if Object.defineProperty works as expected. IE8 fails this test.\nvar canDefineProperty = (function() {\n  try {\n    Object.defineProperty({}, '@', {});\n    return true;\n  } catch (e) {\n    return false;\n  }\n})();\n\n// IE has a `uniqueID` property on DOM nodes. We can construct the hash from it\n// and avoid memory leaks from the IE cloneNode bug.\nfunction getIENodeHash(node) {\n  if (node && node.nodeType > 0) {\n    switch (node.nodeType) {\n      case 1: // Element\n        return node.uniqueID;\n      case 9: // Document\n        return node.documentElement && node.documentElement.uniqueID;\n    }\n  }\n}\n\n// If possible, use a WeakMap.\nvar usingWeakMap = typeof WeakMap === 'function';\nvar weakMap;\nif (usingWeakMap) {\n  weakMap = new WeakMap();\n}\n\nvar objHashUID = 0;\n\nvar UID_HASH_KEY = '__immutablehash__';\nif (typeof Symbol === 'function') {\n  UID_HASH_KEY = Symbol(UID_HASH_KEY);\n}\n\nvar STRING_HASH_CACHE_MIN_STRLEN = 16;\nvar STRING_HASH_CACHE_MAX_SIZE = 255;\nvar STRING_HASH_CACHE_SIZE = 0;\nvar stringHashCache = {};\n\nvar ToKeyedSequence = /*@__PURE__*/(function (KeyedSeq$$1) {\n  function ToKeyedSequence(indexed, useKeys) {\n    this._iter = indexed;\n    this._useKeys = useKeys;\n    this.size = indexed.size;\n  }\n\n  if ( KeyedSeq$$1 ) ToKeyedSequence.__proto__ = KeyedSeq$$1;\n  ToKeyedSequence.prototype = Object.create( KeyedSeq$$1 && KeyedSeq$$1.prototype );\n  ToKeyedSequence.prototype.constructor = ToKeyedSequence;\n\n  ToKeyedSequence.prototype.get = function get (key, notSetValue) {\n    return this._iter.get(key, notSetValue);\n  };\n\n  ToKeyedSequence.prototype.has = function has (key) {\n    return this._iter.has(key);\n  };\n\n  ToKeyedSequence.prototype.valueSeq = function valueSeq () {\n    return this._iter.valueSeq();\n  };\n\n  ToKeyedSequence.prototype.reverse = function reverse () {\n    var this$1 = this;\n\n    var reversedSequence = reverseFactory(this, true);\n    if (!this._useKeys) {\n      reversedSequence.valueSeq = function () { return this$1._iter.toSeq().reverse(); };\n    }\n    return reversedSequence;\n  };\n\n  ToKeyedSequence.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    var mappedSequence = mapFactory(this, mapper, context);\n    if (!this._useKeys) {\n      mappedSequence.valueSeq = function () { return this$1._iter.toSeq().map(mapper, context); };\n    }\n    return mappedSequence;\n  };\n\n  ToKeyedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (v, k) { return fn(v, k, this$1); }, reverse);\n  };\n\n  ToKeyedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    return this._iter.__iterator(type, reverse);\n  };\n\n  return ToKeyedSequence;\n}(KeyedSeq));\nToKeyedSequence.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar ToIndexedSequence = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function ToIndexedSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( IndexedSeq$$1 ) ToIndexedSequence.__proto__ = IndexedSeq$$1;\n  ToIndexedSequence.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  ToIndexedSequence.prototype.constructor = ToIndexedSequence;\n\n  ToIndexedSequence.prototype.includes = function includes (value) {\n    return this._iter.includes(value);\n  };\n\n  ToIndexedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(this);\n    return this._iter.__iterate(\n      function (v) { return fn(v, reverse ? this$1.size - ++i : i++, this$1); },\n      reverse\n    );\n  };\n\n  ToIndexedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1 = this;\n\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    var i = 0;\n    reverse && ensureSize(this);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(\n            type,\n            reverse ? this$1.size - ++i : i++,\n            step.value,\n            step\n          );\n    });\n  };\n\n  return ToIndexedSequence;\n}(IndexedSeq));\n\nvar ToSetSequence = /*@__PURE__*/(function (SetSeq$$1) {\n  function ToSetSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( SetSeq$$1 ) ToSetSequence.__proto__ = SetSeq$$1;\n  ToSetSequence.prototype = Object.create( SetSeq$$1 && SetSeq$$1.prototype );\n  ToSetSequence.prototype.constructor = ToSetSequence;\n\n  ToSetSequence.prototype.has = function has (key) {\n    return this._iter.includes(key);\n  };\n\n  ToSetSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (v) { return fn(v, v, this$1); }, reverse);\n  };\n\n  ToSetSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(type, step.value, step.value, step);\n    });\n  };\n\n  return ToSetSequence;\n}(SetSeq));\n\nvar FromEntriesSequence = /*@__PURE__*/(function (KeyedSeq$$1) {\n  function FromEntriesSequence(entries) {\n    this._iter = entries;\n    this.size = entries.size;\n  }\n\n  if ( KeyedSeq$$1 ) FromEntriesSequence.__proto__ = KeyedSeq$$1;\n  FromEntriesSequence.prototype = Object.create( KeyedSeq$$1 && KeyedSeq$$1.prototype );\n  FromEntriesSequence.prototype.constructor = FromEntriesSequence;\n\n  FromEntriesSequence.prototype.entrySeq = function entrySeq () {\n    return this._iter.toSeq();\n  };\n\n  FromEntriesSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (entry) {\n      // Check if entry exists first so array access doesn't throw for holes\n      // in the parent iteration.\n      if (entry) {\n        validateEntry(entry);\n        var indexedCollection = isCollection(entry);\n        return fn(\n          indexedCollection ? entry.get(1) : entry[1],\n          indexedCollection ? entry.get(0) : entry[0],\n          this$1\n        );\n      }\n    }, reverse);\n  };\n\n  FromEntriesSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        // Check if entry exists first so array access doesn't throw for holes\n        // in the parent iteration.\n        if (entry) {\n          validateEntry(entry);\n          var indexedCollection = isCollection(entry);\n          return iteratorValue(\n            type,\n            indexedCollection ? entry.get(0) : entry[0],\n            indexedCollection ? entry.get(1) : entry[1],\n            step\n          );\n        }\n      }\n    });\n  };\n\n  return FromEntriesSequence;\n}(KeyedSeq));\n\nToIndexedSequence.prototype.cacheResult = ToKeyedSequence.prototype.cacheResult = ToSetSequence.prototype.cacheResult = FromEntriesSequence.prototype.cacheResult = cacheResultThrough;\n\nfunction flipFactory(collection) {\n  var flipSequence = makeSequence(collection);\n  flipSequence._iter = collection;\n  flipSequence.size = collection.size;\n  flipSequence.flip = function () { return collection; };\n  flipSequence.reverse = function() {\n    var reversedSequence = collection.reverse.apply(this); // super.reverse()\n    reversedSequence.flip = function () { return collection.reverse(); };\n    return reversedSequence;\n  };\n  flipSequence.has = function (key) { return collection.includes(key); };\n  flipSequence.includes = function (key) { return collection.has(key); };\n  flipSequence.cacheResult = cacheResultThrough;\n  flipSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    return collection.__iterate(function (v, k) { return fn(k, v, this$1) !== false; }, reverse);\n  };\n  flipSequence.__iteratorUncached = function(type, reverse) {\n    if (type === ITERATE_ENTRIES) {\n      var iterator = collection.__iterator(type, reverse);\n      return new Iterator(function () {\n        var step = iterator.next();\n        if (!step.done) {\n          var k = step.value[0];\n          step.value[0] = step.value[1];\n          step.value[1] = k;\n        }\n        return step;\n      });\n    }\n    return collection.__iterator(\n      type === ITERATE_VALUES ? ITERATE_KEYS : ITERATE_VALUES,\n      reverse\n    );\n  };\n  return flipSequence;\n}\n\nfunction mapFactory(collection, mapper, context) {\n  var mappedSequence = makeSequence(collection);\n  mappedSequence.size = collection.size;\n  mappedSequence.has = function (key) { return collection.has(key); };\n  mappedSequence.get = function (key, notSetValue) {\n    var v = collection.get(key, NOT_SET);\n    return v === NOT_SET\n      ? notSetValue\n      : mapper.call(context, v, key, collection);\n  };\n  mappedSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    return collection.__iterate(\n      function (v, k, c) { return fn(mapper.call(context, v, k, c), k, this$1) !== false; },\n      reverse\n    );\n  };\n  mappedSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var key = entry[0];\n      return iteratorValue(\n        type,\n        key,\n        mapper.call(context, entry[1], key, collection),\n        step\n      );\n    });\n  };\n  return mappedSequence;\n}\n\nfunction reverseFactory(collection, useKeys) {\n  var this$1 = this;\n\n  var reversedSequence = makeSequence(collection);\n  reversedSequence._iter = collection;\n  reversedSequence.size = collection.size;\n  reversedSequence.reverse = function () { return collection; };\n  if (collection.flip) {\n    reversedSequence.flip = function() {\n      var flipSequence = flipFactory(collection);\n      flipSequence.reverse = function () { return collection.flip(); };\n      return flipSequence;\n    };\n  }\n  reversedSequence.get = function (key, notSetValue) { return collection.get(useKeys ? key : -1 - key, notSetValue); };\n  reversedSequence.has = function (key) { return collection.has(useKeys ? key : -1 - key); };\n  reversedSequence.includes = function (value) { return collection.includes(value); };\n  reversedSequence.cacheResult = cacheResultThrough;\n  reversedSequence.__iterate = function(fn, reverse) {\n    var this$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(collection);\n    return collection.__iterate(\n      function (v, k) { return fn(v, useKeys ? k : reverse ? this$1.size - ++i : i++, this$1); },\n      !reverse\n    );\n  };\n  reversedSequence.__iterator = function (type, reverse) {\n    var i = 0;\n    reverse && ensureSize(collection);\n    var iterator = collection.__iterator(ITERATE_ENTRIES, !reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      return iteratorValue(\n        type,\n        useKeys ? entry[0] : reverse ? this$1.size - ++i : i++,\n        entry[1],\n        step\n      );\n    });\n  };\n  return reversedSequence;\n}\n\nfunction filterFactory(collection, predicate, context, useKeys) {\n  var filterSequence = makeSequence(collection);\n  if (useKeys) {\n    filterSequence.has = function (key) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && !!predicate.call(context, v, key, collection);\n    };\n    filterSequence.get = function (key, notSetValue) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && predicate.call(context, v, key, collection)\n        ? v\n        : notSetValue;\n    };\n  }\n  filterSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1);\n      }\n    }, reverse);\n    return iterations;\n  };\n  filterSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterations = 0;\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var key = entry[0];\n        var value = entry[1];\n        if (predicate.call(context, value, key, collection)) {\n          return iteratorValue(type, useKeys ? key : iterations++, value, step);\n        }\n      }\n    });\n  };\n  return filterSequence;\n}\n\nfunction countByFactory(collection, grouper, context) {\n  var groups = Map().asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(grouper.call(context, v, k, collection), 0, function (a) { return a + 1; });\n  });\n  return groups.asImmutable();\n}\n\nfunction groupByFactory(collection, grouper, context) {\n  var isKeyedIter = isKeyed(collection);\n  var groups = (isOrdered(collection) ? OrderedMap() : Map()).asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(\n      grouper.call(context, v, k, collection),\n      function (a) { return ((a = a || []), a.push(isKeyedIter ? [k, v] : v), a); }\n    );\n  });\n  var coerce = collectionClass(collection);\n  return groups.map(function (arr) { return reify(collection, coerce(arr)); }).asImmutable();\n}\n\nfunction sliceFactory(collection, begin, end, useKeys) {\n  var originalSize = collection.size;\n\n  if (wholeSlice(begin, end, originalSize)) {\n    return collection;\n  }\n\n  var resolvedBegin = resolveBegin(begin, originalSize);\n  var resolvedEnd = resolveEnd(end, originalSize);\n\n  // begin or end will be NaN if they were provided as negative numbers and\n  // this collection's size is unknown. In that case, cache first so there is\n  // a known size and these do not resolve to NaN.\n  if (resolvedBegin !== resolvedBegin || resolvedEnd !== resolvedEnd) {\n    return sliceFactory(collection.toSeq().cacheResult(), begin, end, useKeys);\n  }\n\n  // Note: resolvedEnd is undefined when the original sequence's length is\n  // unknown and this slice did not supply an end and should contain all\n  // elements after resolvedBegin.\n  // In that case, resolvedSize will be NaN and sliceSize will remain undefined.\n  var resolvedSize = resolvedEnd - resolvedBegin;\n  var sliceSize;\n  if (resolvedSize === resolvedSize) {\n    sliceSize = resolvedSize < 0 ? 0 : resolvedSize;\n  }\n\n  var sliceSeq = makeSequence(collection);\n\n  // If collection.size is undefined, the size of the realized sliceSeq is\n  // unknown at this point unless the number of items to slice is 0\n  sliceSeq.size =\n    sliceSize === 0 ? sliceSize : (collection.size && sliceSize) || undefined;\n\n  if (!useKeys && isSeq(collection) && sliceSize >= 0) {\n    sliceSeq.get = function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      return index >= 0 && index < sliceSize\n        ? collection.get(index + resolvedBegin, notSetValue)\n        : notSetValue;\n    };\n  }\n\n  sliceSeq.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (sliceSize === 0) {\n      return 0;\n    }\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var skipped = 0;\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k) {\n      if (!(isSkipping && (isSkipping = skipped++ < resolvedBegin))) {\n        iterations++;\n        return (\n          fn(v, useKeys ? k : iterations - 1, this$1) !== false &&\n          iterations !== sliceSize\n        );\n      }\n    });\n    return iterations;\n  };\n\n  sliceSeq.__iteratorUncached = function(type, reverse) {\n    if (sliceSize !== 0 && reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    // Don't bother instantiating parent iterator if taking 0.\n    if (sliceSize === 0) {\n      return new Iterator(iteratorDone);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var skipped = 0;\n    var iterations = 0;\n    return new Iterator(function () {\n      while (skipped++ < resolvedBegin) {\n        iterator.next();\n      }\n      if (++iterations > sliceSize) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (useKeys || type === ITERATE_VALUES || step.done) {\n        return step;\n      }\n      if (type === ITERATE_KEYS) {\n        return iteratorValue(type, iterations - 1, undefined, step);\n      }\n      return iteratorValue(type, iterations - 1, step.value[1], step);\n    });\n  };\n\n  return sliceSeq;\n}\n\nfunction takeWhileFactory(collection, predicate, context) {\n  var takeSequence = makeSequence(collection);\n  takeSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    collection.__iterate(\n      function (v, k, c) { return predicate.call(context, v, k, c) && ++iterations && fn(v, k, this$1); }\n    );\n    return iterations;\n  };\n  takeSequence.__iteratorUncached = function(type, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterating = true;\n    return new Iterator(function () {\n      if (!iterating) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var k = entry[0];\n      var v = entry[1];\n      if (!predicate.call(context, v, k, this$1)) {\n        iterating = false;\n        return iteratorDone();\n      }\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return takeSequence;\n}\n\nfunction skipWhileFactory(collection, predicate, context, useKeys) {\n  var skipSequence = makeSequence(collection);\n  skipSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (!(isSkipping && (isSkipping = predicate.call(context, v, k, c)))) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1);\n      }\n    });\n    return iterations;\n  };\n  skipSequence.__iteratorUncached = function(type, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var skipping = true;\n    var iterations = 0;\n    return new Iterator(function () {\n      var step;\n      var k;\n      var v;\n      do {\n        step = iterator.next();\n        if (step.done) {\n          if (useKeys || type === ITERATE_VALUES) {\n            return step;\n          }\n          if (type === ITERATE_KEYS) {\n            return iteratorValue(type, iterations++, undefined, step);\n          }\n          return iteratorValue(type, iterations++, step.value[1], step);\n        }\n        var entry = step.value;\n        k = entry[0];\n        v = entry[1];\n        skipping && (skipping = predicate.call(context, v, k, this$1));\n      } while (skipping);\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return skipSequence;\n}\n\nfunction concatFactory(collection, values) {\n  var isKeyedCollection = isKeyed(collection);\n  var iters = [collection]\n    .concat(values)\n    .map(function (v) {\n      if (!isCollection(v)) {\n        v = isKeyedCollection\n          ? keyedSeqFromValue(v)\n          : indexedSeqFromValue(Array.isArray(v) ? v : [v]);\n      } else if (isKeyedCollection) {\n        v = KeyedCollection(v);\n      }\n      return v;\n    })\n    .filter(function (v) { return v.size !== 0; });\n\n  if (iters.length === 0) {\n    return collection;\n  }\n\n  if (iters.length === 1) {\n    var singleton = iters[0];\n    if (\n      singleton === collection ||\n      (isKeyedCollection && isKeyed(singleton)) ||\n      (isIndexed(collection) && isIndexed(singleton))\n    ) {\n      return singleton;\n    }\n  }\n\n  var concatSeq = new ArraySeq(iters);\n  if (isKeyedCollection) {\n    concatSeq = concatSeq.toKeyedSeq();\n  } else if (!isIndexed(collection)) {\n    concatSeq = concatSeq.toSetSeq();\n  }\n  concatSeq = concatSeq.flatten(true);\n  concatSeq.size = iters.reduce(function (sum, seq) {\n    if (sum !== undefined) {\n      var size = seq.size;\n      if (size !== undefined) {\n        return sum + size;\n      }\n    }\n  }, 0);\n  return concatSeq;\n}\n\nfunction flattenFactory(collection, depth, useKeys) {\n  var flatSequence = makeSequence(collection);\n  flatSequence.__iterateUncached = function(fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    var stopped = false;\n    function flatDeep(iter, currentDepth) {\n      iter.__iterate(function (v, k) {\n        if ((!depth || currentDepth < depth) && isCollection(v)) {\n          flatDeep(v, currentDepth + 1);\n        } else {\n          iterations++;\n          if (fn(v, useKeys ? k : iterations - 1, flatSequence) === false) {\n            stopped = true;\n          }\n        }\n        return !stopped;\n      }, reverse);\n    }\n    flatDeep(collection, 0);\n    return iterations;\n  };\n  flatSequence.__iteratorUncached = function(type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var stack = [];\n    var iterations = 0;\n    return new Iterator(function () {\n      while (iterator) {\n        var step = iterator.next();\n        if (step.done !== false) {\n          iterator = stack.pop();\n          continue;\n        }\n        var v = step.value;\n        if (type === ITERATE_ENTRIES) {\n          v = v[1];\n        }\n        if ((!depth || stack.length < depth) && isCollection(v)) {\n          stack.push(iterator);\n          iterator = v.__iterator(type, reverse);\n        } else {\n          return useKeys ? step : iteratorValue(type, iterations++, v, step);\n        }\n      }\n      return iteratorDone();\n    });\n  };\n  return flatSequence;\n}\n\nfunction flatMapFactory(collection, mapper, context) {\n  var coerce = collectionClass(collection);\n  return collection\n    .toSeq()\n    .map(function (v, k) { return coerce(mapper.call(context, v, k, collection)); })\n    .flatten(true);\n}\n\nfunction interposeFactory(collection, separator) {\n  var interposedSequence = makeSequence(collection);\n  interposedSequence.size = collection.size && collection.size * 2 - 1;\n  interposedSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(\n      function (v) { return (!iterations || fn(separator, iterations++, this$1) !== false) &&\n        fn(v, iterations++, this$1) !== false; },\n      reverse\n    );\n    return iterations;\n  };\n  interposedSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_VALUES, reverse);\n    var iterations = 0;\n    var step;\n    return new Iterator(function () {\n      if (!step || iterations % 2) {\n        step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n      }\n      return iterations % 2\n        ? iteratorValue(type, iterations++, separator)\n        : iteratorValue(type, iterations++, step.value, step);\n    });\n  };\n  return interposedSequence;\n}\n\nfunction sortFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  var isKeyedCollection = isKeyed(collection);\n  var index = 0;\n  var entries = collection\n    .toSeq()\n    .map(function (v, k) { return [k, v, index++, mapper ? mapper(v, k, collection) : v]; })\n    .valueSeq()\n    .toArray();\n  entries.sort(function (a, b) { return comparator(a[3], b[3]) || a[2] - b[2]; }).forEach(\n    isKeyedCollection\n      ? function (v, i) {\n          entries[i].length = 2;\n        }\n      : function (v, i) {\n          entries[i] = v[1];\n        }\n  );\n  return isKeyedCollection\n    ? KeyedSeq(entries)\n    : isIndexed(collection)\n      ? IndexedSeq(entries)\n      : SetSeq(entries);\n}\n\nfunction maxFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  if (mapper) {\n    var entry = collection\n      .toSeq()\n      .map(function (v, k) { return [v, mapper(v, k, collection)]; })\n      .reduce(function (a, b) { return (maxCompare(comparator, a[1], b[1]) ? b : a); });\n    return entry && entry[0];\n  }\n  return collection.reduce(function (a, b) { return (maxCompare(comparator, a, b) ? b : a); });\n}\n\nfunction maxCompare(comparator, a, b) {\n  var comp = comparator(b, a);\n  // b is considered the new max if the comparator declares them equal, but\n  // they are not equal and b is in fact a nullish value.\n  return (\n    (comp === 0 && b !== a && (b === undefined || b === null || b !== b)) ||\n    comp > 0\n  );\n}\n\nfunction zipWithFactory(keyIter, zipper, iters, zipAll) {\n  var zipSequence = makeSequence(keyIter);\n  var sizes = new ArraySeq(iters).map(function (i) { return i.size; });\n  zipSequence.size = zipAll ? sizes.max() : sizes.min();\n  // Note: this a generic base implementation of __iterate in terms of\n  // __iterator which may be more generically useful in the future.\n  zipSequence.__iterate = function(fn, reverse) {\n    /* generic:\n    var iterator = this.__iterator(ITERATE_ENTRIES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      iterations++;\n      if (fn(step.value[1], step.value[0], this) === false) {\n        break;\n      }\n    }\n    return iterations;\n    */\n    // indexed:\n    var iterator = this.__iterator(ITERATE_VALUES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      if (fn(step.value, iterations++, this) === false) {\n        break;\n      }\n    }\n    return iterations;\n  };\n  zipSequence.__iteratorUncached = function(type, reverse) {\n    var iterators = iters.map(\n      function (i) { return ((i = Collection(i)), getIterator(reverse ? i.reverse() : i)); }\n    );\n    var iterations = 0;\n    var isDone = false;\n    return new Iterator(function () {\n      var steps;\n      if (!isDone) {\n        steps = iterators.map(function (i) { return i.next(); });\n        isDone = zipAll ? steps.every(function (s) { return s.done; }) : steps.some(function (s) { return s.done; });\n      }\n      if (isDone) {\n        return iteratorDone();\n      }\n      return iteratorValue(\n        type,\n        iterations++,\n        zipper.apply(null, steps.map(function (s) { return s.value; }))\n      );\n    });\n  };\n  return zipSequence;\n}\n\n// #pragma Helper Functions\n\nfunction reify(iter, seq) {\n  return iter === seq ? iter : isSeq(iter) ? seq : iter.constructor(seq);\n}\n\nfunction validateEntry(entry) {\n  if (entry !== Object(entry)) {\n    throw new TypeError('Expected [K, V] tuple: ' + entry);\n  }\n}\n\nfunction collectionClass(collection) {\n  return isKeyed(collection)\n    ? KeyedCollection\n    : isIndexed(collection)\n      ? IndexedCollection\n      : SetCollection;\n}\n\nfunction makeSequence(collection) {\n  return Object.create(\n    (isKeyed(collection)\n      ? KeyedSeq\n      : isIndexed(collection)\n        ? IndexedSeq\n        : SetSeq\n    ).prototype\n  );\n}\n\nfunction cacheResultThrough() {\n  if (this._iter.cacheResult) {\n    this._iter.cacheResult();\n    this.size = this._iter.size;\n    return this;\n  }\n  return Seq.prototype.cacheResult.call(this);\n}\n\nfunction defaultComparator(a, b) {\n  if (a === undefined && b === undefined) {\n    return 0;\n  }\n\n  if (a === undefined) {\n    return 1;\n  }\n\n  if (b === undefined) {\n    return -1;\n  }\n\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n// http://jsperf.com/copy-array-inline\nfunction arrCopy(arr, offset) {\n  offset = offset || 0;\n  var len = Math.max(0, arr.length - offset);\n  var newArr = new Array(len);\n  for (var ii = 0; ii < len; ii++) {\n    newArr[ii] = arr[ii + offset];\n  }\n  return newArr;\n}\n\nfunction invariant(condition, error) {\n  if (!condition) { throw new Error(error); }\n}\n\nfunction assertNotInfinite(size) {\n  invariant(\n    size !== Infinity,\n    'Cannot perform this action with an infinite size.'\n  );\n}\n\nfunction coerceKeyPath(keyPath) {\n  if (isArrayLike(keyPath) && typeof keyPath !== 'string') {\n    return keyPath;\n  }\n  if (isOrdered(keyPath)) {\n    return keyPath.toArray();\n  }\n  throw new TypeError(\n    'Invalid keyPath: expected Ordered Collection or Array: ' + keyPath\n  );\n}\n\nfunction isPlainObj(value) {\n  return (\n    value &&\n    (typeof value.constructor !== 'function' ||\n      value.constructor.name === 'Object')\n  );\n}\n\n/**\n * Returns true if the value is a potentially-persistent data structure, either\n * provided by Immutable.js or a plain Array or Object.\n */\nfunction isDataStructure(value) {\n  return (\n    typeof value === 'object' &&\n    (isImmutable(value) || Array.isArray(value) || isPlainObj(value))\n  );\n}\n\n/**\n * Converts a value to a string, adding quotes if a string was provided.\n */\nfunction quoteString(value) {\n  try {\n    return typeof value === 'string' ? JSON.stringify(value) : String(value);\n  } catch (_ignoreError) {\n    return JSON.stringify(value);\n  }\n}\n\nfunction has(collection, key) {\n  return isImmutable(collection)\n    ? collection.has(key)\n    : isDataStructure(collection) && hasOwnProperty.call(collection, key);\n}\n\nfunction get(collection, key, notSetValue) {\n  return isImmutable(collection)\n    ? collection.get(key, notSetValue)\n    : !has(collection, key)\n      ? notSetValue\n      : typeof collection.get === 'function'\n        ? collection.get(key)\n        : collection[key];\n}\n\nfunction shallowCopy(from) {\n  if (Array.isArray(from)) {\n    return arrCopy(from);\n  }\n  var to = {};\n  for (var key in from) {\n    if (hasOwnProperty.call(from, key)) {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\n\nfunction remove(collection, key) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.remove) {\n      throw new TypeError(\n        'Cannot update immutable value without .remove() method: ' + collection\n      );\n    }\n    return collection.remove(key);\n  }\n  if (!hasOwnProperty.call(collection, key)) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  if (Array.isArray(collectionCopy)) {\n    collectionCopy.splice(key, 1);\n  } else {\n    delete collectionCopy[key];\n  }\n  return collectionCopy;\n}\n\nfunction set(collection, key, value) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.set) {\n      throw new TypeError(\n        'Cannot update immutable value without .set() method: ' + collection\n      );\n    }\n    return collection.set(key, value);\n  }\n  if (hasOwnProperty.call(collection, key) && value === collection[key]) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  collectionCopy[key] = value;\n  return collectionCopy;\n}\n\nfunction updateIn(collection, keyPath, notSetValue, updater) {\n  if (!updater) {\n    updater = notSetValue;\n    notSetValue = undefined;\n  }\n  var updatedValue = updateInDeeply(\n    isImmutable(collection),\n    collection,\n    coerceKeyPath(keyPath),\n    0,\n    notSetValue,\n    updater\n  );\n  return updatedValue === NOT_SET ? notSetValue : updatedValue;\n}\n\nfunction updateInDeeply(\n  inImmutable,\n  existing,\n  keyPath,\n  i,\n  notSetValue,\n  updater\n) {\n  var wasNotSet = existing === NOT_SET;\n  if (i === keyPath.length) {\n    var existingValue = wasNotSet ? notSetValue : existing;\n    var newValue = updater(existingValue);\n    return newValue === existingValue ? existing : newValue;\n  }\n  if (!wasNotSet && !isDataStructure(existing)) {\n    throw new TypeError(\n      'Cannot update within non-data-structure value in path [' +\n        keyPath.slice(0, i).map(quoteString) +\n        ']: ' +\n        existing\n    );\n  }\n  var key = keyPath[i];\n  var nextExisting = wasNotSet ? NOT_SET : get(existing, key, NOT_SET);\n  var nextUpdated = updateInDeeply(\n    nextExisting === NOT_SET ? inImmutable : isImmutable(nextExisting),\n    nextExisting,\n    keyPath,\n    i + 1,\n    notSetValue,\n    updater\n  );\n  return nextUpdated === nextExisting\n    ? existing\n    : nextUpdated === NOT_SET\n      ? remove(existing, key)\n      : set(\n          wasNotSet ? (inImmutable ? emptyMap() : {}) : existing,\n          key,\n          nextUpdated\n        );\n}\n\nfunction setIn(collection, keyPath, value) {\n  return updateIn(collection, keyPath, NOT_SET, function () { return value; });\n}\n\nfunction setIn$1(keyPath, v) {\n  return setIn(this, keyPath, v);\n}\n\nfunction removeIn(collection, keyPath) {\n  return updateIn(collection, keyPath, function () { return NOT_SET; });\n}\n\nfunction deleteIn(keyPath) {\n  return removeIn(this, keyPath);\n}\n\nfunction update(collection, key, notSetValue, updater) {\n  return updateIn(collection, [key], notSetValue, updater);\n}\n\nfunction update$1(key, notSetValue, updater) {\n  return arguments.length === 1\n    ? key(this)\n    : update(this, key, notSetValue, updater);\n}\n\nfunction updateIn$1(keyPath, notSetValue, updater) {\n  return updateIn(this, keyPath, notSetValue, updater);\n}\n\nfunction merge() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeIntoKeyedWith(this, iters);\n}\n\nfunction mergeWith(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  if (typeof merger !== 'function') {\n    throw new TypeError('Invalid merger function: ' + merger);\n  }\n  return mergeIntoKeyedWith(this, iters, merger);\n}\n\nfunction mergeIntoKeyedWith(collection, collections, merger) {\n  var iters = [];\n  for (var ii = 0; ii < collections.length; ii++) {\n    var collection$1 = KeyedCollection(collections[ii]);\n    if (collection$1.size !== 0) {\n      iters.push(collection$1);\n    }\n  }\n  if (iters.length === 0) {\n    return collection;\n  }\n  if (\n    collection.toSeq().size === 0 &&\n    !collection.__ownerID &&\n    iters.length === 1\n  ) {\n    return collection.constructor(iters[0]);\n  }\n  return collection.withMutations(function (collection) {\n    var mergeIntoCollection = merger\n      ? function (value, key) {\n          update(\n            collection,\n            key,\n            NOT_SET,\n            function (oldVal) { return (oldVal === NOT_SET ? value : merger(oldVal, value, key)); }\n          );\n        }\n      : function (value, key) {\n          collection.set(key, value);\n        };\n    for (var ii = 0; ii < iters.length; ii++) {\n      iters[ii].forEach(mergeIntoCollection);\n    }\n  });\n}\n\nfunction merge$1(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeWithSources(collection, sources);\n}\n\nfunction mergeWith$1(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeWithSources(collection, sources, merger);\n}\n\nfunction mergeDeep(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(collection, sources);\n}\n\nfunction mergeDeepWith(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeDeepWithSources(collection, sources, merger);\n}\n\nfunction mergeDeepWithSources(collection, sources, merger) {\n  return mergeWithSources(collection, sources, deepMergerWith(merger));\n}\n\nfunction mergeWithSources(collection, sources, merger) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot merge into non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    return typeof merger === 'function' && collection.mergeWith\n      ? collection.mergeWith.apply(collection, [ merger ].concat( sources ))\n      : collection.merge\n        ? collection.merge.apply(collection, sources)\n        : collection.concat.apply(collection, sources);\n  }\n  var isArray = Array.isArray(collection);\n  var merged = collection;\n  var Collection$$1 = isArray ? IndexedCollection : KeyedCollection;\n  var mergeItem = isArray\n    ? function (value) {\n        // Copy on write\n        if (merged === collection) {\n          merged = shallowCopy(merged);\n        }\n        merged.push(value);\n      }\n    : function (value, key) {\n        var hasVal = hasOwnProperty.call(merged, key);\n        var nextVal =\n          hasVal && merger ? merger(merged[key], value, key) : value;\n        if (!hasVal || nextVal !== merged[key]) {\n          // Copy on write\n          if (merged === collection) {\n            merged = shallowCopy(merged);\n          }\n          merged[key] = nextVal;\n        }\n      };\n  for (var i = 0; i < sources.length; i++) {\n    Collection$$1(sources[i]).forEach(mergeItem);\n  }\n  return merged;\n}\n\nfunction deepMergerWith(merger) {\n  function deepMerger(oldValue, newValue, key) {\n    return isDataStructure(oldValue) && isDataStructure(newValue)\n      ? mergeWithSources(oldValue, [newValue], deepMerger)\n      : merger\n        ? merger(oldValue, newValue, key)\n        : newValue;\n  }\n  return deepMerger;\n}\n\nfunction mergeDeep$1() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeDeepWithSources(this, iters);\n}\n\nfunction mergeDeepWith$1(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(this, iters, merger);\n}\n\nfunction mergeIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn(this, keyPath, emptyMap(), function (m) { return mergeWithSources(m, iters); });\n}\n\nfunction mergeDeepIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn(this, keyPath, emptyMap(), function (m) { return mergeDeepWithSources(m, iters); }\n  );\n}\n\nfunction withMutations(fn) {\n  var mutable = this.asMutable();\n  fn(mutable);\n  return mutable.wasAltered() ? mutable.__ensureOwner(this.__ownerID) : this;\n}\n\nfunction asMutable() {\n  return this.__ownerID ? this : this.__ensureOwner(new OwnerID());\n}\n\nfunction asImmutable() {\n  return this.__ensureOwner();\n}\n\nfunction wasAltered() {\n  return this.__altered;\n}\n\nvar Map = /*@__PURE__*/(function (KeyedCollection$$1) {\n  function Map(value) {\n    return value === null || value === undefined\n      ? emptyMap()\n      : isMap(value) && !isOrdered(value)\n        ? value\n        : emptyMap().withMutations(function (map) {\n            var iter = KeyedCollection$$1(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v, k) { return map.set(k, v); });\n          });\n  }\n\n  if ( KeyedCollection$$1 ) Map.__proto__ = KeyedCollection$$1;\n  Map.prototype = Object.create( KeyedCollection$$1 && KeyedCollection$$1.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.of = function of () {\n    var keyValues = [], len = arguments.length;\n    while ( len-- ) keyValues[ len ] = arguments[ len ];\n\n    return emptyMap().withMutations(function (map) {\n      for (var i = 0; i < keyValues.length; i += 2) {\n        if (i + 1 >= keyValues.length) {\n          throw new Error('Missing value for key: ' + keyValues[i]);\n        }\n        map.set(keyValues[i], keyValues[i + 1]);\n      }\n    });\n  };\n\n  Map.prototype.toString = function toString () {\n    return this.__toString('Map {', '}');\n  };\n\n  // @pragma Access\n\n  Map.prototype.get = function get (k, notSetValue) {\n    return this._root\n      ? this._root.get(0, undefined, k, notSetValue)\n      : notSetValue;\n  };\n\n  // @pragma Modification\n\n  Map.prototype.set = function set (k, v) {\n    return updateMap(this, k, v);\n  };\n\n  Map.prototype.remove = function remove (k) {\n    return updateMap(this, k, NOT_SET);\n  };\n\n  Map.prototype.deleteAll = function deleteAll (keys) {\n    var collection = Collection(keys);\n\n    if (collection.size === 0) {\n      return this;\n    }\n\n    return this.withMutations(function (map) {\n      collection.forEach(function (key) { return map.remove(key); });\n    });\n  };\n\n  Map.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._root = null;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyMap();\n  };\n\n  // @pragma Composition\n\n  Map.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator));\n  };\n\n  Map.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator, mapper));\n  };\n\n  Map.prototype.map = function map (mapper, context) {\n    return this.withMutations(function (map) {\n      map.forEach(function (value, key) {\n        map.set(key, mapper.call(context, value, key, map));\n      });\n    });\n  };\n\n  // @pragma Mutability\n\n  Map.prototype.__iterator = function __iterator (type, reverse) {\n    return new MapIterator(this, type, reverse);\n  };\n\n  Map.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    this._root &&\n      this._root.iterate(function (entry) {\n        iterations++;\n        return fn(entry[1], entry[0], this$1);\n      }, reverse);\n    return iterations;\n  };\n\n  Map.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyMap();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeMap(this.size, this._root, ownerID, this.__hash);\n  };\n\n  return Map;\n}(KeyedCollection));\n\nMap.isMap = isMap;\n\nvar MapPrototype = Map.prototype;\nMapPrototype[IS_MAP_SYMBOL] = true;\nMapPrototype[DELETE] = MapPrototype.remove;\nMapPrototype.removeAll = MapPrototype.deleteAll;\nMapPrototype.setIn = setIn$1;\nMapPrototype.removeIn = MapPrototype.deleteIn = deleteIn;\nMapPrototype.update = update$1;\nMapPrototype.updateIn = updateIn$1;\nMapPrototype.merge = MapPrototype.concat = merge;\nMapPrototype.mergeWith = mergeWith;\nMapPrototype.mergeDeep = mergeDeep$1;\nMapPrototype.mergeDeepWith = mergeDeepWith$1;\nMapPrototype.mergeIn = mergeIn;\nMapPrototype.mergeDeepIn = mergeDeepIn;\nMapPrototype.withMutations = withMutations;\nMapPrototype.wasAltered = wasAltered;\nMapPrototype.asImmutable = asImmutable;\nMapPrototype['@@transducer/init'] = MapPrototype.asMutable = asMutable;\nMapPrototype['@@transducer/step'] = function(result, arr) {\n  return result.set(arr[0], arr[1]);\n};\nMapPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\n// #pragma Trie Nodes\n\nvar ArrayMapNode = function ArrayMapNode(ownerID, entries) {\n  this.ownerID = ownerID;\n  this.entries = entries;\n};\n\nArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && entries.length === 1) {\n    return; // undefined\n  }\n\n  if (!exists && !removed && entries.length >= MAX_ARRAY_MAP_SIZE) {\n    return createNodes(ownerID, entries, key, value);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new ArrayMapNode(ownerID, newEntries);\n};\n\nvar BitmapIndexedNode = function BitmapIndexedNode(ownerID, bitmap, nodes) {\n  this.ownerID = ownerID;\n  this.bitmap = bitmap;\n  this.nodes = nodes;\n};\n\nBitmapIndexedNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var bit = 1 << ((shift === 0 ? keyHash : keyHash >>> shift) & MASK);\n  var bitmap = this.bitmap;\n  return (bitmap & bit) === 0\n    ? notSetValue\n    : this.nodes[popCount(bitmap & (bit - 1))].get(\n        shift + SHIFT,\n        keyHash,\n        key,\n        notSetValue\n      );\n};\n\nBitmapIndexedNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var keyHashFrag = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var bit = 1 << keyHashFrag;\n  var bitmap = this.bitmap;\n  var exists = (bitmap & bit) !== 0;\n\n  if (!exists && value === NOT_SET) {\n    return this;\n  }\n\n  var idx = popCount(bitmap & (bit - 1));\n  var nodes = this.nodes;\n  var node = exists ? nodes[idx] : undefined;\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n\n  if (newNode === node) {\n    return this;\n  }\n\n  if (!exists && newNode && nodes.length >= MAX_BITMAP_INDEXED_SIZE) {\n    return expandNodes(ownerID, nodes, bitmap, keyHashFrag, newNode);\n  }\n\n  if (\n    exists &&\n    !newNode &&\n    nodes.length === 2 &&\n    isLeafNode(nodes[idx ^ 1])\n  ) {\n    return nodes[idx ^ 1];\n  }\n\n  if (exists && newNode && nodes.length === 1 && isLeafNode(newNode)) {\n    return newNode;\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newBitmap = exists ? (newNode ? bitmap : bitmap ^ bit) : bitmap | bit;\n  var newNodes = exists\n    ? newNode\n      ? setAt(nodes, idx, newNode, isEditable)\n      : spliceOut(nodes, idx, isEditable)\n    : spliceIn(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.bitmap = newBitmap;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new BitmapIndexedNode(ownerID, newBitmap, newNodes);\n};\n\nvar HashArrayMapNode = function HashArrayMapNode(ownerID, count, nodes) {\n  this.ownerID = ownerID;\n  this.count = count;\n  this.nodes = nodes;\n};\n\nHashArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var node = this.nodes[idx];\n  return node\n    ? node.get(shift + SHIFT, keyHash, key, notSetValue)\n    : notSetValue;\n};\n\nHashArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var removed = value === NOT_SET;\n  var nodes = this.nodes;\n  var node = nodes[idx];\n\n  if (removed && !node) {\n    return this;\n  }\n\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n  if (newNode === node) {\n    return this;\n  }\n\n  var newCount = this.count;\n  if (!node) {\n    newCount++;\n  } else if (!newNode) {\n    newCount--;\n    if (newCount < MIN_HASH_ARRAY_MAP_SIZE) {\n      return packNodes(ownerID, nodes, newCount, idx);\n    }\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newNodes = setAt(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.count = newCount;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new HashArrayMapNode(ownerID, newCount, newNodes);\n};\n\nvar HashCollisionNode = function HashCollisionNode(ownerID, keyHash, entries) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entries = entries;\n};\n\nHashCollisionNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nHashCollisionNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n\n  var removed = value === NOT_SET;\n\n  if (keyHash !== this.keyHash) {\n    if (removed) {\n      return this;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return mergeIntoNode(this, ownerID, shift, keyHash, [key, value]);\n  }\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && len === 2) {\n    return new ValueNode(ownerID, this.keyHash, entries[idx ^ 1]);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new HashCollisionNode(ownerID, this.keyHash, newEntries);\n};\n\nvar ValueNode = function ValueNode(ownerID, keyHash, entry) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entry = entry;\n};\n\nValueNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  return is(key, this.entry[0]) ? this.entry[1] : notSetValue;\n};\n\nValueNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n  var keyMatch = is(key, this.entry[0]);\n  if (keyMatch ? value === this.entry[1] : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n\n  if (removed) {\n    SetRef(didChangeSize);\n    return; // undefined\n  }\n\n  if (keyMatch) {\n    if (ownerID && ownerID === this.ownerID) {\n      this.entry[1] = value;\n      return this;\n    }\n    return new ValueNode(ownerID, this.keyHash, [key, value]);\n  }\n\n  SetRef(didChangeSize);\n  return mergeIntoNode(this, ownerID, shift, hash(key), [key, value]);\n};\n\n// #pragma Iterators\n\nArrayMapNode.prototype.iterate = HashCollisionNode.prototype.iterate = function(\n  fn,\n  reverse\n) {\n  var entries = this.entries;\n  for (var ii = 0, maxIndex = entries.length - 1; ii <= maxIndex; ii++) {\n    if (fn(entries[reverse ? maxIndex - ii : ii]) === false) {\n      return false;\n    }\n  }\n};\n\nBitmapIndexedNode.prototype.iterate = HashArrayMapNode.prototype.iterate = function(\n  fn,\n  reverse\n) {\n  var nodes = this.nodes;\n  for (var ii = 0, maxIndex = nodes.length - 1; ii <= maxIndex; ii++) {\n    var node = nodes[reverse ? maxIndex - ii : ii];\n    if (node && node.iterate(fn, reverse) === false) {\n      return false;\n    }\n  }\n};\n\n// eslint-disable-next-line no-unused-vars\nValueNode.prototype.iterate = function(fn, reverse) {\n  return fn(this.entry);\n};\n\nvar MapIterator = /*@__PURE__*/(function (Iterator$$1) {\n  function MapIterator(map, type, reverse) {\n    this._type = type;\n    this._reverse = reverse;\n    this._stack = map._root && mapIteratorFrame(map._root);\n  }\n\n  if ( Iterator$$1 ) MapIterator.__proto__ = Iterator$$1;\n  MapIterator.prototype = Object.create( Iterator$$1 && Iterator$$1.prototype );\n  MapIterator.prototype.constructor = MapIterator;\n\n  MapIterator.prototype.next = function next () {\n    var type = this._type;\n    var stack = this._stack;\n    while (stack) {\n      var node = stack.node;\n      var index = stack.index++;\n      var maxIndex = (void 0);\n      if (node.entry) {\n        if (index === 0) {\n          return mapIteratorValue(type, node.entry);\n        }\n      } else if (node.entries) {\n        maxIndex = node.entries.length - 1;\n        if (index <= maxIndex) {\n          return mapIteratorValue(\n            type,\n            node.entries[this._reverse ? maxIndex - index : index]\n          );\n        }\n      } else {\n        maxIndex = node.nodes.length - 1;\n        if (index <= maxIndex) {\n          var subNode = node.nodes[this._reverse ? maxIndex - index : index];\n          if (subNode) {\n            if (subNode.entry) {\n              return mapIteratorValue(type, subNode.entry);\n            }\n            stack = this._stack = mapIteratorFrame(subNode, stack);\n          }\n          continue;\n        }\n      }\n      stack = this._stack = this._stack.__prev;\n    }\n    return iteratorDone();\n  };\n\n  return MapIterator;\n}(Iterator));\n\nfunction mapIteratorValue(type, entry) {\n  return iteratorValue(type, entry[0], entry[1]);\n}\n\nfunction mapIteratorFrame(node, prev) {\n  return {\n    node: node,\n    index: 0,\n    __prev: prev,\n  };\n}\n\nfunction makeMap(size, root, ownerID, hash$$1) {\n  var map = Object.create(MapPrototype);\n  map.size = size;\n  map._root = root;\n  map.__ownerID = ownerID;\n  map.__hash = hash$$1;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_MAP;\nfunction emptyMap() {\n  return EMPTY_MAP || (EMPTY_MAP = makeMap(0));\n}\n\nfunction updateMap(map, k, v) {\n  var newRoot;\n  var newSize;\n  if (!map._root) {\n    if (v === NOT_SET) {\n      return map;\n    }\n    newSize = 1;\n    newRoot = new ArrayMapNode(map.__ownerID, [[k, v]]);\n  } else {\n    var didChangeSize = MakeRef();\n    var didAlter = MakeRef();\n    newRoot = updateNode(\n      map._root,\n      map.__ownerID,\n      0,\n      undefined,\n      k,\n      v,\n      didChangeSize,\n      didAlter\n    );\n    if (!didAlter.value) {\n      return map;\n    }\n    newSize = map.size + (didChangeSize.value ? (v === NOT_SET ? -1 : 1) : 0);\n  }\n  if (map.__ownerID) {\n    map.size = newSize;\n    map._root = newRoot;\n    map.__hash = undefined;\n    map.__altered = true;\n    return map;\n  }\n  return newRoot ? makeMap(newSize, newRoot) : emptyMap();\n}\n\nfunction updateNode(\n  node,\n  ownerID,\n  shift,\n  keyHash,\n  key,\n  value,\n  didChangeSize,\n  didAlter\n) {\n  if (!node) {\n    if (value === NOT_SET) {\n      return node;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return new ValueNode(ownerID, keyHash, [key, value]);\n  }\n  return node.update(\n    ownerID,\n    shift,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n}\n\nfunction isLeafNode(node) {\n  return (\n    node.constructor === ValueNode || node.constructor === HashCollisionNode\n  );\n}\n\nfunction mergeIntoNode(node, ownerID, shift, keyHash, entry) {\n  if (node.keyHash === keyHash) {\n    return new HashCollisionNode(ownerID, keyHash, [node.entry, entry]);\n  }\n\n  var idx1 = (shift === 0 ? node.keyHash : node.keyHash >>> shift) & MASK;\n  var idx2 = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n\n  var newNode;\n  var nodes =\n    idx1 === idx2\n      ? [mergeIntoNode(node, ownerID, shift + SHIFT, keyHash, entry)]\n      : ((newNode = new ValueNode(ownerID, keyHash, entry)),\n        idx1 < idx2 ? [node, newNode] : [newNode, node]);\n\n  return new BitmapIndexedNode(ownerID, (1 << idx1) | (1 << idx2), nodes);\n}\n\nfunction createNodes(ownerID, entries, key, value) {\n  if (!ownerID) {\n    ownerID = new OwnerID();\n  }\n  var node = new ValueNode(ownerID, hash(key), [key, value]);\n  for (var ii = 0; ii < entries.length; ii++) {\n    var entry = entries[ii];\n    node = node.update(ownerID, 0, undefined, entry[0], entry[1]);\n  }\n  return node;\n}\n\nfunction packNodes(ownerID, nodes, count, excluding) {\n  var bitmap = 0;\n  var packedII = 0;\n  var packedNodes = new Array(count);\n  for (var ii = 0, bit = 1, len = nodes.length; ii < len; ii++, bit <<= 1) {\n    var node = nodes[ii];\n    if (node !== undefined && ii !== excluding) {\n      bitmap |= bit;\n      packedNodes[packedII++] = node;\n    }\n  }\n  return new BitmapIndexedNode(ownerID, bitmap, packedNodes);\n}\n\nfunction expandNodes(ownerID, nodes, bitmap, including, node) {\n  var count = 0;\n  var expandedNodes = new Array(SIZE);\n  for (var ii = 0; bitmap !== 0; ii++, bitmap >>>= 1) {\n    expandedNodes[ii] = bitmap & 1 ? nodes[count++] : undefined;\n  }\n  expandedNodes[including] = node;\n  return new HashArrayMapNode(ownerID, count + 1, expandedNodes);\n}\n\nfunction popCount(x) {\n  x -= (x >> 1) & 0x55555555;\n  x = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n  x = (x + (x >> 4)) & 0x0f0f0f0f;\n  x += x >> 8;\n  x += x >> 16;\n  return x & 0x7f;\n}\n\nfunction setAt(array, idx, val, canEdit) {\n  var newArray = canEdit ? array : arrCopy(array);\n  newArray[idx] = val;\n  return newArray;\n}\n\nfunction spliceIn(array, idx, val, canEdit) {\n  var newLen = array.length + 1;\n  if (canEdit && idx + 1 === newLen) {\n    array[idx] = val;\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      newArray[ii] = val;\n      after = -1;\n    } else {\n      newArray[ii] = array[ii + after];\n    }\n  }\n  return newArray;\n}\n\nfunction spliceOut(array, idx, canEdit) {\n  var newLen = array.length - 1;\n  if (canEdit && idx === newLen) {\n    array.pop();\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      after = 1;\n    }\n    newArray[ii] = array[ii + after];\n  }\n  return newArray;\n}\n\nvar MAX_ARRAY_MAP_SIZE = SIZE / 4;\nvar MAX_BITMAP_INDEXED_SIZE = SIZE / 2;\nvar MIN_HASH_ARRAY_MAP_SIZE = SIZE / 4;\n\nvar IS_LIST_SYMBOL = '@@__IMMUTABLE_LIST__@@';\n\nfunction isList(maybeList) {\n  return Boolean(maybeList && maybeList[IS_LIST_SYMBOL]);\n}\n\nvar List = /*@__PURE__*/(function (IndexedCollection$$1) {\n  function List(value) {\n    var empty = emptyList();\n    if (value === null || value === undefined) {\n      return empty;\n    }\n    if (isList(value)) {\n      return value;\n    }\n    var iter = IndexedCollection$$1(value);\n    var size = iter.size;\n    if (size === 0) {\n      return empty;\n    }\n    assertNotInfinite(size);\n    if (size > 0 && size < SIZE) {\n      return makeList(0, size, SHIFT, null, new VNode(iter.toArray()));\n    }\n    return empty.withMutations(function (list) {\n      list.setSize(size);\n      iter.forEach(function (v, i) { return list.set(i, v); });\n    });\n  }\n\n  if ( IndexedCollection$$1 ) List.__proto__ = IndexedCollection$$1;\n  List.prototype = Object.create( IndexedCollection$$1 && IndexedCollection$$1.prototype );\n  List.prototype.constructor = List;\n\n  List.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  List.prototype.toString = function toString () {\n    return this.__toString('List [', ']');\n  };\n\n  // @pragma Access\n\n  List.prototype.get = function get (index, notSetValue) {\n    index = wrapIndex(this, index);\n    if (index >= 0 && index < this.size) {\n      index += this._origin;\n      var node = listNodeFor(this, index);\n      return node && node.array[index & MASK];\n    }\n    return notSetValue;\n  };\n\n  // @pragma Modification\n\n  List.prototype.set = function set (index, value) {\n    return updateList(this, index, value);\n  };\n\n  List.prototype.remove = function remove (index) {\n    return !this.has(index)\n      ? this\n      : index === 0\n        ? this.shift()\n        : index === this.size - 1\n          ? this.pop()\n          : this.splice(index, 1);\n  };\n\n  List.prototype.insert = function insert (index, value) {\n    return this.splice(index, 0, value);\n  };\n\n  List.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = this._origin = this._capacity = 0;\n      this._level = SHIFT;\n      this._root = this._tail = null;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyList();\n  };\n\n  List.prototype.push = function push (/*...values*/) {\n    var values = arguments;\n    var oldSize = this.size;\n    return this.withMutations(function (list) {\n      setListBounds(list, 0, oldSize + values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(oldSize + ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.pop = function pop () {\n    return setListBounds(this, 0, -1);\n  };\n\n  List.prototype.unshift = function unshift (/*...values*/) {\n    var values = arguments;\n    return this.withMutations(function (list) {\n      setListBounds(list, -values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.shift = function shift () {\n    return setListBounds(this, 1);\n  };\n\n  // @pragma Composition\n\n  List.prototype.concat = function concat (/*...collections*/) {\n    var arguments$1 = arguments;\n\n    var seqs = [];\n    for (var i = 0; i < arguments.length; i++) {\n      var argument = arguments$1[i];\n      var seq = IndexedCollection$$1(\n        typeof argument !== 'string' && hasIterator(argument)\n          ? argument\n          : [argument]\n      );\n      if (seq.size !== 0) {\n        seqs.push(seq);\n      }\n    }\n    if (seqs.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && seqs.length === 1) {\n      return this.constructor(seqs[0]);\n    }\n    return this.withMutations(function (list) {\n      seqs.forEach(function (seq) { return seq.forEach(function (value) { return list.push(value); }); });\n    });\n  };\n\n  List.prototype.setSize = function setSize (size) {\n    return setListBounds(this, 0, size);\n  };\n\n  List.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    return this.withMutations(function (list) {\n      for (var i = 0; i < this$1.size; i++) {\n        list.set(i, mapper.call(context, list.get(i), i, list));\n      }\n    });\n  };\n\n  // @pragma Iteration\n\n  List.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    if (wholeSlice(begin, end, size)) {\n      return this;\n    }\n    return setListBounds(\n      this,\n      resolveBegin(begin, size),\n      resolveEnd(end, size)\n    );\n  };\n\n  List.prototype.__iterator = function __iterator (type, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    return new Iterator(function () {\n      var value = values();\n      return value === DONE\n        ? iteratorDone()\n        : iteratorValue(type, reverse ? --index : index++, value);\n    });\n  };\n\n  List.prototype.__iterate = function __iterate (fn, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    var value;\n    while ((value = values()) !== DONE) {\n      if (fn(value, reverse ? --index : index++, this) === false) {\n        break;\n      }\n    }\n    return index;\n  };\n\n  List.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyList();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeList(\n      this._origin,\n      this._capacity,\n      this._level,\n      this._root,\n      this._tail,\n      ownerID,\n      this.__hash\n    );\n  };\n\n  return List;\n}(IndexedCollection));\n\nList.isList = isList;\n\nvar ListPrototype = List.prototype;\nListPrototype[IS_LIST_SYMBOL] = true;\nListPrototype[DELETE] = ListPrototype.remove;\nListPrototype.merge = ListPrototype.concat;\nListPrototype.setIn = setIn$1;\nListPrototype.deleteIn = ListPrototype.removeIn = deleteIn;\nListPrototype.update = update$1;\nListPrototype.updateIn = updateIn$1;\nListPrototype.mergeIn = mergeIn;\nListPrototype.mergeDeepIn = mergeDeepIn;\nListPrototype.withMutations = withMutations;\nListPrototype.wasAltered = wasAltered;\nListPrototype.asImmutable = asImmutable;\nListPrototype['@@transducer/init'] = ListPrototype.asMutable = asMutable;\nListPrototype['@@transducer/step'] = function(result, arr) {\n  return result.push(arr);\n};\nListPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nvar VNode = function VNode(array, ownerID) {\n  this.array = array;\n  this.ownerID = ownerID;\n};\n\n// TODO: seems like these methods are very similar\n\nVNode.prototype.removeBefore = function removeBefore (ownerID, level, index) {\n  if (index === level ? 1 << level : this.array.length === 0) {\n    return this;\n  }\n  var originIndex = (index >>> level) & MASK;\n  if (originIndex >= this.array.length) {\n    return new VNode([], ownerID);\n  }\n  var removingFirst = originIndex === 0;\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[originIndex];\n    newChild =\n      oldChild && oldChild.removeBefore(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && removingFirst) {\n      return this;\n    }\n  }\n  if (removingFirst && !newChild) {\n    return this;\n  }\n  var editable = editableVNode(this, ownerID);\n  if (!removingFirst) {\n    for (var ii = 0; ii < originIndex; ii++) {\n      editable.array[ii] = undefined;\n    }\n  }\n  if (newChild) {\n    editable.array[originIndex] = newChild;\n  }\n  return editable;\n};\n\nVNode.prototype.removeAfter = function removeAfter (ownerID, level, index) {\n  if (index === (level ? 1 << level : 0) || this.array.length === 0) {\n    return this;\n  }\n  var sizeIndex = ((index - 1) >>> level) & MASK;\n  if (sizeIndex >= this.array.length) {\n    return this;\n  }\n\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[sizeIndex];\n    newChild =\n      oldChild && oldChild.removeAfter(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && sizeIndex === this.array.length - 1) {\n      return this;\n    }\n  }\n\n  var editable = editableVNode(this, ownerID);\n  editable.array.splice(sizeIndex + 1);\n  if (newChild) {\n    editable.array[sizeIndex] = newChild;\n  }\n  return editable;\n};\n\nvar DONE = {};\n\nfunction iterateList(list, reverse) {\n  var left = list._origin;\n  var right = list._capacity;\n  var tailPos = getTailOffset(right);\n  var tail = list._tail;\n\n  return iterateNodeOrLeaf(list._root, list._level, 0);\n\n  function iterateNodeOrLeaf(node, level, offset) {\n    return level === 0\n      ? iterateLeaf(node, offset)\n      : iterateNode(node, level, offset);\n  }\n\n  function iterateLeaf(node, offset) {\n    var array = offset === tailPos ? tail && tail.array : node && node.array;\n    var from = offset > left ? 0 : left - offset;\n    var to = right - offset;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      if (from === to) {\n        return DONE;\n      }\n      var idx = reverse ? --to : from++;\n      return array && array[idx];\n    };\n  }\n\n  function iterateNode(node, level, offset) {\n    var values;\n    var array = node && node.array;\n    var from = offset > left ? 0 : (left - offset) >> level;\n    var to = ((right - offset) >> level) + 1;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      while (true) {\n        if (values) {\n          var value = values();\n          if (value !== DONE) {\n            return value;\n          }\n          values = null;\n        }\n        if (from === to) {\n          return DONE;\n        }\n        var idx = reverse ? --to : from++;\n        values = iterateNodeOrLeaf(\n          array && array[idx],\n          level - SHIFT,\n          offset + (idx << level)\n        );\n      }\n    };\n  }\n}\n\nfunction makeList(origin, capacity, level, root, tail, ownerID, hash) {\n  var list = Object.create(ListPrototype);\n  list.size = capacity - origin;\n  list._origin = origin;\n  list._capacity = capacity;\n  list._level = level;\n  list._root = root;\n  list._tail = tail;\n  list.__ownerID = ownerID;\n  list.__hash = hash;\n  list.__altered = false;\n  return list;\n}\n\nvar EMPTY_LIST;\nfunction emptyList() {\n  return EMPTY_LIST || (EMPTY_LIST = makeList(0, 0, SHIFT));\n}\n\nfunction updateList(list, index, value) {\n  index = wrapIndex(list, index);\n\n  if (index !== index) {\n    return list;\n  }\n\n  if (index >= list.size || index < 0) {\n    return list.withMutations(function (list) {\n      index < 0\n        ? setListBounds(list, index).set(0, value)\n        : setListBounds(list, 0, index + 1).set(index, value);\n    });\n  }\n\n  index += list._origin;\n\n  var newTail = list._tail;\n  var newRoot = list._root;\n  var didAlter = MakeRef();\n  if (index >= getTailOffset(list._capacity)) {\n    newTail = updateVNode(newTail, list.__ownerID, 0, index, value, didAlter);\n  } else {\n    newRoot = updateVNode(\n      newRoot,\n      list.__ownerID,\n      list._level,\n      index,\n      value,\n      didAlter\n    );\n  }\n\n  if (!didAlter.value) {\n    return list;\n  }\n\n  if (list.__ownerID) {\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(list._origin, list._capacity, list._level, newRoot, newTail);\n}\n\nfunction updateVNode(node, ownerID, level, index, value, didAlter) {\n  var idx = (index >>> level) & MASK;\n  var nodeHas = node && idx < node.array.length;\n  if (!nodeHas && value === undefined) {\n    return node;\n  }\n\n  var newNode;\n\n  if (level > 0) {\n    var lowerNode = node && node.array[idx];\n    var newLowerNode = updateVNode(\n      lowerNode,\n      ownerID,\n      level - SHIFT,\n      index,\n      value,\n      didAlter\n    );\n    if (newLowerNode === lowerNode) {\n      return node;\n    }\n    newNode = editableVNode(node, ownerID);\n    newNode.array[idx] = newLowerNode;\n    return newNode;\n  }\n\n  if (nodeHas && node.array[idx] === value) {\n    return node;\n  }\n\n  if (didAlter) {\n    SetRef(didAlter);\n  }\n\n  newNode = editableVNode(node, ownerID);\n  if (value === undefined && idx === newNode.array.length - 1) {\n    newNode.array.pop();\n  } else {\n    newNode.array[idx] = value;\n  }\n  return newNode;\n}\n\nfunction editableVNode(node, ownerID) {\n  if (ownerID && node && ownerID === node.ownerID) {\n    return node;\n  }\n  return new VNode(node ? node.array.slice() : [], ownerID);\n}\n\nfunction listNodeFor(list, rawIndex) {\n  if (rawIndex >= getTailOffset(list._capacity)) {\n    return list._tail;\n  }\n  if (rawIndex < 1 << (list._level + SHIFT)) {\n    var node = list._root;\n    var level = list._level;\n    while (node && level > 0) {\n      node = node.array[(rawIndex >>> level) & MASK];\n      level -= SHIFT;\n    }\n    return node;\n  }\n}\n\nfunction setListBounds(list, begin, end) {\n  // Sanitize begin & end using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  if (begin !== undefined) {\n    begin |= 0;\n  }\n  if (end !== undefined) {\n    end |= 0;\n  }\n  var owner = list.__ownerID || new OwnerID();\n  var oldOrigin = list._origin;\n  var oldCapacity = list._capacity;\n  var newOrigin = oldOrigin + begin;\n  var newCapacity =\n    end === undefined\n      ? oldCapacity\n      : end < 0\n        ? oldCapacity + end\n        : oldOrigin + end;\n  if (newOrigin === oldOrigin && newCapacity === oldCapacity) {\n    return list;\n  }\n\n  // If it's going to end after it starts, it's empty.\n  if (newOrigin >= newCapacity) {\n    return list.clear();\n  }\n\n  var newLevel = list._level;\n  var newRoot = list._root;\n\n  // New origin might need creating a higher root.\n  var offsetShift = 0;\n  while (newOrigin + offsetShift < 0) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [undefined, newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n    offsetShift += 1 << newLevel;\n  }\n  if (offsetShift) {\n    newOrigin += offsetShift;\n    oldOrigin += offsetShift;\n    newCapacity += offsetShift;\n    oldCapacity += offsetShift;\n  }\n\n  var oldTailOffset = getTailOffset(oldCapacity);\n  var newTailOffset = getTailOffset(newCapacity);\n\n  // New size might need creating a higher root.\n  while (newTailOffset >= 1 << (newLevel + SHIFT)) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n  }\n\n  // Locate or create the new tail.\n  var oldTail = list._tail;\n  var newTail =\n    newTailOffset < oldTailOffset\n      ? listNodeFor(list, newCapacity - 1)\n      : newTailOffset > oldTailOffset\n        ? new VNode([], owner)\n        : oldTail;\n\n  // Merge Tail into tree.\n  if (\n    oldTail &&\n    newTailOffset > oldTailOffset &&\n    newOrigin < oldCapacity &&\n    oldTail.array.length\n  ) {\n    newRoot = editableVNode(newRoot, owner);\n    var node = newRoot;\n    for (var level = newLevel; level > SHIFT; level -= SHIFT) {\n      var idx = (oldTailOffset >>> level) & MASK;\n      node = node.array[idx] = editableVNode(node.array[idx], owner);\n    }\n    node.array[(oldTailOffset >>> SHIFT) & MASK] = oldTail;\n  }\n\n  // If the size has been reduced, there's a chance the tail needs to be trimmed.\n  if (newCapacity < oldCapacity) {\n    newTail = newTail && newTail.removeAfter(owner, 0, newCapacity);\n  }\n\n  // If the new origin is within the tail, then we do not need a root.\n  if (newOrigin >= newTailOffset) {\n    newOrigin -= newTailOffset;\n    newCapacity -= newTailOffset;\n    newLevel = SHIFT;\n    newRoot = null;\n    newTail = newTail && newTail.removeBefore(owner, 0, newOrigin);\n\n    // Otherwise, if the root has been trimmed, garbage collect.\n  } else if (newOrigin > oldOrigin || newTailOffset < oldTailOffset) {\n    offsetShift = 0;\n\n    // Identify the new top root node of the subtree of the old root.\n    while (newRoot) {\n      var beginIndex = (newOrigin >>> newLevel) & MASK;\n      if ((beginIndex !== newTailOffset >>> newLevel) & MASK) {\n        break;\n      }\n      if (beginIndex) {\n        offsetShift += (1 << newLevel) * beginIndex;\n      }\n      newLevel -= SHIFT;\n      newRoot = newRoot.array[beginIndex];\n    }\n\n    // Trim the new sides of the new root.\n    if (newRoot && newOrigin > oldOrigin) {\n      newRoot = newRoot.removeBefore(owner, newLevel, newOrigin - offsetShift);\n    }\n    if (newRoot && newTailOffset < oldTailOffset) {\n      newRoot = newRoot.removeAfter(\n        owner,\n        newLevel,\n        newTailOffset - offsetShift\n      );\n    }\n    if (offsetShift) {\n      newOrigin -= offsetShift;\n      newCapacity -= offsetShift;\n    }\n  }\n\n  if (list.__ownerID) {\n    list.size = newCapacity - newOrigin;\n    list._origin = newOrigin;\n    list._capacity = newCapacity;\n    list._level = newLevel;\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(newOrigin, newCapacity, newLevel, newRoot, newTail);\n}\n\nfunction getTailOffset(size) {\n  return size < SIZE ? 0 : ((size - 1) >>> SHIFT) << SHIFT;\n}\n\nvar OrderedMap = /*@__PURE__*/(function (Map$$1) {\n  function OrderedMap(value) {\n    return value === null || value === undefined\n      ? emptyOrderedMap()\n      : isOrderedMap(value)\n        ? value\n        : emptyOrderedMap().withMutations(function (map) {\n            var iter = KeyedCollection(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v, k) { return map.set(k, v); });\n          });\n  }\n\n  if ( Map$$1 ) OrderedMap.__proto__ = Map$$1;\n  OrderedMap.prototype = Object.create( Map$$1 && Map$$1.prototype );\n  OrderedMap.prototype.constructor = OrderedMap;\n\n  OrderedMap.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedMap.prototype.toString = function toString () {\n    return this.__toString('OrderedMap {', '}');\n  };\n\n  // @pragma Access\n\n  OrderedMap.prototype.get = function get (k, notSetValue) {\n    var index = this._map.get(k);\n    return index !== undefined ? this._list.get(index)[1] : notSetValue;\n  };\n\n  // @pragma Modification\n\n  OrderedMap.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._map.clear();\n      this._list.clear();\n      return this;\n    }\n    return emptyOrderedMap();\n  };\n\n  OrderedMap.prototype.set = function set (k, v) {\n    return updateOrderedMap(this, k, v);\n  };\n\n  OrderedMap.prototype.remove = function remove (k) {\n    return updateOrderedMap(this, k, NOT_SET);\n  };\n\n  OrderedMap.prototype.wasAltered = function wasAltered () {\n    return this._map.wasAltered() || this._list.wasAltered();\n  };\n\n  OrderedMap.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._list.__iterate(\n      function (entry) { return entry && fn(entry[1], entry[0], this$1); },\n      reverse\n    );\n  };\n\n  OrderedMap.prototype.__iterator = function __iterator (type, reverse) {\n    return this._list.fromEntrySeq().__iterator(type, reverse);\n  };\n\n  OrderedMap.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    var newList = this._list.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyOrderedMap();\n      }\n      this.__ownerID = ownerID;\n      this._map = newMap;\n      this._list = newList;\n      return this;\n    }\n    return makeOrderedMap(newMap, newList, ownerID, this.__hash);\n  };\n\n  return OrderedMap;\n}(Map));\n\nOrderedMap.isOrderedMap = isOrderedMap;\n\nOrderedMap.prototype[IS_ORDERED_SYMBOL] = true;\nOrderedMap.prototype[DELETE] = OrderedMap.prototype.remove;\n\nfunction makeOrderedMap(map, list, ownerID, hash) {\n  var omap = Object.create(OrderedMap.prototype);\n  omap.size = map ? map.size : 0;\n  omap._map = map;\n  omap._list = list;\n  omap.__ownerID = ownerID;\n  omap.__hash = hash;\n  return omap;\n}\n\nvar EMPTY_ORDERED_MAP;\nfunction emptyOrderedMap() {\n  return (\n    EMPTY_ORDERED_MAP ||\n    (EMPTY_ORDERED_MAP = makeOrderedMap(emptyMap(), emptyList()))\n  );\n}\n\nfunction updateOrderedMap(omap, k, v) {\n  var map = omap._map;\n  var list = omap._list;\n  var i = map.get(k);\n  var has = i !== undefined;\n  var newMap;\n  var newList;\n  if (v === NOT_SET) {\n    // removed\n    if (!has) {\n      return omap;\n    }\n    if (list.size >= SIZE && list.size >= map.size * 2) {\n      newList = list.filter(function (entry, idx) { return entry !== undefined && i !== idx; });\n      newMap = newList\n        .toKeyedSeq()\n        .map(function (entry) { return entry[0]; })\n        .flip()\n        .toMap();\n      if (omap.__ownerID) {\n        newMap.__ownerID = newList.__ownerID = omap.__ownerID;\n      }\n    } else {\n      newMap = map.remove(k);\n      newList = i === list.size - 1 ? list.pop() : list.set(i, undefined);\n    }\n  } else if (has) {\n    if (v === list.get(i)[1]) {\n      return omap;\n    }\n    newMap = map;\n    newList = list.set(i, [k, v]);\n  } else {\n    newMap = map.set(k, list.size);\n    newList = list.set(list.size, [k, v]);\n  }\n  if (omap.__ownerID) {\n    omap.size = newMap.size;\n    omap._map = newMap;\n    omap._list = newList;\n    omap.__hash = undefined;\n    return omap;\n  }\n  return makeOrderedMap(newMap, newList);\n}\n\nvar IS_STACK_SYMBOL = '@@__IMMUTABLE_STACK__@@';\n\nfunction isStack(maybeStack) {\n  return Boolean(maybeStack && maybeStack[IS_STACK_SYMBOL]);\n}\n\nvar Stack = /*@__PURE__*/(function (IndexedCollection$$1) {\n  function Stack(value) {\n    return value === null || value === undefined\n      ? emptyStack()\n      : isStack(value)\n        ? value\n        : emptyStack().pushAll(value);\n  }\n\n  if ( IndexedCollection$$1 ) Stack.__proto__ = IndexedCollection$$1;\n  Stack.prototype = Object.create( IndexedCollection$$1 && IndexedCollection$$1.prototype );\n  Stack.prototype.constructor = Stack;\n\n  Stack.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Stack.prototype.toString = function toString () {\n    return this.__toString('Stack [', ']');\n  };\n\n  // @pragma Access\n\n  Stack.prototype.get = function get (index, notSetValue) {\n    var head = this._head;\n    index = wrapIndex(this, index);\n    while (head && index--) {\n      head = head.next;\n    }\n    return head ? head.value : notSetValue;\n  };\n\n  Stack.prototype.peek = function peek () {\n    return this._head && this._head.value;\n  };\n\n  // @pragma Modification\n\n  Stack.prototype.push = function push (/*...values*/) {\n    var arguments$1 = arguments;\n\n    if (arguments.length === 0) {\n      return this;\n    }\n    var newSize = this.size + arguments.length;\n    var head = this._head;\n    for (var ii = arguments.length - 1; ii >= 0; ii--) {\n      head = {\n        value: arguments$1[ii],\n        next: head,\n      };\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pushAll = function pushAll (iter) {\n    iter = IndexedCollection$$1(iter);\n    if (iter.size === 0) {\n      return this;\n    }\n    if (this.size === 0 && isStack(iter)) {\n      return iter;\n    }\n    assertNotInfinite(iter.size);\n    var newSize = this.size;\n    var head = this._head;\n    iter.__iterate(function (value) {\n      newSize++;\n      head = {\n        value: value,\n        next: head,\n      };\n    }, /* reverse */ true);\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pop = function pop () {\n    return this.slice(1);\n  };\n\n  Stack.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._head = undefined;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyStack();\n  };\n\n  Stack.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    var resolvedBegin = resolveBegin(begin, this.size);\n    var resolvedEnd = resolveEnd(end, this.size);\n    if (resolvedEnd !== this.size) {\n      // super.slice(begin, end);\n      return IndexedCollection$$1.prototype.slice.call(this, begin, end);\n    }\n    var newSize = this.size - resolvedBegin;\n    var head = this._head;\n    while (resolvedBegin--) {\n      head = head.next;\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  // @pragma Mutability\n\n  Stack.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyStack();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeStack(this.size, this._head, ownerID, this.__hash);\n  };\n\n  // @pragma Iteration\n\n  Stack.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterate(\n        function (v, k) { return fn(v, k, this$1); },\n        reverse\n      );\n    }\n    var iterations = 0;\n    var node = this._head;\n    while (node) {\n      if (fn(node.value, iterations++, this) === false) {\n        break;\n      }\n      node = node.next;\n    }\n    return iterations;\n  };\n\n  Stack.prototype.__iterator = function __iterator (type, reverse) {\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterator(type, reverse);\n    }\n    var iterations = 0;\n    var node = this._head;\n    return new Iterator(function () {\n      if (node) {\n        var value = node.value;\n        node = node.next;\n        return iteratorValue(type, iterations++, value);\n      }\n      return iteratorDone();\n    });\n  };\n\n  return Stack;\n}(IndexedCollection));\n\nStack.isStack = isStack;\n\nvar StackPrototype = Stack.prototype;\nStackPrototype[IS_STACK_SYMBOL] = true;\nStackPrototype.shift = StackPrototype.pop;\nStackPrototype.unshift = StackPrototype.push;\nStackPrototype.unshiftAll = StackPrototype.pushAll;\nStackPrototype.withMutations = withMutations;\nStackPrototype.wasAltered = wasAltered;\nStackPrototype.asImmutable = asImmutable;\nStackPrototype['@@transducer/init'] = StackPrototype.asMutable = asMutable;\nStackPrototype['@@transducer/step'] = function(result, arr) {\n  return result.unshift(arr);\n};\nStackPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nfunction makeStack(size, head, ownerID, hash) {\n  var map = Object.create(StackPrototype);\n  map.size = size;\n  map._head = head;\n  map.__ownerID = ownerID;\n  map.__hash = hash;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_STACK;\nfunction emptyStack() {\n  return EMPTY_STACK || (EMPTY_STACK = makeStack(0));\n}\n\nvar IS_SET_SYMBOL = '@@__IMMUTABLE_SET__@@';\n\nfunction isSet(maybeSet) {\n  return Boolean(maybeSet && maybeSet[IS_SET_SYMBOL]);\n}\n\nfunction isOrderedSet(maybeOrderedSet) {\n  return isSet(maybeOrderedSet) && isOrdered(maybeOrderedSet);\n}\n\nfunction deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (\n    !isCollection(b) ||\n    (a.size !== undefined && b.size !== undefined && a.size !== b.size) ||\n    (a.__hash !== undefined &&\n      b.__hash !== undefined &&\n      a.__hash !== b.__hash) ||\n    isKeyed(a) !== isKeyed(b) ||\n    isIndexed(a) !== isIndexed(b) ||\n    isOrdered(a) !== isOrdered(b)\n  ) {\n    return false;\n  }\n\n  if (a.size === 0 && b.size === 0) {\n    return true;\n  }\n\n  var notAssociative = !isAssociative(a);\n\n  if (isOrdered(a)) {\n    var entries = a.entries();\n    return (\n      b.every(function (v, k) {\n        var entry = entries.next().value;\n        return entry && is(entry[1], v) && (notAssociative || is(entry[0], k));\n      }) && entries.next().done\n    );\n  }\n\n  var flipped = false;\n\n  if (a.size === undefined) {\n    if (b.size === undefined) {\n      if (typeof a.cacheResult === 'function') {\n        a.cacheResult();\n      }\n    } else {\n      flipped = true;\n      var _ = a;\n      a = b;\n      b = _;\n    }\n  }\n\n  var allEqual = true;\n  var bSize = b.__iterate(function (v, k) {\n    if (\n      notAssociative\n        ? !a.has(v)\n        : flipped\n          ? !is(v, a.get(k, NOT_SET))\n          : !is(a.get(k, NOT_SET), v)\n    ) {\n      allEqual = false;\n      return false;\n    }\n  });\n\n  return allEqual && a.size === bSize;\n}\n\n/**\n * Contributes additional methods to a constructor\n */\nfunction mixin(ctor, methods) {\n  var keyCopier = function (key) {\n    ctor.prototype[key] = methods[key];\n  };\n  Object.keys(methods).forEach(keyCopier);\n  Object.getOwnPropertySymbols &&\n    Object.getOwnPropertySymbols(methods).forEach(keyCopier);\n  return ctor;\n}\n\nfunction toJS(value) {\n  if (!value || typeof value !== 'object') {\n    return value;\n  }\n  if (!isCollection(value)) {\n    if (!isDataStructure(value)) {\n      return value;\n    }\n    value = Seq(value);\n  }\n  if (isKeyed(value)) {\n    var result$1 = {};\n    value.__iterate(function (v, k) {\n      result$1[k] = toJS(v);\n    });\n    return result$1;\n  }\n  var result = [];\n  value.__iterate(function (v) {\n    result.push(toJS(v));\n  });\n  return result;\n}\n\nvar Set = /*@__PURE__*/(function (SetCollection$$1) {\n  function Set(value) {\n    return value === null || value === undefined\n      ? emptySet()\n      : isSet(value) && !isOrdered(value)\n        ? value\n        : emptySet().withMutations(function (set) {\n            var iter = SetCollection$$1(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v) { return set.add(v); });\n          });\n  }\n\n  if ( SetCollection$$1 ) Set.__proto__ = SetCollection$$1;\n  Set.prototype = Object.create( SetCollection$$1 && SetCollection$$1.prototype );\n  Set.prototype.constructor = Set;\n\n  Set.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Set.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  Set.intersect = function intersect (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.intersect.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.union = function union (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.union.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.prototype.toString = function toString () {\n    return this.__toString('Set {', '}');\n  };\n\n  // @pragma Access\n\n  Set.prototype.has = function has (value) {\n    return this._map.has(value);\n  };\n\n  // @pragma Modification\n\n  Set.prototype.add = function add (value) {\n    return updateSet(this, this._map.set(value, value));\n  };\n\n  Set.prototype.remove = function remove (value) {\n    return updateSet(this, this._map.remove(value));\n  };\n\n  Set.prototype.clear = function clear () {\n    return updateSet(this, this._map.clear());\n  };\n\n  // @pragma Composition\n\n  Set.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    var removes = [];\n    var adds = [];\n    this.forEach(function (value) {\n      var mapped = mapper.call(context, value, value, this$1);\n      if (mapped !== value) {\n        removes.push(value);\n        adds.push(mapped);\n      }\n    });\n    return this.withMutations(function (set) {\n      removes.forEach(function (value) { return set.remove(value); });\n      adds.forEach(function (value) { return set.add(value); });\n    });\n  };\n\n  Set.prototype.union = function union () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    iters = iters.filter(function (x) { return x.size !== 0; });\n    if (iters.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && iters.length === 1) {\n      return this.constructor(iters[0]);\n    }\n    return this.withMutations(function (set) {\n      for (var ii = 0; ii < iters.length; ii++) {\n        SetCollection$$1(iters[ii]).forEach(function (value) { return set.add(value); });\n      }\n    });\n  };\n\n  Set.prototype.intersect = function intersect () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection$$1(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (!iters.every(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.subtract = function subtract () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection$$1(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (iters.some(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator));\n  };\n\n  Set.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator, mapper));\n  };\n\n  Set.prototype.wasAltered = function wasAltered () {\n    return this._map.wasAltered();\n  };\n\n  Set.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._map.__iterate(function (k) { return fn(k, k, this$1); }, reverse);\n  };\n\n  Set.prototype.__iterator = function __iterator (type, reverse) {\n    return this._map.__iterator(type, reverse);\n  };\n\n  Set.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return this.__empty();\n      }\n      this.__ownerID = ownerID;\n      this._map = newMap;\n      return this;\n    }\n    return this.__make(newMap, ownerID);\n  };\n\n  return Set;\n}(SetCollection));\n\nSet.isSet = isSet;\n\nvar SetPrototype = Set.prototype;\nSetPrototype[IS_SET_SYMBOL] = true;\nSetPrototype[DELETE] = SetPrototype.remove;\nSetPrototype.merge = SetPrototype.concat = SetPrototype.union;\nSetPrototype.withMutations = withMutations;\nSetPrototype.asImmutable = asImmutable;\nSetPrototype['@@transducer/init'] = SetPrototype.asMutable = asMutable;\nSetPrototype['@@transducer/step'] = function(result, arr) {\n  return result.add(arr);\n};\nSetPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nSetPrototype.__empty = emptySet;\nSetPrototype.__make = makeSet;\n\nfunction updateSet(set, newMap) {\n  if (set.__ownerID) {\n    set.size = newMap.size;\n    set._map = newMap;\n    return set;\n  }\n  return newMap === set._map\n    ? set\n    : newMap.size === 0\n      ? set.__empty()\n      : set.__make(newMap);\n}\n\nfunction makeSet(map, ownerID) {\n  var set = Object.create(SetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_SET;\nfunction emptySet() {\n  return EMPTY_SET || (EMPTY_SET = makeSet(emptyMap()));\n}\n\n/**\n * Returns a lazy seq of nums from start (inclusive) to end\n * (exclusive), by step, where start defaults to 0, step to 1, and end to\n * infinity. When start is equal to end, returns empty list.\n */\nvar Range = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function Range(start, end, step) {\n    if (!(this instanceof Range)) {\n      return new Range(start, end, step);\n    }\n    invariant(step !== 0, 'Cannot step a Range by 0');\n    start = start || 0;\n    if (end === undefined) {\n      end = Infinity;\n    }\n    step = step === undefined ? 1 : Math.abs(step);\n    if (end < start) {\n      step = -step;\n    }\n    this._start = start;\n    this._end = end;\n    this._step = step;\n    this.size = Math.max(0, Math.ceil((end - start) / step - 1) + 1);\n    if (this.size === 0) {\n      if (EMPTY_RANGE) {\n        return EMPTY_RANGE;\n      }\n      EMPTY_RANGE = this;\n    }\n  }\n\n  if ( IndexedSeq$$1 ) Range.__proto__ = IndexedSeq$$1;\n  Range.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  Range.prototype.constructor = Range;\n\n  Range.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Range []';\n    }\n    return (\n      'Range [ ' +\n      this._start +\n      '...' +\n      this._end +\n      (this._step !== 1 ? ' by ' + this._step : '') +\n      ' ]'\n    );\n  };\n\n  Range.prototype.get = function get (index, notSetValue) {\n    return this.has(index)\n      ? this._start + wrapIndex(this, index) * this._step\n      : notSetValue;\n  };\n\n  Range.prototype.includes = function includes (searchValue) {\n    var possibleIndex = (searchValue - this._start) / this._step;\n    return (\n      possibleIndex >= 0 &&\n      possibleIndex < this.size &&\n      possibleIndex === Math.floor(possibleIndex)\n    );\n  };\n\n  Range.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    begin = resolveBegin(begin, this.size);\n    end = resolveEnd(end, this.size);\n    if (end <= begin) {\n      return new Range(0, 0);\n    }\n    return new Range(\n      this.get(begin, this._end),\n      this.get(end, this._end),\n      this._step\n    );\n  };\n\n  Range.prototype.indexOf = function indexOf (searchValue) {\n    var offsetValue = searchValue - this._start;\n    if (offsetValue % this._step === 0) {\n      var index = offsetValue / this._step;\n      if (index >= 0 && index < this.size) {\n        return index;\n      }\n    }\n    return -1;\n  };\n\n  Range.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    return this.indexOf(searchValue);\n  };\n\n  Range.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    while (i !== size) {\n      if (fn(value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n      value += reverse ? -step : step;\n    }\n    return i;\n  };\n\n  Range.prototype.__iterator = function __iterator (type, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var v = value;\n      value += reverse ? -step : step;\n      return iteratorValue(type, reverse ? size - ++i : i++, v);\n    });\n  };\n\n  Range.prototype.equals = function equals (other) {\n    return other instanceof Range\n      ? this._start === other._start &&\n          this._end === other._end &&\n          this._step === other._step\n      : deepEqual(this, other);\n  };\n\n  return Range;\n}(IndexedSeq));\n\nvar EMPTY_RANGE;\n\nfunction getIn(collection, searchKeyPath, notSetValue) {\n  var keyPath = coerceKeyPath(searchKeyPath);\n  var i = 0;\n  while (i !== keyPath.length) {\n    collection = get(collection, keyPath[i++], NOT_SET);\n    if (collection === NOT_SET) {\n      return notSetValue;\n    }\n  }\n  return collection;\n}\n\nfunction getIn$1(searchKeyPath, notSetValue) {\n  return getIn(this, searchKeyPath, notSetValue);\n}\n\nfunction hasIn(collection, keyPath) {\n  return getIn(collection, keyPath, NOT_SET) !== NOT_SET;\n}\n\nfunction hasIn$1(searchKeyPath) {\n  return hasIn(this, searchKeyPath);\n}\n\nfunction toObject() {\n  assertNotInfinite(this.size);\n  var object = {};\n  this.__iterate(function (v, k) {\n    object[k] = v;\n  });\n  return object;\n}\n\n// Note: all of these methods are deprecated.\nCollection.isIterable = isCollection;\nCollection.isKeyed = isKeyed;\nCollection.isIndexed = isIndexed;\nCollection.isAssociative = isAssociative;\nCollection.isOrdered = isOrdered;\n\nCollection.Iterator = Iterator;\n\nmixin(Collection, {\n  // ### Conversion to other types\n\n  toArray: function toArray() {\n    assertNotInfinite(this.size);\n    var array = new Array(this.size || 0);\n    var useTuples = isKeyed(this);\n    var i = 0;\n    this.__iterate(function (v, k) {\n      // Keyed collections produce an array of tuples.\n      array[i++] = useTuples ? [k, v] : v;\n    });\n    return array;\n  },\n\n  toIndexedSeq: function toIndexedSeq() {\n    return new ToIndexedSequence(this);\n  },\n\n  toJS: function toJS$1() {\n    return toJS(this);\n  },\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, true);\n  },\n\n  toMap: function toMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return Map(this.toKeyedSeq());\n  },\n\n  toObject: toObject,\n\n  toOrderedMap: function toOrderedMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedMap(this.toKeyedSeq());\n  },\n\n  toOrderedSet: function toOrderedSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedSet(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSet: function toSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return Set(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSetSeq: function toSetSeq() {\n    return new ToSetSequence(this);\n  },\n\n  toSeq: function toSeq() {\n    return isIndexed(this)\n      ? this.toIndexedSeq()\n      : isKeyed(this)\n        ? this.toKeyedSeq()\n        : this.toSetSeq();\n  },\n\n  toStack: function toStack() {\n    // Use Late Binding here to solve the circular dependency.\n    return Stack(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toList: function toList() {\n    // Use Late Binding here to solve the circular dependency.\n    return List(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  // ### Common JavaScript methods and properties\n\n  toString: function toString() {\n    return '[Collection]';\n  },\n\n  __toString: function __toString(head, tail) {\n    if (this.size === 0) {\n      return head + tail;\n    }\n    return (\n      head +\n      ' ' +\n      this.toSeq()\n        .map(this.__toStringMapper)\n        .join(', ') +\n      ' ' +\n      tail\n    );\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  concat: function concat() {\n    var values = [], len = arguments.length;\n    while ( len-- ) values[ len ] = arguments[ len ];\n\n    return reify(this, concatFactory(this, values));\n  },\n\n  includes: function includes(searchValue) {\n    return this.some(function (value) { return is(value, searchValue); });\n  },\n\n  entries: function entries() {\n    return this.__iterator(ITERATE_ENTRIES);\n  },\n\n  every: function every(predicate, context) {\n    assertNotInfinite(this.size);\n    var returnValue = true;\n    this.__iterate(function (v, k, c) {\n      if (!predicate.call(context, v, k, c)) {\n        returnValue = false;\n        return false;\n      }\n    });\n    return returnValue;\n  },\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, true));\n  },\n\n  find: function find(predicate, context, notSetValue) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[1] : notSetValue;\n  },\n\n  forEach: function forEach(sideEffect, context) {\n    assertNotInfinite(this.size);\n    return this.__iterate(context ? sideEffect.bind(context) : sideEffect);\n  },\n\n  join: function join(separator) {\n    assertNotInfinite(this.size);\n    separator = separator !== undefined ? '' + separator : ',';\n    var joined = '';\n    var isFirst = true;\n    this.__iterate(function (v) {\n      isFirst ? (isFirst = false) : (joined += separator);\n      joined += v !== null && v !== undefined ? v.toString() : '';\n    });\n    return joined;\n  },\n\n  keys: function keys() {\n    return this.__iterator(ITERATE_KEYS);\n  },\n\n  map: function map(mapper, context) {\n    return reify(this, mapFactory(this, mapper, context));\n  },\n\n  reduce: function reduce$1(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      false\n    );\n  },\n\n  reduceRight: function reduceRight(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      true\n    );\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, true));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, true));\n  },\n\n  some: function some(predicate, context) {\n    return !this.every(not(predicate), context);\n  },\n\n  sort: function sort(comparator) {\n    return reify(this, sortFactory(this, comparator));\n  },\n\n  values: function values() {\n    return this.__iterator(ITERATE_VALUES);\n  },\n\n  // ### More sequential methods\n\n  butLast: function butLast() {\n    return this.slice(0, -1);\n  },\n\n  isEmpty: function isEmpty() {\n    return this.size !== undefined ? this.size === 0 : !this.some(function () { return true; });\n  },\n\n  count: function count(predicate, context) {\n    return ensureSize(\n      predicate ? this.toSeq().filter(predicate, context) : this\n    );\n  },\n\n  countBy: function countBy(grouper, context) {\n    return countByFactory(this, grouper, context);\n  },\n\n  equals: function equals(other) {\n    return deepEqual(this, other);\n  },\n\n  entrySeq: function entrySeq() {\n    var collection = this;\n    if (collection._cache) {\n      // We cache as an entries array, so we can just return the cache!\n      return new ArraySeq(collection._cache);\n    }\n    var entriesSequence = collection\n      .toSeq()\n      .map(entryMapper)\n      .toIndexedSeq();\n    entriesSequence.fromEntrySeq = function () { return collection.toSeq(); };\n    return entriesSequence;\n  },\n\n  filterNot: function filterNot(predicate, context) {\n    return this.filter(not(predicate), context);\n  },\n\n  findEntry: function findEntry(predicate, context, notSetValue) {\n    var found = notSetValue;\n    this.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        found = [k, v];\n        return false;\n      }\n    });\n    return found;\n  },\n\n  findKey: function findKey(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry && entry[0];\n  },\n\n  findLast: function findLast(predicate, context, notSetValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .find(predicate, context, notSetValue);\n  },\n\n  findLastEntry: function findLastEntry(predicate, context, notSetValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .findEntry(predicate, context, notSetValue);\n  },\n\n  findLastKey: function findLastKey(predicate, context) {\n    return this.toKeyedSeq()\n      .reverse()\n      .findKey(predicate, context);\n  },\n\n  first: function first(notSetValue) {\n    return this.find(returnTrue, null, notSetValue);\n  },\n\n  flatMap: function flatMap(mapper, context) {\n    return reify(this, flatMapFactory(this, mapper, context));\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, true));\n  },\n\n  fromEntrySeq: function fromEntrySeq() {\n    return new FromEntriesSequence(this);\n  },\n\n  get: function get(searchKey, notSetValue) {\n    return this.find(function (_, key) { return is(key, searchKey); }, undefined, notSetValue);\n  },\n\n  getIn: getIn$1,\n\n  groupBy: function groupBy(grouper, context) {\n    return groupByFactory(this, grouper, context);\n  },\n\n  has: function has(searchKey) {\n    return this.get(searchKey, NOT_SET) !== NOT_SET;\n  },\n\n  hasIn: hasIn$1,\n\n  isSubset: function isSubset(iter) {\n    iter = typeof iter.includes === 'function' ? iter : Collection(iter);\n    return this.every(function (value) { return iter.includes(value); });\n  },\n\n  isSuperset: function isSuperset(iter) {\n    iter = typeof iter.isSubset === 'function' ? iter : Collection(iter);\n    return iter.isSubset(this);\n  },\n\n  keyOf: function keyOf(searchValue) {\n    return this.findKey(function (value) { return is(value, searchValue); });\n  },\n\n  keySeq: function keySeq() {\n    return this.toSeq()\n      .map(keyMapper)\n      .toIndexedSeq();\n  },\n\n  last: function last(notSetValue) {\n    return this.toSeq()\n      .reverse()\n      .first(notSetValue);\n  },\n\n  lastKeyOf: function lastKeyOf(searchValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .keyOf(searchValue);\n  },\n\n  max: function max(comparator) {\n    return maxFactory(this, comparator);\n  },\n\n  maxBy: function maxBy(mapper, comparator) {\n    return maxFactory(this, comparator, mapper);\n  },\n\n  min: function min(comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator\n    );\n  },\n\n  minBy: function minBy(mapper, comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator,\n      mapper\n    );\n  },\n\n  rest: function rest() {\n    return this.slice(1);\n  },\n\n  skip: function skip(amount) {\n    return amount === 0 ? this : this.slice(Math.max(0, amount));\n  },\n\n  skipLast: function skipLast(amount) {\n    return amount === 0 ? this : this.slice(0, -Math.max(0, amount));\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, true));\n  },\n\n  skipUntil: function skipUntil(predicate, context) {\n    return this.skipWhile(not(predicate), context);\n  },\n\n  sortBy: function sortBy(mapper, comparator) {\n    return reify(this, sortFactory(this, comparator, mapper));\n  },\n\n  take: function take(amount) {\n    return this.slice(0, Math.max(0, amount));\n  },\n\n  takeLast: function takeLast(amount) {\n    return this.slice(-Math.max(0, amount));\n  },\n\n  takeWhile: function takeWhile(predicate, context) {\n    return reify(this, takeWhileFactory(this, predicate, context));\n  },\n\n  takeUntil: function takeUntil(predicate, context) {\n    return this.takeWhile(not(predicate), context);\n  },\n\n  update: function update(fn) {\n    return fn(this);\n  },\n\n  valueSeq: function valueSeq() {\n    return this.toIndexedSeq();\n  },\n\n  // ### Hashable Object\n\n  hashCode: function hashCode() {\n    return this.__hash || (this.__hash = hashCollection(this));\n  },\n\n  // ### Internal\n\n  // abstract __iterate(fn, reverse)\n\n  // abstract __iterator(type, reverse)\n});\n\nvar CollectionPrototype = Collection.prototype;\nCollectionPrototype[IS_COLLECTION_SYMBOL] = true;\nCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.values;\nCollectionPrototype.toJSON = CollectionPrototype.toArray;\nCollectionPrototype.__toStringMapper = quoteString;\nCollectionPrototype.inspect = CollectionPrototype.toSource = function() {\n  return this.toString();\n};\nCollectionPrototype.chain = CollectionPrototype.flatMap;\nCollectionPrototype.contains = CollectionPrototype.includes;\n\nmixin(KeyedCollection, {\n  // ### More sequential methods\n\n  flip: function flip() {\n    return reify(this, flipFactory(this));\n  },\n\n  mapEntries: function mapEntries(mapper, context) {\n    var this$1 = this;\n\n    var iterations = 0;\n    return reify(\n      this,\n      this.toSeq()\n        .map(function (v, k) { return mapper.call(context, [k, v], iterations++, this$1); })\n        .fromEntrySeq()\n    );\n  },\n\n  mapKeys: function mapKeys(mapper, context) {\n    var this$1 = this;\n\n    return reify(\n      this,\n      this.toSeq()\n        .flip()\n        .map(function (k, v) { return mapper.call(context, k, v, this$1); })\n        .flip()\n    );\n  },\n});\n\nvar KeyedCollectionPrototype = KeyedCollection.prototype;\nKeyedCollectionPrototype[IS_KEYED_SYMBOL] = true;\nKeyedCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.entries;\nKeyedCollectionPrototype.toJSON = toObject;\nKeyedCollectionPrototype.__toStringMapper = function (v, k) { return quoteString(k) + ': ' + quoteString(v); };\n\nmixin(IndexedCollection, {\n  // ### Conversion to other types\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, false);\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, false));\n  },\n\n  findIndex: function findIndex(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  indexOf: function indexOf(searchValue) {\n    var key = this.keyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  lastIndexOf: function lastIndexOf(searchValue) {\n    var key = this.lastKeyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, false));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, false));\n  },\n\n  splice: function splice(index, removeNum /*, ...values*/) {\n    var numArgs = arguments.length;\n    removeNum = Math.max(removeNum || 0, 0);\n    if (numArgs === 0 || (numArgs === 2 && !removeNum)) {\n      return this;\n    }\n    // If index is negative, it should resolve relative to the size of the\n    // collection. However size may be expensive to compute if not cached, so\n    // only call count() if the number is in fact negative.\n    index = resolveBegin(index, index < 0 ? this.count() : this.size);\n    var spliced = this.slice(0, index);\n    return reify(\n      this,\n      numArgs === 1\n        ? spliced\n        : spliced.concat(arrCopy(arguments, 2), this.slice(index + removeNum))\n    );\n  },\n\n  // ### More collection methods\n\n  findLastIndex: function findLastIndex(predicate, context) {\n    var entry = this.findLastEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  first: function first(notSetValue) {\n    return this.get(0, notSetValue);\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, false));\n  },\n\n  get: function get(index, notSetValue) {\n    index = wrapIndex(this, index);\n    return index < 0 ||\n      (this.size === Infinity || (this.size !== undefined && index > this.size))\n      ? notSetValue\n      : this.find(function (_, key) { return key === index; }, undefined, notSetValue);\n  },\n\n  has: function has(index) {\n    index = wrapIndex(this, index);\n    return (\n      index >= 0 &&\n      (this.size !== undefined\n        ? this.size === Infinity || index < this.size\n        : this.indexOf(index) !== -1)\n    );\n  },\n\n  interpose: function interpose(separator) {\n    return reify(this, interposeFactory(this, separator));\n  },\n\n  interleave: function interleave(/*...collections*/) {\n    var collections = [this].concat(arrCopy(arguments));\n    var zipped = zipWithFactory(this.toSeq(), IndexedSeq.of, collections);\n    var interleaved = zipped.flatten(true);\n    if (zipped.size) {\n      interleaved.size = zipped.size * collections.length;\n    }\n    return reify(this, interleaved);\n  },\n\n  keySeq: function keySeq() {\n    return Range(0, this.size);\n  },\n\n  last: function last(notSetValue) {\n    return this.get(-1, notSetValue);\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, false));\n  },\n\n  zip: function zip(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections));\n  },\n\n  zipAll: function zipAll(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections, true));\n  },\n\n  zipWith: function zipWith(zipper /*, ...collections */) {\n    var collections = arrCopy(arguments);\n    collections[0] = this;\n    return reify(this, zipWithFactory(this, zipper, collections));\n  },\n});\n\nvar IndexedCollectionPrototype = IndexedCollection.prototype;\nIndexedCollectionPrototype[IS_INDEXED_SYMBOL] = true;\nIndexedCollectionPrototype[IS_ORDERED_SYMBOL] = true;\n\nmixin(SetCollection, {\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  get: function get(value, notSetValue) {\n    return this.has(value) ? value : notSetValue;\n  },\n\n  includes: function includes(value) {\n    return this.has(value);\n  },\n\n  // ### More sequential methods\n\n  keySeq: function keySeq() {\n    return this.valueSeq();\n  },\n});\n\nSetCollection.prototype.has = CollectionPrototype.includes;\nSetCollection.prototype.contains = SetCollection.prototype.includes;\n\n// Mixin subclasses\n\nmixin(KeyedSeq, KeyedCollection.prototype);\nmixin(IndexedSeq, IndexedCollection.prototype);\nmixin(SetSeq, SetCollection.prototype);\n\n// #pragma Helper functions\n\nfunction reduce(collection, reducer, reduction, context, useFirst, reverse) {\n  assertNotInfinite(collection.size);\n  collection.__iterate(function (v, k, c) {\n    if (useFirst) {\n      useFirst = false;\n      reduction = v;\n    } else {\n      reduction = reducer.call(context, reduction, v, k, c);\n    }\n  }, reverse);\n  return reduction;\n}\n\nfunction keyMapper(v, k) {\n  return k;\n}\n\nfunction entryMapper(v, k) {\n  return [k, v];\n}\n\nfunction not(predicate) {\n  return function() {\n    return !predicate.apply(this, arguments);\n  };\n}\n\nfunction neg(predicate) {\n  return function() {\n    return -predicate.apply(this, arguments);\n  };\n}\n\nfunction defaultZipper() {\n  return arrCopy(arguments);\n}\n\nfunction defaultNegComparator(a, b) {\n  return a < b ? 1 : a > b ? -1 : 0;\n}\n\nfunction hashCollection(collection) {\n  if (collection.size === Infinity) {\n    return 0;\n  }\n  var ordered = isOrdered(collection);\n  var keyed = isKeyed(collection);\n  var h = ordered ? 1 : 0;\n  var size = collection.__iterate(\n    keyed\n      ? ordered\n        ? function (v, k) {\n            h = (31 * h + hashMerge(hash(v), hash(k))) | 0;\n          }\n        : function (v, k) {\n            h = (h + hashMerge(hash(v), hash(k))) | 0;\n          }\n      : ordered\n        ? function (v) {\n            h = (31 * h + hash(v)) | 0;\n          }\n        : function (v) {\n            h = (h + hash(v)) | 0;\n          }\n  );\n  return murmurHashOfSize(size, h);\n}\n\nfunction murmurHashOfSize(size, h) {\n  h = imul(h, 0xcc9e2d51);\n  h = imul((h << 15) | (h >>> -15), 0x1b873593);\n  h = imul((h << 13) | (h >>> -13), 5);\n  h = ((h + 0xe6546b64) | 0) ^ size;\n  h = imul(h ^ (h >>> 16), 0x85ebca6b);\n  h = imul(h ^ (h >>> 13), 0xc2b2ae35);\n  h = smi(h ^ (h >>> 16));\n  return h;\n}\n\nfunction hashMerge(a, b) {\n  return (a ^ (b + 0x9e3779b9 + (a << 6) + (a >> 2))) | 0; // int\n}\n\nvar OrderedSet = /*@__PURE__*/(function (Set$$1) {\n  function OrderedSet(value) {\n    return value === null || value === undefined\n      ? emptyOrderedSet()\n      : isOrderedSet(value)\n        ? value\n        : emptyOrderedSet().withMutations(function (set) {\n            var iter = SetCollection(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v) { return set.add(v); });\n          });\n  }\n\n  if ( Set$$1 ) OrderedSet.__proto__ = Set$$1;\n  OrderedSet.prototype = Object.create( Set$$1 && Set$$1.prototype );\n  OrderedSet.prototype.constructor = OrderedSet;\n\n  OrderedSet.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedSet.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  OrderedSet.prototype.toString = function toString () {\n    return this.__toString('OrderedSet {', '}');\n  };\n\n  return OrderedSet;\n}(Set));\n\nOrderedSet.isOrderedSet = isOrderedSet;\n\nvar OrderedSetPrototype = OrderedSet.prototype;\nOrderedSetPrototype[IS_ORDERED_SYMBOL] = true;\nOrderedSetPrototype.zip = IndexedCollectionPrototype.zip;\nOrderedSetPrototype.zipWith = IndexedCollectionPrototype.zipWith;\n\nOrderedSetPrototype.__empty = emptyOrderedSet;\nOrderedSetPrototype.__make = makeOrderedSet;\n\nfunction makeOrderedSet(map, ownerID) {\n  var set = Object.create(OrderedSetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_ORDERED_SET;\nfunction emptyOrderedSet() {\n  return (\n    EMPTY_ORDERED_SET || (EMPTY_ORDERED_SET = makeOrderedSet(emptyOrderedMap()))\n  );\n}\n\nvar Record = function Record(defaultValues, name) {\n  var hasInitialized;\n\n  var RecordType = function Record(values) {\n    var this$1 = this;\n\n    if (values instanceof RecordType) {\n      return values;\n    }\n    if (!(this instanceof RecordType)) {\n      return new RecordType(values);\n    }\n    if (!hasInitialized) {\n      hasInitialized = true;\n      var keys = Object.keys(defaultValues);\n      var indices = (RecordTypePrototype._indices = {});\n      // Deprecated: left to attempt not to break any external code which\n      // relies on a ._name property existing on record instances.\n      // Use Record.getDescriptiveName() instead\n      RecordTypePrototype._name = name;\n      RecordTypePrototype._keys = keys;\n      RecordTypePrototype._defaultValues = defaultValues;\n      for (var i = 0; i < keys.length; i++) {\n        var propName = keys[i];\n        indices[propName] = i;\n        if (RecordTypePrototype[propName]) {\n          /* eslint-disable no-console */\n          typeof console === 'object' &&\n            console.warn &&\n            console.warn(\n              'Cannot define ' +\n                recordName(this) +\n                ' with property \"' +\n                propName +\n                '\" since that property name is part of the Record API.'\n            );\n          /* eslint-enable no-console */\n        } else {\n          setProp(RecordTypePrototype, propName);\n        }\n      }\n    }\n    this.__ownerID = undefined;\n    this._values = List().withMutations(function (l) {\n      l.setSize(this$1._keys.length);\n      KeyedCollection(values).forEach(function (v, k) {\n        l.set(this$1._indices[k], v === this$1._defaultValues[k] ? undefined : v);\n      });\n    });\n  };\n\n  var RecordTypePrototype = (RecordType.prototype = Object.create(\n    RecordPrototype\n  ));\n  RecordTypePrototype.constructor = RecordType;\n\n  if (name) {\n    RecordType.displayName = name;\n  }\n\n  return RecordType;\n};\n\nRecord.prototype.toString = function toString () {\n  var str = recordName(this) + ' { ';\n  var keys = this._keys;\n  var k;\n  for (var i = 0, l = keys.length; i !== l; i++) {\n    k = keys[i];\n    str += (i ? ', ' : '') + k + ': ' + quoteString(this.get(k));\n  }\n  return str + ' }';\n};\n\nRecord.prototype.equals = function equals (other) {\n  return (\n    this === other ||\n    (other &&\n      this._keys === other._keys &&\n      recordSeq(this).equals(recordSeq(other)))\n  );\n};\n\nRecord.prototype.hashCode = function hashCode () {\n  return recordSeq(this).hashCode();\n};\n\n// @pragma Access\n\nRecord.prototype.has = function has (k) {\n  return this._indices.hasOwnProperty(k);\n};\n\nRecord.prototype.get = function get (k, notSetValue) {\n  if (!this.has(k)) {\n    return notSetValue;\n  }\n  var index = this._indices[k];\n  var value = this._values.get(index);\n  return value === undefined ? this._defaultValues[k] : value;\n};\n\n// @pragma Modification\n\nRecord.prototype.set = function set (k, v) {\n  if (this.has(k)) {\n    var newValues = this._values.set(\n      this._indices[k],\n      v === this._defaultValues[k] ? undefined : v\n    );\n    if (newValues !== this._values && !this.__ownerID) {\n      return makeRecord(this, newValues);\n    }\n  }\n  return this;\n};\n\nRecord.prototype.remove = function remove (k) {\n  return this.set(k);\n};\n\nRecord.prototype.clear = function clear () {\n  var newValues = this._values.clear().setSize(this._keys.length);\n  return this.__ownerID ? this : makeRecord(this, newValues);\n};\n\nRecord.prototype.wasAltered = function wasAltered () {\n  return this._values.wasAltered();\n};\n\nRecord.prototype.toSeq = function toSeq () {\n  return recordSeq(this);\n};\n\nRecord.prototype.toJS = function toJS$1 () {\n  return toJS(this);\n};\n\nRecord.prototype.entries = function entries () {\n  return this.__iterator(ITERATE_ENTRIES);\n};\n\nRecord.prototype.__iterator = function __iterator (type, reverse) {\n  return recordSeq(this).__iterator(type, reverse);\n};\n\nRecord.prototype.__iterate = function __iterate (fn, reverse) {\n  return recordSeq(this).__iterate(fn, reverse);\n};\n\nRecord.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n  if (ownerID === this.__ownerID) {\n    return this;\n  }\n  var newValues = this._values.__ensureOwner(ownerID);\n  if (!ownerID) {\n    this.__ownerID = ownerID;\n    this._values = newValues;\n    return this;\n  }\n  return makeRecord(this, newValues, ownerID);\n};\n\nRecord.isRecord = isRecord;\nRecord.getDescriptiveName = recordName;\nvar RecordPrototype = Record.prototype;\nRecordPrototype[IS_RECORD_SYMBOL] = true;\nRecordPrototype[DELETE] = RecordPrototype.remove;\nRecordPrototype.deleteIn = RecordPrototype.removeIn = deleteIn;\nRecordPrototype.getIn = getIn$1;\nRecordPrototype.hasIn = CollectionPrototype.hasIn;\nRecordPrototype.merge = merge;\nRecordPrototype.mergeWith = mergeWith;\nRecordPrototype.mergeIn = mergeIn;\nRecordPrototype.mergeDeep = mergeDeep$1;\nRecordPrototype.mergeDeepWith = mergeDeepWith$1;\nRecordPrototype.mergeDeepIn = mergeDeepIn;\nRecordPrototype.setIn = setIn$1;\nRecordPrototype.update = update$1;\nRecordPrototype.updateIn = updateIn$1;\nRecordPrototype.withMutations = withMutations;\nRecordPrototype.asMutable = asMutable;\nRecordPrototype.asImmutable = asImmutable;\nRecordPrototype[ITERATOR_SYMBOL] = RecordPrototype.entries;\nRecordPrototype.toJSON = RecordPrototype.toObject =\n  CollectionPrototype.toObject;\nRecordPrototype.inspect = RecordPrototype.toSource = function() {\n  return this.toString();\n};\n\nfunction makeRecord(likeRecord, values, ownerID) {\n  var record = Object.create(Object.getPrototypeOf(likeRecord));\n  record._values = values;\n  record.__ownerID = ownerID;\n  return record;\n}\n\nfunction recordName(record) {\n  return record.constructor.displayName || record.constructor.name || 'Record';\n}\n\nfunction recordSeq(record) {\n  return keyedSeqFromValue(record._keys.map(function (k) { return [k, record.get(k)]; }));\n}\n\nfunction setProp(prototype, name) {\n  try {\n    Object.defineProperty(prototype, name, {\n      get: function() {\n        return this.get(name);\n      },\n      set: function(value) {\n        invariant(this.__ownerID, 'Cannot set on an immutable record.');\n        this.set(name, value);\n      },\n    });\n  } catch (error) {\n    // Object.defineProperty failed. Probably IE8.\n  }\n}\n\n/**\n * Returns a lazy Seq of `value` repeated `times` times. When `times` is\n * undefined, returns an infinite sequence of `value`.\n */\nvar Repeat = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function Repeat(value, times) {\n    if (!(this instanceof Repeat)) {\n      return new Repeat(value, times);\n    }\n    this._value = value;\n    this.size = times === undefined ? Infinity : Math.max(0, times);\n    if (this.size === 0) {\n      if (EMPTY_REPEAT) {\n        return EMPTY_REPEAT;\n      }\n      EMPTY_REPEAT = this;\n    }\n  }\n\n  if ( IndexedSeq$$1 ) Repeat.__proto__ = IndexedSeq$$1;\n  Repeat.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  Repeat.prototype.constructor = Repeat;\n\n  Repeat.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Repeat []';\n    }\n    return 'Repeat [ ' + this._value + ' ' + this.size + ' times ]';\n  };\n\n  Repeat.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._value : notSetValue;\n  };\n\n  Repeat.prototype.includes = function includes (searchValue) {\n    return is(this._value, searchValue);\n  };\n\n  Repeat.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    return wholeSlice(begin, end, size)\n      ? this\n      : new Repeat(\n          this._value,\n          resolveEnd(end, size) - resolveBegin(begin, size)\n        );\n  };\n\n  Repeat.prototype.reverse = function reverse () {\n    return this;\n  };\n\n  Repeat.prototype.indexOf = function indexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return 0;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return this.size;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var i = 0;\n    while (i !== size) {\n      if (fn(this._value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  Repeat.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1 = this;\n\n    var size = this.size;\n    var i = 0;\n    return new Iterator(\n      function () { return i === size\n          ? iteratorDone()\n          : iteratorValue(type, reverse ? size - ++i : i++, this$1._value); }\n    );\n  };\n\n  Repeat.prototype.equals = function equals (other) {\n    return other instanceof Repeat\n      ? is(this._value, other._value)\n      : deepEqual(other);\n  };\n\n  return Repeat;\n}(IndexedSeq));\n\nvar EMPTY_REPEAT;\n\nfunction fromJS(value, converter) {\n  return fromJSWith(\n    [],\n    converter || defaultConverter,\n    value,\n    '',\n    converter && converter.length > 2 ? [] : undefined,\n    { '': value }\n  );\n}\n\nfunction fromJSWith(stack, converter, value, key, keyPath, parentValue) {\n  var toSeq = Array.isArray(value)\n    ? IndexedSeq\n    : isPlainObj(value)\n      ? KeyedSeq\n      : null;\n  if (toSeq) {\n    if (~stack.indexOf(value)) {\n      throw new TypeError('Cannot convert circular structure to Immutable');\n    }\n    stack.push(value);\n    keyPath && key !== '' && keyPath.push(key);\n    var converted = converter.call(\n      parentValue,\n      key,\n      toSeq(value).map(function (v, k) { return fromJSWith(stack, converter, v, k, keyPath, value); }\n      ),\n      keyPath && keyPath.slice()\n    );\n    stack.pop();\n    keyPath && keyPath.pop();\n    return converted;\n  }\n  return value;\n}\n\nfunction defaultConverter(k, v) {\n  return isKeyed(v) ? v.toMap() : v.toList();\n}\n\nvar version = \"4.0.0-rc.11\";\n\nvar Immutable = {\n  version: version,\n\n  Collection: Collection,\n  // Note: Iterable is deprecated\n  Iterable: Collection,\n\n  Seq: Seq,\n  Map: Map,\n  OrderedMap: OrderedMap,\n  List: List,\n  Stack: Stack,\n  Set: Set,\n  OrderedSet: OrderedSet,\n\n  Record: Record,\n  Range: Range,\n  Repeat: Repeat,\n\n  is: is,\n  fromJS: fromJS,\n  hash: hash,\n\n  isImmutable: isImmutable,\n  isCollection: isCollection,\n  isKeyed: isKeyed,\n  isIndexed: isIndexed,\n  isAssociative: isAssociative,\n  isOrdered: isOrdered,\n  isValueObject: isValueObject,\n  isSeq: isSeq,\n  isList: isList,\n  isMap: isMap,\n  isOrderedMap: isOrderedMap,\n  isStack: isStack,\n  isSet: isSet,\n  isOrderedSet: isOrderedSet,\n  isRecord: isRecord,\n\n  get: get,\n  getIn: getIn,\n  has: has,\n  hasIn: hasIn,\n  merge: merge$1,\n  mergeDeep: mergeDeep,\n  mergeWith: mergeWith$1,\n  mergeDeepWith: mergeDeepWith,\n  remove: remove,\n  removeIn: removeIn,\n  set: set,\n  setIn: setIn,\n  update: update,\n  updateIn: updateIn,\n};\n\n// Note: Iterable is deprecated\nvar Iterable = Collection;\n\nexport default Immutable;\nexport { version, Collection, Iterable, Seq, Map, OrderedMap, List, Stack, Set, OrderedSet, Record, Range, Repeat, is, fromJS, hash, isImmutable, isCollection, isKeyed, isIndexed, isAssociative, isOrdered, isValueObject, get, getIn, has, hasIn, merge$1 as merge, mergeDeep, mergeWith$1 as mergeWith, mergeDeepWith, remove, removeIn, set, setIn, update, updateIn };\n","import tinycolor from 'tinycolor2';\nimport { writable } from 'svelte/store'\nimport { fromJS } from 'immutable';\n\nlet ui = {\n  borderSize: 2,\n  selectedMenu: -1,\n  selectedColor: 0,\n  cellSize: 60,\n  pos: [0, 0]\n};\n\nconst store = writable(fromJS(ui));\n\nwindow.dataUI = ui;\nexport default store;\n","<script>\n  import { onMount, onDestroy } from 'svelte';\n  import ui from '../../stores/UI';\n\n  export let xCount;\n  export let yCount;\n  export let toggleCell = (x, y) => false;\n  export let onClick = (x, y) => { };\n  export let onMouseDown = (x, y) => { };\n  export let onMouseUp = (x, y) => { };\n  export let onMouseMove = (x, y) => { };\n  export let disabled = false;\n\n  let canvas;\n  let ctx;\n  let borderSize = 2.5;\n  let cellSize = 25;\n  let rect;\n  let resizeObserver = new ResizeObserver(entries => {\n    rect = canvas.getBoundingClientRect();\n  });\n  let dx = 0;\n  let dy = 0;\n  $: {\n    if(ctx) {\n      syncCanvasDimensions(xCount, yCount);\n    }\n  }\n\n  $: {\n    if(ctx) {\n      drawForm(xCount, yCount, disabled);\n    }\n  }\n\n  onMount(() => {\n    ctx = canvas.getContext('2d');\n    resizeObserver.observe(canvas);\n  });\n  \n  onDestroy(() => {\n    resizeObserver.unobserve(canvas);\n  });\n\n  function syncCanvasDimensions(xCount, yCount) {\n      canvas.width = cellSize * xCount + 2.0 * borderSize;\n      canvas.height = cellSize * yCount + 2.0 * borderSize;\n  }\n\n  function onCanvasMouseDown(event) {\n    if(!disabled) {\n      let indices = getIndices(event);\n      onMouseDown(...indices, event);\n    }\n  }\n\n  function onCanvasMouseMove(event) {\n    if(!disabled) {\n      let indices = getIndices(event);\n      onMouseMove(...indices, event);\n    }\n  }\n\n  function onCanvasMouseUp() {\n    if(!disabled) {\n      let indices = getIndices(event);\n      onMouseUp(...indices, event);\n    }\n  }\n\n  function onCanvasClick() {\n    if(!disabled) {\n      let indices = getIndices(event);\n      onClick(...indices, event);\n    }\n  }\n\n  function getIndices(event) {\n    let canvasSize = rect.width;\n    let size = (canvasSize - borderSize) / xCount;\n    let i = Math.floor(event.offsetX / size);\n    let j = Math.floor(event.offsetY / size);\n    return [i, j];\n  }\n\n  function fillBorders(width, height) {\n    ctx.fillRect(\n      0,\n      0,\n      borderSize,\n      height\n    );\n    ctx.fillRect(\n      width,\n      0,\n      borderSize,\n      height\n    );\n    ctx.fillRect(\n      0,\n      0,\n      width,\n      borderSize\n    );\n    ctx.fillRect(\n      0,\n      height,\n      width + borderSize,\n      borderSize\n    );\n  }\n\n  export function drawForm(xCount, yCount, disabled) {\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    if(disabled) {\n      ctx.fillStyle = 'gray';\n    } else {\n      ctx.fillStyle = 'black';\n    }\n\n    let cw = ctx.canvas.width;\n    let ch = ctx.canvas.height;\n    let size = (cellSize - borderSize / 4.0);\n    let bluppSize = size / 2.0;\n\n    let width = cellSize * xCount + borderSize;\n    let height = cellSize * yCount + borderSize;\n    fillBorders(width, height);\n\n    for(let i = 1; i < xCount; i++) {\n      ctx.fillRect(i * cellSize + borderSize / 2.0, 0, borderSize, height);\n    }\n    for(let i = 1; i < yCount; i++) {\n      ctx.fillRect(0, i * cellSize + borderSize / 2.0, width, borderSize);\n    }\n\n    let innerCellMargin = 10;\n    for(let i = 0; i < xCount; i++) {\n      for(let j = 0; j < yCount; j++) {\n        if(toggleCell(j, i)) {\n          ctx.fillRect(\n            i * cellSize + innerCellMargin / 2.0 + borderSize,\n            j * cellSize + innerCellMargin / 2.0 + borderSize,\n            cellSize - innerCellMargin,\n            cellSize - innerCellMargin\n          );\n        }\n      }\n    }\n  }\n</script>\n\n<canvas\n  on:click={onCanvasClick}\n  on:pointerup={onCanvasMouseUp}\n  on:pointerdown={onCanvasMouseDown}\n  on:pointermove={onCanvasMouseMove}\n  bind:this={canvas}\n  width=\"1\"\n  height=\"1\"\n  class:disabled={disabled}\n  />\n\n<style>\n  .grid {\n    min-height: 100px;\n    min-width: 100px;\n    height: 100%;\n    width: 100%;\n  }\n\n  canvas {\n    image-rendering: crisp-edges;\n  }\n\n  canvas:not(.disabled) {\n    cursor: pointer;\n  }\n\n\n</style>\n","import tinycolor from 'tinycolor2';\nimport { writable } from 'svelte/store'\nimport { fromJS, List } from 'immutable';\nwindow.fromJS = fromJS;\nwindow.List = List;\nlet draft = {};\nif(window.localStorage.getItem('draft')) {\n  draft = JSON.parse(localStorage.getItem('draft'));\n} else {\n  draft = {\n    treadling: [],\n    threading: [],\n    warpColors: new Array(30).fill(0),\n    weftColors: new Array(30).fill(1),\n    tieup: [\n      [1, 0, 0, 1],\n      [0, 0, 1, 1],\n      [0, 1, 1, 0],\n      [1, 1, 0, 0],\n    ],\n    shaftCount: 4,\n    treadleCount: 4,\n    warpCount: 30,\n    pickCount: 30,\n    yarn: [\n      {\n        name: 'White yarn',\n        color: { r: 0.8, g: 0.8, b: 0.8}\n      },\n      {\n        name: 'Black yarn',\n        color: { r: 0.7, g: 0.0, b: 0.0}\n      }\n    ]\n  };\n\n  for(let i = 0; i < draft.warpCount; i++) {\n    draft.threading.push(i % 4);\n  }\n\n  for(let i = 0; i < draft.pickCount; i++) {\n    draft.treadling.push(i % 4);\n  }\n}\n\n\nconst store = writable(fromJS(draft));\nexport default store;\n\nlet d;\nstore.subscribe(value => {\n  let v = value.toJS();\n  window.data = v;\n  d = v;\n  localStorage.setItem('draft', JSON.stringify(v));\n});\n\n//window.draft = draft;\nwindow.update = function() {\n  localStorage.setItem('draft', JSON.stringify(d));\n}\n\nwindow.drop = function() {\n  localStorage.removeItem('draft');\n}\n","import { fromJS } from 'immutable';\nclass DraftUtil {\n  constructor() {\n  }\n\n  updateShaftOrTreadleCounts(draft, shaftCount, treadleCount) {\n    let tieup = new Array(treadleCount);\n    for(let i = 0; i < treadleCount; i++) {\n      tieup[i] = new Array(shaftCount);\n    }\n\n    for(let i = 0; i < treadleCount; i++) {\n      for(let j = 0; j < shaftCount; j++) {\n        if(draft.getIn(['tieup', i]) !== undefined && draft.getIn(['tieup', i, j]) !== undefined) {\n          tieup[i][j] = draft.get(['tieup', i, j]);\n        } else {\n          tieup[i][j] = 0;\n        }\n      }\n    }\n\n    return draft.withMutations((d) => {\n      d.set('shaftCount', shaftCount);\n      d.set('treadleCount', treadleCount);\n      d.set('tieup', fromJS(tieup));\n      return d;\n    });\n  }\n\n  updateWarpCount(draft, warpCount) {\n    let amountToAdd = warpCount - draft.get('warpCount');\n    if(amountToAdd === 0) {\n      return draft;\n    }\n    return draft.withMutations((d) => {\n      d.set('warpCount', warpCount);\n      let warpColors = this.changeArraySize(d.get('warpColors'), amountToAdd);\n      d.set('warpColors', warpColors);\n      let threading = this.changeArraySize(d.get('threading'), amountToAdd);\n      d.set('threading', threading);\n    });\n  }\n\n  updatePickCount(draft, pickCount) {\n    let amountToAdd = pickCount - draft.get('pickCount');\n    if(amountToAdd === 0) {\n      return draft;\n    }\n\n    return draft.withMutations((d) => {\n      d.set('pickCount', pickCount);\n      let weftColors = this.changeArraySize(d.get('weftColors'), amountToAdd);\n      d.set('weftColors', weftColors);\n    });\n  }\n\n  applyPattern(draft, pattern, warpOrWeft, mirroredRepeat) {\n    let newDraft = draft.toJS();\n    let length = warpOrWeft === 'warp' ? newDraft.warpCount : newDraft.pickCount;\n\n    if(warpOrWeft === 'warp') {\n      pattern.reverse();\n    }\n    let array = new Array(length);\n    let offset = 0;\n    for(let i = 0; i < length; i++) {\n      if(mirroredRepeat && (i !== 0 && (i % (pattern.length - 1)) === 0)) {\n        offset += 1;\n      }\n      let j = i + offset;\n      let v = j % (pattern.length);\n      if(mirroredRepeat && (Math.floor(j / pattern.length) % 2) === 1) {\n        v = pattern.length - (j % pattern.length) - 1;\n      }\n      array[i] = pattern[v];\n    }\n\n    if(warpOrWeft === 'warp') {\n      newDraft.threading = array;\n    } else {\n      newDraft.treadling = array;\n    }\n\n    return fromJS(newDraft);\n  }\n\n  changeArraySize(array, amountToAdd, defaultValue = 0) {\n    let newArray = array.withMutations(wc => {\n      if(amountToAdd > 0) {\n        for(let i = 0; i < amountToAdd; i++) {\n          wc.push(defaultValue);\n        }\n      } else {\n        wc = wc.splice(wc.size - amountToAdd);\n      }\n    });\n    return newArray;\n  }\n}\n\nexport default new DraftUtil();\n","<script>\n  import draft from '../../../stores/Draft';\n  import ui from '../../../stores/UI';\n  import DraftUtil from '../../../util/DraftUtil';\n\n  let shaftCount = $draft.get('shaftCount');\n  let treadleCount = $draft.get('treadleCount');\n  let warpCount = $draft.get('warpCount');\n  let pickCount = $draft.get('pickCount');\n  function submit(event) {\n    event.preventDefault();\n    let newDraft = $draft;\n    let changed = false;\n    if(\n      $draft.get('shaftCount') !== shaftCount ||\n      $draft.get('treadleCount') !== treadleCount) {\n      changed = true;\n      newDraft = DraftUtil.updateShaftOrTreadleCounts(newDraft, shaftCount, treadleCount);\n    }\n    if($draft.get('warpCount') !== warpCount) {\n      changed = true;\n      newDraft = DraftUtil.updateWarpCount(newDraft, warpCount);\n    }\n    if($draft.get('pickCount') !== pickCount) {\n      changed = true;\n      newDraft = DraftUtil.updatePickCount(newDraft, pickCount);\n    }\n    if(changed) {\n      draft.update((value) => newDraft);\n    }\n    ui.update(u => u.set('selectedMenu', -1));\n  }\n</script>\n<form on:submit={submit}>\n  <div>\n    <label for=\"shaft-count\">Number of shafts</label>\n    <input type=\"number\" id=\"shaft-count\" bind:value={shaftCount}>\n  </div>\n  <div>\n    <label for=\"treadle-count\">Treadles</label>\n    <input type=\"number\" id=\"treadle-count\" bind:value={treadleCount}>\n  </div>\n  <div>\n    <label for=\"warp-count\">Number of warp threads</label>\n    <input type=\"number\" id=\"warp-count\" bind:value={warpCount}>\n  </div>\n  <div>\n    <label for=\"weft-count\">Number of weft threads</label>\n    <input type=\"number\" id=\"weft-count\" bind:value={pickCount}>\n  </div>\n\n  <button class=\"submit\">Save</button>\n</form>\n<style>\n  form {\n    display: flex;\n    flex-direction: column;\n  }\n\n  form > * {\n    margin: 8px 4px;\n  }\n\n  .tieup input {\n    max-width: 4em;\n  }\n\n</style>\n","export default class VertexArray {\n  constructor(gl, vertexData, indexData, attrs, drawMode = gl.TRIANGLES) {\n    this.gl = gl;\n    if (vertexData instanceof Float32Array) {\n      this.vertexData = vertexData;\n    } else {\n      this.vertexData = new Float32Array(vertexData);\n    }\n\n    if (indexData instanceof Uint16Array) {\n      this.indexData = indexData;\n    } else {\n      this.indexData = new Uint16Array(indexData);\n    }\n\n    this.drawMode = drawMode;\n    this.attrs = attrs;\n    this.initialize(gl);\n  }\n\n  initialize(gl) {\n    this.vertBuf = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertBuf);\n    gl.bufferData(gl.ARRAY_BUFFER, this.vertexData, gl.STATIC_DRAW);\n    if (this.indexData !== undefined) {\n      this.indexBuf = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indexData, gl.STATIC_DRAW);\n    }\n    this.isInitialized = true;\n  }\n\n  bind() {\n    if (this.isInitialized !== true) {\n      console.error('Tried to use uninitialized VertexArray!');\n      return;\n    }\n    const attrSum = this.attrs.reduce((a, b) => a + b);\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertBuf);\n    if (this.indexData !== undefined) {\n      this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\n    }\n    let pointer = 0;\n    for (let i = 0; i < this.attrs.length; i++) {\n      this.gl.vertexAttribPointer(i, this.attrs[i], this.gl.FLOAT, false, attrSum * 4, pointer * 4);\n      this.gl.enableVertexAttribArray(i);\n      pointer += this.attrs[i];\n    }\n  }\n\n  draw() {\n    this.gl.drawElements(this.drawMode, this.indexData.length, this.gl.UNSIGNED_SHORT, 0);\n  }\n\n  unbind() {\n    for (let i = 0; i < this.attrs.length; i++) {\n      this.gl.disableVertexAttribArray(i);\n    }\n    if (this.indexData !== undefined) {\n      this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, null);\n    }\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);\n  }\n\n  free() {\n    this.gl.deleteBuffer(this.vertBuf);\n    if(this.indexBuf) {\n      this.gl.deleteBuffer(this.indexBuf);\n    }\n  }\n}\n","export default class Shader {\n  constructor(src) {\n    this.vert = src.vert;\n    this.frag = src.frag;\n    this.attributes = this.getAttributes(src.vert);\n  }\n\n  getAttributes(source) {\n    return this.vert\n      .split('\\n')\n      .filter(row => row.includes('attribute'))\n      .map(a => a.substring(a.lastIndexOf(' ') + 1, a.length - 1));\n  }\n\n  bind() {\n    if(!this.compiled) {\n      throw new Error(\"Can't bind uncompiled shader\");\n    }\n    this.gl.useProgram(this.program);\n  }\n\n  compile(gl) {\n    this.gl = gl;\n    if (!this.compiled) {\n      this.uniforms = {};\n      const vertProgram = this.compileShader(this.gl, this.vert, gl.VERTEX_SHADER);\n      const fragProgram = this.compileShader(this.gl, this.frag, gl.FRAGMENT_SHADER);\n      this.program = this.createShaderProgram(this.gl, vertProgram, fragProgram);\n      this.compiled = true;\n    }\n  }\n\n  isCompiled() {\n    return this.compiled;\n  }\n\n  compileShader(gl, src, type) {\n    const shader = gl.createShader(type);\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      console.error(`Error when compiling shader: ${gl.getShaderInfoLog(shader)}`);\n      console.groupCollapsed('Shader source');\n      console.log(src);\n      console.groupEnd();\n      return null;\n    }\n    return shader;\n  }\n\n  createShaderProgram(gl, vertexShader, fragmentShader) {\n    const shaderProgram = gl.createProgram();\n    gl.attachShader(shaderProgram, vertexShader);\n    gl.attachShader(shaderProgram, fragmentShader);\n\n    for(let i = 0; i < this.attributes.length; i++) {\n      gl.bindAttribLocation(shaderProgram, i, this.attributes[i]);\n    }\n\n    gl.linkProgram(shaderProgram);\n    if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n      let info = gl.getProgramInfoLog(shaderProgram);\n      console.error(`Error compiling shader: \\n\\n${info}`);\n    }\n    gl.useProgram(shaderProgram);\n    return shaderProgram;\n  }\n\n\n  getUniformHandle(uniformName) {\n    if(this.uniforms[uniformName] === undefined) {\n      let handle = this.gl.getUniformLocation(this.program, uniformName);\n      this.uniforms[uniformName] = handle;\n    }\n    return this.uniforms[uniformName];\n  }\n\n  setBool(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1i(uniformHandle, value?1:0);\n  }\n\n  setInt(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1i(uniformHandle, value);\n  }\n\n  setFloat(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform1f(uniformHandle, value);\n  }\n\n  setVec2(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform2fv(uniformHandle, value);\n  }\n\n  setVec3(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform3fv(uniformHandle, value);\n  }\n\n  setVec4(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniform4fv(uniformHandle, value);\n  }\n\n  setMat3(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniformMatrix3fv(uniformHandle, false, value);\n  }\n\n  setMat4(uniformName, value) {\n    let uniformHandle = this.getUniformHandle(uniformName);\n    this.gl.uniformMatrix4fv(uniformHandle, false, value);\n  }\n\n  setSampler2D(uniformName, value) {\n    this.setInt(uniformName, value);\n  }\n\n  unbind() {\n    this.gl.useProgram(null);\n  }\n}\n\n\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","<script context=\"module\">\n  import { mat4, vec2, vec3, quat } from 'gl-matrix';\n  import tinycolor from 'tinycolor2';\n\n  import { getAngle } from './util';\n  import colorWheelVert from './colorWheel.vert';\n  import colorWheelFrag from './colorWheel.frag';\n  import satValVert from './satVal.vert';\n  import satValFrag from './satVal.frag';\n  import solidFrag from './solid.frag';\n  import solidVert from './solid.vert';\n  import VertexArray from '../WeaveDisplay/gfx/VertexArray';\n  import Shader from '../WeaveDisplay/gfx/shader/Shader';\n  import Ring from './Ring';\n\n  let canvas = document.createElement(\"canvas\");\n  let root = document.body;\n  canvas.setAttribute('class', 'color-input-canvas');\n  canvas.width = 256;\n  canvas.height = 256;\n  let gl = canvas.getContext('webgl', {\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: true\n  });\n  gl.clearColor(0, 0, 0, 1.0);\n\n  let listener;\n  let state = {};\n  let mouseDown = false;\n  let colorWheelToggle = false;\n  let triangleToggle = false;\n\n  let colorWheelShader = new Shader({ frag: colorWheelFrag, vert: colorWheelVert });\n  colorWheelShader.compile(gl);\n  let satValShader = new Shader({ frag: satValFrag, vert: satValVert });\n  satValShader.compile(gl);\n  let solidShader = new Shader({ frag: solidFrag, vert: solidVert });\n  solidShader.compile(gl);\n  \n  let quad = new VertexArray(\n    gl,\n    [\n      1, 1,\n      -1, 1,\n      -1, -1,\n      1, -1\n    ],\n    [1, 0, 2,\n      2, 0, 3],\n    [2]\n  );\n  let t = [\n    [0, 1.0],\n    [0.8660253882408142, -0.5],\n    [-0.8660253882408142, -0.5]\n  ];\n  let triP = t;\n  let triPT = [\n    vec2.create(),\n    vec2.create(),\n    vec2.create()\n  ];\n  let uv = [\n    [1.0, 0.0, 0.0],\n    [0.0, 1.0, 0.0],\n    [0.0, 0.0, 1.0],\n  ];\n  let triUV = uv;\n  let triangle = new VertexArray(\n    gl,\n    [\n      t[0][0], t[0][1], uv[0][0], uv[0][1], uv[0][2],\n      t[1][0], t[1][1], uv[1][0], uv[1][1], uv[1][2],\n      t[2][0], t[2][1], uv[2][0], uv[2][1], uv[2][2],\n    ],\n    [1, 0, 2],\n    [2, 3]\n  );\n  let ring = new Ring(gl, 24, 0.6);\n  let triangleModel = mat4.create();\n\n\n  function onHexInputChange(event) {\n    let str = event.target.value;\n    let color = tinycolor(`#${str}`);\n    if(str.length === 6 && color.isValid()) {\n      let hsv = color.toHsv();\n      updateColor(\n        hsv.h / 360,\n        hsv.s,\n        hsv.v\n      );\n    }\n  }\n\n  function onCanvasMouseDown(event) {\n    event.preventDefault();\n    root.addEventListener('mousemove', onCanvasMouseMove);\n    mouseDown = true;\n    let rect = canvas.getBoundingClientRect();\n    let coords = [\n      2.0 * ((event.clientX - rect.x) / rect.width - 0.5),\n      2.0 * (-(event.clientY - rect.y) / rect.height + 0.5)\n    ];\n    let { hue, saturation, value } = handleInput(coords);\n    updateColor(hue, saturation, value);\n  }\n\n\n  function onCanvasMouseMove(event) {\n    event.preventDefault();\n    if(mouseDown === true && event.buttons === 0) {\n      mouseDown = false;\n      colorWheelToggle = false;\n      triangleToggle = false;\n      root.removeEventListener('mousemove', onCanvasMouseMove);\n      return;\n    }\n    if(mouseDown) {\n      let rect = canvas.getBoundingClientRect();\n      let coords = [\n        2.0 * ((event.clientX - rect.x) / rect.width - 0.5),\n        2.0 * (-(event.clientY - rect.y) / rect.height + 0.5)\n      ];\n      let { hue, saturation, value } = handleInput(coords);\n      updateColor(hue, saturation, value);\n    }\n  }\n\n  function onCanvasMouseUp(event) {\n    event.preventDefault();\n    root.removeEventListener('mousemove', onCanvasMouseMove);\n    mouseDown = false;\n    colorWheelToggle = false;\n    triangleToggle = false;\n  }\n\n  function handleInput(coords) {\n    let { hue, saturation, value } = state;\n    let positionInWheel = getPositionInWheel(coords);\n    if(positionInWheel !== undefined) {\n      hue = positionInWheel;\n      colorWheelToggle = true;\n    }\n    let positionInTriangle = getPositionInTriangle(coords);\n    if (positionInTriangle !== undefined) {\n      let pos = positionInTriangle;\n      if(pos.w + pos.v > 1.0 || pos.v < 0 || pos.w < 0) {\n        pos = getClosestPointToTriangle(pos, coords);\n      }\n\n      value = Math.max(0, Math.min(1.0, 1.0 - pos.w));\n      saturation = Math.max(0, Math.min(1.0, pos.u / value));\n      // Still some weirdness when value is around zero\n      if(Number.isNaN(saturation)) {\n        saturation = 0.0;\n      }\n      triangleToggle = true;\n    }\n    return { hue, saturation, value };\n  }\n\n  function updateColor(hue, saturation, value, fireEvent = true) {\n    let newColor = tinycolor.fromRatio({\n      h: hue,\n      s: saturation,\n      v: value\n    });\n    setState({\n      hue,\n      saturation,\n      value,\n    });\n    let rgb = newColor.toRgb();\n    let ratio = {\n      r: rgb.r / 255,\n      g: rgb.g / 255,\n      b: rgb.b / 255,\n      a: rgb.a\n    };\n\n    if(fireEvent) {\n      emit(ratio);\n    }\n  }\n\n  function getPositionInTriangle(coord) {\n    let a = triPT[0];\n\n    let b = vec2.sub(vec2.create(), triPT[1], a);\n    let c = vec2.sub(vec2.create(), triPT[2], a);\n    let p = vec2.sub(vec2.create(), coord, a);\n\n    let d = b[0]*c[1] - c[0]*b[1];\n    let u = (p[0]*(b[1]-c[1]) + p[1]*(c[0]-b[0]) + b[0]*c[1] - c[0]*b[1])/d;\n    let v = (p[0]*c[1] - p[1]*c[0])/d;\n    let w = (p[1]*b[0]-p[0]*b[1])/d;\n\n    if(!colorWheelToggle && (triangleToggle || (u > 0.0 && u < 1.0 &&\n      v > 0.0 && v < 1.0 &&\n      w > 0.0 && w < 1.0))) {\n      return {\n        u, v, w\n      };\n    }\n    return undefined;\n  }\n\n  function getTriangleCoordinateFromColor(color) {\n    let v = 1.0 - color.value;\n    let s = (1.0 - color.saturation) * color.value;\n\n    let a = triPT[0];\n    let b = triPT[1];\n    let c = triPT[2];\n\n    let v1 = vec2.sub(vec2.create(), b, a);\n    let v2 = vec2.sub(vec2.create(), c, a);\n\n    let r1 = vec2.mul(vec2.create(), v1, [s, s]);\n    let r2 = vec2.mul(vec2.create(), v2, [v, v]);\n    let res = vec2.add(vec2.create(), r1, r2);\n    vec2.add(res, res, a);\n    return res;\n  }\n\n  function getClosestPointToTriangle(pos, coords) {\n    let from;\n    let to;\n    if(pos.w + pos.v > 1.0) {\n      from = triPT[1];\n      to = triPT[2];\n    } else if(pos.v < 0) {\n      from = triPT[0];\n      to = triPT[2];\n    } else if(pos.w < 0) {\n      from = triPT[0];\n      to = triPT[1];\n    }\n    let line = vec2.sub(vec2.create(), from, to);\n    let len = vec2.len(line);\n\n    vec2.normalize(line, line);\n\n    let v = vec2.sub(vec2.create(), coords, to);\n    let d = vec2.dot(v, line);\n    d = Math.max(0, Math.min(len, d));\n    let res = vec2.scaleAndAdd(vec2.create(), to, line, d);\n    return getPositionInTriangle(res);\n  }\n\n  function getPositionInWheel(p) {\n    let center = [0, 0];\n    let dist = vec2.distance(p, center);\n    if(!triangleToggle && (colorWheelToggle || dist > 0.8 && dist < 1.0)) {\n      return getAngle([1, 0], p) / (2.0 * Math.PI);\n    }\n    return undefined;\n  }\n\n  function render() {\n    let color = tinycolor.fromRatio({\n      h: state.hue,\n      s: state.saturation,\n      v: state.value\n    });\n\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    quad.bind();\n\n    let resolution = [\n      canvas.getAttribute('width'),\n      canvas.getAttribute('height')\n    ];\n    colorWheelShader.bind();\n    colorWheelShader.setVec2('resolution', resolution);\n    quad.draw();\n    quad.unbind();\n    colorWheelShader.unbind();\n\n    satValShader.bind();\n    triangle.bind();\n\n    triangleModel = mat4.create();\n    let rot = state.hue * Math.PI * 2.0 - Math.PI/2.0;\n    let hueRot = quat.setAxisAngle(\n      quat.create(),\n      [0, 0, 1],\n      rot\n    );\n    mat4.fromRotationTranslationScale(\n      triangleModel,\n      hueRot,\n      vec3.create(),\n      [0.8, 0.8, 0.8]\n    );\n    vec2.transformMat4(triPT[0], triP[0], triangleModel);\n    vec2.transformMat4(triPT[1], triP[1], triangleModel);\n    vec2.transformMat4(triPT[2], triP[2], triangleModel);\n\n    let mvp2 = mat4.create();\n    mat4.translate(mvp2, mvp2, [0.5, 0.5, 0.0]);\n    mat4.rotate(mvp2, mvp2, rot, [0, 0, 1.0]);\n    mat4.scale(mvp2, mvp2, [0.8, 0.8, 0.8]);\n\n    satValShader.setMat4('mvp', triangleModel);\n    satValShader.setFloat('hue', state.hue);\n    triangle.draw();\n    triangle.unbind();\n    satValShader.unbind();\n\n    solidShader.bind();\n    ring.bind();\n    let pos = getTriangleCoordinateFromColor(state);\n    let svMarkerColor = color.isLight()? [0.0, 0.0, 0.0, 1.0] : [1.0, 1.0, 1.0, 1.0];\n\n    solidShader.setVec4('color', svMarkerColor);\n    solidShader.setMat4('mvp', mat4.fromRotationTranslationScale(\n      mat4.create(),\n      quat.create(),\n      [pos[0], pos[1], 0],\n      [0.03, 0.03, 1.0])\n    );\n\n    ring.draw();\n    ring.unbind();\n\n    let hue = tinycolor.fromRatio({\n      h: state.hue,\n      s: 1.0,\n      v: 1.0\n    });\n    let hueMarkerColor = hue.isLight()? [0.0, 0.0, 0.0, 1.0] : [1.0, 1.0, 1.0, 1.0];\n    let hueMarkerMatrix = mat4.create();\n    let quatMat = mat4.fromQuat(mat4.create(), hueRot);\n    mat4.multiply(hueMarkerMatrix, hueMarkerMatrix, quatMat);\n    mat4.translate(hueMarkerMatrix, hueMarkerMatrix, [0, 0.9, 0]);\n    mat4.scale(hueMarkerMatrix, hueMarkerMatrix, [0.015, 0.1, 1.0]);\n    quad.bind();\n    solidShader.setVec4('color', hueMarkerColor);\n    solidShader.setMat4('mvp', hueMarkerMatrix);\n    quad.draw();\n    quad.unbind();\n    solidShader.unbind();\n  }\n\n  function setColor(color) {\n    let c = tinycolor.fromRatio(color);\n    let hsv = c.toHsv();\n    updateColor(\n      hsv.h / 360,\n      hsv.s,\n      hsv.v,\n      false\n    );\n  }\n\n  function emit(color) {\n    listener(color);\n  }\n\n  function setState(newState) {\n    state = newState;\n    render();\n  }\n\n    canvas.addEventListener('mousedown', onCanvasMouseDown);\n    canvas.addEventListener('mouseup', onCanvasMouseUp);\n\n</script>\n<script>\n  import { onMount,onDestroy } from 'svelte';\n  export let value;\n  export let onChange = () => {};\n\n  let elm;\n  let beforeElm;\n\n  let color = tinycolor.fromRatio(value);\n  let hsv = color.toHsv();\n  let hexString = color.toHex();\n  let state = {\n    hue: hsv.h / 360,\n    value: hsv.v,\n    saturation: hsv.s,\n  };\n  let c2;\n\n  setState(state);\n\n  function canvasColorChange(inColor) {\n    color = tinycolor.fromRatio(inColor);\n    hexString = color.toHex();\n    onChange(inColor);\n  }\n\n  onMount(() => {\n    elm.insertBefore(canvas, beforeElm);\n    listener = canvasColorChange;\n    render(state);\n  });\n\n</script>\n<div class=\"color-picker\" bind:this={elm}>\n  <div\n    bind:this={beforeElm}\n    class=\"color-input-color\"\n    style=\"{`background-color: #${hexString}`}\"\n    >\n    <input\n      type=\"text\"\n      spellCheck=\"false\"\n      maxLength=\"6\"\n      style={`color: ${(color.isLight() ? 'black' : 'white')}`}\n      value={hexString}\n      on:input={onHexInputChange}\n      on:paste={onHexInputChange}\n      />\n  </div>\n</div>\n<style>\n  :global(.color-input-canvas) {\n    margin: auto;\n    display: flex;\n  }\n\n  .color-picker .color-input-color {\n    margin: 0.2em;\n    margin-top: 0.5em;\n    border: 1px solid black;\n    border-radius: 4px;\n  }\n\n  .color-picker .color-input-color input {\n    background: none;\n    border: none;\n    width: 100%;\n    text-align: center;\n    font-size: 14pt;\n    margin: 0;\n  }\n\n</style>\n","import VertexArray from '../WeaveDisplay/gfx/VertexArray';\nimport Geometry from '../WeaveDisplay/gfx/geometry/Geometry';\n\nfunction generateGeometry(gl, numPoints, innerRadius) {\n  let points = [0, 0, 0];\n  let indices = [];\n  for(let i = 0; i < (numPoints + 1) * 2; i++) {\n    let rad = (Math.PI / numPoints) * i;\n    let justify = [\n      ((1.0 - innerRadius) / 2) * Math.sin(rad),\n      (1.0 - innerRadius) / 2 * Math.cos(rad)\n    ];\n\n    if(i % 2 === 0) {\n      points.push(Math.sin(rad) + justify[0]);\n      points.push(Math.cos(rad) + justify[1]);\n    } else {\n      points.push(Math.sin(rad) * innerRadius + justify[0]);\n      points.push(Math.cos(rad) * innerRadius + justify[1]);\n    }\n    points.push(0);\n  }\n\n  for(let i = 0; i < numPoints; i++) {\n    [3, 2, 1, 3, 4, 2]\n      .map(n => n + i*2)\n      .forEach(n => indices.push(n));\n  }\n  return new VertexArray(gl, points, indices, [3], gl.TRIANGLES);\n}\n\nexport default class Ring extends Geometry {\n  constructor(gl, points = 6, innerRadius = 0.5) {\n    super();\n    this.points = points;\n    this.geometry = generateGeometry(gl, points, innerRadius);\n  }\n}\n","export default class Geometry {\n  bind(gl) {\n    this.geometry.bind(gl);\n  }\n\n  unbind(gl) {\n    this.geometry.bind(gl);\n  }\n\n  draw(gl) {\n    this.geometry.draw(gl);\n  }\n}\n","import { vec2 } from 'gl-matrix';\n\nexport function getAngle(v1, v2) {\n  let v1n = vec2.normalize(vec2.create(), v1);\n  let v2n = vec2.normalize(vec2.create(), v2);\n  let dot = vec2.dot(v1n, v2n);\n  let det = v1n[0]*v2n[1] - v1n[1]*v2n[0];\n  let rad = Math.atan2(det, dot);\n  if(rad < 0) {\n    rad += 2*Math.PI;\n  }\n  return rad;\n}\n\n","<script>\n  import tinycolor from 'tinycolor2';\n  import { fromJS } from 'immutable';\n  import draft from '../../../stores/Draft';\n  import ui from '../../../stores/UI';\n  import ColorPicker from '../../ColorPicker/ColorPicker.svelte';\n\n  import add from 'icons/add.svg';\n\n  let colors;\n  $: {\n    colors = $draft.get('yarn').map(y => y.get('color')).toJS().map(c => tinycolor.fromRatio(c));\n  }\n  let color = {r: 1.0, g: 0.0, b: 0.0};\n\n  let newYarnName = \"\";\n  let newYarnColor = color;\n  let yarnUnderModification = -1;\n\n  let yarnsElm;\n  let settingsElm;\n\n  function focus(elm){\n    elm.focus()\n  }\n\n  function createNewYarn(event) {\n    event.preventDefault();\n    draft.update((value) =>\n      value.update('yarn', y =>\n      y.push(fromJS({ name: newYarnName, color: newYarnColor }))));\n    newYarnName = \"\";\n    newYarnColor = color;\n  }\n\n  function selectYarnForModification(event, i) {\n    yarnUnderModification = i;\n    if(i !== $draft.get('yarn').size) {\n      newYarnColor = $draft.getIn(['yarn', i, 'color']).toJS();\n    }\n  }\n\n  function maybeCancel(event) {\n    if(event.target === settingsElm) {\n      yarnUnderModification = -1;\n      event.stopPropagation();\n    }\n  }\n\n  function updateYarn(event, index, yarn) {\n    event.preventDefault();\n    draft.update(d => d.updateIn(['yarn', index], y => fromJS({\n      name: yarn.name,\n      color: fromJS(newYarnColor)\n    })));\n    yarnUnderModification = -1;\n  }\n\n  function deleteColor(index) {\n    draft.update((value) => {\n      value.yarn.splice(index, 1);\n      return value;\n    });\n    yarnUnderModification = -1;\n  }\n\n</script>\n<div class=\"settings\" on:click={maybeCancel} bind:this={settingsElm}>\n  <div class=\"yarns\" bind:this={yarnsElm}>\n    {#each $draft.get('yarn').toJS() as yarn, i}\n      {#if yarnUnderModification === i}\n        <form class=\"yarn\" on:submit={() => updateYarn(event, i, yarn)}>\n          <div class=\"top-row\">\n            <div>\n              <label for=\"newYarnName\">Name</label>\n              <input type=\"text\" id=\"newYarnName\" bind:value={yarn.name} use:focus />\n            </div>\n            <button class=\"delete\" on:click={() => deleteColor(i)}>Delete</button>\n          </div>\n          <ColorPicker onChange={(value) => newYarnColor = value} value={yarn.color} />\n          <button class=\"primary\">Save</button>\n        </form>\n      {:else}\n        <div class=\"yarn\">\n          <button\n            class=\"color\"\n            style={`\n            background-color: ${colors[i].toHexString()};\n            border-color: ${colors[i].isLight() ? 'black' : 'white'};\n            color: ${colors[i].isLight() ? 'black' : 'white'}\n            `}\n            on:click={(e) => selectYarnForModification(e, i)}\n            >\n            {yarn.name}\n          </button>\n        </div>\n      {/if}\n    {/each}\n    {#if yarnUnderModification === $draft.get('yarn').size}\n      <form class=\"yarn\" on:submit={createNewYarn}>\n        <label for=\"newYarnName\">Name</label>\n        <input type=\"text\" id=\"newYarnName\" bind:value={newYarnName} use:focus />\n        <ColorPicker onChange={(value) => newYarnColor = value} value={color} />\n        <button class=\"primary\">Save</button>\n      </form>\n    {:else}\n      <button on:click={(e) => selectYarnForModification(e, $draft.get('yarn').size)}>\n        <div class=\"icon\">{@html add}</div>\n        <span>Add new yarn</span>\n      </button>\n    {/if}\n  </div>\n</div>\n<style>\n  .yarns {\n    padding: 10px;\n    background-color: lightgray;\n  }\n\n  .yarns .yarn {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .yarns .yarn:not(:first-child):before {\n    content: \"\";\n    height: 1.5px;\n    background-color: rgba(0, 0, 0, 0.2);\n    margin: 10px 0;\n    position: relative;\n    left: -10px;\n    width: calc(100% + 20px);\n  }\n\n  .color {\n    border: 1px solid black;\n  }\n\n  button {\n    background-color: white;\n    display: flex;\n    align-items: baseline;\n    width: 100%;\n  }\n\n  input {\n    width: 100%;\n    background-color: white;\n  }\n\n  .icon {\n    width: 14px;\n    height: 14px;\n    margin-right: 8px;\n  }\n\n  .settings {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    min-width: 300px;\n    height: 100%;\n  }\n\n  button.delete {\n    width: initial;\n    margin: 4px;\n    background-color: red;\n    color: white;\n    background-color: #d91b1b;\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 8px;\n    margin-right: 0;\n  }\n\n  .top-row {\n    display: flex;\n  }\n\n</style>\n","export function line(x0, y0, x1, y1) {\n  let points = [];\n\n  let dx = Math.abs(x1 - x0);\n  let sx = x0 < x1 ? 1 : -1;\n  let dy = -Math.abs(y1 - y0);\n  let sy = y0 < y1 ? 1 : -1;\n  let err = dx + dy;\n  while(true) {\n    points.push([x0, y0]);\n    if(x0 === x1 && y0 === y1) {\n      break;\n    }\n    let e2 = 2 * err;\n    if(e2 >= dy) {\n      err += dy;\n      x0 += sx;\n    }\n    if(e2 <= dx) {\n      err += dx;\n      y0 += sy;\n    }\n  }\n  return points;\n}\n\n","<script>\n  import draft from '../../../stores/Draft';\n  import draftUtil from '../../../util/DraftUtil';\n  import ui from '../../../stores/UI';\n  import Grid from '../../Grid/Grid.svelte';\n  import gridIcon from 'icons/grid.svg';\n  import { line } from '../../../util/MathUtil';\n\n  let prevWarpOrWeft;\n\n  let grid;\n  let xCount = $draft.get('treadleCount');\n  let yCount = $draft.get('shaftCount');\n  let mirroredRepeat = true;\n  let cellData = new Array(xCount);\n  cellData = [0,1,2,3];\n  let warpOrWeft = 'warp';\n\n  let isDragging = false;\n  let fromPos = undefined;\n  let linePoints = [];\n\n  $: {\n    if(warpOrWeft !== prevWarpOrWeft) {\n      let temp = xCount;\n      xCount = yCount;\n      yCount = temp;\n      prevWarpOrWeft = warpOrWeft;\n    }\n  }\n\n\n  function increment() {\n    if(warpOrWeft === 'warp') {\n      xCount++;\n    } else if(warpOrWeft === 'weft') {\n      yCount++;\n    }\n  }\n\n  function decrement() {\n    if(warpOrWeft === 'warp') {\n      xCount--;\n    } else if(warpOrWeft === 'weft') {\n      yCount--;\n    }\n  }\n\n  function apply() {\n    let newPattern = draftUtil.applyPattern($draft, cellData, warpOrWeft, mirroredRepeat);\n    draft.update(value => newPattern);\n    $ui.selectedMenu = -1;\n  }\n\n  function onGridClick(i, j) {\n    if(isDragging) {\n      return;\n    }\n    if(warpOrWeft === 'warp') {\n      cellData[i] = j;\n    } else if(warpOrWeft === 'weft') {\n      cellData[j] = i;\n    }\n    grid.drawForm(xCount, yCount, false);\n  }\n\n  function onGridMouseDown(i, j, event) {\n    fromPos = [i, j]\n    linePoints = [[i, j]];\n  }\n\n  function onGridMouseMove(i, j, event) {\n    if(event.buttons === 0) {\n      fromPos = undefined;\n      isDragging = false;\n      return;\n    }\n    if((event.buttons & 1) && ((event.movementX !== 0) || (event.movementY !== 0))) {\n      isDragging = true;\n    }\n    let lp = line(...fromPos, i, j);\n    linePoints = [];\n    lp.forEach(p => {\n      if(warpOrWeft === 'weft') {\n        linePoints[p[1]] = p[0];\n      } else if(warpOrWeft === 'warp') {\n        linePoints[p[0]] = p[1];\n      }\n    });\n    linePoints = addArrays(linePoints, cellData);\n    grid.drawForm(xCount, yCount, false);\n  }\n\n  function onGridMouseUp(i, j, event) {\n    if(isDragging) {\n      cellData = addArrays(linePoints, cellData);\n      fromPos = undefined;\n      linePoints = undefined;\n      isDragging = false;\n      grid.drawForm(xCount, yCount, false);\n    }\n  }\n\n  function addArrays(left, right) {\n    let ret = [...right];\n    for(let i = 0; i < left.length; i++) {\n      if(left[i] !== undefined) {\n        ret[i] = left[i];\n      }\n    }\n    return ret;\n  }\n\n  function toggleCell(i, j) {\n    let x, y;\n    if(warpOrWeft === 'warp') {\n      x = j;\n      y = i;\n    } else if(warpOrWeft === 'weft') {\n      x = i;\n      y = j;\n    }\n\n    if(isDragging) {\n      return linePoints[x] === y;\n    } else {\n      return cellData[x] === y;\n    }\n  }\n\n</script>\n<div class=\"pattern-fill\">\n  <div class=\"button-group\">\n    <div class=\"warp\">\n      <input\n        type=\"radio\"\n              id=\"warp\"\n              name=\"warp-or-weft\"\n              value=\"warp\"\n              class:notActive={warpOrWeft === undefined}\n              bind:group={warpOrWeft}>\n      <label for=\"warp\">Warp {@html gridIcon}</label>\n    </div>\n    <div class=\"weft\">\n      <input\n        type=\"radio\"\n              id=\"weft\"\n              name=\"warp-or-weft\"\n              value=\"weft\"\n              bind:group={warpOrWeft}>\n      <label for=\"weft\">Weft {@html gridIcon}</label>\n    </div>\n  </div>\n  {#if warpOrWeft !== undefined}\n    <div class={\"canvas \" + warpOrWeft}>\n      <Grid\n        bind:this={grid}\n        xCount={xCount}\n        yCount={yCount}\n        toggleCell={toggleCell}\n        onClick={onGridClick}\n        onMouseDown={onGridMouseDown}\n        onMouseUp={onGridMouseUp}\n        onMouseMove={onGridMouseMove}\n        disabled={warpOrWeft === undefined}\n        />\n        <button on:click={decrement}>-</button>\n        <button on:click={increment}>+</button>\n    </div>\n    <div>\n      <label for=\"mirrored-repeat\">Mirrored repeat</label>\n      <input type=\"checkbox\" bind:checked={mirroredRepeat} name=\"mirrored-repeat\" id=\"mirrored-repeat\" />\n    </div>\n    <button on:click={apply}>Apply</button>\n  {/if}\n</div>\n<style>\n  .pattern-fill {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .button-group :global(svg) {\n    width: 50px;\n    stroke: var(--color-1);\n    fill: var(--color-1);\n  }\n\n  .button-group {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    margin: 12px 0px;\n  }\n\n  .button-group input {\n    display: none;\n  }\n\n  .button-group label {\n    padding: 4px;\n    height: 50px;\n    cursor: pointer;\n    border: 3px solid var(--color-2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: var(--color-2);\n    color: var(--color-1);\n  }\n\n  input:checked + label {\n    background-color: var(--color-1);\n    color: var(--color-2);\n  }\n\n  input:checked + label :global(svg) {\n    stroke: var(--color-2);\n    fill: var(--color-2);\n  }\n\n  .button-group div {\n    flex-grow: 1;\n    text-align: center;\n    cursor: pointer;\n    background-color: white;\n  }\n\n  .button-group div:first-child label {\n    border-radius: 8px 0 0 8px;\n    border-right: 2px solid rgba(0, 0, 0, 0.2);\n  }\n\n  .button-group div:last-child label {\n    border-left: 0;\n    border-radius: 0 8px 8px 0;\n  }\n\n  .weft :global(svg) {\n    transform: rotateZ(90deg);\n  }\n\n  .warp label {\n    flex-direction: column;\n  }\n\n  .canvas {\n    display: flex;\n  }\n\n  .canvas button {\n    margin: 0;\n    background-color: gray;\n    border: 1px solid black;\n    min-width: 30px;\n    min-height: 30px;\n  }\n\n  .canvas.weft {\n    flex-direction: column;\n  }\n\n  .canvas.warp {\n    flex-direction: row;\n  }\n\n  .canvas :global(canvas) {\n    flex-grow: 1;\n  }\n\n</style>\n","<script>\n  import { onMount } from 'svelte';\n  import { Router, Link, Route, link } from 'svelte-navigator';\n  import HelpIcon from 'icons/help.svg';\n  import BackIcon from 'icons/back.svg';\n  import ScarfIcon from 'icons/scarf.svg'\n  import YarnIcon from 'icons/yarn.svg'\n  import PatternBucket from 'icons/pattern-bucket.svg'\n\n  import ui from '../../stores/UI';\n  import WeaveSettings from './pages/WeaveSettings.svelte';\n  import YarnSettings from './pages/YarnSettings.svelte';\n  import PatternFill from './pages/PatternFill.svelte';\n\n  let items = [\n    {\n      icon: ScarfIcon,\n      title: 'Weave settings',\n      component: WeaveSettings\n    },\n    {\n      icon: YarnIcon,\n      title: 'Yarns',\n      component: YarnSettings\n    },\n    {\n      icon: PatternBucket,\n      title: 'Fill with pattern',\n      component: PatternFill,\n    },\n  ];\n  let sidebarWidth;\n  let sidebar;\n  onMount(() => {\n    sidebarWidth = sidebar.getBoundingClientRect().width;\n  });\n\n  function selectMenu(index) {\n    ui.update(u => u.update('selectedMenu', s => s === index ? -1 : index));\n  }\n</script>\n\n<Router primary={false}>\n  <div class=\"sidebar-container\">\n    <div class=\"sidebar\" bind:this={sidebar} >\n      {#each items as item, i}\n        <button class=\"icon-button\" on:click={() => selectMenu(i)}>\n      <div class={\"icon\"}>\n            {@html item.icon}\n          </div>\n        </button>\n      {/each}\n\n      <div class=\"help\">\n        <Route path=\"/\">\n          <a href=\"weaver/about\" use:link>\n            <div class=\"icon\">\n              {@html HelpIcon}\n            </div>\n          </a>\n        </Route>\n        <Route path=\"about\">\n        <a class=\"help\" href=\"/\" use:link>\n          <div class=\"icon\">\n            {@html BackIcon}\n          </div>\n        </a>\n        </Route>\n      </div>\n\n    </div>\n\n    {#if $ui.get('selectedMenu') !== -1}\n      <div class=\"settings-sidebar\" style={`left: ${sidebarWidth}px`}>\n        <div class=\"settings\">\n          <h2>{items[$ui.get('selectedMenu')].title}</h2>\n          <svelte:component this={items[$ui.get('selectedMenu')].component} />\n        </div>\n        <div class=\"overlay\" on:click={() => selectMenu(-1)}>\n        </div>\n      </div>\n    {/if}\n  </div>\n</Router>\n\n<style>\n  .icon {\n    fill: var(--color-1);\n    stroke: var(--color-1);\n    width: 50px;\n    height: 50px;\n  }\n\n  .icon-button {\n    background-color: var(--color-2);\n    border-radius: 4px;\n    border: 1px black;\n  }\n\n  .sidebar-container {\n    display: flex;\n    z-index: 10;\n  }\n\n  .sidebar {\n    width: 50px;\n    background-color: #40362A;\n    padding: 10px 20px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .sidebar > * {\n    margin: 10px;\n  }\n\n  .help {\n    display: flex;\n    flex-direction: column-reverse;\n    flex-grow: 1;\n  }\n\n  .settings-sidebar {\n    max-height: 100vh;\n    overflow: auto;\n  }\n\n  .settings {\n    background-color: white;\n    padding: 20px;\n    border-right: 1px solid var(--color-4);\n  }\n\n  .overlay {\n    background-color: rgba(0.0, 0.0, 0.0, 0.4);\n    flex-grow: 1;\n  }\n\n  .pattern-bucket {\n  }\n</style>\n","import solidFrag from './glsl/solid.frag';\nimport weaveFrag from './glsl/weave.frag';\nimport weaveVert from './glsl/weave.vert';\nimport textureFrag from './glsl/textureShader.frag';\nimport gridFrag from './glsl/grid.frag';\nimport tieupFrag from './glsl/tieup.frag';\nimport colorRowFrag from './glsl/colorRow.frag';\nimport genUV2D from './glsl/genUV2D.vert';\nimport Shader from './Shader';\n\nfunction buildShader(name) {\n  switch(name) {\n    case 'texture': return new Shader({ frag: textureFrag, vert: genUV2D });\n    case 'solid': return new Shader({ frag: solidFrag, vert: genUV2D });\n    case 'weave': return new Shader({ frag: weaveFrag, vert: genUV2D });\n    case 'grid': return new Shader({ frag: gridFrag, vert: genUV2D });\n    case 'tieup': return new Shader({ frag: tieupFrag, vert: genUV2D });\n    case 'colorRow': return new Shader({ frag: colorRowFrag, vert: genUV2D });\n    default: return undefined;\n  }\n}\n\nexport default class ShaderBuilder {\n  constructor(gl) {\n    this.gl = gl;\n    this.shaderCache = {};\n  }\n\n  getShader(shaderName) {\n    let shader = this.shaderCache[shaderName];\n    if(shader === undefined) {\n      shader = buildShader(shaderName);\n      if(shader === undefined) {\n        throw new Error(`Unknown shader name ${shaderName}`);\n      }\n      shader.compile(this.gl);\n      this.shaderCache[shaderName] = shader;\n    }\n    return shader;\n  }\n}\n","export default class Texture {\n  constructor(gl, width, height, data) {\n    this.gl = gl;\n    if(width === undefined || height === undefined) {\n      throw new Error(\"Undefined width/height of texture\")\n    }\n    this.width = width;\n    this.height = height;\n\n\n    if (data instanceof Uint8Array) {\n      this.color = data;\n    } else {\n      this.color = new Uint8Array(data.length * 4);\n      for(let i = 0; i < data.length; i++) {\n        let d = data[i];\n        let n = i * 4;\n        this.color[n + 0] = d[0] * 255;\n        this.color[n + 1] = d[1] * 255;\n        this.color[n + 2] = d[2] * 255;\n        this.color[n + 3] = d[3] * 255;\n      }\n    }\n\n    this.compile(this.gl);\n  }\n\n  compile() {\n    this.texture = this.gl.createTexture();\n\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n    this.gl.texImage2D(this.gl.TEXTURE_2D,\n      0,\n      this.gl.RGBA,\n      this.width,\n      this.height,\n      0,\n      this.gl.RGBA,\n      this.gl.UNSIGNED_BYTE,\n      this.color);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n\n  delete() {\n    this.gl.deleteTexture(this.texture);\n  }\n\n  bind(unit) {\n    this.gl.activeTexture(this.gl.TEXTURE0 + unit);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n  }\n\n  setColor(x, y, color) {\n    this.setColorArea(x, y, 1, 1, color);\n  }\n\n  setColorArea(x, y, width, height, color) {\n    this.color = new Uint8Array([\n      color[0] * 255,\n      color[1] * 255,\n      color[2] * 255,\n      color[3] * 255\n    ]);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n    this.gl.texSubImage2D(\n      this.gl.TEXTURE_2D,\n      0,\n      x,\n      y,\n      width,\n      height,\n      this.gl.RGBA,\n      this.gl.UNSIGNED_BYTE,\n      this.color);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n\n  unbind() {\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n  }\n}\n","import VertexArray from '../VertexArray';\nimport Texture from '../Texture';\n\nexport default class RendererEventTarget {\n  clickListeners = [];\n  pointerMoveListeners = [];\n  pointerUpListeners = [];\n  pointerDownListeners = [];\n\n  constructor(gl, shaders) {\n    this.gl = gl;\n    this.solidShader = shaders.getShader('solid');\n    this.centerQuad = new VertexArray(this.gl, [\n      -0.5, 0.5,\n      0.5, 0.5,\n      0.5, -0.5,\n      -0.5, -0.5,\n    ], [\n      1, 0, 2,\n      2, 0, 3\n    ], [2]);\n    this.quad = new VertexArray(this.gl, [\n      0.0, 1.0,\n      1.0, 1.0,\n      1.0, 0.0,\n      0.0, 0.0\n    ], [\n      1, 0, 2,\n      2, 0, 3\n    ], [2]);\n  }\n\n  onClick(listener) {\n    this.clickListeners.push(listener);\n  }\n\n  onPointerMove(listener) {\n    this.pointerMoveListeners.push(listener);\n  }\n\n  onPointerUp(listener) {\n    this.pointerUpListeners.push(listener);\n  }\n\n  onPointerDown(listener) {\n    this.pointerDownListeners.push(listener);\n  }\n\n  emitClick(e) {\n    let event = this.handleEvent(e);\n    if(event !== undefined) {\n      this.clickListeners.forEach(l => l(...event));\n    }\n  }\n\n  emitPointerMove(e) {\n    let event = this.handleEvent(e);\n    if(event !== undefined) {\n      this.pointerMoveListeners.forEach(l => l(...event));\n    }\n  }\n\n  emitPointerUp(e) {\n    let event = this.handleEvent(e);\n    if(event !== undefined) {\n      this.pointerUpListeners.forEach(l => l(...event));\n    }\n  }\n\n  emitPointerDown(e) {\n    let event = this.handleEvent(e);\n    if(event !== undefined) {\n      this.pointerDownListeners.forEach(l => l(...event));\n    }\n  }\n\n  handleEvent(event) {}\n}\n","import VertexArray from '../VertexArray';\nimport { mat4, quat } from 'gl-matrix';\nimport Texture from '../Texture';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class TieupRenderer extends RendererEventTarget {\n  constructor(gl, shaders, toggleFunction = () => false, eventListeners = {}, settings = {innerCellMargin: 15}) {\n    super(gl, shaders);\n    this.shader = shaders.getShader('tieup')\n    this.mvp = mat4.create();\n\n    this.settings = settings;\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [\n        -1.0,\n        1.0,\n        1.0\n      ]);\n    mat4.translate(this.initialView, this.initialView, [\n      -1.0,\n      -1.0,\n      0.0\n      ]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  renderPoints(points) {\n    this.render();\n    let {\n      xCount,\n      yCount,\n      cellSize,\n      pos\n    } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    mat4.translate(view, view, \n      [\n        cw/2.0,\n        ch/2.0,\n        1.0\n      ]\n    );\n    mat4.scale(view, view, \n      [\n        cw,\n        ch,\n        1.0\n      ]\n    );\n    let minorSize = Math.min(xCount, yCount);\n    for(let i = 0; i < xCount; i++) {\n      for(let j = 0; j < yCount; j++) {\n        if(points[i] === undefined || points[i][j] === undefined) {\n          continue;\n        } else if(points[i][j] === true) {\n          this.solidShader.setVec4('color', [1.0, 0.0, 0.0, 1.0]);\n        }\n        mat4.translate(mvp, view, [ i, j, 0.0 ]);\n        mat4.scale(mvp, mvp, [ 0.80, 0.80, 1.0 ]);\n        this.solidShader.setMat4('mvp', mvp);\n        this.centerQuad.draw();\n      }\n    }\n    this.centerQuad.unbind()\n    this.solidShader.unbind();\n  }\n\n\n  handleEvent(event) {\n    let { cellSize, xCount, yCount } = this.values;\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let x = (w - event.offsetX) / w * 2.0;\n    let y = (h - event.offsetY) / h * 2.0;\n\n    let gridX = (this.rendererPos[0]) * (cellSize / w);\n    let gridY = (this.rendererPos[1]) * (cellSize / h);\n    let gridW = (xCount * cellSize) / w;\n    let gridH = (yCount * cellSize) / h;\n    if(\n      x > gridX &&\n      y > gridY &&\n      x < (gridX + gridW) &&\n      y < (gridY + gridH)\n    ) {\n      let i = Math.floor(((x - gridX) / gridW) * xCount);\n      let j = Math.floor(((y - gridY) / gridH) * yCount);\n      return [i, j, event]\n    }\n    return undefined;\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(pos) {\n    this.rendererPos = pos;\n  }\n\n  setCellToggleTexture(cellToggleTexture) {\n    this.cellToggleTexture = cellToggleTexture;\n  }\n\n  render() {\n    if(this.values === undefined) return;\n    let { ui, xCount, yCount, cellSize, borderSize } = this.values;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    let width = Math.min(\n    (cellSize * xCount) / w, \n    w);\n    mat4.scale(mvp, view, \n      [\n        (cellSize * xCount) / w,\n        (cellSize * yCount) / h,\n        1.0\n      ]\n    );\n\n    this.cellToggleTexture.bind(0);\n    this.shader.setSampler2D('cellToggleSampler', 0);\n\n    this.shader.setVec2('pos', [ 0,0 ]);\n\n    this.shader.setVec2('cellSize', [\n      cw / (cw * xCount),\n      ch / (ch * yCount),\n    ]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import VertexArray from '../VertexArray';\nimport { mat4, quat } from 'gl-matrix';\nimport Texture from '../Texture';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class GridRenderer extends RendererEventTarget {\n  constructor(gl, shaders, vertical, scrollX, scrollY) {\n    super(gl, shaders);\n    this.gl = gl;\n    this.shader = shaders.getShader('grid');\n    this.vertical = vertical;\n    this.name = name;\n    this.scrollX = scrollX;\n    this.scrollY = scrollY;\n\n    this.mvp = mat4.create();\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [\n        -1.0,\n        1.0,\n        1.0\n      ]);\n    mat4.translate(this.initialView, this.initialView, [\n      -1.0,\n      -1.0,\n      0.0\n      ]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  handleEvent(event) {\n    let { cellSize, xCount, yCount, pos, warpCount, pickCount } = this.values;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    let x = (w - event.offsetX) / w * 2.0;\n    let y = (h - event.offsetY) / h * 2.0;\n    let gridX = (this.rendererPos[0]) * (cellSize / w);\n    let gridY = (this.rendererPos[1]) * (cellSize / h);\n    let gridW = (xCount * cellSize) / w;\n    let gridH = (yCount * cellSize) / h;\n    if(\n      x > gridX &&\n      y > gridY &&\n      x < (gridX + gridW) &&\n      y < (gridY + gridH)\n    ) {\n      let xOffset = scrollX * (pos.get(0) / cellSize);\n      let yOffset = scrollY * (pos.get(1) / cellSize);\n      let cellX = Math.floor((w - event.offsetX) / (cellSize / 2.0) + xOffset);\n      let cellY = Math.floor((h - event.offsetY) / (cellSize / 2.0) + yOffset);\n      let i = cellX - this.rendererPos[0];\n      let j = cellY - this.rendererPos[1];\n\n      return [i, j, event];\n    }\n    return undefined;\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(pos) {\n    this.rendererPos = pos;\n  }\n\n  setCellToggleTexture(cellToggleTexture) {\n    this.cellToggleTexture = cellToggleTexture;\n  }\n\n  renderPoints(points) {\n    this.render();\n    let {\n      xCount,\n      yCount,\n      cellSize,\n      warpCount,\n      pickCount,\n      pos\n    } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    mat4.translate(view, view, \n      [\n        cw/2.0,\n        ch/2.0,\n        1.0\n      ]\n    );\n    mat4.scale(view, view, \n      [\n        cw,\n        ch,\n        1.0\n      ]\n    );\n    let minorSize = Math.min(xCount, yCount);\n    for(let i = 0; i < points.length; i++) {\n      for(let j = 0; j < minorSize; j++) {\n        let x, y;\n        if(yCount < xCount) {\n          x = i;\n          y = j;\n        } else {\n          x = j;\n          y = i;\n        }\n\n        if(points[i] === undefined) {\n          continue;\n        } else if(points[i] === j) {\n          this.solidShader.setVec4('color', [1.0, 0.0, 0.0, 1.0]);\n        } else {\n          this.solidShader.setVec4('color', [1.0, 1.0, 1.0, 1.0]);\n        }\n        mat4.translate(mvp, view, [\n          (-pos.get(0) / cellSize) * scrollX,\n          (-pos.get(1) / cellSize) * scrollY,\n          0.0\n        ]);\n        mat4.translate(mvp, mvp, [ x, y, 0.0 ]);\n        mat4.scale(mvp, mvp, [ 0.62, 0.62, 1.0 ]);\n        this.solidShader.setMat4('mvp', mvp);\n        this.centerQuad.draw();\n      }\n    }\n    this.centerQuad.unbind()\n    this.solidShader.unbind();\n  }\n\n  render() {\n    if(this.values === undefined) return;\n    let {\n      xCount,\n      yCount,\n      cellSize,\n      borderSize,\n      warpCount,\n      pickCount,\n      pos\n    } = this.values;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    mat4.scale(mvp, view, \n      [\n        (cellSize * xCount) / w,\n        (cellSize * yCount) / h,\n        1.0\n      ]\n    );\n\n    this.cellToggleTexture.bind(0);\n    this.shader.setSampler2D('cellToggleSampler', 0);\n    this.shader.setVec2('pos', [\n      pos.get(0) / (warpCount * cellSize) * scrollX,\n      pos.get(1) / (pickCount * cellSize) * scrollY\n    ]);\n\n    this.shader.setFloat('vert', yCount > xCount ? 1.0 : 0.0);\n\n    this.shader.setFloat('gap', 0.04);\n    this.shader.setVec2('cellSize', [\n      cw / (cw * xCount),\n      ch / (ch * yCount),\n    ]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import ShaderBuilder from '../shader/';\nimport VertexArray from '../VertexArray';\nimport Framebuffer from '../Framebuffer';\nimport Texture from '../Texture';\nimport { mat4, quat } from 'gl-matrix';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class WeaveRenderer extends RendererEventTarget {\n  constructor(gl, shaders) {\n    super(gl, shaders);\n    this.gl = gl;\n    this.weaveShader = shaders.getShader('weave');\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [\n        -1.0,\n        1.0,\n        1.0\n      ]);\n    mat4.translate(this.initialView, this.initialView, [\n      -1.0,\n      -1.0,\n      0.0\n      ]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setTextures(threading, treadling, tieup, warpTexture, weftTexture) {\n    this.threading = threading;\n    this.treadling = treadling;\n    this.tieup = tieup;\n    this.warpTexture = warpTexture;\n    this.weftTexture = weftTexture;\n  }\n\n  setRendererPosition(pos) {\n    this.rendererPos = pos;\n  }\n\n  render() {\n    console.log(\"render weave\");\n    if(this.values === undefined) return;\n    let { xCount, yCount, pos, cellSize } = this.values;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        this.rendererPos[0] * cw,\n        this.rendererPos[1] * ch,\n        0.0\n    ]);\n    mat4.scale(mvp, view, \n      [\n        (cellSize * xCount) / w,\n        (cellSize * yCount) / h,\n        1.0\n      ]\n    );\n\n    this.weaveShader.bind();\n    this.quad.bind();\n    this.weaveShader.setMat4('mvp', mvp);\n\n    this.warpTexture.bind(0);\n    this.weaveShader.setSampler2D('warpSampler', 0);\n\n    this.weftTexture.bind(1);\n    this.weaveShader.setSampler2D('weftSampler', 1);\n\n    this.threading.bind(2);\n    this.weaveShader.setSampler2D('threading', 2);\n\n    this.treadling.bind(3);\n    this.weaveShader.setSampler2D('treadling', 3);\n\n    this.tieup.bind(4);\n    this.weaveShader.setSampler2D('tieup', 4);\n\n    this.weaveShader.setVec2('cellSize', [\n      cw / (cw * xCount),\n      ch / (ch * yCount),\n    ]);\n\n    this.weaveShader.setVec2('pos', [\n      pos.get(0) / (xCount * cellSize),\n      pos.get(1) / (yCount * cellSize)\n    ]);\n\n    this.quad.draw();\n    this.quad.unbind();\n    this.weaveShader.unbind();\n  }\n}\n","import VertexArray from '../VertexArray';\nimport { mat4, quat } from 'gl-matrix';\nimport Texture from '../Texture';\nimport RendererEventTarget from './RendererEventTarget';\n\nexport class ColorRowRenderer extends RendererEventTarget {\n  constructor(gl, shaders, scrollX, scrollY) {\n    super(gl, shaders);\n    this.shader = shaders.getShader('colorRow')\n    this.scrollX = scrollX;\n    this.scrollY = scrollY;\n\n    this.initialView = mat4.create();\n    mat4.scale(this.initialView, this.initialView, [\n        -1.0,\n        1.0,\n        1.0\n      ]);\n    mat4.translate(this.initialView, this.initialView, [\n      -1.0,\n      -1.0,\n      0.0\n      ]);\n    this.view = mat4.create();\n    this.mvp = mat4.create();\n  }\n\n  renderPoints(from, to, color) {\n    this.render();\n    let {\n      xCount,\n      yCount,\n      cellSize,\n      pos\n    } = this.values;\n    this.solidShader.bind();\n    this.centerQuad.bind();\n    if(to < from) {\n      [from, to] = [to, from]\n    }\n    console.log(\"render points from\", from, \"to\", to);\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    mat4.translate(view, view, \n      [\n        cw/2.0,\n        ch/2.0,\n        1.0\n      ]\n    );\n    mat4.scale(view, view, \n      [\n        cw,\n        ch,\n        1.0\n      ]\n    );\n\n    for(let i = 0; i < (to - from) + 1; i++) {\n      let x, y;\n      if(xCount > yCount) {\n        x = from + i;\n        y = 0;\n      } else {\n        x = 0;\n        y = from + i;\n      }\n      this.solidShader.setVec4('color', [color.r, color.g, color.b, 1.0]);\n      mat4.translate(mvp, view, [\n        (-pos.get(0) / cellSize) * scrollX,\n        (-pos.get(1) / cellSize) * scrollY,\n        0.0\n      ]);\n      mat4.translate(mvp, mvp, [ x, y, 0.0 ]);\n      mat4.scale(mvp, mvp, [ 0.61, 0.61, 1.0 ]);\n      this.solidShader.setMat4('mvp', mvp);\n      this.centerQuad.draw();\n    }\n    this.centerQuad.unbind()\n    this.solidShader.unbind();\n  }\n\n\n  handleEvent(event) {\n    let { cellSize, xCount, yCount, pos, warpCount, pickCount } = this.values;\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let x = (w - event.offsetX) / w * 2.0;\n    let y = (h - event.offsetY) / h * 2.0;\n    let gridX = (this.rendererPos[0]) * (cellSize / w);\n    let gridY = (this.rendererPos[1]) * (cellSize / h);\n    let gridW = (xCount * cellSize) / w;\n    let gridH = (yCount * cellSize) / h;\n    if(\n      x > gridX &&\n      y > gridY &&\n      x < (gridX + gridW) &&\n      y < (gridY + gridH)\n    ) {\n      let i = Math.floor(((x - gridX) / gridW) * xCount + pos.get(0) / cellSize);\n      let j = Math.floor(((y - gridY) / gridH) * yCount + pos.get(1) / cellSize);\n      return [i, j, event];\n    }\n    return undefined;\n  }\n\n  updateValues(values) {\n    this.values = values;\n  }\n\n  setRendererPosition(pos) {\n    this.rendererPos = pos;\n  }\n\n  setColorTexture(colorTexture) {\n    this.colorTexture = colorTexture;\n  }\n\n  render() {\n    if(this.values === undefined) return;\n    let {\n      pos,\n      xCount,\n      yCount,\n      cellSize,\n      borderSize,\n      warpCount,\n      pickCount\n    } = this.values;\n    let scrollX = this.scrollX ? 1.0 : 0.0;\n    let scrollY = this.scrollY ? 1.0 : 0.0;\n\n    let w = this.gl.canvas.width;\n    let h = this.gl.canvas.height;\n\n    this.shader.bind();\n    this.quad.bind();\n\n    let cw = cellSize / w;\n    let ch = cellSize / h;\n    let mvp = mat4.identity(this.mvp);\n    let view = mat4.translate(mat4.identity(this.view), this.initialView, [\n        (this.rendererPos[0]) * cw,\n        (this.rendererPos[1]) * ch,\n        0.0\n    ]);\n    mat4.scale(mvp, view, \n      [\n        (cellSize * xCount) / w,\n        (cellSize * yCount) / h,\n        1.0\n      ]\n    );\n\n    this.colorTexture.bind(0);\n    this.shader.setSampler2D('colorSampler', 0);\n    this.shader.setVec2('pos', [\n      pos.get(0) / (warpCount * cellSize) * scrollX,\n      pos.get(1) / (pickCount * cellSize) * scrollY\n    ]);\n\n\n    this.shader.setFloat('vert', yCount > xCount ? 1.0 : 0.0);\n\n    this.shader.setVec2('cellSize', [\n      cw / (cw * xCount),\n      ch / (ch * yCount),\n    ]);\n\n    this.shader.setMat4('mvp', mvp);\n    this.quad.draw();\n    this.quad.unbind();\n    this.shader.unbind();\n  }\n}\n","import Texture from './Texture';\nexport function create1DGridTexture(gl, data, shafts, length) {\n  let gridTexture = new Uint8Array(length * 4);\n  gridTexture.fill(0);\n  for(let i = 0; i < length; i++) {\n    let n = i * 4;\n    let value = (data.get(i) / shafts) * 255;\n    let absence = 255;\n    if(data.get(i) === null || data.get(i) === undefined) {\n      absence = 0;\n    }\n    gridTexture[n + 0] = value;\n    gridTexture[n + 1] = absence;\n    gridTexture[n + 2] = value;\n    gridTexture[n + 3] = value;\n  }\n  return new Texture(gl, length, 1, gridTexture);\n}\n\n\nexport function createGridTexture(gl, data, width, height) {\n  let gridTexture = new Uint8Array(width * height * 4);\n  gridTexture.fill(0);\n  for(let i = 0; i < data.size; i++) {\n    for(let j = 0; j < data.get(0).size; j++) {\n      if(data.getIn([i, j]) === 1) {\n        let n = (i + j*width) * 4;\n        gridTexture[n + 0] = 255;\n        gridTexture[n + 1] = 255;\n        gridTexture[n + 2] = 255;\n        gridTexture[n + 3] = 255;\n      }\n    }\n  }\n  return new Texture(gl, width, height, gridTexture);\n}\n\nexport function createColorTexture(gl, colors, w, h, yarns) {\n  let data = new Uint8Array(colors.size * 4);\n  for(let i = 0; i < colors.size; i++) {\n    let n = i * 4;\n    let c = yarns.getIn([colors.get(i), 'color']).toJS();\n    data[n + 0] = c.r * 255;\n    data[n + 1] = c.g * 255;\n    data[n + 2] = c.b * 255;\n    data[n + 3] = 255;\n  }\n  return new Texture(\n    gl,\n    w,\n    h,\n    data\n  );\n}\n","import ShaderBuilder from './shader/';\nimport VertexArray from './VertexArray';\nimport Texture from './Texture';\nimport { mat4 } from 'gl-matrix';\n\nimport { TieupRenderer} from './renderers/TieupRenderer';\nimport { GridRenderer} from './renderers/GridRenderer';\nimport { WeaveRenderer} from './renderers/WeaveRenderer';\nimport { ColorRowRenderer} from './renderers/ColorRowRenderer';\n\nimport { create1DGridTexture, createGridTexture, createColorTexture } from './TextureUtil';\nimport { fromJS } from 'immutable';\n\nexport class Renderer {\n  prevDraft = fromJS({});\n  prevUI = fromJS({});\n\n  constructor(canvas) {\n    this.gl = canvas.getContext('webgl', {\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: true\n    });\n    this.gl.clearColor(1, 1, 1, 1);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n    this.gl.disable(this.gl.CULL_FACE);\n    this.shaders = new ShaderBuilder(this.gl);\n    this.gl.enable(this.gl.BLEND);\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\n\n    let maxTextureSize = this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE);\n    console.log(\"Max texture size\", maxTextureSize);\n\n    this.threadingTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]]);\n    this.treadlingTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]])\n    this.tieupTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]])\n    this.warpTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]])\n    this.weftTexture = new Texture(this.gl, 1, 1, [[0, 0, 0, 0]])\n\n    this.resizeCanvas();\n    window.addEventListener('beforeunload', () => {\n      let extension = this.gl.getExtension('WEBGL_lose_context');\n      if(extension) {\n        console.log('Trying to free webgl context');\n        extension.loseContext();\n      }\n    });\n    this.tieup = new TieupRenderer(this.gl, this.shaders);\n    this.threading = new GridRenderer(this.gl, this.shaders, false, true, false);\n    this.treadling = new GridRenderer(this.gl, this.shaders, true, false, true);\n    this.warpColor= new ColorRowRenderer(this.gl, this.shaders, true, false);\n    this.weftColor = new ColorRowRenderer(this.gl, this.shaders, false, true);\n    this.weave = new WeaveRenderer(this.gl, this.shaders);\n\n    this.renderers = [\n      {\n        renderer: this.tieup,\n        dirty: true\n      },\n      {\n        renderer: this.threading,\n        dirty: true\n      },\n      {\n        renderer: this.treadling,\n        dirty: true\n      },\n      {\n        renderer: this.warpColor,\n        dirty: true\n      },\n      {\n        renderer: this.weftColor,\n        dirty: true\n      },\n      {\n        renderer: this.weave,\n        dirty: true\n      },\n    ];\n\n    canvas.addEventListener('pointermove', (e) => {\n      this.renderers\n        .map(r => r.renderer)\n        .forEach(r => {\n          r.emitPointerMove(e);\n        });\n    })\n\n    canvas.addEventListener('pointerup', (e) => {\n      this.renderers\n        .map(r => r.renderer)\n        .forEach(r => {\n          r.emitPointerUp(e);\n        });\n    })\n    \n    canvas.addEventListener('pointerdown', (e) => {\n      this.renderers\n        .map(r => r.renderer)\n        .forEach(r => {\n          r.emitPointerDown(e);\n        });\n    })\n\n    canvas.addEventListener('click', (e) => {\n      this.renderers\n        .map(r => r.renderer)\n        .forEach(r => {\n          r.emitClick(e);\n        });\n    })\n\n    let render = () => {\n      if(this.renderNextFrame) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n        this.renderers\n          .filter(r => r.dirty)\n          .forEach(r => r.renderer.render());\n        this.renderNextFrame = false;\n      }\n      requestAnimationFrame(render);\n    }\n    requestAnimationFrame(render);\n  }\n\n  setRendererPosition(draft) {\n    let treadleCount = draft.get('treadleCount');\n    let shaftCount = draft.get('shaftCount');\n    this.tieup.setRendererPosition([3, 3]);\n    this.threading.setRendererPosition([treadleCount + 4, 3]);\n    this.treadling.setRendererPosition([3, shaftCount + 4]);\n    this.weftColor.setRendererPosition([1, shaftCount + 4]);\n    this.warpColor.setRendererPosition([treadleCount + 4, 1]);\n    this.weave.setRendererPosition([\n      treadleCount + 4,\n      shaftCount + 4\n    ]);\n  }\n\n  isDifferent(draft, prevDraft, ...args) {\n    return args.some(a => draft.get(a) !== prevDraft.get(a));\n  }\n\n  update(draft, ui) {\n    let prevDraft = this.prevDraft;\n    let prevUI = this.prevUI;\n    this.updateTextures(draft);\n    this.weave.setTextures(\n      this.threadingTexture,\n      this.treadlingTexture,\n      this.tieupTexture,\n      this.warpTexture,\n      this.weftTexture\n    );\n    if(this.isDifferent(draft, prevDraft,\n      'treadleCount',\n      'shaftCount',\n      'tieup') ||\n      ui !== prevUI\n    ) {\n      this.tieup.updateValues({\n        xCount: draft.get('treadleCount'),\n        yCount: draft.get('shaftCount'),\n        cellSize: ui.get('cellSize'),\n        borderSize: ui.get('borderSize')\n      });\n      this.renderers[0].dirty = true;\n      this.tieup.setCellToggleTexture(this.tieupTexture);\n    }\n\n    if(this.isDifferent(draft, prevDraft,\n      'warpCount',\n      'shaftCount',\n      'pickCount',\n      'threading') ||\n      ui !== prevUI\n    ) {\n      this.threading.updateValues({\n        xCount: draft.get('warpCount'),\n        yCount: draft.get('shaftCount'),\n        pickCount: draft.get('pickCount'),\n        warpCount: draft.get('warpCount'),\n        cellSize: ui.get('cellSize'),\n        borderSize: ui.get('borderSize'),\n        pos: ui.get('pos')\n      });\n      this.renderers[1].dirty = true;\n      this.threading.setCellToggleTexture(this.threadingTexture);\n    }\n\n    if(\n      this.isDifferent(draft, prevDraft, \n      'treadleCount',\n      'pickCount',\n      'warpCount',\n      'treadling') ||\n      ui !== prevUI\n    ) {\n      this.treadling.updateValues({\n        xCount: draft.get('treadleCount'),\n        yCount: draft.get('pickCount'),\n        pickCount: draft.get('pickCount'),\n        warpCount: draft.get('warpCount'),\n        cellSize: ui.get('cellSize'),\n        borderSize: ui.get('borderSize'),\n        pos: ui.get('pos'),\n      });\n      this.renderers[2].dirty = true;\n      this.treadling.setCellToggleTexture(this.treadlingTexture);\n    }\n\n    if(\n      this.isDifferent(draft, prevDraft, \n        'warpCount',\n        'pickCount',\n        'warpColors') ||\n      ui !== prevUI\n    ) {\n      this.warpColor.updateValues({\n        xCount: draft.get('pickCount'),\n        yCount: 1,\n        pickCount: draft.get('pickCount'),\n        warpCount: draft.get('warpCount'),\n        cellSize: ui.get('cellSize'),\n        borderSize: ui.get('borderSize'),\n        pos: ui.get('pos')\n      });\n      this.renderers[3].dirty = true;\n      this.warpColor.setColorTexture(this.warpTexture);\n    }\n\n    if(\n      this.isDifferent(draft, prevDraft, \n      'warpCount',\n      'pickCount',\n      'weftColors') ||\n      ui !== prevUI\n    ) {\n      this.weftColor.updateValues({\n        xCount: 1,\n        yCount: draft.get('pickCount'),\n        pickCount: draft.get('pickCount'),\n        warpCount: draft.get('warpCount'),\n        cellSize: ui.get('cellSize'),\n        borderSize: ui.get('borderSize'),\n        pos: ui.get('pos')\n      });\n      this.renderers[4].dirty = true;\n      this.weftColor.setColorTexture(this.weftTexture);\n    }\n\n    if(\n      draft !== prevDraft ||\n      prevUI !== ui\n    ) {\n      this.weave.updateValues({\n        xCount: draft.get('warpCount'),\n        yCount: draft.get('pickCount'),\n        cellSize: ui.get('cellSize'),\n        pos: ui.get('pos')\n      });\n      this.renderers[5].dirty = true;\n    }\n\n\n    this.prevDraft = draft;\n    this.prevUI = draft;\n  }\n\n  updateTextures(draft) {\n    let prevDraft = this.prevDraft;\n    if(this.isDifferent(draft, prevDraft, 'threading', 'shaftCount', 'warpCount')) {\n      this.threadingTexture.delete();\n      this.threadingTexture = create1DGridTexture(this.gl,\n        draft.get('threading'),\n        draft.get('shaftCount'),\n        draft.get('warpCount'));\n    }\n\n    if(this.isDifferent(draft, prevDraft, 'treadling', 'shaftCount', 'pickCount')) {\n      this.treadlingTexture.delete();\n      this.treadlingTexture = create1DGridTexture(this.gl,\n        draft.get('treadling'),\n        draft.get('shaftCount'),\n        draft.get('pickCount'));\n    }\n\n    if(this.isDifferent(draft, prevDraft, 'tieup', 'shaftCount')) {\n      this.tieupTexture.delete();\n      this.tieupTexture = createGridTexture(this.gl,\n        draft.get('tieup'),\n        draft.get('shaftCount'),\n        draft.get('shaftCount'));\n    }\n\n    if(this.isDifferent(draft, prevDraft, 'warpColors', 'yarn')) {\n      this.warpTexture.delete()\n      this.warpTexture = createColorTexture(this.gl,\n        draft.get('warpColors'),\n        draft.get('warpColors').size,\n        1,\n        draft.get('yarn'));\n    }\n\n    if(this.isDifferent(draft, prevDraft, 'weftColors', 'yarn')) {\n      this.weftTexture.delete();\n      this.weftTexture = createColorTexture(this.gl,\n        draft.get('weftColors'),\n        1,\n        draft.get('weftColors').size,\n        draft.get('yarn'));\n    }\n  }\n\n  resizeCanvas() {\n    this.width = this.gl.canvas.width;\n    this.height = this.gl.canvas.height;\n    this.gl.viewport(0, 0, this.width, this.height);\n  }\n\n  render() {\n    this.renderNextFrame = true;\n  }\n}\n","<script>\n  import draft from '../../stores/Draft';\n  import ui from '../../stores/UI';\n\n  let width = $draft.get('warpCount') * $ui.get('cellSize');\n  let height = $draft.get('pickCount') * $ui.get('cellSize');\n\n</script>\n<div\n      class=\"scrollpane\"\n      style={`left: ${width}px; top: ${height}px;`}\n      >\n</div>\n<style>\n  .scrollpane {\n    background-color: #5959308f;\n    pointer-events: none;\n    position: relative;\n    width: 10px;\n    height: 10px;\n  }\n</style>\n","<script>\n  import { onMount } from 'svelte';\n\n  import draft from '../../stores/Draft';\n  import ui from '../../stores/UI';\n  import { Renderer } from './gfx/Renderer';\n  import ScrollPane from '../ScrollPane/ScrollPane.svelte';\n  import { line } from '../../util/MathUtil';\n\n  let renderer;\n  let canvas;\n  let tieup;\n  let treadling;\n  let threading;\n  let weave;\n  let warpColor;\n  let weftColor;\n\n  let drag = '';\n  let hasDragged = false;\n  let isDragging = false;\n  let fromPos = [];\n  let linePoints = [];\n  let oldLinePoints = [];\n  let vert = true;\n\n  let colorStart;\n  let colorEnd;\n\n  $: {\n    if(renderer) {\n      renderer.update($draft, $ui);\n      renderer.setRendererPosition($draft);\n      try {\n        renderer.render();\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }\n\n  onMount(() => {\n    renderer = new Renderer(canvas);\n    syncCanvasDimensions();\n    renderer.tieup.onClick((x, y) => {\n      if(!hasDragged) {\n        draft.update(d => d.updateIn(['tieup', x, y], i => i === 1 ? 0 : 1));\n      }\n      hasDragged = false;\n    });\n\n    renderer.tieup.onPointerDown((x, y) => {\n      startDrag(x, y, 'tieup');\n    });\n\n    renderer.tieup.onPointerMove((x, y, event) => {\n      if(drag === 'tieup') {\n        onMove(event, x, y);\n        if(isDragging && linePointsChanged()) {\n          renderer.tieup.renderPoints(linePoints);\n        }\n      }\n    });\n\n    renderer.tieup.onPointerUp((x, y) => {\n      if(hasDragged && drag === 'tieup') {\n        updateGridWithLine('tieup');\n      }\n      stopDrag();\n    });\n\n    renderer.threading.onClick((x, y) => {\n      if(!hasDragged) {\n        draft.update(d => d.updateIn(['threading', x], (v) => v === y ? undefined : y))\n      }\n      hasDragged = false;\n    });\n\n    renderer.threading.onPointerDown((x, y) => {\n      startDrag(x, y, 'threading');\n    });\n\n    renderer.threading.onPointerMove((x, y, event) => {\n      if(drag === 'threading') {\n        onMove(event, x, y);\n        if(isDragging && linePointsChanged()) {\n          renderer.threading.renderPoints(linePoints);\n        }\n      }\n    });\n\n    renderer.threading.onPointerUp((x, y) => {\n      if(hasDragged && drag === 'threading') {\n        updateListWithLine('threading');\n      }\n      stopDrag();\n    });\n\n    renderer.treadling.onClick((x, y) => {\n      if(!hasDragged) {\n        draft.update(d => d.updateIn(['treadling', y], (v) => v === x ? undefined : x))\n      }\n      hasDragged = false;\n    });\n\n    renderer.treadling.onPointerDown((x, y) => {\n      startDrag(x, y, 'treadling');\n    });\n\n    renderer.treadling.onPointerMove((x, y, event) => {\n      if(drag === 'treadling') {\n        onMove(event, x, y);\n        if(isDragging && linePointsChanged()) {\n          renderer.treadling.renderPoints(linePoints);\n        }\n      }\n    });\n\n    renderer.treadling.onPointerUp((x, y) => {\n      if(hasDragged && drag === 'treadling') {\n        updateListWithLine('treadling');\n      }\n      stopDrag();\n    });\n\n    renderer.warpColor.onClick((x, y) => {\n      draft.update(d => d.setIn(['warpColors', x], $ui.get('selectedColor')));\n    });\n\n    renderer.warpColor.onPointerDown((x, y, event) => {\n      drag = 'warpColors';\n      isDragging = true;\n      colorStart = x;\n      let color = $draft.getIn(['yarn', $ui.get('selectedColor'), 'color']).toJS();\n      renderer.warpColor.renderPoints(colorStart, x, color);\n    });\n\n    renderer.warpColor.onPointerMove((x, y, event) => {\n      if(drag === 'warpColors') {\n        if(isDragging && x !== colorEnd) {\n          hasDragged = true;\n          let color = $draft.getIn(['yarn', $ui.get('selectedColor'), 'color']).toJS();\n          renderer.warpColor.renderPoints(colorStart, x, color);\n        }\n        colorEnd = x;\n      }\n    });\n\n    renderer.warpColor.onPointerUp((x, y, event) => {\n      if(hasDragged && drag === 'warpColors') {\n        updateColor('warpColors', colorStart, colorEnd, $ui.get('selectedColor'));\n      }\n      stopDrag();\n    });\n\n    renderer.weftColor.onClick((x, y) => {\n      draft.update(d => d.setIn(['weftColors', y], $ui.get('selectedColor')));\n    });\n\n    renderer.weftColor.onPointerDown((x, y, event) => {\n      drag = 'weftColors';\n      isDragging = true;\n      colorStart = y;\n      let color = $draft.getIn(['yarn', $ui.get('selectedColor'), 'color']).toJS();\n      renderer.weftColor.renderPoints(colorStart, y, color);\n    });\n\n    renderer.weftColor.onPointerMove((x, y, event) => {\n      if(drag === 'weftColors') {\n        if(isDragging && y !== colorEnd) {\n          hasDragged = true;\n          let color = $draft.getIn(['yarn', $ui.get('selectedColor'), 'color']).toJS();\n          renderer.weftColor.renderPoints(colorStart, y, color);\n        }\n        colorEnd = y;\n      }\n    });\n\n    renderer.weftColor.onPointerUp((x, y, event) => {\n      if(hasDragged && drag === 'weftColors') {\n        updateColor('weftColors', colorStart, colorEnd, $ui.get('selectedColor'));\n      }\n      stopDrag();\n    });\n  });\n\n  function updateGridWithLine(name) {\n    let newTieup = [];\n    for(let i = 0; i < $draft.get('shaftCount'); i++) {\n      newTieup.push([]);\n    }\n\n    let tieup = $draft.get('tieup');\n    for(let i = 0; i < $draft.get('treadleCount'); i++) {\n      for(let j = 0; j < $draft.get('shaftCount'); j++) {\n        if(linePoints[i] !== undefined && linePoints[i][j] === true) {\n          newTieup[i][j] = 1;\n        } else {\n          newTieup[i][j] = tieup.getIn([i, j]);\n        }\n      }\n    }\n    draft.update(d => d.set('tieup', fromJS(newTieup)));\n  }\n\n  function updateColor(name, colorStart, colorEnd, selectedColor) {\n    if(colorEnd < colorStart) {\n      [colorStart, colorEnd] = [colorEnd, colorStart];\n    }\n\n    let newList = $draft.get(name).withMutations(l => {\n      for(let i = 0; i < (colorEnd - colorStart) + 1; i++) {\n        l.set(colorStart + i, selectedColor);\n      }\n    });\n\n    draft.update(d => d.set(name, newList));\n  }\n\n  function updateListWithLine(name) {\n    draft.update(d => d.update(name, list => list.withMutations(l => {\n      linePoints.forEach((p, i) => l.set(i, p));\n    })));\n  }\n\n  function startDrag(i, j, name) {\n    drag = name;\n    fromPos = [i, j]\n    linePoints = [[i, j]];\n  }\n\n  function linePointsChanged() {\n    if(linePoints.length !== oldLinePoints.length) {\n      return true;\n    }\n    for(let i = 0; i < linePoints.length; i++) {\n      if(linePoints[i] !== oldLinePoints[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function onMove(event, i, j) {\n    if(event.buttons === 0) {\n      fromPos = undefined;\n      isDragging = false;\n      return;\n    }\n    if((event.buttons & 1) && ((event.movementX !== 0) || (event.movementY !== 0))) {\n      isDragging = true;\n      hasDragged = true;\n    }\n    oldLinePoints = [...linePoints];\n    let lp = line(...fromPos, i, j);\n    linePoints = [];\n    lp.forEach(p => {\n      if(drag === 'tieup') {\n        if(linePoints[p[0]] === undefined) {\n          linePoints[p[0]] = [];\n        }\n        linePoints[p[0]][p[1]] = true;\n      } else  if(drag === 'treadling') {\n        linePoints[p[1]] = p[0];\n      } else if(drag === 'threading') {\n        linePoints[p[0]] = p[1];\n      }\n    });\n  }\n\n  function stopDrag() {\n    fromPos = undefined;\n    isDragging = false;\n    drag = '';\n  }\n\n  export function syncCanvasDimensions() {\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n    renderer.resizeCanvas();\n    renderer.render();\n  }\n\n</script>\n<canvas class=\"weave-display\" bind:this={canvas} />\n<style>\n  .weave-display {\n    image-rendering: crisp-edges;\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>\n  import tinycolor from 'tinycolor2';\n  import draft from '../../stores/Draft';\n  import ui from '../../stores/UI';\n  import downArrow from 'icons/down-arrow.svg';\n  import upArrow from 'icons/up-arrow.svg';\n\n  let isToggled = false;\n  let color = tinycolor('black');\n  $: {\n    let selectedColor = $ui.get('selectedColor');\n    let c = $draft.getIn([\n      'yarn',\n      selectedColor,\n      'color'\n    ]).toJS();\n    color = tinycolor.fromRatio(c);\n  }\n\n\n  function setColor(index) {\n    ui.update(u => u.set('selectedColor', index));\n    isToggled = false;\n  }\n\n</script>\n\n<div class=\"yarn-selector\">\n  <button\n    class=\"color-display\"\n    on:click={() => isToggled = !isToggled}>\n    <div\n      class=\"color-marker\"\n      style={`background-color: ${color.toHexString()};`}\n      >\n    </div>\n      <span\n        class=\"arrow\"\n        style={`\n        stroke: ${color.isDark() ? 'black' : 'white'};\n        fill: ${color.isLight() ? 'black' : 'white'};\n        `}>\n        {#if isToggled === true}\n          {@html upArrow}\n        {:else}\n          {@html downArrow}\n        {/if}\n      </span>\n  </button>\n  {#if isToggled === true}\n    <ul>\n      {#each $draft.get('yarn').toJS() as yarn, i}\n        <li style={`background-color: ${tinycolor.fromRatio(yarn.color).toHexString()}`} on:click={() => setColor(i)}></li>\n      {/each}\n    </ul>\n  {/if}\n</div>\n\n<style>\n  .yarn-selector {\n    min-height: 2em;\n    min-width: 2em;\n    position: absolute;\n    right: 2em;\n    bottom: 2em;\n    display: flex;\n    justify-content: center;\n    flex-direction: column;\n    align-items: center;\n    background-color: white;\n\n    z-index: 10;\n    border: 1px solid black;\n  }\n\n  .yarn-selector button {\n    width: calc(100%);\n    height: calc(100%);\n    padding: 8px;\n    margin: 0;\n  }\n\n  .yarn-selector ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  .yarn-selector li {\n    width: 2em;\n    height: 2em;\n  }\n\n  .arrow {\n    position: absolute;\n    top: calc(2em - 8px);\n    right: 0;\n    width: 15px;\n    height: 15px;\n  }\n\n  .arrow :global(svg) {\n    stroke-width: 10px;\n  }\n\n  .color-marker {\n    width: 12px;\n    height: 12px;\n    padding: 8px;\n  }\n</style>\n","<script>\n  import { onMount, onDestroy, afterUpdate } from 'svelte';\n  import { Map, List } from 'immutable';\n  import ui from '../stores/UI';\n  import draft from '../stores/Draft';\n  import { useFocus } from \"svelte-navigator\";\n  import WeaveDisplay from '../components/WeaveDisplay/WeaveDisplay.svelte';\n  import YarnSelector from '../components/YarnSelector/YarnSelector.svelte';\n  import ScrollPane from '../components/ScrollPane/ScrollPane.svelte';\n\n  const registerFocus = useFocus();\n\n  let scrollContainer;\n  let canvasContainer;\n  let newCellSize = $ui.get('cellSize');\n\n  let scrollbarWidth = 15; //Works for chrome and firefox\n  let weaveDisplay;\n\n  let resizeObserver;\n\n  onMount(() => {\n    scrollbarWidth = scrollContainer.offsetWidth - scrollContainer.clientWidth;\n    scrollContainer.addEventListener('scroll', updatePosition);\n    scrollContainer.scrollTo(\n      scrollContainer.scrollLeftMax,\n      scrollContainer.scrollTopMax\n    );\n    resizeObserver = new ResizeObserver(entries => {\n      weaveDisplay.syncCanvasDimensions();\n    });\n    resizeObserver.observe(canvasContainer);\n  });\n\n  onDestroy(() => {\n    scrollContainer.removeEventListener('scroll', updatePosition);\n  });\n\n  function updatePosition(event) {\n    let xOffset = 0;\n    let yOffset = 0;\n    let canvasRect = canvasContainer.getBoundingClientRect();\n    let rect = scrollContainer.getBoundingClientRect();\n    let x = scrollContainer.scrollLeftMax - scrollContainer.scrollLeft;\n    let y = scrollContainer.scrollTopMax - scrollContainer.scrollTop ;\n    \n    ui.update(u => {\n      return u.set('pos', List([x, y]))\n    });\n  }\n\n  function changeCellSize() {\n    ui.update(u => u.set('cellSize', newCellSize));\n  }\n\n</script>\n<div on:scroll={updatePosition} bind:this={scrollContainer} class=\"container\" tabindex=\"0\">\n  <YarnSelector />\n  <ScrollPane />\n  <div bind:this={canvasContainer} class=\"fixed\" style={`\n                                   right: ${scrollbarWidth}px;\n                                   bottom: ${scrollbarWidth}px\n                                   `}>\n    <WeaveDisplay bind:this={weaveDisplay} />\n  </div>\n</div>\n<div class=\"ok-zoomer\">\n  <input type=\"range\" min=\"5\" max=\"70\" on:input={changeCellSize} bind:value={newCellSize} />\n</div>\n<style>\n\n  .container {\n    overflow: auto;\n  }\n\n  .fixed {\n    display: flex;\n    justify-content: stretch;\n    align-items: stretch;\n\n    position: absolute;\n    right: 0;\n    left: 90px;\n    bottom: 0;\n    top: 0;\n  }\n\n  .ok-zoomer {\n    position: fixed;\n    bottom: 0;\n    right: 20px;\n    z-index: 1000;\n  }\n\n  .scrollbar-measure {\n    width: 100px;\n    height: 100px;\n    overflow: scroll;\n    position: absolute;\n    top: -9999px;\n  }\n\n</style>\n","<script>\n  import { useFocus } from \"svelte-navigator\";\n\n  const registerFocus = useFocus();\n</script>\n\n<div class=\"application\">\n  <h1 use:registerFocus >Halp plix!!!</h1>\n  <h2>Oh man i am not good with computer plz to help</h2>\n\n  <ul>\n    <li>help by Baboon designs from the Noun Project</li>\n    <li>back by David from the Noun Project</li>\n    <li>Scarf by Sergey Demushkin from the Noun Project</li>\n    <li>Yarn by Sergey Demushkin from the Noun Project</li>\n    <li>add by Johan Ronsse from the Noun Project</li>\n  </ul>\n</div>\n\n<style>\n</style>\n","<script>\n  import { Router, Link, Route } from \"svelte-navigator\";\n  import {\n    Sidebar\n  } from './components';\n  import Editor from './pages/Editor.svelte';\n  import Help from './pages/Help.svelte';\n  import ui from './stores/UI';\n  import draft from './stores/Draft';\n\n  export let url;\n</script>\n\n<Router url=\"{url}\" basepath=\"/weaver\">\n  <div class=\"application\">\n    <Sidebar />\n    <Route path=\"about\" component=\"{Help}\" />\n    <Route path=\"/\" component=\"{Editor}\" />\n  </div>\n</Router>\n\n<style>\n  .application {\n    flex-grow: 1;\n    display: grid;\n    grid-template-columns: auto 1fr;\n  }\n\n  main {\n    grid-gap: 16px;\n    padding: 16px;\n    display: grid;\n  }\n\n  .tieup-container {\n    grid-row: 2;\n    grid-column: 2;\n  }\n\n  .threading-container {\n    grid-row: 2;\n    grid-column: 3;\n  }\n\n  .treadling-container {\n    grid-row: 3;\n    grid-column: 2;\n  }\n\n  .weave-display-container {\n    grid-row: 3;\n    grid-column: 3;\n  }\n\n  .warp-colors {\n    grid-row: 1;\n    grid-column: 3;\n  }\n\n  .weft-colors {\n    grid-row: 3;\n    grid-column: 1;\n  }\n\n</style>\n","import tinycolor from 'tinycolor2';\nimport App from './App.svelte';\n\nconst app = new App({\n  target: document.body,\n  props: {\n    url: location.pathname.substr(location.pathname.lastIndexOf('/'))\n  }\n});\n\nwindow.tinycolor = tinycolor;\nexport default app;\n"],"names":["Math","trimLeft","trimRight","tinyCounter","mathRound","round","mathMin","min","mathMax","max","mathRandom","random","tinycolor","color","opts","this","rgb","r","g","b","a","s","v","l","ok","format","replace","toLowerCase","match","named","names","matchers","exec","rgba","hsl","h","hsla","hsv","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","String","substr","convertToPercentage","i","floor","f","p","q","t","mod","hsvToRgb","hue2rgb","hslToRgb","hasOwnProperty","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_a","_roundA","_format","_gradientType","gradientType","_ok","_tc_id","rgbToHsl","d","rgbToHsv","rgbToHex","allow3Char","hex","pad2","toString","charAt","join","rgbaToArgbHex","convertDecimalToHex","desaturate","amount","toHsl","clamp01","saturate","greyscale","lighten","brighten","toRgb","darken","spin","hue","complement","triad","tetrad","splitcomplement","analogous","results","slices","part","ret","push","monochromatic","toHsv","modification","prototype","isDark","getBrightness","isLight","isValid","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","pow","setAlpha","value","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","clone","_applyModification","fn","args","apply","concat","slice","call","arguments","_applyCombination","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","readability","c1","c2","isReadable","wcag2","wcag2Parms","out","parms","level","size","toUpperCase","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","length","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","o","flipped","flip","parseFloat","isNaN","n","indexOf","isOnePointZero","processPercent","isPercentage","parseInt","abs","val","c","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","RegExp","module","exports","window","noop","assign","tar","src","k","run","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","subscribe","store","callbacks","unsub","unsubscribe","get_store_value","_","component_subscribe","component","callback","$$","on_destroy","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","update_slot","slot","slot_definition","dirty","get_slot_changes_fn","get_slot_context_fn","slot_changes","lets","undefined","merged","len","get_slot_changes","slot_context","exclude_internal_props","props","result","compute_rest_props","keys","rest","Set","has","null_to_empty","action_destroyer","action_result","destroy","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","element","name","document","createElement","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","to_number","set_data","wholeText","set_input_value","input","set_style","key","important","style","setProperty","toggle_class","toggle","classList","HtmlTag","[object Object]","e","html","nodeName","innerHTML","Array","from","childNodes","current_component","set_current_component","get_current_component","Error","onMount","on_mount","onDestroy","setContext","context","set","getContext","get","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","schedule_update","then","flush","tick","add_render_callback","flushing","seen_callbacks","update","pop","add","clear","fragment","before_update","after_update","outroing","outros","group_outros","check_outros","transition_in","block","local","delete","transition_out","get_spread_object","spread_props","create_component","mount_component","m","new_on_destroy","map","filter","destroy_component","init","instance","create_fragment","not_equal","parent_component","prop_values","bound","Map","skip_bound","ready","fill","make_dirty","hydrate","nodes","children","intro","SvelteComponent","$destroy","type","index","splice","$$props","obj","$$set","isUndefined","isNumber","createCounter","isSSR","addListener","subscriber_queue","writable","start","stop","subscribers","new_value","run_queue","invalidate","subscriber","derived","stores","initial_value","single","isArray","stores_array","auto","inited","values","pending","cleanup","sync","unsubscribers","createKey","ctxName","LOCATION","ROUTER","ROUTE","ROUTE_PARAMS","FOCUS_ELEM","paramRegex","startsWith","string","search","isSplat","segment","stripSlashes","str","segmentize","uri","filterFalsy","segments","split","Boolean","addQuery","pathname","query","normalizePath","path","pathFragments","joinedSegments","labels","1","2","3","4","5","6","7","8","9","10","11","createLabel","labelId","createMessage","message","originId","origin","to","basepath","createIdentifier","originMsg","label","createMessageHandler","fail","warn","console","rankRoute","route","score","default","fullPath","reduce","acc","nextScore","isRootSegment","test","isDynamic","SEGMENT_POINTS","pick","routes","bestMatch","defaultMatch","uriPathname","uriSegments","isRootUri","ranked","sort","rankRoutes","missed","params","createMatch","routeSegments","routeSegment","uriSegment","splatName","decodeURIComponent","dynamicMatch","normalizeLocation","location","hash","state","baseSegments","pathSegments","shift","normalizeUrlFragment","frag","createLocation","url","searchIndex","hashIndex","hasSearchIndex","hasHashIndex","pathnameAndSearch","resolveLink","routeBase","appBase","base","toPathname","toQuery","basePathname","toSegments","allSegments","extractBaseUri","routePath","routeMatch","POP","getLocation","source","encodeURI","decodeURI","history","_key","createStackFrame","canUseDOM","isEmbeddedPage","globalHistory","listeners","action","notifyListeners","listenerFns","listener","unlisten","go","keyedState","substring","createHistory","initialPathname","stack","entries","title","newIndex","createMemorySource","navigate","focusCandidate","initialNavigation","pushFocusCandidate","item","routerIdA","routerIdB","routerMarkers","querySelectorAll","currentId","Number","dataset","svnavRouter","isAbove","routerId","focus","elem","TABINDEX","hasAttribute","blurListener","activeElement","isEndMarker","id","svnavRouteEnd","selector","parent","querySelector","handleFocus","focusElement","current","nextElementSibling","tagName","heading","queryHeading","documentElement","createTriggerFocus","a11yConfig","announcementText","manageFocus","announceNavigation","announcements","meta","announcementMessage","createAnnouncement","createId","defaultBasepath","primary","a11y","initialBasepath","normalizedBasepath","locationContext","routerContext","isTopLevelRouter","activeRoute","hasActiveRoute","prevLocation","$location","triggerFocus","createRouteFilter","routeId","routeList","routeItem","changedHistory","normalizedLocation","registerRoute","matchingRoute","prevRoutes","nextRoutes","unregisterRoute","$routes","hasHash","shouldManageFocus","$prevLocation","$activeRoute","usePreflightCheck","componentId","ctxKey","ctxProviderId","useLocation","toReadonly","useRouteBase","_route","useNavigate","useResolve","useHistory","useFocus","lazyElement","_resolve","unmounted","innerUnsubscribe","levels","updates","to_null_out","accounted_for","parentBase","ssrMatch","isDefault","rawBase","$parentBase","updatedRoute","isActive","activeParams","link","getAnchor","defaultNavigate","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","shouldNavigate","preventDefault","createAction","currentTarget","SIZE","MASK","NOT_SET","SetRef","ref","OwnerID","ensureSize","iter","__iterate","returnTrue","wrapIndex","uint32Index","NaN","wholeSlice","begin","end","isNeg","resolveBegin","resolveIndex","resolveEnd","defaultIndex","Infinity","IS_COLLECTION_SYMBOL","isCollection","maybeCollection","IS_KEYED_SYMBOL","isKeyed","maybeKeyed","IS_INDEXED_SYMBOL","isIndexed","maybeIndexed","isAssociative","maybeAssociative","Collection","Seq","KeyedCollection","KeyedSeq","__proto__","constructor","IndexedCollection","IndexedSeq","SetCollection","SetSeq","Keyed","Indexed","IS_SEQ_SYMBOL","isSeq","maybeSeq","isRecord","maybeRecord","isImmutable","maybeImmutable","IS_ORDERED_SYMBOL","isOrdered","maybeOrdered","REAL_ITERATOR_SYMBOL","Symbol","iterator","FAUX_ITERATOR_SYMBOL","ITERATOR_SYMBOL","Iterator","next","iteratorValue","iteratorResult","done","iteratorDone","hasIterator","maybeIterable","getIteratorFn","isIterator","maybeIterator","getIterator","iterable","iteratorFn","KEYS","VALUES","ENTRIES","inspect","toSource","isArrayLike","isInteger","Collection$$1","emptySequence","toSeq","seq","maybeIndexedSeqFromValue","ObjectSeq","TypeError","seqFromValue","__toString","cacheResult","_cache","__iterateUncached","entrySeq","toArray","reverse","cache","entry","__iterator","__iteratorUncached","toKeyedSeq","fromEntrySeq","keyedSeqFromValue","toIndexedSeq","indexedSeqFromValue","of","toSetSeq","ArraySeq","array","_array","notSetValue","ii","object","_object","_keys","EMPTY_SEQ","CollectionSeq","collection","_collection","step","IS_MAP_SYMBOL","isMap","maybeMap","isOrderedMap","maybeOrderedMap","isValueObject","maybeValue","hashCode","is","valueA","valueB","valueOf","imul","smi","i32","defaultValueOf","hashNumber","STRING_HASH_CACHE_MIN_STRLEN","hashed","stringHashCache","hashString","STRING_HASH_CACHE_SIZE","STRING_HASH_CACHE_MAX_SIZE","cachedHashString","usingWeakMap","weakMap","UID_HASH_KEY","canDefineProperty","propertyIsEnumerable","nodeType","uniqueID","getIENodeHash","objHashUID","isExtensible","defineProperty","enumerable","configurable","hashJSObj","charCodeAt","WeakMap","ToKeyedSequence","KeyedSeq$$1","indexed","useKeys","_iter","_useKeys","valueSeq","this$1","reversedSequence","reverseFactory","mapper","mappedSequence","mapFactory","ToIndexedSequence","IndexedSeq$$1","includes","ToSetSequence","SetSeq$$1","FromEntriesSequence","validateEntry","indexedCollection","flipFactory","flipSequence","makeSequence","cacheResultThrough","filterFactory","predicate","filterSequence","sliceFactory","originalSize","resolvedBegin","resolvedEnd","sliceSize","resolvedSize","sliceSeq","skipped","isSkipping","skipWhileFactory","skipSequence","skipping","concatFactory","isKeyedCollection","iters","singleton","concatSeq","flatten","sum","flattenFactory","depth","flatSequence","stopped","flatDeep","currentDepth","sortFactory","comparator","defaultComparator","maxFactory","maxCompare","comp","zipWithFactory","keyIter","zipper","zipAll","zipSequence","sizes","iterators","isDone","steps","every","some","reify","collectionClass","arrCopy","arr","offset","newArr","invariant","condition","error","assertNotInfinite","coerceKeyPath","keyPath","isPlainObj","isDataStructure","quoteString","JSON","stringify","_ignoreError","shallowCopy","updateIn","updater","updatedValue","updateInDeeply","inImmutable","existing","wasNotSet","existingValue","newValue","nextExisting","nextUpdated","remove","collectionCopy","emptyMap","setIn$1","setIn","deleteIn","removeIn","update$1","updateIn$1","mergeIntoKeyedWith","collections","merger","collection$1","__ownerID","withMutations","mergeIntoCollection","oldVal","mergeDeepWithSources","sources","mergeWithSources","deepMerger","oldValue","deepMergerWith","mergeWith","merge","mergeItem","hasVal","nextVal","mergeIn","mergeDeepIn","mutable","asMutable","wasAltered","__ensureOwner","asImmutable","__altered","KeyedCollection$$1","keyValues","_root","updateMap","deleteAll","__hash","OrderedMap","sortBy","MapIterator","iterate","ownerID","makeMap","MapPrototype","removeAll","mergeDeep","mergeDeepWith","ArrayMapNode","keyHash","didChangeSize","didAlter","removed","idx","exists","MAX_ARRAY_MAP_SIZE","ValueNode","createNodes","isEditable","newEntries","BitmapIndexedNode","bitmap","bit","popCount","keyHashFrag","newNode","updateNode","MAX_BITMAP_INDEXED_SIZE","including","count","expandedNodes","HashArrayMapNode","expandNodes","isLeafNode","newBitmap","newNodes","setAt","canEdit","newLen","newArray","after","spliceOut","spliceIn","newCount","MIN_HASH_ARRAY_MAP_SIZE","excluding","packedII","packedNodes","packNodes","HashCollisionNode","mergeIntoNode","keyMatch","maxIndex","EMPTY_MAP","Iterator$$1","_type","_reverse","_stack","mapIteratorFrame","mapIteratorValue","subNode","__prev","prev","root","hash$$1","newRoot","newSize","idx1","idx2","x","IS_LIST_SYMBOL","isList","maybeList","List","IndexedCollection$$1","emptyList","makeList","VNode","list","setSize","listNodeFor","_origin","setListBounds","newTail","_tail","getTailOffset","_capacity","updateVNode","_level","updateList","oldSize","unshift","arguments$1","seqs","argument","iterateList","DONE","ListPrototype","removeBefore","originIndex","newChild","removingFirst","oldChild","editable","editableVNode","removeAfter","sizeIndex","EMPTY_LIST","left","right","tailPos","tail","iterateNodeOrLeaf","iterateLeaf","iterateNode","capacity","nodeHas","lowerNode","newLowerNode","rawIndex","owner","oldOrigin","oldCapacity","newOrigin","newCapacity","newLevel","offsetShift","oldTailOffset","newTailOffset","oldTail","beginIndex","EMPTY_ORDERED_MAP","Map$$1","emptyOrderedMap","_map","_list","updateOrderedMap","newMap","newList","makeOrderedMap","omap","toMap","IS_STACK_SYMBOL","isStack","maybeStack","Stack","emptyStack","pushAll","head","_head","peek","makeStack","EMPTY_STACK","StackPrototype","unshiftAll","IS_SET_SYMBOL","isSet","maybeSet","isOrderedSet","maybeOrderedSet","deepEqual","notAssociative","allEqual","bSize","mixin","ctor","methods","keyCopier","getOwnPropertySymbols","toJS","result$1","SetCollection$$1","emptySet","fromKeys","keySeq","intersect","sets","SetPrototype","union","updateSet","removes","adds","mapped","toRemove","subtract","OrderedSet","__make","__empty","EMPTY_SET","makeSet","EMPTY_RANGE","Range","_start","_end","_step","ceil","searchValue","possibleIndex","offsetValue","lastIndexOf","other","getIn","searchKeyPath","toObject","isIterable","useTuples","toOrderedMap","toOrderedSet","toSet","toStack","toList","__toStringMapper","returnValue","find","findEntry","sideEffect","bind","separator","joined","isFirst","reducer","initialReduction","reduceRight","not","butLast","isEmpty","countBy","grouper","groups","countByFactory","entriesSequence","entryMapper","filterNot","found","findKey","findLast","findLastEntry","findLastKey","first","flatMap","coerce","flatMapFactory","searchKey","groupBy","isKeyedIter","groupByFactory","hasIn","isSubset","isSuperset","keyOf","keyMapper","last","lastKeyOf","maxBy","neg","defaultNegComparator","minBy","skip","skipLast","skipWhile","skipUntil","take","takeLast","takeWhile","takeSequence","iterating","takeWhileFactory","takeUntil","ordered","keyed","murmurHashOfSize","hashMerge","hashCollection","CollectionPrototype","toJSON","chain","contains","mapEntries","mapKeys","KeyedCollectionPrototype","findIndex","removeNum","numArgs","spliced","findLastIndex","interpose","interposedSequence","interposeFactory","interleave","zipped","interleaved","zip","defaultZipper","zipWith","IndexedCollectionPrototype","reduction","useFirst","Set$$1","emptyOrderedSet","EMPTY_ORDERED_SET","OrderedSetPrototype","makeOrderedSet","fromJS","converter","fromJSWith","defaultConverter","parentValue","converted","ui","borderSize","selectedMenu","selectedColor","cellSize","pos","dataUI","canvas","rect","xCount","yCount","toggleCell","y","onClick","onMouseDown","onMouseUp","onMouseMove","disabled","resizeObserver","ResizeObserver","getBoundingClientRect","getIndices","width","offsetX","offsetY","drawForm","fillStyle","fillRect","height","fillBorders","j","innerCellMargin","observe","unobserve","syncCanvasDimensions","indices","draft","localStorage","getItem","parse","treadling","threading","warpColors","weftColors","tieup","shaftCount","treadleCount","warpCount","pickCount","yarn","setItem","drop","removeItem","amountToAdd","changeArraySize","pattern","warpOrWeft","mirroredRepeat","newDraft","defaultValue","wc","$draft","changed","DraftUtil","updateShaftOrTreadleCounts","updateWarpCount","updatePickCount","u","VertexArray","gl","vertexData","indexData","attrs","drawMode","TRIANGLES","Float32Array","Uint16Array","initialize","vertBuf","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","indexBuf","ELEMENT_ARRAY_BUFFER","isInitialized","attrSum","pointer","vertexAttribPointer","FLOAT","enableVertexAttribArray","drawElements","UNSIGNED_SHORT","disableVertexAttribArray","deleteBuffer","Shader","vert","attributes","getAttributes","row","compiled","useProgram","program","uniforms","vertProgram","compileShader","VERTEX_SHADER","fragProgram","FRAGMENT_SHADER","createShaderProgram","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","groupCollapsed","log","groupEnd","vertexShader","fragmentShader","shaderProgram","createProgram","attachShader","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","info","getProgramInfoLog","uniformName","handle","getUniformLocation","uniformHandle","getUniformHandle","uniform1i","uniform1f","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","setInt","EPSILON","ARRAY_TYPE","glMatrix.ARRAY_TYPE","identity","translate","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","z","scale","fromRotationTranslationScale","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","fromValues","cross","ax","ay","az","bx","by","bz","hypot","sqrt","vec","setAxisAngle","axis","rad","sin","cos","slerp","omega","cosom","sinom","scale0","scale1","aw","bw","glMatrix.EPSILON","acos","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","normalize","vec3.create","vec3.fromValues","dot","transformMat4","sub","mul","onHexInputChange","body","premultipliedAlpha","preserveDrawingBuffer","clearColor","mouseDown","colorWheelToggle","triangleToggle","colorWheelShader","compile","satValShader","solidShader","quad","triP","triPT","vec2.create","uv","triangle","ring","geometry","draw","points","innerRadius","super","numPoints","PI","justify","generateGeometry","triangleModel","mat4.create","updateColor","onCanvasMouseMove","buttons","coords","clientX","clientY","saturation","handleInput","positionInWheel","dist","v1","v2","v1n","vec2.normalize","v2n","vec2.dot","det","atan2","getAngle","getPositionInWheel","positionInTriangle","getPositionInTriangle","line","vec2.sub","vec2.len","vec2.scaleAndAdd","getClosestPointToTriangle","fireEvent","setState","ratio","coord","render","COLOR_BUFFER_BIT","resolution","setVec2","unbind","rot","hueRot","quat.setAxisAngle","quat.create","mat4.fromRotationTranslationScale","vec2.transformMat4","mvp2","mat4.translate","b00","b01","b02","b10","b11","b12","b20","b21","b22","mat4.rotate","mat4.scale","setMat4","setFloat","r1","vec2.mul","r2","res","vec2.add","getTriangleCoordinateFromColor","svMarkerColor","setVec4","hueMarkerColor","hueMarkerMatrix","a30","a31","a32","a33","b0","b1","b2","b3","mat4.multiply","yx","zx","zy","mat4.fromQuat","newState","elm","beforeElm","onChange","hexString","canvasColorChange","inColor","colors","yarnsElm","settingsElm","newYarnName","newYarnColor","yarnUnderModification","selectYarnForModification","updateYarn","deleteColor","stopPropagation","x0","y0","x1","y1","dx","dy","err","e2","gridIcon","addArrays","prevWarpOrWeft","grid","cellData","fromPos","isDragging","linePoints","temp","newPattern","draftUtil","applyPattern","$ui","movementX","movementY","lp","icon","sidebarWidth","sidebar","items","WeaveSettings","YarnSettings","PatternFill","selectMenu","ShaderBuilder","shaderCache","shaderName","genUV2D","buildShader","Texture","Uint8Array","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_T","CLAMP_TO_EDGE","TEXTURE_WRAP_S","deleteTexture","unit","activeTexture","TEXTURE0","setColorArea","texSubImage2D","RendererEventTarget","shaders","getShader","centerQuad","clickListeners","pointerMoveListeners","pointerUpListeners","pointerDownListeners","handleEvent","TieupRenderer","toggleFunction","eventListeners","settings","mvp","initialView","view","cw","ch","scrollX","scrollY","mat4.identity","rendererPos","gridX","gridY","gridW","gridH","cellToggleTexture","setSampler2D","GridRenderer","vertical","xOffset","yOffset","cellX","cellY","minorSize","WeaveRenderer","weaveShader","warpTexture","weftTexture","ColorRowRenderer","colorTexture","create1DGridTexture","shafts","gridTexture","absence","createColorTexture","yarns","Renderer","disable","CULL_FACE","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","maxTextureSize","getParameter","MAX_TEXTURE_SIZE","threadingTexture","treadlingTexture","tieupTexture","resizeCanvas","extension","getExtension","loseContext","warpColor","weftColor","weave","renderers","renderer","emitPointerMove","emitPointerUp","emitPointerDown","emitClick","renderNextFrame","requestAnimationFrame","setRendererPosition","prevDraft","prevUI","updateTextures","setTextures","isDifferent","updateValues","setCellToggleTexture","setColorTexture","createGridTexture","viewport","colorStart","colorEnd","drag","hasDragged","oldLinePoints","updateListWithLine","startDrag","linePointsChanged","onMove","stopDrag","offsetWidth","offsetHeight","onPointerDown","onPointerMove","renderPoints","onPointerUp","newTieup","updateGridWithLine","isToggled","setColor","scrollContainer","canvasContainer","weaveDisplay","newCellSize","scrollbarWidth","updatePosition","scrollLeftMax","scrollLeft","scrollTopMax","scrollTop","clientWidth","scrollTo","Help","Editor","app"],"mappings":"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"}