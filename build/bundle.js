var app=function(){"use strict";var e=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e){!function(t){var n=/^\s+/,r=/\s+$/,i=0,o=t.round,l=t.min,a=t.max,s=t.random;function u(e,s){if(s=s||{},(e=e||"")instanceof u)return e;if(!(this instanceof u))return new u(e,s);var c=function(e){var i={r:0,g:0,b:0},o=1,s=null,u=null,c=null,d=!1,h=!1;"string"==typeof e&&(e=function(e){e=e.replace(n,"").replace(r,"").toLowerCase();var t,i=!1;if(k[e])e=k[e],i=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=j.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=j.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=j.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=j.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=j.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=j.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=j.hex8.exec(e))return{r:R(t[1]),g:R(t[2]),b:R(t[3]),a:V(t[4]),format:i?"name":"hex8"};if(t=j.hex6.exec(e))return{r:R(t[1]),g:R(t[2]),b:R(t[3]),format:i?"name":"hex"};if(t=j.hex4.exec(e))return{r:R(t[1]+""+t[1]),g:R(t[2]+""+t[2]),b:R(t[3]+""+t[3]),a:V(t[4]+""+t[4]),format:i?"name":"hex8"};if(t=j.hex3.exec(e))return{r:R(t[1]+""+t[1]),g:R(t[2]+""+t[2]),b:R(t[3]+""+t[3]),format:i?"name":"hex"};return!1}(e));"object"==typeof e&&(I(e.r)&&I(e.g)&&I(e.b)?(i=function(e,t,n){return{r:255*A(e,255),g:255*A(t,255),b:255*A(n,255)}}(e.r,e.g,e.b),d=!0,h="%"===String(e.r).substr(-1)?"prgb":"rgb"):I(e.h)&&I(e.s)&&I(e.v)?(s=z(e.s),u=z(e.v),i=function(e,n,r){e=6*A(e,360),n=A(n,100),r=A(r,100);var i=t.floor(e),o=e-i,l=r*(1-n),a=r*(1-o*n),s=r*(1-(1-o)*n),u=i%6;return{r:255*[r,a,l,l,s,r][u],g:255*[s,r,r,a,l,l][u],b:255*[l,l,s,r,r,a][u]}}(e.h,s,u),d=!0,h="hsv"):I(e.h)&&I(e.s)&&I(e.l)&&(s=z(e.s),c=z(e.l),i=function(e,t,n){var r,i,o;function l(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=A(e,360),t=A(t,100),n=A(n,100),0===t)r=i=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,s=2*n-a;r=l(s,a,e+1/3),i=l(s,a,e),o=l(s,a,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,s,c),d=!0,h="hsl"),e.hasOwnProperty("a")&&(o=e.a));return o=E(o),{ok:d,format:e.format||h,r:l(255,a(i.r,0)),g:l(255,a(i.g,0)),b:l(255,a(i.b,0)),a:o}}(e);this._originalInput=e,this._r=c.r,this._g=c.g,this._b=c.b,this._a=c.a,this._roundA=o(100*this._a)/100,this._format=s.format||c.format,this._gradientType=s.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b)),this._ok=c.ok,this._tc_id=i++}function c(e,t,n){e=A(e,255),t=A(t,255),n=A(n,255);var r,i,o=a(e,t,n),s=l(e,t,n),u=(o+s)/2;if(o==s)r=i=0;else{var c=o-s;switch(i=u>.5?c/(2-o-s):c/(o+s),o){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return{h:r,s:i,l:u}}function d(e,t,n){e=A(e,255),t=A(t,255),n=A(n,255);var r,i,o=a(e,t,n),s=l(e,t,n),u=o,c=o-s;if(i=0===o?0:c/o,o==s)r=0;else{switch(o){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return{h:r,s:i,v:u}}function h(e,t,n,r){var i=[D(o(e).toString(16)),D(o(t).toString(16)),D(o(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function f(e,t,n,r){return[D(O(r)),D(o(e).toString(16)),D(o(t).toString(16)),D(o(n).toString(16))].join("")}function p(e,t){t=0===t?0:t||10;var n=u(e).toHsl();return n.s-=t/100,n.s=P(n.s),u(n)}function g(e,t){t=0===t?0:t||10;var n=u(e).toHsl();return n.s+=t/100,n.s=P(n.s),u(n)}function v(e){return u(e).desaturate(100)}function m(e,t){t=0===t?0:t||10;var n=u(e).toHsl();return n.l+=t/100,n.l=P(n.l),u(n)}function w(e,t){t=0===t?0:t||10;var n=u(e).toRgb();return n.r=a(0,l(255,n.r-o(-t/100*255))),n.g=a(0,l(255,n.g-o(-t/100*255))),n.b=a(0,l(255,n.b-o(-t/100*255))),u(n)}function b(e,t){t=0===t?0:t||10;var n=u(e).toHsl();return n.l-=t/100,n.l=P(n.l),u(n)}function y(e,t){var n=u(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,u(n)}function $(e){var t=u(e).toHsl();return t.h=(t.h+180)%360,u(t)}function x(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+120)%360,s:t.s,l:t.l}),u({h:(n+240)%360,s:t.s,l:t.l})]}function C(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+90)%360,s:t.s,l:t.l}),u({h:(n+180)%360,s:t.s,l:t.l}),u({h:(n+270)%360,s:t.s,l:t.l})]}function _(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+72)%360,s:t.s,l:t.l}),u({h:(n+216)%360,s:t.s,l:t.l})]}function S(e,t,n){t=t||6,n=n||30;var r=u(e).toHsl(),i=360/n,o=[u(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(u(r));return o}function T(e,t){t=t||6;for(var n=u(e).toHsv(),r=n.h,i=n.s,o=n.v,l=[],a=1/t;t--;)l.push(u({h:r,s:i,v:o})),o=(o+a)%1;return l}u.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,n,r,i=this.toRgb();return e=i.r/255,n=i.g/255,r=i.b/255,.2126*(e<=.03928?e/12.92:t.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:t.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:t.pow((r+.055)/1.055,2.4))},setAlpha:function(e){return this._a=E(e),this._roundA=o(100*this._a)/100,this},toHsv:function(){var e=d(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=d(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),r=o(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=c(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=c(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),r=o(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return h(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var l=[D(o(e).toString(16)),D(o(t).toString(16)),D(o(n).toString(16)),D(O(r))];if(i&&l[0].charAt(0)==l[0].charAt(1)&&l[1].charAt(0)==l[1].charAt(1)&&l[2].charAt(0)==l[2].charAt(1)&&l[3].charAt(0)==l[3].charAt(1))return l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0)+l[3].charAt(0);return l.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(100*A(this._r,255))+"%",g:o(100*A(this._g,255))+"%",b:o(100*A(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+o(100*A(this._r,255))+"%, "+o(100*A(this._g,255))+"%, "+o(100*A(this._b,255))+"%)":"rgba("+o(100*A(this._r,255))+"%, "+o(100*A(this._g,255))+"%, "+o(100*A(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(M[h(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+f(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=u(e);n="#"+f(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return u(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(m,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(p,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(v,arguments)},spin:function(){return this._applyModification(y,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(S,arguments)},complement:function(){return this._applyCombination($,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(x,arguments)},tetrad:function(){return this._applyCombination(C,arguments)}},u.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:z(e[r]));e=n}return u(e,t)},u.equals=function(e,t){return!(!e||!t)&&u(e).toRgbString()==u(t).toRgbString()},u.random=function(){return u.fromRatio({r:s(),g:s(),b:s()})},u.mix=function(e,t,n){n=0===n?0:n||50;var r=u(e).toRgb(),i=u(t).toRgb(),o=n/100;return u({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},u.readability=function(e,n){var r=u(e),i=u(n);return(t.max(r.getLuminance(),i.getLuminance())+.05)/(t.min(r.getLuminance(),i.getLuminance())+.05)},u.isReadable=function(e,t,n){var r,i,o=u.readability(e,t);switch(i=!1,(r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},u.mostReadable=function(e,t,n){var r,i,o,l,a=null,s=0;i=(n=n||{}).includeFallbackColors,o=n.level,l=n.size;for(var c=0;c<t.length;c++)(r=u.readability(e,t[c]))>s&&(s=r,a=u(t[c]));return u.isReadable(e,a,{level:o,size:l})||!i?a:(n.includeFallbackColors=!1,u.mostReadable(e,["#fff","#000"],n))};var k=u.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},M=u.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(k);function E(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function A(e,n){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=l(n,a(0,parseFloat(e))),r&&(e=parseInt(e*n,10)/100),t.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function P(e){return l(1,a(0,e))}function R(e){return parseInt(e,16)}function D(e){return 1==e.length?"0"+e:""+e}function z(e){return e<=1&&(e=100*e+"%"),e}function O(e){return t.round(255*parseFloat(e)).toString(16)}function V(e){return R(e)/255}var L,N,F,j=(N="[\\s|\\(]+("+(L="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",F="[\\s|\\(]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",{CSS_UNIT:new RegExp(L),rgb:new RegExp("rgb"+N),rgba:new RegExp("rgba"+F),hsl:new RegExp("hsl"+N),hsla:new RegExp("hsla"+F),hsv:new RegExp("hsv"+N),hsva:new RegExp("hsva"+F),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function I(e){return!!j.CSS_UNIT.exec(e)}e.exports?e.exports=u:window.tinycolor=u}(Math)}));function t(){}const n=e=>e;function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function l(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t}function s(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(s(t,n))}function c(e,t,n,r){if(e){const i=d(e,t,n,r);return e[0](i)}}function d(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function h(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}function f(e,t,n,r,i,o){if(i){const l=d(t,n,r,o);e.p(l,i)}}function p(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function g(e){return null==e?"":e}function v(e,t,n){return e.set(n),t}const m="undefined"!=typeof window;let w=m?()=>window.performance.now():()=>Date.now(),b=m?e=>requestAnimationFrame(e):t;const y=new Set;function $(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&b($)}function x(e,t){e.appendChild(t)}function C(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function _(e){const t=M("style");return function(e,t){x(e.head||e,t)}(C(e),t),t}function S(e,t,n){e.insertBefore(t,n||null)}function T(e){e.parentNode.removeChild(e)}function k(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function M(e){return document.createElement(e)}function E(e){return document.createTextNode(e)}function A(){return E(" ")}function P(){return E("")}function R(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function D(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function z(e){return""===e?null:+e}function O(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function V(e,t){e.value=null==t?"":t}function L(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}e.selectedIndex=-1}function N(e,t,n){e.classList[n?"add":"remove"](t)}class F{constructor(){this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.e=M(t.nodeName),this.t=t,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)S(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(T)}}const j=new Set;let I,B=0;function X(e,t,n,r,i,o,l,a=0){const s=16.666/r;let u="{\n";for(let e=0;e<=1;e+=s){const r=t+(n-t)*o(e);u+=100*e+`%{${l(r,1-r)}}\n`}const c=u+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(c)}_${a}`,h=C(e);j.add(h);const f=h.__svelte_stylesheet||(h.__svelte_stylesheet=_(e).sheet),p=h.__svelte_rules||(h.__svelte_rules={});p[d]||(p[d]=!0,f.insertRule(`@keyframes ${d} ${c}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${d} ${r}ms linear ${i}ms 1 both`,B+=1,d}function Y(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-r.length;i&&(e.style.animation=r.join(", "),B-=i,B||b((()=>{B||(j.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),j.clear())})))}function H(e){I=e}function U(){if(!I)throw new Error("Function called outside component initialization");return I}function W(e){U().$$.on_mount.push(e)}function q(e){U().$$.after_update.push(e)}function K(e){U().$$.on_destroy.push(e)}function G(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const J=[],Z=[],Q=[],ee=[],te=Promise.resolve();let ne=!1;function re(e){Q.push(e)}function ie(e){ee.push(e)}let oe=!1;const le=new Set;function ae(){if(!oe){oe=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];H(t),se(t.$$)}for(H(null),J.length=0;Z.length;)Z.pop()();for(let e=0;e<Q.length;e+=1){const t=Q[e];le.has(t)||(le.add(t),t())}Q.length=0}while(J.length);for(;ee.length;)ee.pop()();ne=!1,oe=!1,le.clear()}}function se(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(re)}}let ue;function ce(e,t,n){e.dispatchEvent(function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(`${t?"intro":"outro"}${n}`))}const de=new Set;let he;function fe(){he={r:0,c:[],p:he}}function pe(){he.r||o(he.c),he=he.p}function ge(e,t){e&&e.i&&(de.delete(e),e.i(t))}function ve(e,t,n,r){if(e&&e.o){if(de.has(e))return;de.add(e),he.c.push((()=>{de.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}const me={duration:0};function we(e,r,i,a){let s=r(e,i),u=a?0:1,c=null,d=null,h=null;function f(){h&&Y(e,h)}function p(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(r){const{delay:i=0,duration:l=300,easing:a=n,tick:g=t,css:v}=s||me,m={start:w()+i,b:r};r||(m.group=he,he.r+=1),c||d?d=m:(v&&(f(),h=X(e,u,r,l,i,a,v)),r&&g(0,1),c=p(m,l),re((()=>ce(e,r,"start"))),function(e){let t;0===y.size&&b($),new Promise((n=>{y.add(t={c:e,f:n})}))}((t=>{if(d&&t>d.start&&(c=p(d,l),d=null,ce(e,c.b,"start"),v&&(f(),h=X(e,u,c.b,c.duration,0,a,s.css))),c)if(t>=c.end)g(u=c.b,1-u),ce(e,c.b,"end"),d||(c.b?f():--c.group.r||o(c.group.c)),c=null;else if(t>=c.start){const e=t-c.start;u=c.a+c.d*a(e/c.duration),g(u,1-u)}return!(!c&&!d)})))}return{run(e){l(s)?(ue||(ue=Promise.resolve(),ue.then((()=>{ue=null}))),ue).then((()=>{s=s(),g(e)})):g(e)},end(){f(),c=d=null}}}function be(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function ye(e){e&&e.c()}function $e(e,t,n,i){const{fragment:a,on_mount:s,on_destroy:u,after_update:c}=e.$$;a&&a.m(t,n),i||re((()=>{const t=s.map(r).filter(l);u?u.push(...t):o(t),e.$$.on_mount=[]})),c.forEach(re)}function xe(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(e,t){-1===e.$$.dirty[0]&&(J.push(e),ne||(ne=!0,te.then(ae)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _e(e,n,r,l,a,s,u,c=[-1]){const d=I;H(e);const h=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:i(),dirty:c,skip_bound:!1,root:n.target||d.$$.root};u&&u(h.root);let f=!1;if(h.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return h.ctx&&a(h.ctx[t],h.ctx[t]=i)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](i),f&&Ce(e,t)),n})):[],h.update(),f=!0,o(h.before_update),h.fragment=!!l&&l(h.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);h.fragment&&h.fragment.l(e),e.forEach(T)}else h.fragment&&h.fragment.c();n.intro&&ge(e.$$.fragment),$e(e,n.target,n.anchor,n.customElement),ae()}H(d)}class Se{$destroy(){xe(this,1),this.$destroy=t}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Te=1e-6,ke="undefined"!=typeof Float32Array?Float32Array:Array;function Me(){var e=new ke(16);return ke!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ee(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ae(e,t,n){var r,i,o,l,a,s,u,c,d,h,f,p,g=n[0],v=n[1],m=n[2];return t===e?(e[12]=t[0]*g+t[4]*v+t[8]*m+t[12],e[13]=t[1]*g+t[5]*v+t[9]*m+t[13],e[14]=t[2]*g+t[6]*v+t[10]*m+t[14],e[15]=t[3]*g+t[7]*v+t[11]*m+t[15]):(r=t[0],i=t[1],o=t[2],l=t[3],a=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=l,e[4]=a,e[5]=s,e[6]=u,e[7]=c,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=r*g+a*v+d*m+t[12],e[13]=i*g+s*v+h*m+t[13],e[14]=o*g+u*v+f*m+t[14],e[15]=l*g+c*v+p*m+t[15]),e}function Pe(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Re(e,t,n,r){var i=t[0],o=t[1],l=t[2],a=t[3],s=i+i,u=o+o,c=l+l,d=i*s,h=i*u,f=i*c,p=o*u,g=o*c,v=l*c,m=a*s,w=a*u,b=a*c,y=r[0],$=r[1],x=r[2];return e[0]=(1-(p+v))*y,e[1]=(h+b)*y,e[2]=(f-w)*y,e[3]=0,e[4]=(h-b)*$,e[5]=(1-(d+v))*$,e[6]=(g+m)*$,e[7]=0,e[8]=(f+w)*x,e[9]=(g-m)*x,e[10]=(1-(d+p))*x,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function De(){var e=new ke(3);return ke!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ze(e,t,n){var r=new ke(3);return r[0]=e,r[1]=t,r[2]=n,r}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Oe(){var e=new ke(4);return ke!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ve(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}De(),function(){var e,t=(e=new ke(4),ke!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e)}();var Le;function Ne(){var e=new ke(2);return ke!=Float32Array&&(e[0]=0,e[1]=0),e}function Fe(e,t){var n=new ke(2);return n[0]=e,n[1]=t,n}function je(e,t){return e[0]=t[0],e[1]=t[1],e}function Ie(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Be(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function Xe(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function Ye(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function He(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Ue(e,t){return e[0]*t[0]+e[1]*t[1]}function We(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}De(),ze(1,0,0),ze(0,1,0),Oe(),Oe(),Le=new ke(9),ke!=Float32Array&&(Le[1]=0,Le[2]=0,Le[3]=0,Le[5]=0,Le[6]=0,Le[7]=0),Le[0]=1,Le[4]=1,Le[8]=1;var qe=Ye,Ke=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},Ge=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},Je=Xe;!function(){var e=Ne()}();class Ze{constructor(e,t,n,r,i=e.TRIANGLES){this.gl=e,t instanceof Float32Array?this.vertexData=t:this.vertexData=new Float32Array(t),n instanceof Uint16Array?this.indexData=n:this.indexData=new Uint16Array(n),this.drawMode=i,this.attrs=r,this.initialize(e)}initialize(e){this.vertBuf=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuf),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),void 0!==this.indexData&&(this.indexBuf=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuf),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indexData,e.STATIC_DRAW)),this.isInitialized=!0}bind(){if(!0!==this.isInitialized)return void console.error("Tried to use uninitialized VertexArray!");const e=this.attrs.reduce(((e,t)=>e+t));this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertBuf),void 0!==this.indexData&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf);let t=0;for(let n=0;n<this.attrs.length;n++)this.gl.vertexAttribPointer(n,this.attrs[n],this.gl.FLOAT,!1,4*e,4*t),this.gl.enableVertexAttribArray(n),t+=this.attrs[n]}draw(){this.gl.drawElements(this.drawMode,this.indexData.length,this.gl.UNSIGNED_SHORT,0)}unbind(){for(let e=0;e<this.attrs.length;e++)this.gl.disableVertexAttribArray(e);void 0!==this.indexData&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}free(){this.gl.deleteBuffer(this.vertBuf),this.indexBuf&&this.gl.deleteBuffer(this.indexBuf)}}class Qe{constructor(e){this.vert=e.vert,this.frag=e.frag,this.attributes=this.getAttributes(e.vert)}getAttributes(e){return e.split("\n").filter((e=>e.includes("attribute"))).map((e=>e.substring(e.lastIndexOf(" ")+1,e.length-1)))}bind(){if(!this.compiled)throw new Error("Can't bind uncompiled shader");this.gl.useProgram(this.program)}compile(e){if(this.gl=e,!this.compiled){this.uniforms={};const t=this.compileShader(this.gl,this.vert,e.VERTEX_SHADER),n=this.compileShader(this.gl,this.frag,e.FRAGMENT_SHADER);this.program=this.createShaderProgram(this.gl,t,n),this.compiled=!0}}isCompiled(){return this.compiled}compileShader(e,t,n){const r=e.createShader(n);return e.shaderSource(r,t),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.error(`Error when compiling shader: ${e.getShaderInfoLog(r)}`),console.groupCollapsed("Shader source"),console.log(t),console.groupEnd(),null)}createShaderProgram(e,t,n){const r=e.createProgram();e.attachShader(r,t),e.attachShader(r,n);for(let t=0;t<this.attributes.length;t++)e.bindAttribLocation(r,t,this.attributes[t]);if(e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)){let t=e.getProgramInfoLog(r);console.error(`Error compiling shader: \n\n${t}`)}return e.useProgram(r),r}getUniformHandle(e){if(void 0===this.uniforms[e]){let t=this.gl.getUniformLocation(this.program,e);this.uniforms[e]=t}return this.uniforms[e]}setBool(e,t){let n=this.getUniformHandle(e);this.gl.uniform1i(n,t?1:0)}setInt(e,t){let n=this.getUniformHandle(e);this.gl.uniform1i(n,t)}setFloat(e,t){let n=this.getUniformHandle(e);this.gl.uniform1f(n,t)}setVec2(e,t){let n=this.getUniformHandle(e);this.gl.uniform2fv(n,t)}setVec3(e,t){let n=this.getUniformHandle(e);this.gl.uniform3fv(n,t)}setVec4(e,t){let n=this.getUniformHandle(e);this.gl.uniform4fv(n,t)}setMat3(e,t){let n=this.getUniformHandle(e);this.gl.uniformMatrix3fv(n,!1,t)}setMat4(e,t){let n=this.getUniformHandle(e);this.gl.uniformMatrix4fv(n,!1,t)}setSampler2D(e,t){this.setInt(e,t)}unbind(){this.gl.useProgram(null)}}class et{constructor(e,t=6,n=.5){this.points=t,this.geometry=function(e,t,n){let r=[0,0,0],i=[];for(let e=0;e<2*(t+1);e++){let i=Math.PI/t*e,o=[(1-n)/2*Math.sin(i),(1-n)/2*Math.cos(i)];e%2==0?(r.push(Math.sin(i)+o[0]),r.push(Math.cos(i)+o[1])):(r.push(Math.sin(i)*n+o[0]),r.push(Math.cos(i)*n+o[1])),r.push(0)}for(let e=0;e<t;e++)[3,2,1,3,4,2].map((t=>t+2*e)).forEach((e=>i.push(e)));return new Ze(e,r,i,[3],e.TRIANGLES)}(e,t,n)}bind(e){this.geometry.bind(e)}unbind(e){this.geometry.bind(e)}draw(e){this.geometry.draw(e)}}function tt(e){let n,r,i,l,a,s,u,c;return{c(){n=M("div"),r=M("div"),i=M("canvas"),l=A(),a=M("input"),D(i,"class","color-input-canvas svelte-1ocz4nw"),D(i,"width","512"),D(i,"height","512"),D(a,"type","text"),D(a,"spellcheck","false"),D(a,"maxlength","7"),D(a,"style",s=`color: ${e[2].isLight()?"black":"white"}; background-color: #${e[3]}`),a.value=e[3],D(a,"class","svelte-1ocz4nw"),D(r,"class","color-input-color"),D(n,"class","color-picker svelte-1ocz4nw")},m(t,o){S(t,n,o),x(n,r),x(r,i),e[8](i),x(r,l),x(r,a),e[9](n),u||(c=[R(a,"input",e[4]),R(a,"paste",e[4])],u=!0)},p(e,t){12&t[0]&&s!==(s=`color: ${e[2].isLight()?"black":"white"}; background-color: #${e[3]}`)&&D(a,"style",s),8&t[0]&&a.value!==e[3]&&(a.value=e[3])},i:t,o:t,d(t){t&&T(n),e[8](null),e[9](null),u=!1,o(c)}}}function nt(t,n,r){let i,o,l,a,s,u,c,d,h,f,p,g=document.body;let v=!1,m=!1,w=!1,b={};function y(e){e.preventDefault(),g.addEventListener("pointermove",$),v=!0;let t=i.getBoundingClientRect(),n=C([2*((e.clientX-t.x)/t.width-.5),2*(-(e.clientY-t.y)/t.height+.5)]);if(void 0!==n){let{hue:e,saturation:t,value:r}=n;_(e,t,r)}}function $(e){if(e.preventDefault(),!0===v&&0===e.buttons)return v=!1,m=!1,w=!1,void g.removeEventListener("mousemove",$);if(v){let t=i.getBoundingClientRect(),n=C([2*((e.clientX-t.x)/t.width-.5),2*(-(e.clientY-t.y)/t.height+.5)]);if(void 0===n)return;{let{hue:e,saturation:t,value:r}=n;_(e,t,r)}}}function x(e){e.preventDefault(),g.removeEventListener("mousemove",$),v=!1,m=!1,w=!1}function C(e){let{hue:t,saturation:n,value:r}=b,i=function(e){let t=Xe(e,[0,0]);if(!w&&(m||t>.8&&t<1))return function(e,t){let n=He(Ne(),e),r=He(Ne(),t),i=Ue(n,r),o=n[0]*r[1]-n[1]*r[0],l=Math.atan2(o,i);return l<0&&(l+=2*Math.PI),l}([1,0],e)/(2*Math.PI);return}(e),o=S(e);if(void 0!==i)return t=i,m=!0,{hue:t,saturation:n,value:r};if(void 0!==o){let i=o;return(i.w+i.v>1||i.v<0||i.w<0)&&(i=function(e,t){let n,r;e.w+e.v>1?(n=d[1],r=d[2]):e.v<0?(n=d[0],r=d[2]):e.w<0&&(n=d[0],r=d[1]);let i=Ke(Ne(),n,r),o=qe(i);He(i,i);let l=Ue(Ke(Ne(),t,r),i);return l=Math.max(0,Math.min(o,l)),S(function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}(Ne(),r,i,l))}(i,e)),r=Math.max(0,Math.min(1,1-i.w)),n=Math.max(0,Math.min(1,i.u/r)),Number.isNaN(n)&&(n=0),w=!0,{hue:t,saturation:n,value:r}}}function _(t,n,i,o=!0){let l=e.fromRatio({h:t,s:n,v:i});k({hue:t,saturation:n,value:i});let a=l.toRgb(),s={r:a.r/255,g:a.g/255,b:a.b/255,a:a.a};var u;o&&(u=s,r(2,P=e.fromRatio(u)),r(3,D=P.toHex()),A(u))}function S(e){let t=d[0],n=Ke(Ne(),d[1],t),r=Ke(Ne(),d[2],t),i=Ke(Ne(),e,t),o=n[0]*r[1]-r[0]*n[1],l=(i[0]*(n[1]-r[1])+i[1]*(r[0]-n[0])+n[0]*r[1]-r[0]*n[1])/o,a=(i[0]*r[1]-i[1]*r[0])/o,s=(i[1]*n[0]-i[0]*n[1])/o;if(!m&&(w||l>0&&l<1&&a>0&&a<1&&s>0&&s<1))return{u:l,v:a,w:s}}function T(){let t=e.fromRatio({h:b.hue,s:b.saturation,v:b.value});o.clear(o.COLOR_BUFFER_BIT),u.bind();let n=[i.getAttribute("width"),i.getAttribute("height")];l.bind(),l.setVec2("resolution",n),u.draw(),u.unbind(),l.unbind(),a.bind(),h.bind(),p=Me();let r=b.hue*Math.PI*2-Math.PI/2,g=Ve(Oe(),[0,0,1],r);Re(p,g,De(),[.8,.8,.8]),We(d[0],c[0],p),We(d[1],c[1],p),We(d[2],c[2],p);let v=Me();Ae(v,v,[.5,.5,0]),function(e,t,n,r){var i,o,l,a,s,u,c,d,h,f,p,g,v,m,w,b,y,$,x,C,_,S,T,k,M=r[0],E=r[1],A=r[2],P=Math.hypot(M,E,A);P<Te||(M*=P=1/P,E*=P,A*=P,i=Math.sin(n),l=1-(o=Math.cos(n)),a=t[0],s=t[1],u=t[2],c=t[3],d=t[4],h=t[5],f=t[6],p=t[7],g=t[8],v=t[9],m=t[10],w=t[11],b=M*M*l+o,y=E*M*l+A*i,$=A*M*l-E*i,x=M*E*l-A*i,C=E*E*l+o,_=A*E*l+M*i,S=M*A*l+E*i,T=E*A*l-M*i,k=A*A*l+o,e[0]=a*b+d*y+g*$,e[1]=s*b+h*y+v*$,e[2]=u*b+f*y+m*$,e[3]=c*b+p*y+w*$,e[4]=a*x+d*C+g*_,e[5]=s*x+h*C+v*_,e[6]=u*x+f*C+m*_,e[7]=c*x+p*C+w*_,e[8]=a*S+d*T+g*k,e[9]=s*S+h*T+v*k,e[10]=u*S+f*T+m*k,e[11]=c*S+p*T+w*k,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(v,v,r,[0,0,1]),Pe(v,v,[.8,.8,.8]),a.setMat4("mvp",p),a.setFloat("hue",b.hue),h.draw(),h.unbind(),a.unbind(),s.bind(),f.bind();let m=function(e){let t=1-e.value,n=(1-e.saturation)*e.value,r=d[0],i=d[1],o=d[2],l=Ke(Ne(),i,r),a=Ke(Ne(),o,r),s=Ge(Ne(),l,[n,n]),u=Ge(Ne(),a,[t,t]),c=Ie(Ne(),s,u);return Ie(c,c,r),c}(b),w=t.isLight()?[0,0,0,1]:[1,1,1,1];s.setVec4("color",w),s.setMat4("mvp",Re(Me(),Oe(),[m[0],m[1],0],[.03,.03,1])),f.draw(),f.unbind();let y=e.fromRatio({h:b.hue,s:1,v:1}).isLight()?[0,0,0,1]:[1,1,1,1],$=Me(),x=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],l=n+n,a=r+r,s=i+i,u=n*l,c=r*l,d=r*a,h=i*l,f=i*a,p=i*s,g=o*l,v=o*a,m=o*s;return e[0]=1-d-p,e[1]=c+m,e[2]=h-v,e[3]=0,e[4]=c-m,e[5]=1-u-p,e[6]=f+g,e[7]=0,e[8]=h+v,e[9]=f-g,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(Me(),g);!function(e,t,n){var r=t[0],i=t[1],o=t[2],l=t[3],a=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],g=t[12],v=t[13],m=t[14],w=t[15],b=n[0],y=n[1],$=n[2],x=n[3];e[0]=b*r+y*a+$*d+x*g,e[1]=b*i+y*s+$*h+x*v,e[2]=b*o+y*u+$*f+x*m,e[3]=b*l+y*c+$*p+x*w,b=n[4],y=n[5],$=n[6],x=n[7],e[4]=b*r+y*a+$*d+x*g,e[5]=b*i+y*s+$*h+x*v,e[6]=b*o+y*u+$*f+x*m,e[7]=b*l+y*c+$*p+x*w,b=n[8],y=n[9],$=n[10],x=n[11],e[8]=b*r+y*a+$*d+x*g,e[9]=b*i+y*s+$*h+x*v,e[10]=b*o+y*u+$*f+x*m,e[11]=b*l+y*c+$*p+x*w,b=n[12],y=n[13],$=n[14],x=n[15],e[12]=b*r+y*a+$*d+x*g,e[13]=b*i+y*s+$*h+x*v,e[14]=b*o+y*u+$*f+x*m,e[15]=b*l+y*c+$*p+x*w}($,$,x),Ae($,$,[0,.9,0]),Pe($,$,[.015,.1,1]),u.bind(),s.setVec4("color",y),s.setMat4("mvp",$),u.draw(),u.unbind(),s.unbind()}function k(e){b=e,T()}K((()=>{g.removeEventListener("mousemove",$)}));let M,{value:E}=n,{onChange:A=(()=>{})}=n,P=e.fromRatio(E),R=P.toHsv(),D=P.toHex();return b={hue:R.h/360,value:R.v,saturation:R.s},W((()=>{!function(){o=i.getContext("webgl",{premultipliedAlpha:!0,preserveDrawingBuffer:!0}),o.clearColor(0,0,0,1),l=new Qe({frag:"precision highp float;\nuniform vec2 resolution;\n\n#define PI2 6.28318530718\n#define THICKNESS 0.2\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat getAngle(vec2 v1, vec2 v2) {\n  float det = v1.x*v2.y - v1.y * v2.x;\n  float rad = atan(dot(v1, v2), det);\n  if(rad < 0.0) {\n   rad += PI2;\n  }\n  return rad;\n}\n\nvoid main(void) {\n  vec2 pos = gl_FragCoord.xy / resolution.xy;\n  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n  vec2 center = vec2(0.5, 0.5);\n  float dist = distance(pos, center);\n  if(dist > 0.4 && dist < (0.3 + THICKNESS)) {\n    vec2 dir = normalize(pos - center);\n    float hue = getAngle(dir, vec2(0.0, 1.0)) / PI2;\n    vec3 hsv = hsv2rgb(vec3(hue, 1.0, 1.0));\n    color = vec4(hsv, 1.0);\n  }\n  gl_FragColor = color;\n}\n",vert:"attribute vec2 aVertexPosition;\nvarying vec2 uv;\nvoid main(void) {\n  uv = vec2(\n    clamp(aVertexPosition.x, 0.0, 1.0),\n    clamp(aVertexPosition.y, 0.0, 1.0)\n  );\n  gl_Position = vec4(vec3(aVertexPosition, 1.0), 1.0);\n}\n\n"}),l.compile(o),a=new Qe({frag:"precision highp float;\nvarying vec3 uvw;\nuniform float hue;\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main(void) {\n  float value = 1.0 - uvw.z;\n  float saturation = uvw.x / value;\n  vec3 color = hsv2rgb(vec3(hue, saturation, value));\n  gl_FragColor = vec4(color, 1.0);\n}\n",vert:"attribute vec2 aVertexPosition;\nattribute vec3 barycentric;\n\nvarying vec3 uvw;\nuniform mat4 mvp;\n\nvoid main(void) {\n  uvw = barycentric;\n  gl_Position = mvp * vec4(vec3(aVertexPosition, 1.0), 1.0);\n}\n\n"}),a.compile(o),s=new Qe({frag:"precision highp float;\nuniform vec4 color;\nvoid main(void) {\n  gl_FragColor = vec4(color);\n}\n",vert:"attribute vec2 aVertexPosition;\nuniform mat4 mvp;\nvoid main(void) {\n  gl_Position = mvp * vec4(vec3(aVertexPosition, 1.0), 1.0);\n}\n"}),s.compile(o),u=new Ze(o,[1,1,-1,1,-1,-1,1,-1],[1,0,2,2,0,3],[2]);let e=[[0,1],[.8660253882408142,-.5],[-.8660253882408142,-.5]];c=e,d=[Ne(),Ne(),Ne()];let t=[[1,0,0],[0,1,0],[0,0,1]];h=new Ze(o,[e[0][0],e[0][1],t[0][0],t[0][1],t[0][2],e[1][0],e[1][1],t[1][0],t[1][1],t[1][2],e[2][0],e[2][1],t[2][0],t[2][1],t[2][2]],[1,0,2],[2,3]),f=new et(o,24,.6),p=Me(),i.addEventListener("pointerdown",y),i.addEventListener("pointerup",x)}(),k(b)})),t.$$set=e=>{"value"in e&&r(6,E=e.value),"onChange"in e&&r(7,A=e.onChange)},[i,M,P,D,function(t){let n=t.target.value;"#"===n[0]&&(n=n.substr(1));let r=e(`#${n}`);if(6===n.length&&r.isValid()){let e=r.toHsv();_(e.h/360,e.s,e.v)}},function(){return v},E,A,function(e){Z[e?"unshift":"push"]((()=>{i=e,r(0,i)}))},function(e){Z[e?"unshift":"push"]((()=>{M=e,r(1,M)}))}]}class rt extends Se{constructor(e){super(),_e(this,e,nt,tt,a,{isMouseDown:5,value:6,onChange:7},null,[-1,-1])}get isMouseDown(){return this.$$.ctx[5]}}const it=[];function ot(e,n=t){let r;const i=new Set;function o(t){if(function(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}(e,t)&&(e=t,r)){const t=!it.length;for(const t of i)t[1](),it.push(t,e);if(t){for(let e=0;e<it.length;e+=2)it[e][0](it[e+1]);it.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(l,a=t){const s=[l,a];return i.add(s),1===i.size&&(r=n(o)||t),l(e),()=>{i.delete(s),0===i.size&&(r(),r=null)}}}}function lt(e,n,r){const i=!Array.isArray(e),a=i?[e]:e,u=n.length<2;return c=e=>{let r=!1;const c=[];let d=0,h=t;const f=()=>{if(d)return;h();const r=n(i?c[0]:c,e);u?e(r):h=l(r)?r:t},p=a.map(((e,t)=>s(e,(e=>{c[t]=e,d&=~(1<<t),r&&f()}),(()=>{d|=1<<t}))));return r=!0,f(),function(){o(p),h()}},{subscribe:ot(r,c).subscribe};var c}let at,st=0,ut=ot({}),ct=ot(!1),dt=ot([0,0]),ht=ot({r:1,g:0,b:0});ut.subscribe((e=>at=e));let ft={onColorChange:e=>{let t=st++;return ut.update((n=>({...n,[t]:e}))),t},removeListener:e=>{ut.update((t=>{let n={...t};return delete n[e],{...n}}))},showColorPicker:(e,t,n)=>{dt.set([e,t]),ct.set(!0),ht.set(n)},emit:e=>{console.log("emit"),Object.values(at).forEach((t=>t(e)))},listeners:ut,isVisible:ct,position:dt,color:ht};function pt(e){let t,n,r,i,o={value:e[5],onChange:e[11]};return n=new rt({props:o}),e[12](n),{c(){t=M("div"),ye(n.$$.fragment),D(t,"class","dialog svelte-7kugx9"),D(t,"style",r=`left: ${e[0]}px; top: ${e[1]}px`)},m(r,o){S(r,t,o),$e(n,t,null),e[13](t),i=!0},p(e,o){const l={};32&o&&(l.value=e[5]),n.$set(l),(!i||3&o&&r!==(r=`left: ${e[0]}px; top: ${e[1]}px`))&&D(t,"style",r)},i(e){i||(ge(n.$$.fragment,e),i=!0)},o(e){ve(n.$$.fragment,e),i=!1},d(r){r&&T(t),e[12](null),xe(n),e[13](null)}}}function gt(e){let t,n,r,i,l,a=e[4]&&pt(e);return{c(){t=A(),a&&a.c(),n=P()},m(o,s){S(o,t,s),a&&a.m(o,s),S(o,n,s),r=!0,i||(l=[R(document.body,"pointermove",e[9]),R(document.body,"pointerdown",e[10])],i=!0)},p(e,[t]){e[4]?a?(a.p(e,t),16&t&&ge(a,1)):(a=pt(e),a.c(),ge(a,1),a.m(n.parentNode,n)):a&&(fe(),ve(a,1,1,(()=>{a=null})),pe())},i(e){r||(ge(a),r=!0)},o(e){ve(a),r=!1},d(e){e&&T(t),a&&a.d(e),e&&T(n),i=!1,o(l)}}}function vt(e,t,n){let r,i,o,l,a,s=ft.position;u(e,s,(e=>n(14,i=e)));let c=ft.isVisible;u(e,c,(e=>n(4,r=e)));let d,h,f=ft.color;return u(e,f,(e=>n(5,o=e))),q((()=>{let e=i;r&&function(e,t){if(null!=d){let r=d.getBoundingClientRect();n(0,l=e-r.width/2),n(1,a=t+10),l<0&&n(0,l=0),l+r.width>window.innerWidth&&n(0,l=window.innerWidth-r.width),a+r.height>window.innerHeight&&n(1,a=window.innerHeight-r.height)}}(e[0],e[1])})),[l,a,d,h,r,o,s,c,f,function(e){if(r){let t=d.getBoundingClientRect(),n=t.x+t.width/2,i=t.y+t.height/2,o=Ke(Ne(),[e.clientX,e.clientY],[n,i]);(Math.abs(o[0])>220||Math.abs(o[1])>220&&!h.isMouseDown())&&v(c,r=!1,r)}},function(e){r&&(d.contains(e.target)||v(c,r=!1,r))},function(e){ft.emit(e)},function(e){Z[e?"unshift":"push"]((()=>{h=e,n(3,h)}))},function(e){Z[e?"unshift":"push"]((()=>{d=e,n(2,d)}))}]}class mt extends Se{constructor(e){super(),_e(this,e,vt,gt,a,{})}}function wt(e,{delay:t=0,duration:r=400,easing:i=n}={}){const o=+getComputedStyle(e).opacity;return{delay:t,duration:r,easing:i,css:e=>"opacity: "+e*o}}const bt={fallbackLocale:"",initialLocale:"",loadingDelay:200,formats:{number:{scientific:{notation:"scientific"},engineering:{notation:"engineering"},compactLong:{notation:"compact",compactDisplay:"long"},compactShort:{notation:"compact",compactDisplay:"short"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},warnOnMissingMessages:!0};let yt,$t;function xt(){return yt}function Ct(){return bt}function _t(e){return e.split("-").map(((e,t,n)=>n.slice(0,t+1).join("-"))).reverse()}function St(e,t=Ct().fallbackLocale){const n=_t(e);return t?[...new Set([...n,..._t(t)])]:n}const Tt=ot({});function kt(e){return e in $t}function Mt(e,t){if(kt(e)){const n=function(e){return $t[e]||null}(e);if(t in n)return n[t];const r=t.split(".");let i=n;for(let e=0;e<r.length;e++){if("object"!=typeof i[r[e]])return i[r[e]]||null;i=i[r[e]]}}return null}function Et(e,...t){Tt.update((n=>(n[e]=Object.assign(n[e]||{},...t),n)))}Tt.subscribe((e=>$t=e));const At=ot(!1),Pt={};function Rt(e){return Pt[e]}function Dt(e){return St(e).reverse().some(Rt)}const zt={};function Ot(e){if(!Dt(e))return Promise.resolve();if(e in zt)return zt[e];const t=function(e){return St(e).reverse().map((e=>{const t=Rt(e);return[e,t?[...t]:[]]})).filter((([,e])=>e.length>0))}(e);if(0===t.length)return Promise.resolve();const n=setTimeout((()=>At.set(!0)),Ct().loadingDelay);return zt[e]=Promise.all(t.map((([e,t])=>Promise.all(t.map((e=>e()))).then((t=>{!function(e){delete Pt[e]}(e),t=t.map((e=>e.default||e)),Et(e,...t)}))))).then((()=>{clearTimeout(n),At.set(!1),delete zt[e]})),zt[e]}const Vt=ot("");Vt.subscribe((e=>{yt=e,"undefined"!=typeof window&&document.documentElement.setAttribute("lang",e)}));const Lt=Vt.set;Vt.set=e=>function(e){if(null==e)return null;const t=St(e);for(let e=0;e<t.length;e++){const n=t[e];if(kt(n))return n}return null}(e)&&Dt(e)?Ot(e).then((()=>Lt(e))):Lt(e),Vt.update=e=>{let t=xt();e(t),Lt(t)};const Nt={},Ft=(e,t,n)=>n?(t in Nt||(Nt[t]={}),e in Nt[t]||(Nt[t][e]=n),n):n,jt=(e,t={})=>{const n="string"==typeof e?e:e.id,r="string"==typeof e?t:e,{values:i,locale:o=xt(),default:l}=r;if(null==o)throw new Error("[svelte-i18n] Cannot format a message without first setting the initial locale.");let a=((e,t)=>{if(null==t)return;if(t in Nt&&e in Nt[t])return Nt[t][e];const n=St(t);for(let r=0;r<n.length;r++){const i=Mt(n[r],e);if(i)return Ft(e,t,i)}})(n,o);return"string"==typeof a?a:"function"==typeof a?a(...Object.keys(r.values||{}).sort().map((e=>(r.values||{})[e]))):(Ct().warnOnMissingMessages&&console.warn(`[svelte-i18n] The message "${n}" was not found in "${St(o).join('", "')}".${Dt(xt())?"\n\nNote: there are at least one loader still registered to this locale that wasn't executed.":""}`),l||n)},It=lt([Vt,Tt],(()=>jt));function Bt(e){let n,r,i,l,a,s;return{c(){n=M("label"),r=E(e[1]),i=A(),l=M("input"),D(l,"type","text"),D(l,"autocomplete","number"),D(l,"id","warp-count"),l.disabled=e[2],D(l,"class","svelte-1fqrv9k"),D(n,"class","svelte-1fqrv9k"),N(n,"disabled",e[2])},m(t,o){S(t,n,o),x(n,r),x(n,i),x(n,l),V(l,e[0]),a||(s=[R(l,"input",e[3]),R(l,"input",e[4])],a=!0)},p(e,[t]){2&t&&O(r,e[1]),4&t&&(l.disabled=e[2]),1&t&&l.value!==e[0]&&V(l,e[0]),4&t&&N(n,"disabled",e[2])},i:t,o:t,d(e){e&&T(n),a=!1,o(s)}}}function Xt(e,t,n){let{value:r}=t,{label:i}=t,{disabled:o=!1}=t;return e.$$set=e=>{"value"in e&&n(0,r=e.value),"label"in e&&n(1,i=e.label),"disabled"in e&&n(2,o=e.disabled)},[r,i,o,function(t){G.call(this,e,t)},function(){r=this.value,n(0,r)}]}class Yt extends Se{constructor(e){super(),_e(this,e,Xt,Bt,a,{value:0,label:1,disabled:2})}}function Ht(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("production"!==process.env.NODE_ENV){var i=zn[e],o=i?"function"==typeof i?i.apply(null,n):i:"unknown error nr: "+e;throw Error("[Immer] "+o)}throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ut(e){return!!e&&!!e[Dn]}function Wt(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&Function.toString.call(n)===On}(e)||Array.isArray(e)||!!e[Rn]||!!e.constructor[Rn]||Qt(e)||en(e))}function qt(e,t,n){void 0===n&&(n=!1),0===Kt(e)?(n?Object.keys:Vn)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function Kt(e){var t=e[Dn];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Qt(e)?2:en(e)?3:0}function Gt(e,t){return 2===Kt(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Jt(e,t){return 2===Kt(e)?e.get(t):e[t]}function Zt(e,t,n){var r=Kt(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function Qt(e){return Mn&&e instanceof Map}function en(e){return En&&e instanceof Set}function tn(e){return e.o||e.t}function nn(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Ln(e);delete t[Dn];for(var n=Vn(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function rn(e,t){return void 0===t&&(t=!1),ln(e)||Ut(e)||!Wt(e)||(Kt(e)>1&&(e.set=e.add=e.clear=e.delete=on),Object.freeze(e),t&&qt(e,(function(e,t){return rn(t,!0)}),!0)),e}function on(){Ht(2)}function ln(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function an(e){var t=Nn[e];return t||Ht(18,e),t}function sn(){return"production"===process.env.NODE_ENV||Tn||Ht(0),Tn}function un(e,t){t&&(an("Patches"),e.u=[],e.s=[],e.v=t)}function cn(e){dn(e),e.p.forEach(fn),e.p=null}function dn(e){e===Tn&&(Tn=e.l)}function hn(e){return Tn={p:[],l:Tn,h:e,m:!0,_:0}}function fn(e){var t=e[Dn];0===t.i||1===t.i?t.j():t.g=!0}function pn(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||an("ES5").S(t,e,r),r?(n[Dn].P&&(cn(t),Ht(4)),Wt(e)&&(e=gn(t,e),t.l||mn(t,e)),t.u&&an("Patches").M(n[Dn],e,t.u,t.s)):e=gn(t,n,[]),cn(t),t.u&&t.v(t.u,t.s),e!==Pn?e:void 0}function gn(e,t,n){if(ln(t))return t;var r=t[Dn];if(!r)return qt(t,(function(i,o){return vn(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return mn(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=nn(r.k):r.o;qt(3===r.i?new Set(i):i,(function(t,o){return vn(e,r,i,t,o,n)})),mn(e,i,!1),n&&e.u&&an("Patches").R(r,n,e.u,e.s)}return r.o}function vn(e,t,n,r,i,o){if("production"!==process.env.NODE_ENV&&i===n&&Ht(5),Ut(i)){var l=gn(e,i,o&&t&&3!==t.i&&!Gt(t.D,r)?o.concat(r):void 0);if(Zt(n,r,l),!Ut(l))return;e.m=!1}if(Wt(i)&&!ln(i)){if(!e.h.F&&e._<1)return;gn(e,i),t&&t.A.l||mn(e,i)}}function mn(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&rn(t,n)}function wn(e,t){var n=e[Dn];return(n?tn(n):e)[t]}function bn(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function yn(e){e.P||(e.P=!0,e.l&&yn(e.l))}function $n(e){e.o||(e.o=nn(e.t))}function xn(e,t,n){var r=Qt(t)?an("MapSet").N(t,n):en(t)?an("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:sn(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=Fn;n&&(i=[r],o=jn);var l=Proxy.revocable(i,o),a=l.revoke,s=l.proxy;return r.k=s,r.j=a,s}(t,n):an("ES5").J(t,n);return(n?n.A:sn()).p.push(r),r}function Cn(e){return Ut(e)||Ht(22,e),function e(t){if(!Wt(t))return t;var n,r=t[Dn],i=Kt(t);if(r){if(!r.P&&(r.i<4||!an("ES5").K(r)))return r.t;r.I=!0,n=_n(t,i),r.I=!1}else n=_n(t,i);return qt(n,(function(t,i){r&&Jt(r.t,t)===i||Zt(n,t,e(i))})),3===i?new Set(n):n}(e)}function _n(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return nn(e)}var Sn,Tn,kn="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Mn="undefined"!=typeof Map,En="undefined"!=typeof Set,An="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Pn=kn?Symbol.for("immer-nothing"):((Sn={})["immer-nothing"]=!0,Sn),Rn=kn?Symbol.for("immer-draftable"):"__$immer_draftable",Dn=kn?Symbol.for("immer-state"):"__$immer_state",zn={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},On=""+Object.prototype.constructor,Vn="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Ln=Object.getOwnPropertyDescriptors||function(e){var t={};return Vn(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Nn={},Fn={get:function(e,t){if(t===Dn)return e;var n=tn(e);if(!Gt(n,t))return function(e,t,n){var r,i=bn(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Wt(r)?r:r===wn(e.t,t)?($n(e),e.o[t]=xn(e.A.h,r,e)):r},has:function(e,t){return t in tn(e)},ownKeys:function(e){return Reflect.ownKeys(tn(e))},set:function(e,t,n){var r=bn(tn(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=wn(tn(e),t),o=null==i?void 0:i[Dn];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||Gt(e.t,t)))return!0;$n(e),yn(e)}return e.o[t]===n&&"number"!=typeof n||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==wn(e.t,t)||t in e.t?(e.D[t]=!1,$n(e),yn(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=tn(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){Ht(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Ht(12)}},jn={};qt(Fn,(function(e,t){jn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),jn.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&Ht(13),Fn.deleteProperty.call(this,e[0],t)},jn.set=function(e,t,n){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&Ht(14),Fn.set.call(this,e[0],t,n,e[0])};var In=function(){function e(e){var t=this;this.O=An,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,l=Array(r>1?r-1:0),a=1;a<r;a++)l[a-1]=arguments[a];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(l))}))}}var l;if("function"!=typeof n&&Ht(6),void 0!==r&&"function"!=typeof r&&Ht(7),Wt(e)){var a=hn(t),s=xn(t,e,void 0),u=!0;try{l=n(s),u=!1}finally{u?cn(a):dn(a)}return"undefined"!=typeof Promise&&l instanceof Promise?l.then((function(e){return un(a,r),pn(e,a)}),(function(e){throw cn(a),e})):(un(a,r),pn(l,a))}if(!e||"object"!=typeof e){if((l=n(e))===Pn)return;return void 0===l&&(l=e),t.F&&rn(l,!0),l}Ht(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))}:[t.produce(e,n,(function(e,t){r=e,i=t})),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Wt(e)||Ht(8),Ut(e)&&(e=Cn(e));var t=hn(this),n=xn(this,e,void 0);return n[Dn].C=!0,dn(t),n},t.finishDraft=function(e,t){var n=e&&e[Dn];"production"!==process.env.NODE_ENV&&(n&&n.C||Ht(9),n.I&&Ht(10));var r=n.A;return un(r,t),pn(void 0,r)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!An&&Ht(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=an("Patches").$;return Ut(e)?i(e,t):this.produce(e,(function(e){return i(e,t.slice(n+1))}))},e}(),Bn=new In,Xn=Bn.produce;Bn.produceWithPatches.bind(Bn),Bn.setAutoFreeze.bind(Bn),Bn.setUseProxies.bind(Bn);var Yn=Bn.applyPatches.bind(Bn);Bn.createDraft.bind(Bn),Bn.finishDraft.bind(Bn);let Hn=[],Un=-1;function Wn(e){Un<Hn.length&&(Hn.length=Un+1),Hn.push(e),Un++,console.log("currentIndex:",Un,". length:",Hn)}let qn=(new Set).add("clear"),Kn={};var Gn={paths:qn,patches:Kn,clear:()=>{qn.clear(),Object.keys(Kn).forEach((e=>{delete Kn[e]}))}};function Jn(e){for(let r of e)"hoverCell"!==r.path[0]&&"isDragging"!==r.path[0]&&(qn.add(r.path[0]),t=r.path[0],n=r,void 0===Kn[t]&&(Kn[t]=[]),Kn[t].push(n));var t,n}let Zn={};if(window.localStorage.getItem("draft")){if(Zn=JSON.parse(localStorage.getItem("draft")),void 0!==Zn.treadling&&(Zn.treadleOrder=Zn.treadling,delete Zn.treadling),void 0!==Zn.pickCount&&(Zn.weftCount=Zn.pickCount,delete Zn.pickCount),Zn.warpColors=Zn.warpColors.slice(0,Zn.warpCount),Zn.weftColors=Zn.weftColors.slice(0,Zn.weftCount),void 0===Zn.yarn[0].id)for(let e=0;e<Zn.yarn.length;e++)Zn.yarn[e].id=e}else{Zn={treadleOrder:[],threading:[],warpColors:new Array(30).fill(1),weftColors:new Array(30).fill(0),tieup:[[1,0,0,1],[0,0,1,1],[0,1,1,0],[1,1,0,0]],shaftCount:4,treadleCount:4,warpCount:100,weftCount:100,yarn:[{id:0,name:"Black yarn",color:{r:.72,g:.29,b:.13}},{id:1,name:"White yarn",color:{r:.8,g:.8,b:.8}}]};for(let e=0;e<Zn.warpCount;e++)Zn.threading.push(e%4);for(let e=0;e<Zn.weftCount;e++)Zn.treadleOrder.push(e%4)}function Qn(){let e=function(){let e=Hn[Un].inversePatches;return Un=Math.max(Un-1,0),console.log("currentIndex:",Un,". length:",Hn),e}();if(e){let t=Yn(rr,e);Jn(e),tr.set(t)}}function er(){let e=function(){let e=Hn[Un].patches;return Un=Math.min(Un+1,Hn.length-1),console.log("currentIndex:",Un,". length:",Hn),e}();if(e){let t=Yn(rr,e);Jn(e),tr.set(t)}}const tr=ot(Zn);var nr={draft:tr,update:function(e,t=!0){tr.set(Xn(rr,e,((e,n)=>{t&&Wn({patches:e,inversePatches:n}),Jn(e)})))},set:function(e){tr.set(Xn(rr,(()=>e),((e,t)=>{Wn({patches:e,inversePatches:t}),Gn.paths.add("clear")})))},subscribe:function(e){return tr.subscribe(e)},undo:Qn,redo:er};let rr;tr.subscribe((e=>{rr=e,window.data=rr,localStorage.setItem("draft",JSON.stringify(rr))})),window.drop=function(){localStorage.removeItem("draft")},window.update=function(){localStorage.setItem("draft",JSON.stringify(window.data))},document.body.addEventListener("keydown",(e=>{!0===e.ctrlKey&&"z"===e.key?Qn():!0===e.ctrlKey&&"y"===e.key&&er()}));let ir={selectedMenu:-1,selectedColor:0,cellSize:60,scrollX:0,scrollY:0,xStepDistance:8,yStepDistance:8,showTreadleOrder:!0,showThreading:!0,selectTo:0,selectFrom:0,isDragging:!1,hoverCell:[0,0],disableScroll:!1,locale:"",showReloadDialog:!1};if(window.localStorage.getItem("ui")){let e=JSON.parse(localStorage.getItem("ui"));ir={...ir,...e}}const or=ot(ir);let lr=ir;or.subscribe((e=>{lr=e}));var ar={ui:or,update:function(e){or.set(Xn(lr,e,(e=>Jn(e))))},subscribe:function(e){return or.subscribe(e)}};function sr(e,t,n,r,i=0,o=("warp"===n?e.warpCount:e.weftCount)){let l=e["warp"===n?"threading":"treadleOrder"],a=0,s=Math.min(o-i,l.length-i);for(let e=i;e<s;e++){r&&0!==e&&e%(t.length-1)==0&&(a+=1);let n=e+a,i=n%t.length;r&&Math.floor(n/t.length)%2==1&&(i=t.length-n%t.length-1),l[e]=t[i]}}function ur(e,t){let n=t-e.length;if(n>0){let t=e.length;for(let r=0;r<n;r++)e.push(e[r%t])}else e.splice(e.length+n)}function cr(e,t,n,r=0,i=("warp"===n?e.warpCount:e.weftCount)){let o=e["warp"===n?"warpColors":"weftColors"];for(let e=r;e<i;e++)o[e]=t[e%t.length]}function dr(e,t){let n=e.yarn.map((e=>e.id)).reduce(((e,t)=>Math.max(e,t)))+1;e.yarn.push({...t,id:n})}function hr(e,t,n){const r=e.slice();return r[22]=t[n],r}function fr(e){let t,n,r,i,o,l,a,s,u,c=e[22].name+"";function d(...t){return e[16](e[22],...t)}return{c(){t=M("button"),n=M("div"),i=A(),o=M("div"),l=E(c),a=A(),D(n,"class","color svelte-1gaaezq"),D(n,"style",r=`background-color: ${e[3][e[22].id].toHexString()};`),D(o,"class","name svelte-1gaaezq"),D(t,"class","yarn svelte-1gaaezq"),N(t,"selected",e[1]===e[22].id)},m(e,r){S(e,t,r),x(t,n),x(t,i),x(t,o),x(o,l),x(t,a),s||(u=R(t,"click",d),s=!0)},p(i,o){e=i,12&o&&r!==(r=`background-color: ${e[3][e[22].id].toHexString()};`)&&D(n,"style",r),4&o&&c!==(c=e[22].name+"")&&O(l,c),6&o&&N(t,"selected",e[1]===e[22].id)},d(e){e&&T(t),s=!1,u()}}}function pr(e){let n,r,i,a;return{c(){n=M("form"),r=M("input"),D(r,"type","text")},m(o,s){var u;S(o,n,s),x(n,r),V(r,e[5]),i||(a=[R(r,"input",e[18]),R(r,"blur",e[19]),(u=wr.call(null,r),u&&l(u.destroy)?u.destroy:t),R(n,"submit",e[13])],i=!0)},p(e,t){32&t&&r.value!==e[5]&&V(r,e[5])},d(e){e&&T(n),i=!1,o(a)}}}function gr(e){let n,r,i;return{c(){n=M("button"),n.textContent="Paste"},m(t,o){S(t,n,o),r||(i=R(n,"click",e[17]),r=!0)},p:t,d(e){e&&T(n),r=!1,i()}}}function vr(e){let t,n,r,i,o,l,a,s,u,c,d,h,f=e[7]("terms.color")+"";return n=new Yt({props:{label:e[7]("page.yarn_settings.name"),value:e[0]?.name}}),n.$on("input",e[20]),{c(){t=M("div"),ye(n.$$.fragment),r=A(),i=M("div"),o=M("label"),l=E(f),a=A(),s=M("button"),D(o,"for","newYarnColor"),D(s,"class","yarn-color-change svelte-1gaaezq"),D(s,"style",u=`background-color: ${e[6].toHexString()};`)},m(u,f){S(u,t,f),$e(n,t,null),x(t,r),x(t,i),x(i,o),x(o,l),x(i,a),x(i,s),c=!0,d||(h=R(s,"click",e[12]),d=!0)},p(e,t){const r={};128&t&&(r.label=e[7]("page.yarn_settings.name")),1&t&&(r.value=e[0]?.name),n.$set(r),(!c||128&t)&&f!==(f=e[7]("terms.color")+"")&&O(l,f),(!c||64&t&&u!==(u=`background-color: ${e[6].toHexString()};`))&&D(s,"style",u)},i(e){c||(ge(n.$$.fragment,e),c=!0)},o(e){ve(n.$$.fragment,e),c=!1},d(e){e&&T(t),xe(n),d=!1,h()}}}function mr(e){let t,n,r,i,l,a,s,u,c,d,h,f,p,g,v,m=e[2].yarn,w=[];for(let t=0;t<m.length;t+=1)w[t]=fr(hr(e,m,t));function b(e,t){return e[4]?pr:gr}let y=b(e),$=y(e),C=-1!==e[1]&&vr(e);return{c(){t=M("div"),n=M("div"),r=M("div"),i=M("button"),i.textContent="+",l=A(),a=M("button"),s=E("-"),c=A(),d=M("div");for(let e=0;e<w.length;e+=1)w[e].c();h=A(),$.c(),f=A(),C&&C.c(),D(i,"class","add svelte-1gaaezq"),a.disabled=u=e[2].yarn.length<=1||void 0,D(a,"class","remove svelte-1gaaezq"),D(r,"class","add-or-remove svelte-1gaaezq"),D(d,"class","yarns svelte-1gaaezq"),D(n,"class","container svelte-1gaaezq"),D(t,"class","yarn-settings")},m(o,u){S(o,t,u),x(t,n),x(n,r),x(r,i),x(r,l),x(r,a),x(a,s),x(n,c),x(n,d);for(let e=0;e<w.length;e+=1)w[e].m(d,null);x(t,h),$.m(t,null),x(t,f),C&&C.m(t,null),p=!0,g||(v=[R(i,"click",e[8]),R(a,"click",e[15])],g=!0)},p(e,[n]){if((!p||4&n&&u!==(u=e[2].yarn.length<=1||void 0))&&(a.disabled=u),526&n){let t;for(m=e[2].yarn,t=0;t<m.length;t+=1){const r=hr(e,m,t);w[t]?w[t].p(r,n):(w[t]=fr(r),w[t].c(),w[t].m(d,null))}for(;t<w.length;t+=1)w[t].d(1);w.length=m.length}y===(y=b(e))&&$?$.p(e,n):($.d(1),$=y(e),$&&($.c(),$.m(t,f))),-1!==e[1]?C?(C.p(e,n),2&n&&ge(C,1)):(C=vr(e),C.c(),ge(C,1),C.m(t,null)):C&&(fe(),ve(C,1,1,(()=>{C=null})),pe())},i(e){p||(ge(C),p=!0)},o(e){ve(C),p=!1},d(e){e&&T(t),k(w,e),$.d(),C&&C.d(),g=!1,o(v)}}}function wr(e){e.focus()}function br(e){return{r:e.r/255,g:e.g/255,b:e.b/255}}function yr(t,n,r){let i,o,l,a,s,c;u(t,nr,(e=>r(2,a=e))),u(t,ar,(e=>r(14,s=e))),u(t,It,(e=>r(7,c=e))),window.tinycolor=e;let d,h,f=[],p=!1;function g(e,t){ar.update((e=>{e.selectedColor=t}))}function v(e,t){nr.update((n=>{n.yarn.find((e=>e.id===t)).name=e}))}function m(e){ar.update((t=>{let n=a.yarn.findIndex((t=>t.id===e));0==n&&(n=2),t.selectedColor=a.yarn[n-1].id})),nr.update((t=>{!function(e,t){let n,r=e.yarn.findIndex((e=>e.id===t));n=0===r?e.yarn[1].id:e.yarn[r-1].id,e.yarn.splice(r,1);for(let r=0;r<e.warpColors.length;r++)e.warpColors[r]===t&&(e.warpColors[r]=n);for(let r=0;r<e.weftColors.length;r++)e.weftColors[r]===t&&(e.weftColors[r]=n)}(t,e)}))}W((()=>{d=ft.onColorChange((e=>{-1!==i&&nr.update((t=>{t.yarn.find((e=>e.id===i)).color=e}))}))})),K((()=>{ft.removeListener(d)}));return t.$$.update=()=>{4&t.$$.dirty&&a.yarn.forEach((t=>{r(3,f[t.id]=e.fromRatio(t.color),f)})),16384&t.$$.dirty&&r(1,i=s.selectedColor),6&t.$$.dirty&&r(0,o=a.yarn.find((e=>i===e.id))),1&t.$$.dirty&&r(6,l=e.fromRatio(o?.color))},[o,i,a,f,p,h,l,c,function(e){e.preventDefault();let t=a.yarn.map((e=>e.id)).reduce(((e,t)=>Math.max(e,t)))+1;nr.update((e=>{dr(e,{name:"Yarn",color:{r:1,g:1,b:1}})})),ar.update((e=>{e.selectedColor=t}))},g,v,m,function(e){e.preventDefault(),ft.showColorPicker(e.pageX,e.pageY,o.color)},function(t){t.preventDefault(),console.log("Please import "+h);let n=h.trim(),i=[];try{let t=JSON.parse(n);if(t instanceof Array)if(t[0]instanceof Object)for(let n of t){let t=e(n.hex);if(!t.isValid())throw new Error("Invalid color",n);i.push({name:n.name,color:br(t.toRgb())})}else for(let n of t){let t=e(n);if(!t.isValid())throw new Error("Invalid color",n);i.push({name:"Yarn",color:br(t.toRgb())})}else for(let n of Object.entries(t)){let t=e(n[1]);if(!t.isValid())throw new Error("Invalid color",n);i.push({name:n[0],color:br(t.toRgb())})}}catch(t){let n=h.split(",");for(let o of n){let n=e(o);if(!n.isValid())return console.error("Unable to import colors from string "+h,t),void r(4,p=!1);i.push({name:"Yarn",color:br(n.toRgb())})}}i.length>0&&nr.update((e=>{for(let t of i)dr(e,t)})),r(5,h=""),r(4,p=!1)},s,()=>m(i),(e,t)=>g(0,e.id),()=>r(4,p=!0),function(){h=this.value,r(5,h)},()=>r(4,p=!1),e=>v(e.target.value,i)]}window.dropUi=function(){localStorage.removeItem("ui")},or.subscribe((e=>{window.ui=e,localStorage.setItem("ui",JSON.stringify({selectedColor:e.selectedColor,cellSize:e.cellSize}))}));class $r extends Se{constructor(e){super(),_e(this,e,yr,mr,a,{})}}var xr=function(e){this.value=e};xr.math={isDegree:!0,acos:function(e){return xr.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return xr.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return xr.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var n=1,r=e-t,i=t;i<r&&(i=r,r=t);for(var o=i+1;o<=e;o++)n*=o;return n/xr.math.fact(r)},changeSign:function(e){return-e},cos:function(e){return xr.math.isDegree&&(e=xr.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!=0)return"NaN";for(var t=1,n=2;n<=e;n++)t*=n;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var n=1,r=Math.floor(e)-Math.floor(t)+1;r<=Math.floor(e);r++)n*=r;return n},Pi:function(e,t,n){for(var r=1,i=e;i<=t;i++)r*=Number(n.postfixEval({n:i}));return r},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,n){for(var r=0,i=e;i<=t;i++)r+=Number(n.postfixEval({n:i}));return r},sin:function(e){return xr.math.isDegree&&(e=xr.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return xr.math.isDegree&&(e=xr.math.toRadian(e)),Math.tan(e)},tanh:function(e){return xr.sinha(e)/xr.cosha(e)},toRadian:function(e){return e*Math.PI/180}},xr.Exception=function(e){this.message=e};var Cr=xr;function _r(e,t){for(var n=0;n<e.length;n++)e[n]+=t;return e}var Sr=["sin","cos","tan","pi","(",")","P","C"," ","asin","acos","atan","7","8","9","int","cosh","acosh","ln","^","root","4","5","6","/","!","tanh","atanh","Mod","1","2","3","*","sinh","asinh","e","log","0",".","+","-",",","Sigma","n","Pi","pow"],Tr=["sin","cos","tan","&pi;","(",")","P","C"," ","asin","acos","atan","7","8","9","Int","cosh","acosh"," ln","^","root","4","5","6","&divide;","!","tanh","atanh"," Mod ","1","2","3","&times;","sinh","asinh","e"," log","0",".","+","-",",","&Sigma;","n","&Pi;","pow"],kr=[Cr.math.sin,Cr.math.cos,Cr.math.tan,"PI","(",")",Cr.math.P,Cr.math.C," ".anchor,Cr.math.asin,Cr.math.acos,Cr.math.atan,"7","8","9",Math.floor,Cr.math.cosh,Cr.math.acosh,Math.log,Math.pow,Math.sqrt,"4","5","6",Cr.math.div,Cr.math.fact,Cr.math.tanh,Cr.math.atanh,Cr.math.mod,"1","2","3",Cr.math.mul,Cr.math.sinh,Cr.math.asinh,"E",Cr.math.log,"0",".",Cr.math.add,Cr.math.sub,",",Cr.math.sigma,"n",Cr.math.Pi,Math.pow],Mr={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1},Er=[0,0,0,3,4,5,10,10,14,0,0,0,1,1,1,0,0,0,0,10,0,1,1,1,2,7,0,0,2,1,1,1,2,0,0,3,0,1,6,9,9,11,12,13,12,8],Ar={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},Pr={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},Rr={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},Dr={},zr={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},Or={1:!0},Vr=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," "],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function Lr(e,t,n,r){for(var i=0;i<r;i++)if(e[n+i]!==t[i])return!1;return!0}Cr.addToken=function(e){for(var t=0;t<e.length;t++){var n=e[t].token.length,r=-1;Vr[n]=Vr[n]||[];for(var i=0;i<Vr[n].length;i++)if(e[t].token===Vr[n][i]){r=Sr.indexOf(Vr[n][i]);break}-1===r?(Sr.push(e[t].token),Er.push(e[t].type),Vr.length<=e[t].token.length&&(Vr[e[t].token.length]=[]),Vr[e[t].token.length].push(e[t].token),kr.push(e[t].value),Tr.push(e[t].show)):(Sr[r]=e[t].token,Er[r]=e[t].type,kr[r]=e[t].value,Tr[r]=e[t].show)}},Cr.lex=function(e,t){var n,r={value:Cr.math.changeSign,type:0,pre:21,show:"-"},i={value:")",show:")",type:5,pre:0},o={value:"(",type:4,pre:0,show:"("},l=[o],a=[],s=e,u=Ar,c=0,d=Dr,h="";void 0!==t&&Cr.addToken(t);var f={},p=function(e){for(var t,n,r,i=[],o=e.length,l=0;l<o;l++)if(!(l<o-1&&" "===e[l]&&" "===e[l+1])){for(t="",n=e.length-l>Vr.length-2?Vr.length-1:e.length-l;n>0;n--)if(void 0!==Vr[n])for(r=0;r<Vr[n].length;r++)Lr(e,Vr[n][r],l,n)&&(t=Vr[n][r],r=Vr[n].length,n=0);if(l+=t.length-1,""===t)throw new Cr.Exception("Can't understand after "+e.slice(l));var a=Sr.indexOf(t);i.push({index:a,token:t,type:Er[a],eval:kr[a],precedence:Mr[Er[a]],show:Tr[a]})}return i}(s);for(n=0;n<p.length;n++){var g=p[n];if(14!==g.type){var v,m=g.token,w=g.type,b=g.eval,y=g.precedence,$=g.show,x=l[l.length-1];for(v=a.length;v--&&0===a[v];)if(-1!==[0,2,3,4,5,9,11,12,13].indexOf(w)){if(!0!==u[w])throw new Cr.Exception(m+" is not allowed after "+h);l.push(i),u=Pr,d=zr,_r(a,-1).pop()}if(!0!==u[w])throw new Cr.Exception(m+" is not allowed after "+h);if(!0===d[w]&&(w=2,b=Cr.math.mul,$="&times;",y=3,n-=1),f={value:b,type:w,pre:y,show:$},0===w)u=Ar,d=Dr,_r(a,2).push(2),l.push(f),l.push(o);else if(1===w)1===x.type?(x.value+=b,_r(a,1)):l.push(f),u=Pr,d=Rr;else if(2===w)u=Ar,d=Dr,_r(a,2),l.push(f);else if(3===w)l.push(f),u=Pr,d=zr;else if(4===w)_r(a,1),c++,u=Ar,d=Dr,l.push(f);else if(5===w){if(!c)throw new Cr.Exception("Closing parenthesis are more than opening one, wait What!!!");c--,u=Pr,d=zr,l.push(f),_r(a,1)}else if(6===w){if(x.hasDec)throw new Cr.Exception("Two decimals are not allowed in one number");1!==x.type&&(x={value:0,type:1,pre:0},l.push(x),_r(a,-1)),u=Or,_r(a,1),d=Dr,x.value+=b,x.hasDec=!0}else 7===w&&(u=Pr,d=zr,_r(a,1),l.push(f));8===w?(u=Ar,d=Dr,_r(a,4).push(4),l.push(f),l.push(o)):9===w?(9===x.type?x.value===Cr.math.add?(x.value=b,x.show=$,_r(a,1)):x.value===Cr.math.sub&&"-"===$&&(x.value=Cr.math.add,x.show="+",_r(a,1)):5!==x.type&&7!==x.type&&1!==x.type&&3!==x.type&&13!==x.type?"-"===m&&(u=Ar,d=Dr,_r(a,2).push(2),l.push(r),l.push(o)):(l.push(f),_r(a,2)),u=Ar,d=Dr):10===w?(u=Ar,d=Dr,_r(a,2),l.push(f)):11===w?(u=Ar,d=Dr,l.push(f)):12===w?(u=Ar,d=Dr,_r(a,6).push(6),l.push(f),l.push(o)):13===w&&(u=Pr,d=zr,l.push(f)),_r(a,-1),h=m}else if(n>0&&n<p.length-1&&1===p[n+1].type&&(1===p[n-1].type||6===p[n-1].type))throw new Cr.Exception("Unexpected Space")}for(v=a.length;v--&&0===a[v];)l.push(i),_r(a,-1).pop();if(!0!==u[5])throw new Cr.Exception("complete the expression");for(;c--;)l.push(i);return l.push(i),new Cr(l)};var Nr=Cr;Nr.prototype.toPostfix=function(){for(var e,t,n,r,i,o=[],l=[{value:"(",type:4,pre:0}],a=this.value,s=1;s<a.length;s++)if(1===a[s].type||3===a[s].type||13===a[s].type)1===a[s].type&&(a[s].value=Number(a[s].value)),o.push(a[s]);else if(4===a[s].type)l.push(a[s]);else if(5===a[s].type)for(;4!==(t=l.pop()).type;)o.push(t);else if(11===a[s].type){for(;4!==(t=l.pop()).type;)o.push(t);l.push(t)}else{r=(e=a[s]).pre,n=(i=l[l.length-1]).pre;var u="Math.pow"==i.value&&"Math.pow"==e.value;if(r>n)l.push(e);else{for(;n>=r&&!u||u&&r<n;)t=l.pop(),i=l[l.length-1],o.push(t),n=i.pre,u="Math.pow"==e.value&&"Math.pow"==i.value;l.push(e)}}return new Nr(o)};var Fr=Nr;Fr.prototype.postfixEval=function(e){(e=e||{}).PI=Math.PI,e.E=Math.E;for(var t,n,r,i=[],o=this.value,l=void 0!==e.n,a=0;a<o.length;a++)1===o[a].type?i.push({value:o[a].value,type:1}):3===o[a].type?i.push({value:e[o[a].value],type:1}):0===o[a].type||7===o[a].type?void 0===i[i.length-1].type?i[i.length-1].value.push(o[a]):i[i.length-1].value=o[a].value(i[i.length-1].value):8===o[a].type?(t=i.pop(),n=i.pop(),i.push({type:1,value:o[a].value(n.value,t.value)})):10===o[a].type?(t=i.pop(),void 0===(n=i.pop()).type?(n.value=n.concat(t),n.value.push(o[a]),i.push(n)):void 0===t.type?(t.unshift(n),t.push(o[a]),i.push(t)):i.push({type:1,value:o[a].value(n.value,t.value)})):2===o[a].type||9===o[a].type?(t=i.pop(),void 0===(n=i.pop()).type?((n=n.concat(t)).push(o[a]),i.push(n)):void 0===t.type?(t.unshift(n),t.push(o[a]),i.push(t)):i.push({type:1,value:o[a].value(n.value,t.value)})):12===o[a].type?(void 0!==(t=i.pop()).type&&(t=[t]),n=i.pop(),r=i.pop(),i.push({type:1,value:o[a].value(r.value,n.value,new Fr(t))})):13===o[a].type&&(l?i.push({value:e[o[a].value],type:3}):i.push([o[a]]));if(i.length>1)throw new Fr.Exception("Uncaught Syntax error");return i[0].value>1e15?"Infinity":parseFloat(i[0].value.toFixed(15))},Fr.eval=function(e,t,n){return void 0===t?this.lex(e).toPostfix().postfixEval():void 0===n?void 0!==t.length?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(n)};var jr=Fr;jr.prototype.formulaEval=function(){for(var e,t,n,r=[],i=this.value,o=0;o<i.length;o++)1===i[o].type||3===i[o].type?r.push({value:3===i[o].type?i[o].show:i[o].value,type:1}):13===i[o].type?r.push({value:i[o].show,type:1}):0===i[o].type?r[r.length-1]={value:i[o].show+("-"!=i[o].show?"(":"")+r[r.length-1].value+("-"!=i[o].show?")":""),type:0}:7===i[o].type?r[r.length-1]={value:(1!=r[r.length-1].type?"(":"")+r[r.length-1].value+(1!=r[r.length-1].type?")":"")+i[o].show,type:7}:10===i[o].type?(e=r.pop(),t=r.pop(),"P"===i[o].show||"C"===i[o].show?r.push({value:"<sup>"+t.value+"</sup>"+i[o].show+"<sub>"+e.value+"</sub>",type:10}):r.push({value:(1!=t.type?"(":"")+t.value+(1!=t.type?")":"")+"<sup>"+e.value+"</sup>",type:1})):2===i[o].type||9===i[o].type?(e=r.pop(),t=r.pop(),r.push({value:(1!=t.type?"(":"")+t.value+(1!=t.type?")":"")+i[o].show+(1!=e.type?"(":"")+e.value+(1!=e.type?")":""),type:i[o].type})):12===i[o].type&&(e=r.pop(),t=r.pop(),n=r.pop(),r.push({value:i[o].show+"("+n.value+","+t.value+","+e.value+")",type:12}));return r[0].value};var Ir=jr;function Br(e){let n,r,i,l,a;return{c(){n=M("button"),n.textContent="▲",r=A(),i=M("button"),i.textContent="▼",D(n,"class","arrow top svelte-736cov"),D(n,"type","button"),D(i,"class","arrow bottom svelte-736cov"),D(i,"type","button")},m(t,o){S(t,n,o),S(t,r,o),S(t,i,o),l||(a=[R(n,"click",e[10]),R(i,"click",e[11])],l=!0)},p:t,d(e){e&&T(n),e&&T(r),e&&T(i),l=!1,o(a)}}}function Xr(e){let n,r,i,l,a,s,u,c,d=e[5]&&Br(e);return{c(){n=M("label"),r=E(e[1]),i=A(),l=M("div"),a=M("input"),s=A(),d&&d.c(),D(a,"name","number-input"),D(a,"type","text"),D(a,"autocomplete","off"),D(a,"min",e[2]),D(a,"max",e[3]),a.disabled=e[4],D(a,"class","svelte-736cov"),D(l,"class","svelte-736cov"),D(n,"for","number-input"),D(n,"class","svelte-736cov"),N(n,"disabled",e[4])},m(t,o){S(t,n,o),x(n,r),x(n,i),x(n,l),x(l,a),V(a,e[0]),x(l,s),d&&d.m(l,null),u||(c=[R(a,"blur",e[6]),R(a,"keydown",e[7]),R(a,"input",e[9])],u=!0)},p(e,[t]){2&t&&O(r,e[1]),4&t&&D(a,"min",e[2]),8&t&&D(a,"max",e[3]),16&t&&(a.disabled=e[4]),1&t&&a.value!==e[0]&&V(a,e[0]),e[5]?d?d.p(e,t):(d=Br(e),d.c(),d.m(l,null)):d&&(d.d(1),d=null),16&t&&N(n,"disabled",e[4])},i:t,o:t,d(e){e&&T(n),d&&d.d(),u=!1,o(c)}}}function Yr(e,t,n){let{value:r}=t,{label:i}=t,{min:o}=t,{max:l}=t,{disabled:a}=t,{showArrows:s=!1}=t,{evalExpr:u=!0}=t,c=r;return e.$$set=e=>{"value"in e&&n(0,r=e.value),"label"in e&&n(1,i=e.label),"min"in e&&n(2,o=e.min),"max"in e&&n(3,l=e.max),"disabled"in e&&n(4,a=e.disabled),"showArrows"in e&&n(5,s=e.showArrows),"evalExpr"in e&&n(8,u=e.evalExpr)},[r,i,o,l,a,s,function(){if(u){let e=r;try{e=Ir.eval(e)}catch(e){}n(0,r=Math.floor(e)),void 0!==l&&n(0,r=Math.min(l,e)),void 0!==o&&n(0,r=Math.max(o,e)),isNaN(r)?n(0,r=c):c=r}},function(e){s&&("ArrowUp"===e.key?(event.preventDefault(),n(0,r++,r)):"ArrowDown"===e.key&&(event.preventDefault(),n(0,r--,r)))},u,function(){r=this.value,n(0,r)},()=>n(0,r++,r),()=>n(0,r--,r)]}class Hr extends Se{constructor(e){super(),_e(this,e,Yr,Xr,a,{value:0,label:1,min:2,max:3,disabled:4,showArrows:5,evalExpr:8})}}function Ur(e){let t,n,r,i,o,l,a,s,u,c,d,h,f,p,g,v,m,w,b,y,$;function C(t){e[6](t)}let _={label:e[4]("page.weave_settings.shaft_count"),showArrows:!0};function k(t){e[7](t)}void 0!==e[0]&&(_.value=e[0]),n=new Hr({props:_}),Z.push((()=>be(n,"value",C)));let E={label:e[4]("page.weave_settings.treadle_count"),showArrows:!0};function P(t){e[8](t)}void 0!==e[1]&&(E.value=e[1]),o=new Hr({props:E}),Z.push((()=>be(o,"value",k)));let z={label:e[4]("page.weave_settings.warp_count")};function O(t){e[9](t)}void 0!==e[2]&&(z.value=e[2]),s=new Hr({props:z}),Z.push((()=>be(s,"value",P)));let V={label:e[4]("page.weave_settings.weft_count")};return void 0!==e[3]&&(V.value=e[3]),d=new Hr({props:V}),Z.push((()=>be(d,"value",O))),w=new $r({}),{c(){t=M("form"),ye(n.$$.fragment),i=A(),ye(o.$$.fragment),a=A(),ye(s.$$.fragment),c=A(),ye(d.$$.fragment),f=A(),p=M("button"),p.textContent="Submit",g=A(),v=M("h2"),v.textContent="Yarns",m=A(),ye(w.$$.fragment),D(p,"type","submit"),D(p,"class","svelte-i2e354"),D(t,"class","svelte-i2e354")},m(r,l){S(r,t,l),$e(n,t,null),x(t,i),$e(o,t,null),x(t,a),$e(s,t,null),x(t,c),$e(d,t,null),x(t,f),x(t,p),S(r,g,l),S(r,v,l),S(r,m,l),$e(w,r,l),b=!0,y||($=R(t,"submit",e[5]),y=!0)},p(e,[t]){const i={};16&t&&(i.label=e[4]("page.weave_settings.shaft_count")),!r&&1&t&&(r=!0,i.value=e[0],ie((()=>r=!1))),n.$set(i);const a={};16&t&&(a.label=e[4]("page.weave_settings.treadle_count")),!l&&2&t&&(l=!0,a.value=e[1],ie((()=>l=!1))),o.$set(a);const c={};16&t&&(c.label=e[4]("page.weave_settings.warp_count")),!u&&4&t&&(u=!0,c.value=e[2],ie((()=>u=!1))),s.$set(c);const f={};16&t&&(f.label=e[4]("page.weave_settings.weft_count")),!h&&8&t&&(h=!0,f.value=e[3],ie((()=>h=!1))),d.$set(f)},i(e){b||(ge(n.$$.fragment,e),ge(o.$$.fragment,e),ge(s.$$.fragment,e),ge(d.$$.fragment,e),ge(w.$$.fragment,e),b=!0)},o(e){ve(n.$$.fragment,e),ve(o.$$.fragment,e),ve(s.$$.fragment,e),ve(d.$$.fragment,e),ve(w.$$.fragment,e),b=!1},d(e){e&&T(t),xe(n),xe(o),xe(s),xe(d),e&&T(g),e&&T(v),e&&T(m),xe(w,e),y=!1,$()}}}function Wr(e,t,n){let r,i;u(e,nr,(e=>n(10,r=e))),u(e,It,(e=>n(4,i=e)));let o=r.shaftCount,l=r.treadleCount,a=r.warpCount,s=r.weftCount;return[o,l,a,s,i,function(e){e.preventDefault(),nr.update((e=>{r.shaftCount!==o&&function(e,t){let n=e.tieup.length;e.tieup.length=t,e.tieup.fill([],n),e.shaftCount=t}(e,Number(o)),r.treadleCount!==l&&function(e,t){e.tieup.forEach((e=>{let n=e.length;e.length=t,e.fill(0,n)})),e.treadleCount=t}(e,Number(l)),r.warpCount!==a&&function(e,t){if(0==t-e.warpCount)return e;e.warpCount=t,ur(e.warpColors,t),ur(e.threading,t)}(e,Number(a)),r.weftCount!==s&&function(e,t){if(0==t-e.weftCount)return e;e.weftCount=t,ur(e.weftColors,t),ur(e.treadleOrder,t)}(e,Number(s))}),!1)},function(e){o=e,n(0,o)},function(e){l=e,n(1,l)},function(e){a=e,n(2,a)},function(e){s=e,n(3,s)}]}function qr(e){let n,r,i,o,l,a;return{c(){n=M("label"),r=E(e[1]),i=A(),o=M("input"),D(o,"type","checkbox"),D(o,"id","warp-count"),o.disabled=e[2],D(o,"class","svelte-emmwaj"),D(n,"class","svelte-emmwaj"),N(n,"disabled",e[2])},m(t,s){S(t,n,s),x(n,r),x(n,i),x(n,o),o.checked=e[0],l||(a=R(o,"change",e[3]),l=!0)},p(e,[t]){2&t&&O(r,e[1]),4&t&&(o.disabled=e[2]),1&t&&(o.checked=e[0]),4&t&&N(n,"disabled",e[2])},i:t,o:t,d(e){e&&T(n),l=!1,a()}}}function Kr(e,t,n){let{checked:r}=t,{label:i}=t,{disabled:o=!1}=t;return e.$$set=e=>{"checked"in e&&n(0,r=e.checked),"label"in e&&n(1,i=e.label),"disabled"in e&&n(2,o=e.disabled)},[r,i,o,function(){r=this.checked,n(0,r)}]}class Gr extends Se{constructor(e){super(),_e(this,e,Kr,qr,a,{checked:0,label:1,disabled:2})}}let Jr={isSelecting:!1,from:[0,0],to:[10,10],useThreading:!1,useWarpColors:!1,useTreadleOrder:!1,useWeftColors:!1};const Zr=ot(Jr);let Qr=Jr;Zr.subscribe((e=>{Qr=e}));var ei={selection:Zr,update:function(e){Zr.set(Xn(Qr,e))},subscribe:function(e){return Zr.subscribe(e)}};function ti(e){let t,n,r,i,l,a,s,u,c,d,h,f,p,g,v,m,w,b,y,$,C,_,k,P,z,V,L,N,F,j,I,B,X,Y,H,U,W,q,K,G=e[8]("page.selection.title")+"",J=e[8]("page.selection.fillAll")+"";function Q(t){e[13](t)}let ee={label:e[8]("terms.threading")};function te(t){e[14](t)}void 0!==e[3]&&(ee.checked=e[3]),a=new Gr({props:ee}),Z.push((()=>be(a,"checked",Q)));let ne={label:e[8]("terms.treadleOrder")};function re(t){e[15](t)}void 0!==e[1]&&(ne.checked=e[1]),c=new Gr({props:ne}),Z.push((()=>be(c,"checked",te)));let oe={label:e[8]("terms.warp")};function le(t){e[16](t)}void 0!==e[2]&&(oe.checked=e[2]),f=new Gr({props:oe}),Z.push((()=>be(f,"checked",re)));let ae={label:e[8]("terms.weft")};function se(t){e[18](t)}void 0!==e[0]&&(ae.checked=e[0]),v=new Gr({props:ae}),Z.push((()=>be(v,"checked",le)));let ue={label:"From",min:"0",max:e[4]};function ce(t){e[19](t)}void 0!==e[7]&&(ue.value=e[7]),L=new Hr({props:ue}),Z.push((()=>be(L,"value",se)));let de={label:e[8]("page.selection.to"),min:"0",max:e[4],disabled:e[5]};return void 0!==e[6]&&(de.value=e[6]),j=new Hr({props:de}),Z.push((()=>be(j,"value",ce))),{c(){t=M("div"),n=M("fieldset"),r=M("legend"),i=E(G),l=A(),ye(a.$$.fragment),u=A(),ye(c.$$.fragment),h=A(),ye(f.$$.fragment),g=A(),ye(v.$$.fragment),w=A(),b=M("legend"),b.textContent="Target",y=A(),$=M("fieldset"),C=M("div"),_=M("label"),k=E(J),P=A(),z=M("input"),V=A(),ye(L.$$.fragment),F=A(),ye(j.$$.fragment),B=A(),X=M("div"),Y=M("button"),Y.textContent="Apply repetition",H=A(),U=M("button"),U.textContent="Close",D(r,"class","svelte-2nju0y"),D(n,"class","repeat-options svelte-2nju0y"),D(b,"class","svelte-2nju0y"),D(_,"for","fill-all"),D(_,"class","svelte-2nju0y"),D(z,"name","fill-all"),D(z,"id","fill-all"),D(z,"type","checkbox"),D(z,"class","svelte-2nju0y"),D(C,"class","svelte-2nju0y"),D($,"class","to-from-inputs svelte-2nju0y"),D(Y,"class","submit"),D(U,"class","submit"),D(X,"class","buttons svelte-2nju0y")},m(o,s){S(o,t,s),x(t,n),x(n,r),x(r,i),x(n,l),$e(a,n,null),x(n,u),$e(c,n,null),x(n,h),$e(f,n,null),x(n,g),$e(v,n,null),x(t,w),x(t,b),x(t,y),x(t,$),x($,C),x(C,_),x(_,k),x(C,P),x(C,z),z.checked=e[5],x($,V),$e(L,$,null),x($,F),$e(j,$,null),x(t,B),x(t,X),x(X,Y),x(X,H),x(X,U),W=!0,q||(K=[R(z,"change",e[17]),R(Y,"click",e[9]),R(U,"click",e[10])],q=!0)},p(e,[t]){(!W||256&t)&&G!==(G=e[8]("page.selection.title")+"")&&O(i,G);const n={};256&t&&(n.label=e[8]("terms.threading")),!s&&8&t&&(s=!0,n.checked=e[3],ie((()=>s=!1))),a.$set(n);const r={};256&t&&(r.label=e[8]("terms.treadleOrder")),!d&&2&t&&(d=!0,r.checked=e[1],ie((()=>d=!1))),c.$set(r);const o={};256&t&&(o.label=e[8]("terms.warp")),!p&&4&t&&(p=!0,o.checked=e[2],ie((()=>p=!1))),f.$set(o);const l={};256&t&&(l.label=e[8]("terms.weft")),!m&&1&t&&(m=!0,l.checked=e[0],ie((()=>m=!1))),v.$set(l),(!W||256&t)&&J!==(J=e[8]("page.selection.fillAll")+"")&&O(k,J),32&t&&(z.checked=e[5]);const u={};16&t&&(u.max=e[4]),!N&&128&t&&(N=!0,u.value=e[7],ie((()=>N=!1))),L.$set(u);const h={};256&t&&(h.label=e[8]("page.selection.to")),16&t&&(h.max=e[4]),32&t&&(h.disabled=e[5]),!I&&64&t&&(I=!0,h.value=e[6],ie((()=>I=!1))),j.$set(h)},i(e){W||(ge(a.$$.fragment,e),ge(c.$$.fragment,e),ge(f.$$.fragment,e),ge(v.$$.fragment,e),ge(L.$$.fragment,e),ge(j.$$.fragment,e),W=!0)},o(e){ve(a.$$.fragment,e),ve(c.$$.fragment,e),ve(f.$$.fragment,e),ve(v.$$.fragment,e),ve(L.$$.fragment,e),ve(j.$$.fragment,e),W=!1},d(e){e&&T(t),xe(a),xe(c),xe(f),xe(v),xe(L),xe(j),q=!1,o(K)}}}function ni(e,t,n){let r,i,o,l,a,s,c,d,h,f,p,g;u(e,nr,(e=>n(11,f=e))),u(e,ei,(e=>n(12,p=e))),u(e,It,(e=>n(8,g=e)));let v=!0;return W((()=>{ei.update((e=>{e.isSelecting=!0}))})),K((()=>{ei.update((e=>{e.isSelecting=!1}))})),e.$$.update=()=>{4096&e.$$.dirty&&n(3,r=p.useThreading),4096&e.$$.dirty&&n(1,i=p.useTreadleOrder),4096&e.$$.dirty&&n(2,o=p.useWarpColors),4096&e.$$.dirty&&n(0,l=p.useWeftColors),2048&e.$$.dirty&&n(4,a=Math.max(f.warpCount,f.weftCount)),4096&e.$$.dirty&&(s=p.from),4096&e.$$.dirty&&(c=p.to),16&e.$$.dirty&&n(6,h=a),8&e.$$.dirty&&ei.update((e=>{e.useThreading=r})),2&e.$$.dirty&&ei.update((e=>{e.useTreadleOrder=i})),4&e.$$.dirty&&ei.update((e=>{e.useWarpColors=o})),1&e.$$.dirty&&ei.update((e=>{e.useWeftColors=l}))},n(7,d=0),[l,i,o,r,a,v,h,d,g,function(e){e.preventDefault(),nr.update((e=>{r&&sr(e,f.threading.slice(s[0],c[0]),"warp",!1,d,h),o&&cr(e,f.warpColors.slice(s[0],c[0]),"warp"),i&&sr(e,f.treadleOrder.slice(s[1],c[1]),"weft",!1,d,h),l&&cr(e,f.weftColors.slice(s[1],c[1]),"weft")}))},function(){ar.update((e=>{e.selectedMenu=-1}))},f,p,function(e){r=e,n(3,r),n(12,p)},function(e){i=e,n(1,i),n(12,p)},function(e){o=e,n(2,o),n(12,p)},function(e){l=e,n(0,l),n(12,p)},function(){v=this.checked,n(5,v)},function(e){d=e,n(7,d)},function(e){h=e,n(6,h),n(4,a),n(11,f)}]}function ri(e,t,n,r){let i=[],o=Math.abs(n-e),l=e<n?1:-1,a=-Math.abs(r-t),s=t<r?1:-1,u=o+a;for(;i.push([e,t]),e!==n||t!==r;){let n=2*u;n>=a&&(u+=a,e+=l),n<=o&&(u+=o,t+=s)}return i}function ii(e){let t,n,r;return{c(){t=M("input"),D(t,"type","number")},m(i,o){S(i,t,o),V(t,e[0]),n||(r=R(t,"input",e[21]),n=!0)},p(e,n){1&n[0]&&z(t.value)!==e[0]&&V(t,e[0])},d(e){e&&T(t),n=!1,r()}}}function oi(e){let t,n,r;return{c(){t=M("input"),D(t,"type","number")},m(i,o){S(i,t,o),V(t,e[1]),n||(r=R(t,"input",e[22]),n=!0)},p(e,n){2&n[0]&&z(t.value)!==e[1]&&V(t,e[1])},d(e){e&&T(t),n=!1,r()}}}function li(e){let t,n,r;return{c(){t=M("button"),D(t,"class","resize-btn svelte-1si1hr0"),N(t,"disabled",e[2]),N(t,"resizeX",e[3]),N(t,"resizeY",e[4])},m(i,o){S(i,t,o),n||(r=R(t,"pointerdown",e[10]),n=!0)},p(e,n){4&n[0]&&N(t,"disabled",e[2]),8&n[0]&&N(t,"resizeX",e[3]),16&n[0]&&N(t,"resizeY",e[4])},d(e){e&&T(t),n=!1,r()}}}function ai(e){let n,r,i,l,a,s,u,c,d,h=e[3]&&ii(e),f=e[4]&&oi(e),p=!e[2]&&(!0===e[3]||!0===e[4])&&li(e);return{c(){n=M("div"),h&&h.c(),r=A(),f&&f.c(),i=A(),l=M("div"),a=M("canvas"),u=A(),p&&p.c(),D(a,"style",s=`\n    max-width: ${e[0]*ui+2*si}px;\n    max-height: ${e[1]*ui+2*si}px;\n    `),D(a,"width","1"),D(a,"height","1"),D(a,"class","svelte-1si1hr0"),N(a,"disabled",e[2]),D(l,"class","inner svelte-1si1hr0"),N(l,"resizeX",e[3]),N(l,"resizeY",e[4]),D(n,"class","container svelte-1si1hr0")},m(t,o){S(t,n,o),h&&h.m(n,null),x(n,r),f&&f.m(n,null),x(n,i),x(n,l),x(l,a),e[23](a),x(l,u),p&&p.m(l,null),c||(d=[R(a,"click",e[9]),R(a,"pointerup",e[8]),R(a,"pointerdown",e[6]),R(a,"pointermove",e[7])],c=!0)},p(e,t){e[3]?h?h.p(e,t):(h=ii(e),h.c(),h.m(n,r)):h&&(h.d(1),h=null),e[4]?f?f.p(e,t):(f=oi(e),f.c(),f.m(n,i)):f&&(f.d(1),f=null),3&t[0]&&s!==(s=`\n    max-width: ${e[0]*ui+2*si}px;\n    max-height: ${e[1]*ui+2*si}px;\n    `)&&D(a,"style",s),4&t[0]&&N(a,"disabled",e[2]),e[2]||!0!==e[3]&&!0!==e[4]?p&&(p.d(1),p=null):p?p.p(e,t):(p=li(e),p.c(),p.m(l,null)),8&t[0]&&N(l,"resizeX",e[3]),16&t[0]&&N(l,"resizeY",e[4])},i:t,o:t,d(t){t&&T(n),h&&h.d(),f&&f.d(),e[23](null),p&&p.d(),c=!1,o(d)}}}let si=2.5,ui=25;function ci(t,n,r){let i,o,l,a,{xCount:s}=n,{yCount:u}=n,{toggleCell:c=(()=>!1)}=n,{onClick:d=(()=>{})}=n,{onMouseDown:h=(()=>{})}=n,{onMouseUp:f=(()=>{})}=n,{onMouseMove:p=(()=>{})}=n,{disabled:g=!1}=n,{resizeX:v=!1}=n,{resizeY:m=!1}=n,w=new ResizeObserver((()=>{l=i.getBoundingClientRect()})),b=!1;function y(t,n,i){r(20,o.fillStyle=i?"#ababab":"white",o),o.fillRect(0,0,o.canvas.width,o.canvas.height),r(20,o.fillStyle=i?"gray":"black",o),r(20,o.fillStyle=i?"gray":"black",o);let l=ui*t+si,a=ui*n+si;!function(e,t){o.fillRect(0,0,si,t),o.fillRect(e,0,si,t),o.fillRect(0,0,e,si),o.fillRect(0,t,e+si,si)}(l,a);for(let e=1;e<t;e++)o.fillRect(e*ui+si/2,0,si,a);for(let e=1;e<n;e++)o.fillRect(0,e*ui+si/2,l,si);for(let i=0;i<t;i++)for(let t=0;t<n;t++){let n=c(t,i);n&&(r(20,o.fillStyle=n instanceof Object?e.fromRatio(n).toHexString():"black",o),o.fillRect(i*ui+5+si,t*ui+5+si,ui-10,ui-10))}}function $(e){if(console.log("pointermove"),0===e.buttons)return console.log("stop"),void C();let t,n=[e.pageX,e.pageY],i=Ke(Ne(),n,a)[v?0:1]/ui;t=i>0?Math.floor(i):-Math.floor(Math.abs(i)),0!==t&&(v&&s+t>0?(r(0,s+=t),a[0]=a[0]+t*ui):m&&u+t>0&&(r(1,u+=t),a[1]=a[1]+t*ui))}function x(){C()}function C(){console.log("stopdrag"),ar.update((e=>{e.disableScroll=!1})),document.body.removeEventListener("pointermove",$),document.body.removeEventListener("pointerup",x),document.body.style.cursor="",b=!1}return W((()=>{r(20,o=i.getContext("2d")),l=i.getBoundingClientRect(),w.observe(i)})),K((()=>{w.unobserve(i)})),t.$$set=e=>{"xCount"in e&&r(0,s=e.xCount),"yCount"in e&&r(1,u=e.yCount),"toggleCell"in e&&r(11,c=e.toggleCell),"onClick"in e&&r(12,d=e.onClick),"onMouseDown"in e&&r(13,h=e.onMouseDown),"onMouseUp"in e&&r(14,f=e.onMouseUp),"onMouseMove"in e&&r(15,p=e.onMouseMove),"disabled"in e&&r(2,g=e.disabled),"resizeX"in e&&r(3,v=e.resizeX),"resizeY"in e&&r(4,m=e.resizeY)},t.$$.update=()=>{1048579&t.$$.dirty[0]&&o&&function(e,t){r(5,i.width=ui*e+2*si,i),r(5,i.height=ui*t+2*si,i)}(s,u),1048583&t.$$.dirty[0]&&o&&y(s,u,g)},[s,u,g,v,m,i,function(e){g||b||h(e)},function(e){g||b||p(e)},function(){g||b||f(event)},function(){g||b||d(event)},function(e){a=[e.pageX,e.pageY],b=!0,ar.update((e=>{e.disableScroll=!0})),document.body.addEventListener("pointermove",$),document.body.addEventListener("pointerup",x),document.body.addEventListener("pointercancel",(()=>{console.log("cancel")})),v?document.body.style.cursor="col-resize":m&&(document.body.style.cursor="row-resize")},c,d,h,f,p,function(){return i.getBoundingClientRect()},function(e,t){let n=this.getCellAtPos(e),r=this.getCellAtPos(t);return ri(n[0],n[1],r[0],r[1]).filter((e=>e[0]>=0&&e[0]<s&&e[1]>=0&&e[1]<u))},function(e){let t=(l.width-si)/s;return[Math.floor(e[0]/t),Math.floor(e[1]/t)]},y,o,function(){s=z(this.value),r(0,s)},function(){u=z(this.value),r(1,u)},function(e){Z[e?"unshift":"push"]((()=>{i=e,r(5,i)}))}]}class di extends Se{constructor(e){super(),_e(this,e,ci,ai,a,{xCount:0,yCount:1,toggleCell:11,onClick:12,onMouseDown:13,onMouseUp:14,onMouseMove:15,disabled:2,resizeX:3,resizeY:4,getBoundingClientRect:16,getCellsBetweenPoints:17,getCellAtPos:18,drawForm:19},null,[-1,-1])}get getBoundingClientRect(){return this.$$.ctx[16]}get getCellsBetweenPoints(){return this.$$.ctx[17]}get getCellAtPos(){return this.$$.ctx[18]}get drawForm(){return this.$$.ctx[19]}}function hi(e){let t,n,r,i,o,l,a,s,u,c,d,h,f,p,v,m=e[6]("page.pattern_fill.mirrored_repeat")+"";function w(t){e[16](t)}function b(t){e[17](t)}let y={resizeX:"warp"===e[0],resizeY:"weft"===e[0],toggleCell:e[8],onMouseDown:e[9],onMouseUp:e[7],disabled:e[1]};return void 0!==e[2]&&(y.xCount=e[2]),void 0!==e[3]&&(y.yCount=e[3]),n=new di({props:y}),e[15](n),Z.push((()=>be(n,"xCount",w))),Z.push((()=>be(n,"yCount",b))),{c(){t=M("div"),ye(n.$$.fragment),l=A(),a=M("div"),s=M("fieldset"),u=M("label"),c=E(m),d=A(),h=M("input"),D(t,"class",o=g("canvas "+e[0])+" svelte-dbckys"),D(u,"for","mirrored-repeat"),D(h,"type","checkbox"),D(h,"name","mirrored-repeat"),D(h,"id","mirrored-repeat"),D(a,"class","controls")},m(r,i){S(r,t,i),$e(n,t,null),S(r,l,i),S(r,a,i),x(a,s),x(s,u),x(u,c),x(s,d),x(s,h),h.checked=e[5],f=!0,p||(v=R(h,"change",e[18]),p=!0)},p(e,l){const a={};1&l&&(a.resizeX="warp"===e[0]),1&l&&(a.resizeY="weft"===e[0]),2&l&&(a.disabled=e[1]),!r&&4&l&&(r=!0,a.xCount=e[2],ie((()=>r=!1))),!i&&8&l&&(i=!0,a.yCount=e[3],ie((()=>i=!1))),n.$set(a),(!f||1&l&&o!==(o=g("canvas "+e[0])+" svelte-dbckys"))&&D(t,"class",o),(!f||64&l)&&m!==(m=e[6]("page.pattern_fill.mirrored_repeat")+"")&&O(c,m),32&l&&(h.checked=e[5])},i(e){f||(ge(n.$$.fragment,e),f=!0)},o(e){ve(n.$$.fragment,e),f=!1},d(r){r&&T(t),e[15](null),xe(n),r&&T(l),r&&T(a),p=!1,v()}}}function fi(e){let t,n,r=void 0!==e[0]&&hi(e);return{c(){t=M("div"),r&&r.c(),D(t,"class","pattern-fill svelte-dbckys")},m(e,i){S(e,t,i),r&&r.m(t,null),n=!0},p(e,[n]){void 0!==e[0]?r?(r.p(e,n),1&n&&ge(r,1)):(r=hi(e),r.c(),ge(r,1),r.m(t,null)):r&&(fe(),ve(r,1,1,(()=>{r=null})),pe())},i(e){n||(ge(r),n=!0)},o(e){ve(r),n=!1},d(e){e&&T(t),r&&r.d()}}}function pi(e,t){let n=[...t];for(let t=0;t<e.length;t++)void 0!==e[t]&&(n[t]=e[t]);return n}function gi(e,t,n){let r,i,o,l;u(e,nr,(e=>n(14,o=e))),u(e,It,(e=>n(6,l=e)));let a,s,c,{warpOrWeft:d}=t,{disabled:h=!1}=t,f=!0,p=!1,g=[],v=0,m=0,w=[];function b(e){if(e.stopPropagation(),0===e.buttons)return c=void 0,void(p=!1);let t=a.getBoundingClientRect(),n=[e.clientX-t.left,e.clientY-t.top];if(!1===p&&1&e.buttons&&(0!==e.movementX||0!==e.movementY)&&(p=!0,c=n),p){let e=a.getCellsBetweenPoints(c,n);g=[],e.forEach((e=>{"weft"===d?g[e[1]]=e[0]:"warp"===d&&(g[e[0]]=e[1])})),g=pi(g,w),a.drawForm(v,m,!1)}}return W((()=>{n(2,v=r),n(3,m=i);for(let e=0;e<v;e++)w[e]=e})),e.$$set=e=>{"warpOrWeft"in e&&n(0,d=e.warpOrWeft),"disabled"in e&&n(1,h=e.disabled)},e.$$.update=()=>{16384&e.$$.dirty&&n(13,r=o.treadleCount),16384&e.$$.dirty&&n(12,i=o.shaftCount),14349&e.$$.dirty&&s!==d&&(n(2,[v,m]=[m,v],v,(n(3,m),n(11,s),n(0,d),n(2,v),n(13,r),n(12,i),n(14,o))),"weft"===d?n(2,v=r):"warp"===d&&n(3,m=i),n(11,s=d),w=w.map((e=>e>v-1?void 0:e)))},[d,h,v,m,a,f,l,function(e){if(p)w=pi(g,w),c=void 0,g=void 0,p=!1,document.body.removeEventListener("mousemove",b);else{let t=a.getBoundingClientRect(),n=[e.clientX-t.left,e.clientY-t.top],[r,i]=a.getCellAtPos(n);"warp"===d?w[r]=w[r]===i?void 0:i:"weft"===d&&(w[i]=w[i]===r?void 0:r)}a.drawForm(v,m,!1)},function(e,t){let n,r;return"warp"===d?(n=t,r=e):"weft"===d&&(n=e,r=t),p?g[n]===r:w[n]===r},function(){document.body.addEventListener("mousemove",b)},function(){nr.update((e=>{let t="warp"===d?v:m,n=[...w];n.splice(t,w.length),sr(e,n,d,f)}))},s,i,r,o,function(e){Z[e?"unshift":"push"]((()=>{a=e,n(4,a)}))},function(e){v=e,n(2,v),n(11,s),n(0,d),n(3,m),n(13,r),n(12,i),n(14,o)},function(e){m=e,n(3,m),n(11,s),n(0,d),n(2,v),n(13,r),n(12,i),n(14,o)},function(){f=this.checked,n(5,f)}]}class vi extends Se{constructor(e){super(),_e(this,e,gi,fi,a,{warpOrWeft:0,disabled:1,apply:10})}get apply(){return this.$$.ctx[10]}}var mi='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 228 86.8">\n  <g stroke-width="10" fill="none">\n    <path d="M226.7 43.4H7.1" stroke-width="5"/>\n    <path d="M26.7 63L7.1 43.4l19.6-19.7" stroke-linecap="square" />\n  </g>\n  <path d="M57.6 1h169.3v84.7H57.6" fill="none" stroke-width="2.1" stroke-linecap="round" />\n  <path d="M57.6 22.2h169.3M57.6 43.4h169.1M227 64.6H57.5" fill="none" stroke-width="2.1" stroke-linecap="round"/>\n  <path d="M78.7 1v84.7M100 1v84.7M121 1v84.7M142.2 1v84.7M163.4 1v84.7M184.6 1v84.7M205.7 1v84.7" fill="none" stroke-width="2.1"/>\n  <path stroke-width="2.1" stroke-linecap="round" d="M63 6.4h10.5V17H63zM84 27.6h10.6v10.6H84zM105.2 48.7h10.6v10.6h-10.6zM126.4 69.9H137v10.6h-10.6zM147.5 6.4h10.6V17h-10.6zM168.7 27.6h10.6v10.6h-10.6zM190 48.7h10.5v10.6H190zM211 69.9h10.6v10.6H211z"/>\n  <path d="M7 43.4L33.9 70" fill="none"/>\n</svg>\n';function wi(e){let t,n,r,i,l,a,s,u,c,d,h,f,p,g,v,m,w,b,y=e[2]("page.pattern_fill.apply")+"",$={warpOrWeft:e[0]};return f=new vi({props:$}),e[7](f),{c(){t=M("div"),n=M("div"),r=M("input"),i=A(),l=M("label"),a=A(),s=M("div"),u=M("input"),c=A(),d=M("label"),h=A(),ye(f.$$.fragment),p=A(),g=M("button"),v=E(y),D(r,"type","radio"),D(r,"id","warp"),D(r,"name","warp-or-weft"),r.__value="warp",r.value=r.__value,D(r,"class","svelte-ffg717"),e[5][0].push(r),N(r,"notActive",void 0===e[0]),D(l,"for","warp"),D(l,"class","svelte-ffg717"),D(n,"class","warp svelte-ffg717"),D(u,"type","radio"),D(u,"id","weft"),D(u,"name","warp-or-weft"),u.__value="weft",u.value=u.__value,D(u,"class","svelte-ffg717"),e[5][0].push(u),D(d,"for","weft"),D(d,"class","svelte-ffg717"),D(s,"class","weft svelte-ffg717"),D(t,"class","button-group svelte-ffg717")},m(o,y){S(o,t,y),x(t,n),x(n,r),r.checked=r.__value===e[0],x(n,i),x(n,l),l.innerHTML=mi,x(t,a),x(t,s),x(s,u),u.checked=u.__value===e[0],x(s,c),x(s,d),d.innerHTML=mi,S(o,h,y),$e(f,o,y),S(o,p,y),S(o,g,y),x(g,v),m=!0,w||(b=[R(r,"change",e[4]),R(u,"change",e[6]),R(g,"click",e[3])],w=!0)},p(e,[t]){1&t&&(r.checked=r.__value===e[0]),1&t&&N(r,"notActive",void 0===e[0]),1&t&&(u.checked=u.__value===e[0]);const n={};1&t&&(n.warpOrWeft=e[0]),f.$set(n),(!m||4&t)&&y!==(y=e[2]("page.pattern_fill.apply")+"")&&O(v,y)},i(e){m||(ge(f.$$.fragment,e),m=!0)},o(e){ve(f.$$.fragment,e),m=!1},d(n){n&&T(t),e[5][0].splice(e[5][0].indexOf(r),1),e[5][0].splice(e[5][0].indexOf(u),1),n&&T(h),e[7](null),xe(f,n),n&&T(p),n&&T(g),w=!1,o(b)}}}function bi(e,t,n){let r;u(e,It,(e=>n(2,r=e)));let i,o="warp";return[o,i,r,function(){i.apply()},function(){o=this.__value,n(0,o)},[[]],function(){o=this.__value,n(0,o)},function(e){Z[e?"unshift":"push"]((()=>{i=e,n(1,i)}))}]}let yi,$i=ot({tableData:[],repeatRows:[[]],repeatTimesPerRow:[],width:0,yarns:[],hasInitialized:!1});function xi(e){let t=Xn(yi,e);$i.set(t)}$i.subscribe((e=>{yi=e}));var Ci={update:xi,subscribe:function(e){return $i.subscribe(e)},insertColumn:function(e){this.table.insertColumn(e)},table:{setValue:function(e,t,n){xi((r=>{for(let t=0;t<r.tableData.length;t++)r.tableData[t][e]=void 0;r.tableData[t][e]=n,r.tableData=[...r.tableData]}))},insertColumn:function(e){xi((t=>{for(let n of t.tableData)n.splice(e+1,0,void 0);t.width++}))},deleteRow:function(e){xi((t=>{t.tableData=t.tableData.filter(((t,n)=>n!==e))}))},addYarn:function(e){xi((t=>{t.yarns.push(e),t.tableData.push([])}))},removeColumn:function(e){xi((t=>{t.tableData.forEach((t=>t.splice(e,1))),t.width--}))},toThreads:function(){let e=yi.tableData,t=yi.yarns,n=[];if(void 0!==e&&e.length>0)for(let r=0;r<e[0].length;r++)for(let i=0;i<e.length;i++)void 0!==e[i][r]&&void 0===n[r]&&(n[r]={yarn:t[i],times:e[i][r]});return n}},repeats:{setRepeatRows:function(e){xi((t=>{t.repeatRows=e}))},setRepeatTimesPerRow:function(e){xi((t=>{t.repeatTimesPerRow=e}))}},initialize:e=>{yi.hasInitialized||$i.update((t=>({...t,hasInitialized:!0,yarns:e.map((e=>e.id)),tableData:Array(e.length).fill([])})))}};function _i(e,t,n){const r=e.slice();return r[39]=t[n],r[40]=t,r[41]=n,r}function Si(e,t,n){const r=e.slice();return r[42]=t[n],r}function Ti(e,t,n){const r=e.slice();return r[45]=t[n],r[47]=n,r}function ki(e){let t,n=e[0],r=[];for(let t=0;t<n.length;t+=1)r[t]=Pi(_i(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=P()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);S(e,t,n)},p(e,i){if(4095&i[0]){let o;for(n=e[0],o=0;o<n.length;o+=1){const l=_i(e,n,o);r[o]?r[o].p(l,i):(r[o]=Pi(l),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){k(r,e),e&&T(t)}}}function Mi(e){let t,n,r,i;function o(...t){return e[18](e[41],e[47],...t)}return{c(){t=M("button"),D(t,"data-id",n=e[0][e[41]][e[47]]),D(t,"data-row",e[41]),D(t,"class","svelte-1ydheu8"),N(t,"active",e[3]===e[47]&&e[2]===e[41]&&e[4])},m(e,n){S(e,t,n),r||(i=R(t,"pointerdown",o),r=!0)},p(r,i){e=r,1&i[0]&&n!==(n=e[0][e[41]][e[47]])&&D(t,"data-id",n),28&i[0]&&N(t,"active",e[3]===e[47]&&e[2]===e[41]&&e[4])},d(e){e&&T(t),r=!1,i()}}}function Ei(e){let t,n,r,i,o,l,a=zi(e[0][e[41]],e[47],e[7]?.id),s=a&&Mi(e);return{c(){t=M("td"),n=M("div"),r=M("div"),i=A(),s&&s.c(),o=A(),l=M("div"),D(r,"class","line left svelte-1ydheu8"),N(r,"visible",0!==e[0][e[41]][e[47]]&&0!==e[0][e[41]][e[47]-1]&&e[0][e[41]][e[47]]===e[0][e[41]][e[47]-1]),D(l,"class","line right svelte-1ydheu8"),N(l,"visible",0!==e[0][e[41]][e[47]]&&0!==e[0][e[41]][e[47]]&&e[0][e[41]][e[47]]===e[0][e[41]][e[47]+1]),D(n,"class","repeat-container svelte-1ydheu8"),D(t,"class","svelte-1ydheu8")},m(e,a){S(e,t,a),x(t,n),x(n,r),x(n,i),s&&s.m(n,null),x(n,o),x(n,l)},p(e,t){1&t[0]&&N(r,"visible",0!==e[0][e[41]][e[47]]&&0!==e[0][e[41]][e[47]-1]&&e[0][e[41]][e[47]]===e[0][e[41]][e[47]-1]),129&t[0]&&(a=zi(e[0][e[41]],e[47],e[7]?.id)),a?s?s.p(e,t):(s=Mi(e),s.c(),s.m(n,o)):s&&(s.d(1),s=null),1&t[0]&&N(l,"visible",0!==e[0][e[41]][e[47]]&&0!==e[0][e[41]][e[47]]&&e[0][e[41]][e[47]]===e[0][e[41]][e[47]+1])},d(e){e&&T(t),s&&s.d()}}}function Ai(e){let t,n,r,i,o,l;function a(...t){return e[19](e[42],e[41],...t)}return{c(){t=M("input"),D(t,"type","text"),D(t,"class","times-input svelte-1ydheu8"),D(t,"style",n=`left: calc(${e[9](e[42],e[41])}px - 1em)`),D(t,"data-id",r=e[42]),D(t,"data-row",e[41]),t.value=i=e[11](e[41],e[42])},m(e,n){S(e,t,n),o||(l=R(t,"input",a),o=!0)},p(o,l){e=o,64&l[0]&&n!==(n=`left: calc(${e[9](e[42],e[41])}px - 1em)`)&&D(t,"style",n),64&l[0]&&r!==(r=e[42])&&D(t,"data-id",r),64&l[0]&&i!==(i=e[11](e[41],e[42]))&&t.value!==i&&(t.value=i)},d(e){e&&T(t),o=!1,l()}}}function Pi(e){let t,n,r,i,o,l,a=e[41],s={length:e[5]},u=[];for(let t=0;t<s.length;t+=1)u[t]=Ei(Ti(e,s,t));let c=e[6][e[41]],d=[];for(let t=0;t<c.length;t+=1)d[t]=Ai(Si(e,c,t));const h=()=>e[20](t,a),f=()=>e[20](null,a);return{c(){t=M("tr"),n=M("td"),r=A();for(let e=0;e<u.length;e+=1)u[e].c();i=A(),o=M("div");for(let e=0;e<d.length;e+=1)d[e].c();l=A(),D(n,"class","svelte-1ydheu8"),D(t,"class","repeat svelte-1ydheu8")},m(e,a){S(e,t,a),x(t,n),x(t,r);for(let e=0;e<u.length;e+=1)u[e].m(t,null);x(t,i),x(t,o);for(let e=0;e<d.length;e+=1)d[e].m(o,null);x(t,l),h()},p(n,r){if(e=n,445&r[0]){let n;for(s={length:e[5]},n=0;n<s.length;n+=1){const o=Ti(e,s,n);u[n]?u[n].p(o,r):(u[n]=Ei(o),u[n].c(),u[n].m(t,i))}for(;n<u.length;n+=1)u[n].d(1);u.length=s.length}if(3648&r[0]){let t;for(c=e[6][e[41]],t=0;t<c.length;t+=1){const n=Si(e,c,t);d[t]?d[t].p(n,r):(d[t]=Ai(n),d[t].c(),d[t].m(o,null))}for(;t<d.length;t+=1)d[t].d(1);d.length=c.length}a!==e[41]&&(f(),a=e[41],h())},d(e){e&&T(t),k(u,e),k(d,e),f()}}}function Ri(e){let n,r=e[5]>1&&ki(e);return{c(){r&&r.c(),n=P()},m(e,t){r&&r.m(e,t),S(e,n,t)},p(e,t){e[5]>1?r?r.p(e,t):(r=ki(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(e){r&&r.d(e),e&&T(n)}}}function Di(e,t=[]){let n=-1,r=[];for(let i=0;i<e.length;i++)n!==e[i]&&(r.length>0&&(r[r.length-1].to=i-1),r.push({from:i,times:t[e[i]],id:e[i]}),n=e[i]);return r.length>0&&void 0===r[r.length-1].to&&(r[r.length-1].to=e.length-1),r.filter((e=>0!==e.id))}function zi(e,t,n){return e[t-1]!==e[t]||e[t+1]!==e[t]||0===e[t]||void 0!==n&&(0===e[t]||n===e[t])}function Oi(e,t,n){let r,i,o,l,a,s;u(e,Ci,(e=>n(17,s=e)));let c,d,h,f,p,g,{repeats:v=[]}=t,m=[],w=!1;function b(e){n(6,l=[]);for(let t=0;t<e.length;t++){let e=new Set(r[t].filter((e=>0!==e)));n(6,l[t]=[],l),e.forEach((e=>{l[t].push(e)}))}n(6,l=[...l])}W((()=>{n(0,r=JSON.parse(JSON.stringify(s.repeatRows))),n(16,i=JSON.parse(JSON.stringify(s.repeatTimesPerRow))),b(r),n(15,w=!0)}));let y,$,x,C,_=!1;function S(e,t,r){y=!1,n(2,h=t),n(3,f=r),p=e.target.getBoundingClientRect().x,g=e.clientX,c=function(){if(void 0!==m&&void 0!==m[0]&&void 0!==m[0].firstChild){let e=m[0],t=e.getBoundingClientRect().width;return d=e.firstChild.getBoundingClientRect().width,(t-d)/a}return 1}(),document.body.classList.add("dragging"),document.addEventListener("mousemove",k),document.addEventListener("pointerup",T,{once:!0})}function T(e){e.clientX-g<8&&(_&&h===x?(p=$,n(2,h=x),n(3,f=C),k(e),n(4,_=!1)):!1===y&&($=p,x=h,C=f,n(4,_=!0))),document.body.classList.remove("dragging"),document.removeEventListener("mousemove",k)}function k(e){let t=e.clientX,i=r[h],o=Math.round((t-p)/c);if(Number.isNaN(o)||0===o||f+o<0||f+o>a-1)return;y=!0;let l=i[f];if(0!==o){for(;0!==o&&M(l,f,o,h);){let e=Math.sign(o);l=E(l,h,e,f),n(3,f+=e),p+=c*e,o-=e}A(),n(0,r[h]=i,r),n(0,r=[...r])}}function M(e,t,n,i){if(0===i)return!0;let o=r[i-1],l=r[i],a=Di(o),s=t+n;if(0===s)return!0;if(0===o[s]||s===o.length-1)return!0;if(function(e,t){let n=r[t],i=n[e];return n[e-1]!==i||n[e+1]!==i||0===e||e===n.length-1}(s,i)&&l[s]===e)return!0;for(let t of a)if(l[s]!==e||0===e){if(n>0&&s===t.to)return!0;if(n<0&&s===t.from)return!0}else{if(n>0&&s===t.from)return!0;if(n<0&&s===t.to)return!0}return!1}function E(e,t,o,l){let a=r[t];if(0===e&&(e=function(e){return r[e].reduce(((e,t)=>Math.max(e,t)))+1}(h),a[l]=e,void 0===i[h]&&n(16,i[h]=[],i),n(16,i[h][e]=1,i),n(16,i=[...i])),a[l+o]!==e){a[l+o]=e;for(let e=t+1;e<r.length;e++){let t=r[e];t[l]!==t[l+o]&&(t[l+o]=t[l])}}else a[l]=0;return e}function A(){for(let e of r){for(let t=1;t<e.length-1;t++){let n=e[t-1],r=e[t],i=e[t+1];n!==r&&i!==r&&(e[t]=0)}e[0]!==e[1]&&(e[0]=0),e[e.length-1]!==e[e.length-2]&&(e[e.length-1]=0)}let e=r[r.length-1];if(e.some((e=>0!==e))&&(r.push(Array(a).fill(0)),i.push([])),r.length>1){let t=r[r.length-2];(e.every((e=>0===e))&&t.every((e=>0===e))||0!==t[0]&&t.every((e=>e===t[0])))&&n(0,r.length=r.length-1,r)}}function P(e,t,r){n(16,i[t][e]=r,i),n(16,i=[...i])}return e.$$set=e=>{"repeats"in e&&n(12,v=e.repeats)},e.$$.update=()=>{if(131072&e.$$.dirty[0]&&n(5,a=s.width),1&e.$$.dirty[0]&&b(r),65537&e.$$.dirty[0]){n(12,v=[]);for(let e=0;e<r.length;e++){let t=Di(r[e],i[e]);t.length>0&&n(12,v[e]=t,v)}}32769&e.$$.dirty[0]&&w&&Ci.update((e=>{e.repeatRows=JSON.parse(JSON.stringify(r))})),98304&e.$$.dirty[0]&&w&&Ci.update((e=>{e.repeatTimesPerRow=JSON.parse(JSON.stringify(i))}))},n(0,r=[[]]),n(16,i=[]),n(7,o=void 0),n(6,l=[]),[r,m,h,f,_,a,l,undefined,S,function(e,t){let n=-1,i=0;for(let o=0;o<r[t].length;o++){r[t][o]===e&&(-1===n?(n=o,i=1):i++)}return(n+i/2)*c+d},P,function(e,t){return i[e][t]},v,function(e){for(let t=0;t<r.length;t++)e<r[t].length-1?r[t].splice(e,0,r[t][e]):r[t].push(0);n(0,r=[...r])},function(e){for(let t=0;t<r.length;t++)r[t].splice(e,1),A(r[t]);n(0,r=[...r])},w,i,s,(e,t,n)=>S(n,e,t),(e,t,n)=>P(e,t,Number(n.target.value)),function(e,t){Z[e?"unshift":"push"]((()=>{m[t]=e,n(1,m)}))}]}class Vi extends Se{constructor(e){super(),_e(this,e,Oi,Ri,a,{repeats:12,insertColumn:13,removeColumn:14},null,[-1,-1])}get insertColumn(){return this.$$.ctx[13]}get removeColumn(){return this.$$.ctx[14]}}function Li(e,t,n){const r=e.slice();return r[5]=t[n],r}function Ni(e){let t,n,r,i,o=e[5].name+"";return{c(){t=M("option"),n=E(o),r=A(),t.__value=i=e[5].id,t.value=t.__value},m(e,i){S(e,t,i),x(t,n),x(t,r)},p(e,r){2&r&&o!==(o=e[5].name+"")&&O(n,o),2&r&&i!==(i=e[5].id)&&(t.__value=i,t.value=t.__value)},d(e){e&&T(t)}}}function Fi(e){let t,n;return{c(){t=M("div"),D(t,"class","color-marker svelte-jxdqux"),D(t,"style",n=`background-color: ${e[2]}`)},m(e,n){S(e,t,n)},p(e,r){4&r&&n!==(n=`background-color: ${e[2]}`)&&D(t,"style",n)},d(e){e&&T(t)}}}function ji(e){let n,r,i,l,a,s,u=e[1].yarn,c=[];for(let t=0;t<u.length;t+=1)c[t]=Ni(Li(e,u,t));let d=-1!==e[0]&&Fi(e);return{c(){n=M("div"),r=M("select"),i=M("option"),i.textContent="Add new yarn";for(let e=0;e<c.length;e+=1)c[e].c();l=A(),d&&d.c(),i.__value=-1,i.value=i.__value,D(r,"class","svelte-jxdqux"),void 0===e[0]&&re((()=>e[4].call(r))),D(n,"class","color-dropdown svelte-jxdqux")},m(t,o){S(t,n,o),x(n,r),x(r,i);for(let e=0;e<c.length;e+=1)c[e].m(r,null);L(r,e[0]),x(n,l),d&&d.m(n,null),a||(s=[R(r,"change",e[4]),R(r,"input",e[3])],a=!0)},p(e,[t]){if(2&t){let n;for(u=e[1].yarn,n=0;n<u.length;n+=1){const i=Li(e,u,n);c[n]?c[n].p(i,t):(c[n]=Ni(i),c[n].c(),c[n].m(r,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=u.length}3&t&&L(r,e[0]),-1!==e[0]?d?d.p(e,t):(d=Fi(e),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:t,o:t,d(e){e&&T(n),k(c,e),d&&d.d(),a=!1,o(s)}}}function Ii(t,n,r){let i;u(t,nr,(e=>r(1,i=e)));let o,{selectedYarn:l=-1}=n;return t.$$set=e=>{"selectedYarn"in e&&r(0,l=e.selectedYarn)},t.$$.update=()=>{if(3&t.$$.dirty&&-1!==Number(l)){let t=i.yarn.find((e=>e.id===Number(l))).color;r(2,o=e.fromRatio(t).toHexString())}},[l,i,o,function(e){G.call(this,t,e)},function(){l=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),r(0,l)}]}class Bi extends Se{constructor(e){super(),_e(this,e,Ii,ji,a,{selectedYarn:0})}}var Xi='<svg xmlns="http://www.w3.org/2000/svg" height="30px" width="30px" fill="none" viewBox="0 0 20.43 32">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 3a3 3 0 0 1 3-3h14.43a3 3 0 0 1 3 3v18a3 3 0 0 1-3 3h-1.92l-4.44 7.53a1 1 0 0 1-1.7 0L4.92 24H3a3 3 0 0 1-3-3Z" />\n  <path class="plus" d="M4.22 12a1 1 0 0 1 1-1h4V7a1 1 0 1 1 2 0v4h4a1 1 0 1 1 0 2h-4v4a1 1 0 1 1-2 0v-4h-4a1 1 0 0 1-1-1z" fill="#000" />\n  <path d="M0 3a3 3 0 0 1 3-3h14.43a3 3 0 0 1 3 3v18a3 3 0 0 1-3 3h-1.92l-4.44 7.53a1 1 0 0 1-1.7 0L4.92 24H3a3 3 0 0 1-3-3Zm3-1a1 1 0 0 0-1 1v18a1 1 0 0 0 1 1h2.47a1 1 0 0 1 .85.47l3.9 6.64 3.88-6.64a1 1 0 0 1 .85-.47h2.48a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z" fill="#000" />\n</svg>\n';function Yi(e,t,n){const r=e.slice();return r[24]=t[n],r[26]=n,r}function Hi(e,t,n){const r=e.slice();return r[24]=t[n],r[28]=n,r}function Ui(e){let t,n,r,i,l,a,s=0===e[26]&&function(e){let t,n,r;function i(){return e[14](e[28])}return{c(){t=M("button"),D(t,"class","add-button svelte-11jhekp")},m(e,o){S(e,t,o),t.innerHTML=Xi,n||(r=R(t,"click",i),n=!0)},p(t,n){e=t},d(e){e&&T(t),n=!1,r()}}}(e);function u(){return e[15](e[28])}function c(){return e[16](e[28])}function d(...t){return e[17](e[28],e[26],...t)}return{c(){t=M("td"),s&&s.c(),n=A(),r=M("input"),D(r,"size","4"),D(r,"type","number"),r.value=i=void 0!==e[5].tableData[e[26]][e[28]]?e[5].tableData[e[26]][e[28]]:"",D(r,"class","svelte-11jhekp"),D(t,"data-column",e[28]),D(t,"class","svelte-11jhekp"),N(t,"new",e[28]===e[4])},m(e,i){S(e,t,i),s&&s.m(t,null),x(t,n),x(t,r),l||(a=[R(r,"focus",u),R(r,"blur",c),R(r,"input",d)],l=!0)},p(n,o){0===(e=n)[26]&&s.p(e,o),32&o&&i!==(i=void 0!==e[5].tableData[e[26]][e[28]]?e[5].tableData[e[26]][e[28]]:"")&&(r.value=i),16&o&&N(t,"new",e[28]===e[4])},d(e){e&&T(t),s&&s.d(),l=!1,o(a)}}}function Wi(e){let n,r,i,o,l,a,s=0===e[26]&&function(e){let n,r,i;return{c(){n=M("button"),D(n,"class","add-button svelte-11jhekp")},m(t,o){S(t,n,o),n.innerHTML=Xi,r||(i=R(n,"click",e[12]),r=!0)},p:t,d(e){e&&T(n),r=!1,i()}}}(e);o=new Bi({props:{selectedYarn:e[5].yarns[e[26]]}}),o.$on("input",(function(...t){return e[13](e[26],...t)}));let u={length:e[5].width},c=[];for(let t=0;t<u.length;t+=1)c[t]=Ui(Hi(e,u,t));return{c(){n=M("tr"),r=M("td"),s&&s.c(),i=A(),ye(o.$$.fragment),l=A();for(let e=0;e<c.length;e+=1)c[e].c();D(r,"class","svelte-11jhekp"),D(n,"class","svelte-11jhekp")},m(e,t){S(e,n,t),x(n,r),s&&s.m(r,null),x(r,i),$e(o,r,null),x(n,l);for(let e=0;e<c.length;e+=1)c[e].m(n,null);a=!0},p(t,r){0===(e=t)[26]&&s.p(e,r);const i={};if(32&r&&(i.selectedYarn=e[5].yarns[e[26]]),o.$set(i),1968&r){let t;for(u={length:e[5].width},t=0;t<u.length;t+=1){const i=Hi(e,u,t);c[t]?c[t].p(i,r):(c[t]=Ui(i),c[t].c(),c[t].m(n,null))}for(;t<c.length;t+=1)c[t].d(1);c.length=u.length}},i(e){a||(ge(o.$$.fragment,e),a=!0)},o(e){ve(o.$$.fragment,e),a=!1},d(e){e&&T(n),s&&s.d(),xe(o),k(c,e)}}}function qi(e){let t,n,r,i,o,l,a,s,u,c,d,h,f=e[5].tableData,p=[];for(let t=0;t<f.length;t+=1)p[t]=Wi(Yi(e,f,t));const g=e=>ve(p[e],1,1,(()=>{p[e]=null}));function v(t){e[18](t)}let m={};function w(t){e[20](t)}void 0!==e[0]&&(m.selectedYarn=e[0]),a=new Bi({props:m}),Z.push((()=>be(a,"selectedYarn",v)));let b={};return void 0!==e[1]&&(b.repeats=e[1]),c=new Vi({props:b}),e[19](c),Z.push((()=>be(c,"repeats",w))),{c(){t=M("div"),n=M("table"),r=M("tbody");for(let e=0;e<p.length;e+=1)p[e].c();i=A(),o=M("tr"),l=M("td"),ye(a.$$.fragment),u=A(),ye(c.$$.fragment),D(l,"class","svelte-11jhekp"),D(o,"class","svelte-11jhekp"),D(n,"class","svelte-11jhekp"),D(t,"class","top svelte-11jhekp")},m(s,d){S(s,t,d),x(t,n),x(n,r);for(let e=0;e<p.length;e+=1)p[e].m(r,null);x(r,i),x(r,o),x(o,l),$e(a,l,null),x(r,u),$e(c,r,null),e[21](n),h=!0},p(e,[t]){if(2032&t){let n;for(f=e[5].tableData,n=0;n<f.length;n+=1){const o=Yi(e,f,n);p[n]?(p[n].p(o,t),ge(p[n],1)):(p[n]=Wi(o),p[n].c(),ge(p[n],1),p[n].m(r,i))}for(fe(),n=f.length;n<p.length;n+=1)g(n);pe()}const n={};!s&&1&t&&(s=!0,n.selectedYarn=e[0],ie((()=>s=!1))),a.$set(n);const o={};!d&&2&t&&(d=!0,o.repeats=e[1],ie((()=>d=!1))),c.$set(o)},i(e){if(!h){for(let e=0;e<f.length;e+=1)ge(p[e]);ge(a.$$.fragment,e),ge(c.$$.fragment,e),h=!0}},o(e){p=p.filter(Boolean);for(let e=0;e<p.length;e+=1)ve(p[e]);ve(a.$$.fragment,e),ve(c.$$.fragment,e),h=!1},d(n){n&&T(t),k(p,n),xe(a),e[19](null),xe(c),e[21](null)}}}function Ki(e,t,n){let r,i,o,l;u(e,Ci,(e=>n(5,o=e))),u(e,nr,(e=>n(23,l=e)));let a,s,c,d=[];function h(e){Ci.table.deleteRow(e)}function f(e,t,n){Ci.table.setValue(e,t,n)}function p(e){Ci.insertColumn(e),window.setTimeout((()=>{let e=a.querySelectorAll(".new");if(e.length>0){for(let t=0;t<e.length;t++)e[t].style.width="3em";e[0].addEventListener("transitionend",(()=>{for(let t=0;t<e.length;t++)e[t].style.width="",e[t].classList.remove("new")}),{once:!0})}}),10),window.setTimeout((()=>{n(4,r=-1)}),200),n(4,r=e),s.insertColumn(e)}function g(e){if(void 0!==c&&e!==c){let e=c,t=!0,n=o.tableData;for(let r=0;r<n.length;r++)if(void 0!==n[r][e]&&""!==n[r][e]&&0!==n[r][e]){t=!1;break}t&&(Ci.table.removeColumn(e),s.removeColumn(e))}}function m(e){c=e}W((()=>{Ci.initialize(l.yarn)}));return e.$$.update=()=>{1&e.$$.dirty&&-1!==i&&(Ci.table.addYarn(i),n(0,i=-1))},n(4,r=-1),n(0,i=-1),[i,d,a,s,r,o,h,f,p,g,m,function(){let e=[...Ci.table.toThreads()];for(let t=0;t<d.length;t++){let n=d[t];for(let r=n.length-1;r>=0;r--){let i=n[r],o=e.slice(i.from,i.to+1);for(let t=0;t<i.times-1;t++)e.splice(i.from,0,...o);let l=(i.to-i.from+1)*(i.times-1);for(let e=t+1;e<d.length;e++){let t=d[e];for(let e=0;e<t.length;e++){let n=t[e];n.to>=i.to&&(n.to+=l)}}}}let t=[];return e.forEach((e=>{for(let n=0;n<e.times;n++)t.push(e.yarn)})),t.reverse(),t},()=>p(0),(e,t)=>{"-1"===t.target.value?h(e):v(Ci,o.tableData[e][0]=t.target.value,o)},e=>p(e+1),e=>g(e),e=>m(e),(e,t,n)=>f(e,t,Number(n.target.value)),function(e){i=e,n(0,i)},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(3,s)}))},function(e){d=e,n(1,d)},function(e){Z[e?"unshift":"push"]((()=>{a=e,n(2,a)}))}]}class Gi extends Se{constructor(e){super(),_e(this,e,Ki,qi,a,{getThreads:11})}get getThreads(){return this.$$.ctx[11]}}function Ji(e){let t,n,r,i,o,l,a,s,u,c,d,h,f,p,g=e[3]("page.pattern_fill.apply")+"";function v(t){e[6](t)}n=new Gi({props:{}}),e[5](n);let m={label:"Apply on warp"};function w(t){e[7](t)}void 0!==e[1]&&(m.checked=e[1]),i=new Gr({props:m}),Z.push((()=>be(i,"checked",v)));let b={label:"Apply on weft"};return void 0!==e[2]&&(b.checked=e[2]),a=new Gr({props:b}),Z.push((()=>be(a,"checked",w))),{c(){t=M("div"),ye(n.$$.fragment),r=A(),ye(i.$$.fragment),l=A(),ye(a.$$.fragment),u=A(),c=M("button"),d=E(g)},m(o,s){S(o,t,s),$e(n,t,null),x(t,r),$e(i,t,null),x(t,l),$e(a,t,null),S(o,u,s),S(o,c,s),x(c,d),h=!0,f||(p=R(c,"click",e[4]),f=!0)},p(e,[t]){n.$set({});const r={};!o&&2&t&&(o=!0,r.checked=e[1],ie((()=>o=!1))),i.$set(r);const l={};!s&&4&t&&(s=!0,l.checked=e[2],ie((()=>s=!1))),a.$set(l),(!h||8&t)&&g!==(g=e[3]("page.pattern_fill.apply")+"")&&O(d,g)},i(e){h||(ge(n.$$.fragment,e),ge(i.$$.fragment,e),ge(a.$$.fragment,e),h=!0)},o(e){ve(n.$$.fragment,e),ve(i.$$.fragment,e),ve(a.$$.fragment,e),h=!1},d(r){r&&T(t),e[5](null),xe(n),xe(i),xe(a),r&&T(u),r&&T(c),f=!1,p()}}}function Zi(e,t,n){let r,i,o,l;return u(e,It,(e=>n(3,r=e))),[i,o,l,r,function(){let e=i.getThreads();(o||l)&&nr.update((t=>{l&&cr(t,e,"weft"),o&&cr(t,e,"warp")}))},function(e){Z[e?"unshift":"push"]((()=>{i=e,n(0,i)}))},function(e){o=e,n(1,o)},function(e){l=e,n(2,l)}]}function Qi(e){let n,r,i,l,a,s,u,c,d,h,f;return{c(){n=M("button"),n.textContent="Warp to weft",r=A(),i=M("button"),i.textContent="Weft to warp",l=A(),a=M("button"),a.textContent="Flip warp",s=A(),u=M("button"),u.textContent="Flip weft",c=A(),d=M("button"),d.textContent="Invert tieup"},m(t,o){S(t,n,o),S(t,r,o),S(t,i,o),S(t,l,o),S(t,a,o),S(t,s,o),S(t,u,o),S(t,c,o),S(t,d,o),h||(f=[R(n,"click",e[1]),R(i,"click",e[0]),R(a,"click",e[2]),R(u,"click",e[3]),R(d,"click",e[4])],h=!0)},p:t,i:t,o:t,d(e){e&&T(n),e&&T(r),e&&T(i),e&&T(l),e&&T(a),e&&T(s),e&&T(u),e&&T(c),e&&T(d),h=!1,o(f)}}}function eo(e,t,n){let r;return u(e,nr,(e=>n(5,r=e))),[function(){nr.update((e=>{for(let t=0;t<r.warpCount;t++)e.threading[t]=r.treadleOrder[t%r.treadleOrder.length]}))},function(){nr.update((e=>{for(let t=0;t<r.weftCount;t++)e.treadleOrder[t]=r.threading[t%r.threading.length]}))},function(){nr.update((e=>{for(let t=0;t<r.warpCount;t++)e.threading[t]=r.shaftCount-r.threading[t]-1}))},function(){nr.update((e=>{for(let t=0;t<r.warpCount;t++)e.treadleOrder[t]=r.treadleCount-r.treadleOrder[t]-1}))},function(){nr.update((e=>{for(let t=0;t<r.tieup.length;t++)for(let n=0;n<r.tieup[0].length;n++)e.tieup[t][n]=0===r.tieup[t][n]?1:0}))}]}var to=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.213 85.096"><path d="M41.563 6.96a1.506 1.506 0 000-2.123 1.513 1.513 0 00-2.122 0l-1.357 1.357-2.276-2.275 1.357-1.358a1.505 1.505 0 000-2.12 1.497 1.497 0 00-2.12 0L6.305 29.176c-.063.063-.12.134-.17.197-1.259 1.4-1.746 3.345-1.266 5.155a5.385 5.385 0 001.45 2.481l.077.078 10.925 10.953L.437 64.928a1.505 1.505 0 000 2.121 1.499 1.499 0 002.122 0l1.357-1.357L6.2 67.975l-1.357 1.358a1.496 1.496 0 000 2.121 1.497 1.497 0 002.121 0l1.357-1.357 2.277 2.277-1.357 1.357a1.504 1.504 0 000 2.121 1.497 1.497 0 002.121 0l1.357-1.357 2.285 2.284-1.357 1.357a1.496 1.496 0 000 2.121 1.497 1.497 0 002.121 0l1.357-1.357 2.283 2.284-1.357 1.357a1.495 1.495 0 00-.008 2.113 1.514 1.514 0 002.13.008L48.9 55.933c1.33-1.329 1.896-3.663 1.443-5.36a5.629 5.629 0 00-1.436-2.496l-11.02-11.023 16.885-16.886a1.497 1.497 0 000-2.12 1.506 1.506 0 00-2.122-.002l-1.357 1.357-2.277-2.276 1.358-1.357a1.505 1.505 0 00-.008-2.128 1.503 1.503 0 00-2.114.006l-1.357 1.357-2.284-2.283 1.358-1.357a1.505 1.505 0 000-2.12 1.504 1.504 0 00-2.122 0L42.49 10.6l-2.284-2.284zM11.914 38.39c1.626-.494 4.49-1.846 7.538-3.295 2.793-1.322 5.953-2.828 7.254-3.168a2.576 2.576 0 012.228.445c.425.34.75.807.898 1.365.212.764.092 1.704-.835 2.631l-9.553 9.553zm1.91 28.511h4.37l.006 4.377c0 .396.155.778.438 1.062.275.275.665.438 1.061.438l4.362-.007.008 3.755-2.539 2.538L6.038 63.57l2.538-2.539h3.747v4.37c.008.403.164.785.44 1.061.282.283.663.44 1.06.44zm4.95-4.95h4.37l.005 4.376c0 .396.156.778.44 1.062.274.275.663.438 1.06.438l4.362-.007.007 3.756-1.95 1.951v-2.263c0-.396-.157-.778-.439-1.06a1.51 1.51 0 00-1.06-.439l-4.363.007-.008-4.377a1.51 1.51 0 00-1.5-1.499H15.33l.007-4.363a1.541 1.541 0 00-.445-1.068 1.535 1.535 0 00-1.06-.438l-2.256.007 1.951-1.95 3.747-.002v4.37c.001.396.163.785.438 1.062a1.51 1.51 0 001.062.437zm28.015-11.753c.317.318.544.714.65 1.146.211.764.105 1.705-.828 2.64L32.017 68.575v-2.263c0-.396-.156-.778-.439-1.06a1.52 1.52 0 00-1.062-.439l-4.362.007v-4.37a1.523 1.523 0 00-1.507-1.507h-4.37l.008-4.362a1.541 1.541 0 00-.445-1.068 1.538 1.538 0 00-1.06-.438l-2.257.007 14.764-14.765a5.488 5.488 0 001.365-2.256zM35.764 34.933l-4.278-4.279c-1.336-1.336-3.23-2.24-5.544-1.625-1.568.41-4.588 1.845-7.785 3.358-2.785 1.33-5.96 2.835-7.262 3.175a2.559 2.559 0 01-2.468-.658 2.558 2.558 0 01-.657-1.152c-.234-.869-.007-1.789.842-2.637l14.58-14.58v2.248a1.51 1.51 0 001.5 1.5h4.368v4.37c0 .82.672 1.491 1.5 1.497h4.37v4.371c0 .82.671 1.492 1.5 1.5h2.247zm5.911-5.912H37.928v-4.37a1.491 1.491 0 00-1.499-1.499h-4.37v-4.369a1.462 1.462 0 00-.438-1.06 1.458 1.458 0 00-1.06-.44h-4.37v-3.747l1.95-1.95v2.248a1.509 1.509 0 001.5 1.498h4.37v4.37a1.51 1.51 0 001.498 1.5h4.37v4.37c0 .82.672 1.491 1.5 1.498h2.248zm7.496-7.495l-2.539 2.54-3.006.006h-.748v-4.37a1.49 1.49 0 00-1.499-1.499h-4.37v-4.37a1.46 1.46 0 00-.439-1.06 1.459 1.459 0 00-1.06-.439h-4.37V8.586l2.546-2.545 13.208 13.207z"/></svg>\n',name:"weave_settings",component:class extends Se{constructor(e){super(),_e(this,e,Wr,Ur,a,{})}}},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26.46 26.46">\n  <g fill="none">\n    <path d="M8.63 13.47a39.14 39.14 0 001.34 1.44s-1.3.65-2.68 1.1c-1.4.45-3.42.31-3.42.31s.05 6.97.03 8.41c.47.07 19.16.03 19.16.03L23 16.18s-6.75-.32-9.47-1.68c-1.21-.6-2.8-3.16-2.8-3.16" stroke-linejoin="round"/>\n    <path d="M1.74 6.7l4.37-4.8 7.75 5.75-5.7 6.08z" stroke-linecap="round" stroke-linejoin="round" />\n    <path d="M11.67 8.53l2.34-5.3-.83-.68-2.36 2.84" stroke-linejoin="round"/>\n    <g transform="matrix(1 0 0 .98193 0 -265.35)" stroke-width="0.5">\n      <path d="M6.55 295.18v-7.65h14.1v7.72" />\n      <path d="M17.1 287.55v7.7M10.02 287.57v7.63M13.51 287.53v7.84" />\n      <path d="M6.52 290.53h14M6.5 293.34h14.05" />\n      <path d="M7.02 287.98h2.54v2.12H7.02zM10.44 290.96h2.67v1.98h-2.67z" fill="#E4E1D2" />\n      <rect y="293.75" x="13.94" height="1.67" width="2.73" ry="0" fill="#E4E1D2" />\n    </g>\n  </g>\n</svg>\n',name:"pattern_fill",component:class extends Se{constructor(e){super(),_e(this,e,bi,wi,a,{})}}},{icon:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   viewBox="-5 0 80 60"\n   width="50"\n   height="50"\n   version="1.1"\n   id="svg4"\n   sodipodi:docname="repetition.svg"\n   inkscape:version="1.1.1 (3bf5ae0d25, 2021-09-20)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <defs\n     id="defs8" />\n  <sodipodi:namedview\n     id="namedview6"\n     pagecolor="#ffffff"\n     bordercolor="#999999"\n     borderopacity="1"\n     inkscape:pageshadow="0"\n     inkscape:pageopacity="0"\n     inkscape:pagecheckerboard="0"\n     showgrid="false"\n     inkscape:zoom="16.744289"\n     inkscape:cx="42.372657"\n     inkscape:cy="31.503279"\n     inkscape:window-width="3836"\n     inkscape:window-height="2104"\n     inkscape:window-x="1920"\n     inkscape:window-y="26"\n     inkscape:window-maximized="1"\n     inkscape:current-layer="svg4" />\n  <path\n     fill-rule="evenodd"\n     d="M48.4 50.3A9 9 0 0 1 36 42c0-1 .1-1.8.4-2.7A9 9 0 0 1 24 31c0-1 .1-1.8.4-2.7A9 9 0 0 1 12 20c0-1 .1-1.8.4-2.7A9 9 0 0 1 0 9a9 9 0 1 1 17.6 2.7A9 9 0 0 1 30 20a9 9 0 0 1-.4 2.7A9 9 0 0 1 42 31a9 9 0 0 1-.4 2.7A9 9 0 0 1 54 42a9 9 0 0 1-.4 2.7A9 9 0 0 1 66 53a9 9 0 1 1-17.6-2.7zM21 27a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm24 22a7 7 0 1 0 0-14 7 7 0 0 0 0 14z"\n     id="path2" />\n</svg>\n',name:"repetition",component:class extends Se{constructor(e){super(),_e(this,e,Zi,Ji,a,{})}}},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><switch><g><path d="M73.4 73.3c-1.1-.1-2.1.2-2.9.9A31.7 31.7 0 0118.4 50v-1.9h4.3c1.3 0 2.4-.7 3.1-1.8.6-1.1.6-2.5-.1-3.5l-8.3-12.9c-.6-1-1.7-1.5-2.9-1.5s-2.3.6-2.9 1.5L3.1 42.8a3.4 3.4 0 00-.1 3.5 3.5 3.5 0 003.1 1.8h4.3V50a39.8 39.8 0 0065.5 30.3 4 4 0 00.5-5.7c-1-.7-1.9-1.3-3-1.3zM97.1 53.7a3.5 3.5 0 00-3.1-1.8h-4.3V50a39.8 39.8 0 00-65.5-30.4 4 4 0 00-.5 5.7 4 4 0 005.7.5A31.7 31.7 0 0181.5 50v1.8h-4.3c-1.3 0-2.4.7-3.1 1.8-.6 1.1-.6 2.5.1 3.5L82.5 70c.6 1 1.7 1.6 2.9 1.6s2.3-.6 2.9-1.6l8.3-12.9c1-1 1.1-2.3.5-3.4z"/></g></switch></svg>\n',name:"selection",component:class extends Se{constructor(e){super(),_e(this,e,ni,ti,a,{})}}},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 39.34 59.97"><path d="m39.31 14.9-1-4.89a1 1 0 0 0-.56-.7 1 1 0 0 0-.89 0l-4.44 2.39a1 1 0 0 0-.44.46l-4.18 9V1a1 1 0 0 0-1-1h-12a1 1 0 0 0-1 1v19.89L9.12 8.65a3 3 0 0 0-3.87-1.73l-1.86.71a3 3 0 0 0-1.67 1.58 3 3 0 0 0-.07 2.3l1.78 4.67-2.8 1.07a1 1 0 0 0-.56.52 1.08 1.08 0 0 0 0 .77l2.14 5.6a1 1 0 0 0 .94.64 1.13 1.13 0 0 0 .36-.06 1 1 0 0 0 .57-1.29L2.3 18.76 4.14 18l4.2 11h-.25a3 3 0 0 0-2.29 1 3 3 0 0 0-.7 2.38l3.44 25a3 3 0 0 0 3 2.59h18.52a3 3 0 0 0 3-2.59l3.45-25a3 3 0 0 0-.7-2.38 3 3 0 0 0-2.27-1h-.56l6.3-13.47a1 1 0 0 0 .03-.63ZM15.81 2h10v3h-1a1 1 0 0 0 0 2h1v3h-3a1 1 0 0 0 0 2h3v3h-1a1 1 0 0 0 0 2h1v3h-3a1 1 0 0 0 0 2h3v3h-1a1 1 0 0 0 0 2h1v2h-8.9l-1.1-2.88ZM3.5 10.8a1 1 0 0 1 0-.77 1 1 0 0 1 .56-.53l1.86-.71a1 1 0 0 1 1.3.58L9.04 14 5.3 15.46Zm2.5 6.53 3.8-1.43 5 13.1h-4.34ZM30.06 58H11.54a1 1 0 0 1-1-.86L10.12 54h21.36l-.43 3.14a1 1 0 0 1-.99.86Zm4.2-26.66a1 1 0 0 1 .24.8L31.8 52h-22L7.1 32.14a1 1 0 0 1 .24-.8A1 1 0 0 1 8.1 31h25.42a1 1 0 0 1 .75.34zM30.74 29H27.8v-3.16l5.86-12.54 2.94-1.57.68 3.27Z"/></svg>\n',name:"tools",component:class extends Se{constructor(e){super(),_e(this,e,eo,Qi,a,{})}}}];function no(e){let t,n,r,i,l,a;return{c(){t=M("form"),n=M("input"),r=A(),i=M("button"),i.textContent="√",D(n,"type","text"),D(n,"class","svelte-hi8ing"),D(i,"type","button"),D(i,"class","icon-button save-load svelte-hi8ing"),D(t,"class","download svelte-hi8ing")},m(o,s){S(o,t,s),x(t,n),V(n,e[1]),e[9](n),x(t,r),x(t,i),e[10](i),l||(a=[R(n,"input",e[8]),R(n,"blur",e[6]),R(i,"click",e[5]),R(t,"submit",e[5])],l=!0)},p(e,t){2&t&&n.value!==e[1]&&V(n,e[1])},d(n){n&&T(t),e[9](null),e[10](null),l=!1,o(a)}}}function ro(e){let t,n,r,i,o,l,a,s=e[4]("terms.save")+"";return{c(){t=M("button"),n=M("span"),r=E(s),i=A(),o=M("div"),D(o,"class","icon svelte-hi8ing"),D(t,"class","icon-button save-load svelte-hi8ing")},m(s,u){S(s,t,u),x(t,n),x(n,r),x(t,i),x(t,o),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 317 317" width="317" height="317"><path d="M317.6 230.7V301a16 16 0 01-.5 3.9 15.1 15.1 0 01-14.7 12.1H15.1A15 15 0 01.2 303.6c-.2-.9-.2-1.7-.2-2.7v-70.3A15 15 0 0125.6 220a15 15 0 014.4 10.6v56.3h257.7v-56.3a15 15 0 0125.6-10.6c2.6 2.8 4.3 6.6 4.3 10.7z"/><path d="M245.3 160.3L171.6 234l-.4.4a17.4 17.4 0 01-9.7 4.9l-.9.1-1.8.1-1.7-.1-.9-.1a17 17 0 01-9.7-4.9l-.4-.4-73.7-73.7a17.5 17.5 0 010-24.8 17.6 17.6 0 0124.8 0l44.3 44.3V17.5a17.6 17.6 0 0129.9-12.4c3.2 3.2 5.1 7.5 5.1 12.4v162.3l44.3-44.3a17.6 17.6 0 0124.8 0 18 18 0 01-.3 24.8z"/></svg>\n',l||(a=R(t,"click",e[7]),l=!0)},p(e,t){16&t&&s!==(s=e[4]("terms.save")+"")&&O(r,s)},d(e){e&&T(t),l=!1,a()}}}function io(e){let n;function r(e,t){return e[3]?no:ro}let i=r(e),o=i(e);return{c(){o.c(),n=P()},m(e,t){o.m(e,t),S(e,n,t)},p(e,[t]){i===(i=r(e))&&o?o.p(e,t):(o.d(1),o=i(e),o&&(o.c(),o.m(n.parentNode,n)))},i:t,o:t,d(e){o.d(e),e&&T(n)}}}function oo(e,t,n){let r,i,o,l,a,s;u(e,nr,(e=>n(11,i=e))),u(e,It,(e=>n(4,o=e))),q((()=>{!0===r&&(console.log("set focus",s),s.focus())}));return n(3,r=!1),[l,a,s,r,o,function(e){console.log("?"),e.preventDefault();const t=new Blob([JSON.stringify(i)],{type:"text/json"}),o=document.createElement("a");o.download=a+".json",o.href=window.URL.createObjectURL(t),o.dataset.downloadurl=["text/json",o.download,o.href].join(":");const l=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(l),n(3,r=!1)},function(e){e.relatedTarget},()=>n(3,r=!0),function(){a=this.value,n(1,a)},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(2,s)}))},function(e){Z[e?"unshift":"push"]((()=>{l=e,n(0,l)}))}]}class lo extends Se{constructor(e){super(),_e(this,e,oo,io,a,{})}}function ao(e,t,n){const r=e.slice();return r[9]=t[n],r[11]=n,r}function so(e){let t,n,r,i,o,l,a,s,u,c,d,h,f,p,g,v,m,w,b=e[3]("terms.upload")+"",y=to,$=[];for(let t=0;t<y.length;t+=1)$[t]=uo(ao(e,y,t));return r=new lo({}),{c(){t=M("div");for(let e=0;e<$.length;e+=1)$[e].c();n=A(),ye(r.$$.fragment),i=A(),o=M("div"),l=M("input"),a=A(),s=M("label"),u=E(b),c=A(),d=M("div"),h=M("a"),f=M("div"),D(l,"type","file"),D(l,"name","upload"),D(l,"id","upload"),D(l,"class","svelte-1d8ljdh"),D(s,"class","icon-button button svelte-1d8ljdh"),D(s,"for","upload"),D(o,"class","save-load svelte-1d8ljdh"),D(f,"class","icon svelte-1d8ljdh"),D(h,"href",p=`/weaver/docs_${e[1].locale}`),D(d,"class","help svelte-1d8ljdh"),D(t,"class","sidebar svelte-1d8ljdh")},m(p,g){S(p,t,g);for(let e=0;e<$.length;e+=1)$[e].m(t,null);x(t,n),$e(r,t,null),x(t,i),x(t,o),x(o,l),x(o,a),x(o,s),x(s,u),x(t,c),x(t,d),x(d,h),x(h,f),f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"  width="100" height="100" viewbox="0 0 100 100"><path d="M50 0a50 50 0 1050 50A50 50 0 0050 0zm4 70c0 3-2 5-5 5s-5-2-5-5 1-5 5-5c2 0 5 1 5 5zm7-23l-5 3a7 7 0 00-3 6 4 4 0 01-3 4 4 4 0 01-5-1 4 4 0 010-2 14 14 0 015-12 42 42 0 005-4 5 5 0 001-3c0-3-2-4-5-5-3 0-6 1-8 4a4 4 0 01-4 2c-3 0-5-3-4-6a13 13 0 017-6 22 22 0 019-2 46 46 0 015 1c5 1 9 6 9 11a10 10 0 01-4 10z"/></svg>\n',e[7](t),v=!0,m||(w=R(l,"input",e[5]),m=!0)},p(e,r){if(24&r){let i;for(y=to,i=0;i<y.length;i+=1){const o=ao(e,y,i);$[i]?$[i].p(o,r):($[i]=uo(o),$[i].c(),$[i].m(t,n))}for(;i<$.length;i+=1)$[i].d(1);$.length=y.length}(!v||8&r)&&b!==(b=e[3]("terms.upload")+"")&&O(u,b),(!v||2&r&&p!==(p=`/weaver/docs_${e[1].locale}`))&&D(h,"href",p)},i(e){v||(ge(r.$$.fragment,e),re((()=>{g||(g=we(t,wt,{x:-150,duration:20,opacity:1},!0)),g.run(1)})),v=!0)},o(e){ve(r.$$.fragment,e),g||(g=we(t,wt,{x:-150,duration:20,opacity:1},!1)),g.run(0),v=!1},d(n){n&&T(t),k($,n),xe(r),e[7](null),n&&g&&g.end(),m=!1,w()}}}function uo(e){let t,n,r,i,o,l,a,s,u=e[9].icon+"",c=e[3](`page.${e[9].name}.title`)+"";function d(){return e[6](e[11])}return{c(){t=M("button"),n=M("div"),i=A(),o=M("span"),l=E(c),D(n,"class",r=g("icon")+" svelte-1d8ljdh"),D(t,"class","icon-button svelte-1d8ljdh")},m(e,r){S(e,t,r),x(t,n),n.innerHTML=u,x(t,i),x(t,o),x(o,l),a||(s=R(t,"click",d),a=!0)},p(t,n){e=t,8&n&&c!==(c=e[3](`page.${e[9].name}.title`)+"")&&O(l,c)},d(e){e&&T(t),a=!1,s()}}}function co(e){let t,n,r=e[0]&&so(e);return{c(){t=M("div"),r&&r.c(),D(t,"class","sidebar-container svelte-1d8ljdh")},m(e,i){S(e,t,i),r&&r.m(t,null),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&ge(r,1)):(r=so(e),r.c(),ge(r,1),r.m(t,null)):r&&(fe(),ve(r,1,1,(()=>{r=null})),pe())},i(e){n||(ge(r),n=!0)},o(e){ve(r),n=!1},d(e){e&&T(t),r&&r.d()}}}function ho(e,t,n){let r,i,o;u(e,ar,(e=>n(1,r=e))),u(e,It,(e=>n(3,i=e)));let{open:l=!1}=t;function a(e){console.log("select menu",e),n(0,l=!1),ar.update((t=>{t.selectedMenu=t.selectedMenu===e?-1:e}))}return e.$$set=e=>{"open"in e&&n(0,l=e.open)},e.$$.update=()=>{e.$$.dirty},[l,r,o,i,a,function(e){let t=e.target.files;if(t.length>0){let e=t[0],n=new FileReader;n.onload=e=>{try{let t=JSON.parse(e.target.result);nr.set(t)}catch(e){console.error(e)}},n.readAsText(e)}},e=>a(e),function(e){Z[e?"unshift":"push"]((()=>{o=e,n(2,o)}))}]}class fo extends Se{constructor(e){super(),_e(this,e,ho,co,a,{open:0})}}let po={xStepDistance:8,yStepDistance:8,showTreadleOrder:!0,showThreading:!0};if(window.localStorage.getItem("options")){let e=JSON.parse(localStorage.getItem("options"));po={...po,...e}}const go=ot(po);let vo=po;go.subscribe((e=>{vo=e}));var mo={options:go,update:function(e){go.set(Xn(vo,e,(e=>Jn(e))))},subscribe:function(e){return go.subscribe(e)}};window.dropOptions=function(){localStorage.removeItem("options")},go.subscribe((e=>{window.options=e,localStorage.setItem("options",JSON.stringify({}))}));function wo(e,t,n){const r=e.slice();return r[11]=t[n],r[13]=n,r}function bo(e){let n,r;return{c(){n=new F,r=P(),n.a=r},m(e,t){n.m('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140.7 121.9"><path d="M140.1.4H.6l69.8 120.8z" /></svg>\n',e,t),S(e,r,t)},p:t,d(e){e&&T(r),e&&n.d()}}}function yo(e){let n,r;return{c(){n=new F,r=P(),n.a=r},m(e,t){n.m('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140.7 121.9"><path d="M140.1 121.5H.6L70.4.7z" /></svg>\n',e,t),S(e,r,t)},p:t,d(e){e&&T(r),e&&n.d()}}}function $o(e){let t,n=e[3],r=[];for(let t=0;t<n.length;t+=1)r[t]=xo(wo(e,n,t));return{c(){t=M("div");for(let e=0;e<r.length;e+=1)r[e].c();D(t,"class","color-dropdown svelte-1urfrg8")},m(e,n){S(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,i){if(26&i){let o;for(n=e[3],o=0;o<n.length;o+=1){const l=wo(e,n,o);r[o]?r[o].p(l,i):(r[o]=xo(l),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){e&&T(t),k(r,e)}}}function xo(t){let n,r,i,o;function l(){return t[9](t[11])}return{c(){n=M("button"),D(n,"class","item svelte-1urfrg8"),D(n,"style",r=`background-color: ${e.fromRatio(t[11].color).toHexString()};\n          `),N(n,"selected",t[1]===t[11].id)},m(e,t){S(e,n,t),i||(o=R(n,"click",l),i=!0)},p(i,o){t=i,8&o&&r!==(r=`background-color: ${e.fromRatio(t[11].color).toHexString()};\n          `)&&D(n,"style",r),10&o&&N(n,"selected",t[1]===t[11].id)},d(e){e&&T(n),i=!1,o()}}}function Co(e){let n,r,i,o,l,a,s,u;function c(e,t){return!0===e[2]?yo:bo}let d=c(e),h=d(e),f=!0===e[2]&&$o(e);return{c(){n=M("div"),r=M("button"),i=M("span"),h.c(),a=A(),f&&f.c(),D(i,"class","arrow svelte-1urfrg8"),D(i,"style",o=`\n        stroke: ${e[0].isDark()?"black":"white"};\n        fill: ${e[0].isLight()?"black":"white"};\n        `),D(r,"class","color-display svelte-1urfrg8"),D(r,"style",l=`background-color: ${e[0].toHexString()};`),D(n,"class","yarn-selector svelte-1urfrg8")},m(t,o){S(t,n,o),x(n,r),x(r,i),h.m(i,null),x(n,a),f&&f.m(n,null),s||(u=R(r,"click",e[8]),s=!0)},p(e,[t]){d===(d=c(e))&&h?h.p(e,t):(h.d(1),h=d(e),h&&(h.c(),h.m(i,null))),1&t&&o!==(o=`\n        stroke: ${e[0].isDark()?"black":"white"};\n        fill: ${e[0].isLight()?"black":"white"};\n        `)&&D(i,"style",o),1&t&&l!==(l=`background-color: ${e[0].toHexString()};`)&&D(r,"style",l),!0===e[2]?f?f.p(e,t):(f=$o(e),f.c(),f.m(n,null)):f&&(f.d(1),f=null)},i:t,o:t,d(e){e&&T(n),h.d(),f&&f.d(),s=!1,u()}}}function _o(t,n,r){let i,o,l,a,s;u(t,nr,(e=>r(6,a=e))),u(t,ar,(e=>r(7,s=e)));let c,d=!1;function h(e){ar.update((t=>{t.selectedColor=e})),r(2,d=!1)}return t.$$.update=()=>{128&t.$$.dirty&&r(1,i=s.selectedColor),66&t.$$.dirty&&r(5,o=a.yarn.find((e=>e.id===i))),32&t.$$.dirty&&r(0,c=e.fromRatio(o?.color)),1&t.$$.dirty&&c.isDark(),64&t.$$.dirty&&r(3,l=a.yarn)},[c,i,d,l,h,o,a,s,()=>r(2,d=!d),e=>h(e.id)]}class So extends Se{constructor(e){super(),_e(this,e,_o,Co,a,{})}}function To(e){let t,n,r;const i=e[4].default,o=c(i,e,e[3],null);return{c(){t=M("div"),o&&o.c(),D(t,"class","dropdown-content svelte-ctlky3"),D(t,"style",n=`top: ${e[2]}px`)},m(e,n){S(e,t,n),o&&o.m(t,null),r=!0},p(e,l){o&&o.p&&(!r||8&l)&&f(o,i,e,e[3],r?h(i,e[3],l,null):p(e[3]),null),(!r||4&l&&n!==(n=`top: ${e[2]}px`))&&D(t,"style",n)},i(e){r||(ge(o,e),r=!0)},o(e){ve(o,e),r=!1},d(e){e&&T(t),o&&o.d(e)}}}function ko(e){let t,n,r,i,o,l,a=e[0]&&To(e);return{c(){t=M("div"),n=M("button"),n.textContent="👁",r=A(),a&&a.c(),D(t,"class","dropdown svelte-ctlky3")},m(s,u){S(s,t,u),x(t,n),x(t,r),a&&a.m(t,null),e[6](t),i=!0,o||(l=R(n,"click",e[5]),o=!0)},p(e,[n]){e[0]?a?(a.p(e,n),1&n&&ge(a,1)):(a=To(e),a.c(),ge(a,1),a.m(t,null)):a&&(fe(),ve(a,1,1,(()=>{a=null})),pe())},i(e){i||(ge(a),i=!0)},o(e){ve(a),i=!1},d(n){n&&T(t),a&&a.d(),e[6](null),o=!1,l()}}}function Mo(e,t,n){let r,i,{$$slots:o={},$$scope:l}=t,{isToggled:a=!1}=t;return e.$$set=e=>{"isToggled"in e&&n(0,a=e.isToggled),"$$scope"in e&&n(3,l=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&void 0!==r&&0===i&&n(2,i=r.firstChild.getBoundingClientRect().height)},n(1,r=void 0),n(2,i=0),[a,r,i,l,o,()=>n(0,a=!a),function(e){Z[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class Eo extends Se{constructor(e){super(),_e(this,e,Mo,ko,a,{isToggled:0})}}function Ao(e){let t,n;const r=e[1].default,i=c(r,e,e[0],null);return{c(){t=M("div"),i&&i.c(),D(t,"class","dropdown-item svelte-4pxv5h")},m(e,r){S(e,t,r),i&&i.m(t,null),n=!0},p(e,[t]){i&&i.p&&(!n||1&t)&&f(i,r,e,e[0],n?h(r,e[0],t,null):p(e[0]),null)},i(e){n||(ge(i,e),n=!0)},o(e){ve(i,e),n=!1},d(e){e&&T(t),i&&i.d(e)}}}function Po(e,t,n){let{$$slots:r={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(0,i=e.$$scope)},[i,r]}class Ro extends Se{constructor(e){super(),_e(this,e,Po,Ao,a,{})}}function Do(e){let t;return{c(){t=E("x")},m(e,n){S(e,t,n)},d(e){e&&T(t)}}}function zo(e){let t;return{c(){t=E("≡")},m(e,n){S(e,t,n)},d(e){e&&T(t)}}}function Oo(e){let t,n,r;function i(t){e[9](t)}let o={label:e[4]("toolbar.showThreading")};return void 0!==e[1]&&(o.checked=e[1]),t=new Gr({props:o}),Z.push((()=>be(t,"checked",i))),{c(){ye(t.$$.fragment)},m(e,n){$e(t,e,n),r=!0},p(e,r){const i={};16&r&&(i.label=e[4]("toolbar.showThreading")),!n&&2&r&&(n=!0,i.checked=e[1],ie((()=>n=!1))),t.$set(i)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){ve(t.$$.fragment,e),r=!1},d(e){xe(t,e)}}}function Vo(e){let t,n,r;function i(t){e[10](t)}let o={label:e[4]("toolbar.showTreadleOrder")};return void 0!==e[2]&&(o.checked=e[2]),t=new Gr({props:o}),Z.push((()=>be(t,"checked",i))),{c(){ye(t.$$.fragment)},m(e,n){$e(t,e,n),r=!0},p(e,r){const i={};16&r&&(i.label=e[4]("toolbar.showTreadleOrder")),!n&&4&r&&(n=!0,i.checked=e[2],ie((()=>n=!1))),t.$set(i)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){ve(t.$$.fragment,e),r=!1},d(e){xe(t,e)}}}function Lo(e){let t,n,r,i;return t=new Ro({props:{$$slots:{default:[Oo]},$$scope:{ctx:e}}}),r=new Ro({props:{$$slots:{default:[Vo]},$$scope:{ctx:e}}}),{c(){ye(t.$$.fragment),n=A(),ye(r.$$.fragment)},m(e,o){$e(t,e,o),S(e,n,o),$e(r,e,o),i=!0},p(e,n){const i={};8210&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i);const o={};8212&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){i||(ge(t.$$.fragment,e),ge(r.$$.fragment,e),i=!0)},o(e){ve(t.$$.fragment,e),ve(r.$$.fragment,e),i=!1},d(e){xe(t,e),e&&T(n),xe(r,e)}}}function No(e){let t,n,r,i,l,a,s,u,c,d,h,f,p,g,v,m,w=e[4]("terms.undo")+"",b=e[4]("terms.redo")+"";function y(e,t){return e[0]?Do:zo}let $=y(e),C=$(e);return h=new Eo({props:{$$slots:{default:[Lo]},$$scope:{ctx:e}}}),p=new So({}),{c(){t=M("div"),n=M("button"),C.c(),r=A(),i=M("div"),l=M("button"),a=E(w),s=A(),u=M("button"),c=E(b),d=A(),ye(h.$$.fragment),f=A(),ye(p.$$.fragment),D(n,"class","hamberder svelte-1617tc9"),D(t,"class","tool-bar svelte-1617tc9")},m(o,w){S(o,t,w),x(t,n),C.m(n,null),x(t,r),x(t,i),x(i,l),x(l,a),x(i,s),x(i,u),x(u,c),x(t,d),$e(h,t,null),x(t,f),$e(p,t,null),e[11](t),g=!0,v||(m=[R(n,"click",e[5]),R(l,"click",nr.undo),R(u,"click",nr.redo)],v=!0)},p(e,[t]){$!==($=y(e))&&(C.d(1),C=$(e),C&&(C.c(),C.m(n,null))),(!g||16&t)&&w!==(w=e[4]("terms.undo")+"")&&O(a,w),(!g||16&t)&&b!==(b=e[4]("terms.redo")+"")&&O(c,b);const r={};8214&t&&(r.$$scope={dirty:t,ctx:e}),h.$set(r)},i(e){g||(ge(h.$$.fragment,e),ge(p.$$.fragment,e),g=!0)},o(e){ve(h.$$.fragment,e),ve(p.$$.fragment,e),g=!1},d(n){n&&T(t),C.d(),xe(h),xe(p),e[11](null),v=!1,o(m)}}}function Fo(e,t,n){let r,i,o,l,a;u(e,mo,(e=>n(7,o=e))),u(e,ar,(e=>n(8,l=e))),u(e,It,(e=>n(4,a=e)));let s,{height:c=0}=t,{sidebarOpen:d}=t;return W((()=>{n(6,c=s.clientHeight)})),e.$$set=e=>{"height"in e&&n(6,c=e.height),"sidebarOpen"in e&&n(0,d=e.sidebarOpen)},e.$$.update=()=>{e.$$.dirty,128&e.$$.dirty&&n(2,r=o.showTreadleOrder),128&e.$$.dirty&&n(1,i=o.showThreading),4&e.$$.dirty&&mo.update((e=>{e.showTreadleOrder=r})),2&e.$$.dirty&&mo.update((e=>{e.showThreading=i}))},[d,i,r,s,a,function(){n(0,d=!d),!1===d&&ar.update((e=>{e.selectedMenu=-1}))},c,o,l,function(e){i=e,n(1,i),n(7,o)},function(e){r=e,n(2,r),n(7,o)},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(3,s)}))}]}class jo extends Se{constructor(e){super(),_e(this,e,Fo,No,a,{height:6,sidebarOpen:0})}}var Io="attribute vec2 aVertexPosition;\nvarying vec2 uv;\nuniform mat4 mvp;\nvoid main(void) {\n  uv = vec2(\n    clamp(aVertexPosition.x, 0.0, 1.0),\n    clamp(aVertexPosition.y, 0.0, 1.0)\n  );\n  gl_Position = mvp * vec4(vec3(aVertexPosition, 0.0), 1.0);\n}\n";class Bo{constructor(e){this.gl=e,this.shaderCache={}}getShader(e){let t=this.shaderCache[e];if(void 0===t){if(t=function(e){switch(e){case"texture":return new Qe({frag:"precision highp float;\n\nuniform sampler2D sampler;\nuniform float opacity;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_FragColor = vec4(texture2D(sampler, uv).rgb * opacity, opacity);\n}\n",vert:Io});case"solid":return new Qe({frag:"precision highp float;\nuniform vec4 color;\nvoid main(void) {\n  vec3 outColor = color.rgb * color.a;\n  gl_FragColor = vec4(vec3(outColor), color.a);\n}\n",vert:Io});case"weave":return new Qe({frag:"precision highp float;\n\nuniform sampler2D warpSampler;\nuniform sampler2D weftSampler;\nuniform sampler2D threading;\nuniform sampler2D treadleOrder;\nuniform sampler2D tieup;\n\nuniform vec2 cellSize;\nuniform vec2 scrollPos;\nuniform float shaftCount;\nuniform float treadleCount;\n\nvarying vec2 uv;\n\nconst float gap = 0.07;\n\nfloat getBorder(float x, float y, float tieupValue) {\n  vec2 b = vec2(\n      (mod(x, cellSize.x) / cellSize.x),\n      (mod(y, cellSize.y) / cellSize.y));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  /*\n  // Antialiasing, ish\n  float f =\n    smoothstep(0.9, 1.1 - gap, bv.x) * (1.0 - tieupValue) +\n    smoothstep(0.9, 1.1 - gap, bv.y) * tieupValue;\n  */\n  float f =\n    step(1.0 - gap, bv.x) * (1.0 - tieupValue) +\n    step(1.0 - gap, bv.y) * tieupValue;\n\n  return 1.0 - f;\n}\n\nvoid main(void) {\n  float x = (uv.s + scrollPos.x);\n  float y = (uv.t + scrollPos.y);\n\n  vec2 shaft = texture2D(threading, vec2(x, 0.0)).rg;\n  vec2 pedal = texture2D(treadleOrder, vec2(y, 0.0)).rg;\n\n  vec3 warpColor = texture2D(warpSampler, vec2(x, 0.0)).rgb;\n  vec3 weftColor = texture2D(weftSampler, vec2(y, 0.0)).rgb;\n\n  vec2 tieupOffset = vec2(\n      1.0 / (treadleCount + 1.0),\n      1.0 / (shaftCount + 1.0));\n  float tieupValue = texture2D(tieup, vec2(\n        pedal.r + tieupOffset.x,\n        shaft.r + tieupOffset.y\n        )).r;\n  float absence = shaft.g * pedal.g;\n\n  vec3 color = mix(warpColor, weftColor, tieupValue) * getBorder(x, y, tieupValue);\n\n  color = mix(warpColor * getBorder(x, y, 0.0), color, pedal.g);\n  color = mix(weftColor * getBorder(x, y, 1.0), color, shaft.g);\n\n  float overflow = step(y, 1.0) * step(x, 1.0);\n  color = mix(vec3(1.0, 1.0, 1.0), color.rgb, overflow);\n  gl_FragColor = vec4(vec3(color), 1.0);\n}\n",vert:Io});case"grid":return new Qe({frag:"precision highp float;\n\nuniform sampler2D cellToggleSampler;\nuniform vec2 cellSize;\nuniform vec2 scrollPos;\nuniform float vert;\nuniform float steps;\n\nvarying vec2 uv;\n\nconst float cellMargin = 0.15;\nconst float gap = 0.05;\n\nfloat getBorder(float x, float y, float margin) {\n  vec2 b = vec2(\n      (mod(x, cellSize.x) / cellSize.x),\n      (mod(y, cellSize.y) / cellSize.y));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  float f = step(1.0 - margin, bv.x) + step(1.0 - margin, bv.y);\n\n  return 1.0 - f;\n}\n\nfloat getSteps(float x, float y) {\n  float horiz = 1.0 - vert;\n\n  vec2 b = vec2(\n      (mod(x, cellSize.x * steps) / (cellSize.x * steps)),\n      (mod(y, cellSize.y * steps) / (cellSize.y * steps)));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  float margin = 0.012;\n  float f = step(1.0 - margin, bv.x) * horiz + step(1.0 - margin, bv.y) * vert;\n\n  return 1.0 - f;\n}\n\nvoid main(void) {\n  float x = (uv.s + scrollPos.x);\n  float y = (uv.t + scrollPos.y);\n  float horiz = 1.0 - vert;\n\n  vec2 tv = texture2D(cellToggleSampler, vec2(x * horiz + y * vert, 0)).rg;\n  float toggleValue = tv.r + tv.g - 1.0;\n\n  float border = getBorder(x, y, gap) * getSteps(x, y);\n  float squareBorder = 1.0 - getBorder(x, y, cellMargin);\n\n  float nx = x * vert + y * horiz;\n  float cellSizeF = cellSize.x * vert + cellSize.y * horiz;\n  float square = 1.0 - step(toggleValue, nx) * (1.0 - step(toggleValue, nx - cellSizeF));\n\n  float v = (square + squareBorder) * border;\n  float overflow = step(x, 1.0) * step(y, 1.0);\n  v = mix(1.0, v, overflow);\n  gl_FragColor = vec4(vec3(v), 1.0);\n}\n",vert:Io});case"tieup":return new Qe({frag:"precision highp float;\n\nuniform sampler2D cellToggleSampler;\n\nuniform vec2 cellSize;\nuniform vec2 scrollPos;\n\nvarying vec2 uv;\n\nconst float gap = 0.04;\nconst float cellMargin = 0.09;\n\nfloat getBorder(float x, float y, float margin) {\n  vec2 b = vec2(\n      (mod(x, cellSize.x) / cellSize.x),\n      (mod(y, cellSize.y) / cellSize.y));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  float f = step(1.0 - margin, bv.x) + step(1.0 - margin, bv.y);\n\n  return 1.0 - f;\n}\n\nvoid main(void) {\n  vec3 color = vec3(1.0, 1.0, 1.0);\n  float x = (uv.s);\n  float y = (uv.t);\n  float toggleValue = texture2D(cellToggleSampler, vec2(x, y)).r;\n\n  float border = getBorder(x, y, gap);\n  vec3 fill = mix(\n      vec3(0.0, 0.0, 0.0),\n      vec3(1.0, 1.0, 1.0),\n      1.0 - getBorder(x, y, cellMargin) * toggleValue);\n  gl_FragColor = vec4(fill * border, 1.0);\n}\n",vert:Io});case"colorRow":return new Qe({frag:"precision highp float;\n\nuniform sampler2D colorSampler;\n\nuniform vec2 cellSize;\nuniform vec2 scrollPos;\nuniform float vert;\nuniform float steps;\n\nvarying vec2 uv;\n\nconst float gap = 0.04;\nconst float cellMargin = 0.15;\n\nfloat getBorder(float x, float y, float margin) {\n  vec2 b = vec2(\n      (mod(x, cellSize.x) / cellSize.x),\n      (mod(y, cellSize.y) / cellSize.y));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  float f = step(1.0 - margin, bv.x) + step(1.0 - margin, bv.y);\n\n  return 1.0 - f;\n}\n\nfloat getSteps(float x, float y) {\n  float horiz = 1.0 - vert;\n\n  float margin = 0.012;\n  vec2 b = vec2(\n      (mod(x, cellSize.x * steps) / (cellSize.x * steps)),\n      (mod(y, cellSize.y * steps) / (cellSize.y * steps)));\n\n  vec2 bv = 1.0 - vec2(\n      b.x * (1.0 - b.x),\n      b.y * (1.0 - b.y)\n      );\n\n  float f = step(1.0 - margin, bv.x) * horiz + step(1.0 - margin, bv.y) * vert;\n\n  return 1.0 - f;\n}\n\nvoid main(void) {\n  float x = uv.s + scrollPos.x;\n  float y = uv.t + scrollPos.y;\n  if(x > 1.0 || y > 1.0) {\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n  } else {\n    float horiz = 1.0 - vert;\n  //vec2 tv = texture2D(cellToggleSampler, vec2(x * horiz + y * vert, 0)).rg;\n    vec3 cellColor = texture2D(\n        colorSampler,\n        vec2(x * horiz + y * vert, 0)).rgb;\n    float border = getBorder(x, y, gap) * getSteps(x, y);\n    vec3 fill = mix(\n        cellColor,\n        vec3(1.0, 1.0, 1.0),\n        1.0 - getBorder(x, y, cellMargin));\n    float overflow = step(x, 1.0) * step(y, 1.0);\n    gl_FragColor = vec4((fill * border) * overflow, 1.0);\n  }\n}\n",vert:Io});default:return}}(e),void 0===t)throw new Error(`Unknown shader name ${e}`);t.compile(this.gl),this.shaderCache[e]=t}return t}}class Xo{constructor(e,t,n,r){if(this.gl=e,void 0===t||void 0===n)throw new Error("Undefined width/height of texture");if(this.width=t,this.height=n,r instanceof Uint8Array)this.color=r;else{this.color=new Uint8Array(4*r.length);for(let e=0;e<r.length;e++){let t=r[e],n=4*e;this.color[n+0]=255*t[0],this.color[n+1]=255*t[1],this.color[n+2]=255*t[2],this.color[n+3]=255*t[3]}}this.compile(this.gl)}compile(){this.texture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.color),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}delete(){this.gl.deleteTexture(this.texture)}bind(e){this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}setColor(e,t,n){this.setColorArea(e,t,1,1,n)}setColorArea(e,t,n,r,i){this.color=new Uint8Array([255*i[0],255*i[1],255*i[2],255*i[3]]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,e,t,n,r,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.color),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}unbind(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}}class Yo{clickListeners=[];pointerMoveListeners=[];pointerUpListeners=[];pointerDownListeners=[];constructor(e,t,n){this.gl=e,this.name=n,this.solidShader=t.getShader("solid"),this.centerQuad=new Ze(this.gl,[-.5,.5,.5,.5,.5,-.5,-.5,-.5],[1,0,2,2,0,3],[2]),this.quad=new Ze(this.gl,[0,1,1,1,1,0,0,0],[1,0,2,2,0,3],[2])}prerender(){let{cellSize:e,xCount:t,yCount:n}=this.values,[r,i]=this.rendererPos,o=this.gl.canvas.width,l=e/2;this.gl.scissor(o-(r+t)*l-2/2.1,i*l-2/2.1,l*t+2,l*n+2)}isWithinGrid(e){let{cellSize:t,xCount:n,yCount:r}=this.values,i=window.devicePixelRatio,o=this.gl.canvas.width/i,l=this.gl.canvas.height/i,a=t/i,s=(o-e[0])/o*2,u=(l-e[1])/l*2,c=this.rendererPos[0]*(a/o),d=this.rendererPos[1]*(a/l);return s>c&&u>d&&s<c+n*a/o&&u<d+r*a/l}getCellAtPos(e){let{cellSize:t,scrollX:n,scrollY:r}=this.values,i=this.shouldScrollX?1:0,o=this.shouldScrollY?1:0,l=window.devicePixelRatio,a=this.gl.canvas.width/l,s=this.gl.canvas.height/l,u=t/l,c=i*(n/u),d=o*(r/u),h=Math.floor((a-e[0])/(u/2)+c),f=Math.floor((s-e[1])/(u/2)+d);return[h-this.rendererPos[0],f-this.rendererPos[1]]}getCellsBetweenPoints(e,t){let n=this.getCellAtPos(e),r=this.getCellAtPos(t),i=ri(n[0],n[1],r[0],r[1]),{xCount:o,yCount:l}=this.values;return i.filter((e=>e[0]>=0&&e[0]<o&&e[1]>=0&&e[1]<l))}}class Ho extends Yo{constructor(e,t,n){super(e,t,n),this.shader=t.getShader("tieup"),this.mvp=Me(),this.initialView=Me(),Pe(this.initialView,this.initialView,[-1,1,1]),Ae(this.initialView,this.initialView,[-1,-1,0]),this.view=Me(),this.mvp=Me()}renderPoints(e){this.render();let{xCount:t,yCount:n,cellSize:r}=this.values;this.solidShader.bind(),this.centerQuad.bind();let i=r/this.gl.canvas.width,o=r/this.gl.canvas.height,l=Ee(this.mvp),a=Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*i,this.rendererPos[1]*o,0]);Ae(a,a,[i/2,o/2,1]),Pe(a,a,[i,o,1]);for(let r=0;r<t;r++)for(let t=0;t<n;t++)e.some((e=>e[0]===r&&e[1]===t))&&(this.solidShader.setVec4("color",[1,0,0,1]),Ae(l,a,[r,t,0]),Pe(l,l,[.8,.8,1]),this.solidShader.setMat4("mvp",l),this.centerQuad.draw());this.centerQuad.unbind(),this.solidShader.unbind()}handleEvent(e){let{cellSize:t,xCount:n,yCount:r}=this.values,i=this.gl.canvas.width,o=this.gl.canvas.height,l=(i-e.offsetX)/i*2,a=(o-e.offsetY)/o*2,s=this.rendererPos[0]*(t/i),u=this.rendererPos[1]*(t/o),c=n*t/i,d=r*t/o;if(l>s&&a>u&&l<s+c&&a<u+d){return[Math.floor((l-s)/c*n),Math.floor((a-u)/d*r),e]}}updateValues(e){this.values=e}setRendererPosition(e){this.rendererPos=e}setCellToggleTexture(e){this.cellToggleTexture=e}render(){if(this.prerender(),void 0===this.values)return;let{xCount:e,yCount:t,cellSize:n}=this.values,r=this.gl.canvas.width,i=this.gl.canvas.height;this.shader.bind(),this.quad.bind();let o=n/r,l=n/i,a=Ee(this.mvp);Pe(a,Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*o,this.rendererPos[1]*l,0]),[n*e/r,n*t/i,1]),this.cellToggleTexture.bind(0),this.shader.setSampler2D("cellToggleSampler",0),this.shader.setVec2("scrollPos",[0,0]),this.shader.setVec2("cellSize",[o/(o*e),l/(l*t)]),this.shader.setMat4("mvp",a),this.quad.draw(),this.quad.unbind(),this.shader.unbind()}}class Uo extends Yo{constructor(e,t,n,r,i,o){super(e,t,o),this.gl=e,this.shader=t.getShader("grid"),this.vertical=n,this.name=o,this.shouldScrollX=r,this.shouldScrollY=i,this.mvp=Me(),this.initialView=Me(),Pe(this.initialView,this.initialView,[-1,1,1]),Ae(this.initialView,this.initialView,[-1,-1,0]),this.view=Me(),this.mvp=Me()}updateValues(e){this.values=e}setRendererPosition(e){this.rendererPos=e}setCellToggleTexture(e){this.cellToggleTexture=e}renderPoints(e){this.render();let{xCount:t,yCount:n,cellSize:r,scrollX:i,scrollY:o}=this.values;this.solidShader.bind(),this.centerQuad.bind();let l=r/this.gl.canvas.width,a=r/this.gl.canvas.height,s=this.shouldScrollX?1:0,u=this.shouldScrollY?1:0,c=Ee(this.mvp),d=Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*l,this.rendererPos[1]*a,0]);Ae(d,d,[l/2,a/2,1]),Pe(d,d,[l,a,1]);let h=Math.min(t,n);for(let l=0;l<e.length;l++)for(let a=0;a<h;a++){let h,f;n<t?(h=l,f=a):(h=a,f=l);let p=window.devicePixelRatio;Ae(c,d,[-i/r*s*p,-o/r*u*p,0]),Ae(c,c,[h,f,0]),void 0!==e[l]&&(e[l]===a?(this.solidShader.setVec4("color",[.02,.4,.02,1]),Pe(c,c,[.62,.62,1])):(this.solidShader.setVec4("color",[1,1,1,1]),Pe(c,c,[.8,.8,1])),this.solidShader.setMat4("mvp",c),this.centerQuad.draw())}this.centerQuad.unbind(),this.solidShader.unbind()}render(){if(this.prerender(),void 0===this.values)return;let{xCount:e,yCount:t,cellSize:n,warpCount:r,weftCount:i,scrollX:o,scrollY:l,xStepDistance:a,yStepDistance:s}=this.values,u=this.shouldScrollX?1:0,c=this.shouldScrollY?1:0,d=this.gl.canvas.width,h=this.gl.canvas.height;this.shader.bind(),this.quad.bind();let f=n/d,p=n/h,g=Ee(this.mvp);Pe(g,Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*f,this.rendererPos[1]*p,0]),[n*e/d,n*t/h,1]),this.cellToggleTexture.bind(0),this.shader.setSampler2D("cellToggleSampler",0),this.shader.setVec2("scrollPos",[o/(r*n)*devicePixelRatio*u,l/(i*n)*devicePixelRatio*c]),this.shader.setFloat("vert",t>e?1:0),this.shader.setFloat("steps",t>e?s:a),this.shader.setVec2("cellSize",[f/(f*e),p/(p*t)]),this.shader.setMat4("mvp",g),this.quad.draw(),this.quad.unbind(),this.shader.unbind()}}class Wo extends Yo{constructor(e,t,n){super(e,t,n),this.gl=e,this.weaveShader=t.getShader("weave"),this.initialView=Me(),Pe(this.initialView,this.initialView,[-1,1,1]),Ae(this.initialView,this.initialView,[-1,-1,0]),this.view=Me(),this.mvp=Me()}updateValues(e){this.values=e}setThreadingTexture(e){this.threading=e}setTreadleOrderTexture(e){this.treadleOrder=e}setTieupTexture(e){this.tieup=e}setWarpTexture(e){this.warpTexture=e}setWeftTexture(e){this.weftTexture=e}setRendererPosition(e){this.rendererPos=e}render(){if(this.prerender(),void 0===this.values)return;let{xCount:e,yCount:t,scrollX:n,scrollY:r,cellSize:i,shaftCount:o,treadleCount:l}=this.values,a=this.gl.canvas.width,s=this.gl.canvas.height,u=i/a,c=i/s,d=Ee(this.mvp);Pe(d,Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*u,this.rendererPos[1]*c,0]),[i*e/a,i*t/s,1]),this.weaveShader.bind(),this.quad.bind(),this.weaveShader.setMat4("mvp",d),this.warpTexture.bind(0),this.weaveShader.setSampler2D("warpSampler",0),this.weftTexture.bind(1),this.weaveShader.setSampler2D("weftSampler",1),this.threading.bind(2),this.weaveShader.setSampler2D("threading",2),this.treadleOrder.bind(3),this.weaveShader.setSampler2D("treadleOrder",3),this.tieup.bind(4),this.weaveShader.setSampler2D("tieup",4),this.weaveShader.setFloat("shaftCount",o),this.weaveShader.setFloat("treadleCount",l),this.weaveShader.setVec2("cellSize",[u/(u*e),c/(c*t)]);let h=window.devicePixelRatio;this.weaveShader.setVec2("scrollPos",[n/(e*i)*h,r/(t*i)*h]),this.quad.draw(),this.quad.unbind(),this.weaveShader.unbind()}}class qo extends Yo{constructor(e,t,n,r,i){super(e,t,i),this.shader=t.getShader("colorRow"),this.shouldScrollX=n,this.shouldScrollY=r,this.initialView=Me(),Pe(this.initialView,this.initialView,[-1,1,1]),Ae(this.initialView,this.initialView,[-1,-1,0]),this.view=Me(),this.mvp=Me()}getCellsBetweenPoints(e,t){let n=this.getCellAtPos(e),r=this.getCellAtPos(t);return this.values.yCount>this.values.xCount?[n[1],r[1]]:[n[0],r[0]]}renderPoints(e,t,n){this.render();let{xCount:r,yCount:i,cellSize:o,scrollX:l,scrollY:a}=this.values;this.solidShader.bind(),this.centerQuad.bind(),t<e&&([e,t]=[t,e]);let s=o/this.gl.canvas.width,u=o/this.gl.canvas.height,c=this.shouldScrollX?1:0,d=this.shouldScrollY?1:0,h=Ee(this.mvp),f=Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*s,this.rendererPos[1]*u,0]);Ae(f,f,[s/2,u/2,1]),Pe(f,f,[s,u,1]);for(let s=0;s<t-e+1;s++){let t,u;r>i?(t=e+s,u=0):(t=0,u=e+s),this.solidShader.setVec4("color",[n.r,n.g,n.b,1]);let p=window.devicePixelRatio;Ae(h,f,[-l/o*c*p,-a/o*d*p,0]),Ae(h,h,[t,u,0]),Pe(h,h,[.61,.61,1]),this.solidShader.setMat4("mvp",h),this.centerQuad.draw()}this.centerQuad.unbind(),this.solidShader.unbind()}handleEvent(e){let{cellSize:t,xCount:n,yCount:r,scrollX:i,scrollY:o}=this.values,l=this.gl.canvas.width,a=this.gl.canvas.height,s=(l-e.offsetX)/l*2,u=(a-e.offsetY)/a*2,c=this.rendererPos[0]*(t/l),d=this.rendererPos[1]*(t/a),h=n*t/l,f=r*t/a;if(s>c&&u>d&&s<c+h&&u<d+f){return[Math.floor((s-c)/h*n+i/t),Math.floor((u-d)/f*r+o/t),e]}}updateValues(e){this.values=e}setRendererPosition(e){this.rendererPos=e}setColorTexture(e){this.colorTexture=e}render(){if(this.prerender(),void 0===this.values)return;let{scrollX:e,scrollY:t,xCount:n,yCount:r,cellSize:i,warpCount:o,weftCount:l,xStepDistance:a,yStepDistance:s}=this.values,u=this.shouldScrollX?1:0,c=this.shouldScrollY?1:0,d=this.gl.canvas.width,h=this.gl.canvas.height;this.shader.bind(),this.quad.bind();let f=i/d,p=i/h,g=Ee(this.mvp);Pe(g,Ae(Ee(this.view),this.initialView,[this.rendererPos[0]*f,this.rendererPos[1]*p,0]),[i*n/d,i*r/h,1]),this.colorTexture.bind(0),this.shader.setSampler2D("colorSampler",0),this.shader.setVec2("scrollPos",[e/(o*i)*devicePixelRatio*u,t/(l*i)*devicePixelRatio*c]),this.shader.setFloat("vert",r>n?1:0),this.shader.setFloat("steps",r>n?s:a),this.shader.setVec2("cellSize",[f/(f*n),p/(p*r)]),this.shader.setMat4("mvp",g),this.quad.draw(),this.quad.unbind(),this.shader.unbind()}}function Ko(e,t,n,r){let i=new Uint8Array(4*r);for(let e=0;e<r;e++){let r=4*e,o=t[e]/n*255,l=255;null!==t[e]&&void 0!==t[e]&&-1!==t[e]||(l=0),i[r+0]=o,i[r+1]=l,i[r+2]=o,i[r+3]=o}return new Xo(e,r,1,i)}function Go(e,t,n,r,i){let o=new Uint8Array(4*r.length);for(let e=0;e<r.length;e++){let t=4*e,n=r[e]/i*255,l=255;null!==r[e]&&void 0!==r[e]&&-1!==r[e]||(l=0),o[t+0]=n,o[t+1]=l,o[t+2]=n,o[t+3]=n}e.bindTexture(e.TEXTURE_2D,t.texture),e.texSubImage2D(e.TEXTURE_2D,0,n,0,r.length,1,e.RGBA,e.UNSIGNED_BYTE,o),e.bindTexture(e.TEXTURE_2D,null)}function Jo(e,t,n,r){let i=[];for(let e=0;e<r.length;e++)i[r[e].id]=r[e];let o=new Uint8Array(4*t.length);for(let e=0;e<t.length;e++){let n=4*e,r=i[t[e]].color;o[n+0]=255*r.r,o[n+1]=255*r.g,o[n+2]=255*r.b,o[n+3]=255}return new Xo(e,n,1,o)}function Zo(e,t,n,r,i){let o=[];for(let e=0;e<i.length;e++)o[i[e].id]=i[e];let l=new Uint8Array(4*r.length);for(let e=0;e<r.length;e++){let t=4*e,n=o[r[e]].color;l[t+0]=255*n.r,l[t+1]=255*n.g,l[t+2]=255*n.b,l[t+3]=255}e.bindTexture(e.TEXTURE_2D,t.texture),e.texSubImage2D(e.TEXTURE_2D,0,n,0,r.length,1,e.RGBA,e.UNSIGNED_BYTE,l),e.bindTexture(e.TEXTURE_2D,null)}class Qo{showTreadleOrder=!0;showThreading=!0;renderNextFrame=!1;prevDraft={};prevUI={};dependencyGraph={treadleOrder:["treadleOrder","weave"],threading:["threading","weave"],warpColors:["warpColors","weave"],weftColors:["weftColors","weave"],tieup:["tieup","weave"],shaftCount:"clear",treadleCount:"clear",warpCount:["threading","warpColors","weave"],weftCount:["treadleOrder","weftColors","weave"],yarn:["warpColors","weftColors","weave"],cellSize:"clear",scrollX:["warpColors","threading","weave"],scrollY:["weftColors","treadleOrder","weave"]};constructor(e,t){this.scrollContainer=t,this.gl=e.getContext("webgl",{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:!0}),this.gl.clearColor(1,1,1,1),this.shaders=new Bo(this.gl),this.gl.disable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.SCISSOR_TEST),this.startup=!0;let n=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE);console.log("Max texture size",n),this.threadingTexture=new Xo(this.gl,1,1,[[0,0,0,0]]),this.treadleOrderTexture=new Xo(this.gl,1,1,[[0,0,0,0]]),this.tieupTexture=new Xo(this.gl,1,1,[[0,0,0,0]]),this.warpTexture=new Xo(this.gl,1,1,[[0,0,0,0]]),this.weftTexture=new Xo(this.gl,1,1,[[0,0,0,0]]),this.resizeCanvas(),this.renderers={tieup:{renderer:new Ho(this.gl,this.shaders,"tieup"),dirty:!0,enabled:!0,updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:e.treadleCount,yCount:e.shaftCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY})},threading:{renderer:new Uo(this.gl,this.shaders,!1,!0,!1,"threading"),updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:e.warpCount,yCount:e.shaftCount,weftCount:e.weftCount,warpCount:e.warpCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY,xStepDistance:t.xStepDistance}),dirty:!0,enabled:!0},treadleOrder:{renderer:new Uo(this.gl,this.shaders,!0,!1,!0,"treadleOrder"),updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:e.treadleCount,yCount:e.weftCount,weftCount:e.weftCount,warpCount:e.warpCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY,yStepDistance:t.yStepDistance}),dirty:!0,enabled:!0},warpColors:{renderer:new qo(this.gl,this.shaders,!0,!1,"warpColors"),updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:e.warpCount,yCount:1,weftCount:e.weftCount,warpCount:e.warpCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY,xStepDistance:t.xStepDistance}),dirty:!0,enabled:!0},weftColors:{renderer:new qo(this.gl,this.shaders,!1,!0,"weftColors"),updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:1,yCount:e.weftCount,weftCount:e.weftCount,warpCount:e.warpCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY,yStepDistance:t.yStepDistance}),dirty:!0,enabled:!0},weave:{renderer:new Wo(this.gl,this.shaders,"weave"),updateValues:function(e,t){this.renderer.updateValues(this.getValues(e,t))},getValues:(e,t)=>({xCount:e.warpCount,yCount:e.weftCount,shaftCount:e.shaftCount,treadleCount:e.treadleCount,cellSize:t.cellSize,scrollX:t.scrollX,scrollY:t.scrollY}),dirty:!0,enabled:!0}},this.names=Object.keys(this.renderers);let r=Object.values(this.renderers);window.setTimeout((()=>{let e=()=>{if(this.renderNextFrame){for(let e=0;e<r.length;e++){let t=r[e];t.dirty&&t.enabled&&(t.renderer.render(),t.dirty=!1)}this.renderNextFrame=!1}requestAnimationFrame(e)};requestAnimationFrame(e)}))}setRendererPosition(e,t,n){let r=e.treadleCount,i=e.shaftCount;this.showTreadleOrder=t,this.showThreading=n;let o=Number(t),l=Number(n);this.renderers.tieup.enabled=t&&n,this.renderers.tieup.renderer.setRendererPosition([3,3]),this.renderers.threading.enabled=n,this.renderers.threading.renderer.setRendererPosition([o*(r+4),3]),this.renderers.treadleOrder.enabled=t,this.renderers.treadleOrder.renderer.setRendererPosition([3,l*(i+4)]),this.renderers.weftColors.renderer.setRendererPosition([1,l*(i+4)]),this.renderers.weftColors.enabled=t,this.renderers.warpColors.enabled=n,this.renderers.warpColors.renderer.setRendererPosition([o*(r+4),1]),this.renderers.weave.renderer.setRendererPosition([o*(r+4),l*(i+4)]),this.clear()}isDifferent(e,t,...n){return n.some((n=>e[n]!==t[n]))}update(e,t,n){if(n.paths.size){this.updateTextures(e,n);for(let r of n.paths){let n;if("clear"===r||"clear"===this.dependencyGraph[r]?(this.clearCanvas(),n=this.names):n=this.dependencyGraph[r],void 0!==n)for(let r=0;r<n.length;r++){let i=this.renderers[n[r]];i.dirty=!0,i.updateValues(e,t)}}n.clear()}this.startup=!1}createThreadingTexture(e){this.threadingTexture.delete(),this.threadingTexture=Ko(this.gl,e.threading,e.shaftCount,e.warpCount),this.renderers.threading.renderer.setCellToggleTexture(this.threadingTexture),this.renderers.weave.renderer.setThreadingTexture(this.threadingTexture)}createTreadleOrderTexture(e){this.treadleOrderTexture.delete(),this.treadleOrderTexture=Ko(this.gl,e.treadleOrder,e.treadleCount,e.weftCount),this.renderers.treadleOrder.renderer.setCellToggleTexture(this.treadleOrderTexture),this.renderers.weave.renderer.setTreadleOrderTexture(this.treadleOrderTexture)}createTieupTexture(e){this.tieupTexture.delete(),this.tieupTexture=function(e,t,n,r){let i=new Uint8Array(n*r*4);for(let e=0;e<r;e++)for(let r=0;r<n;r++)if(1===t[e][r]){let t=4*(e*n+r);i[t+0]=255,i[t+1]=255,i[t+2]=255,i[t+3]=255}return new Xo(e,n,r,i)}(this.gl,e.tieup,e.treadleCount,e.shaftCount),this.renderers.tieup.renderer.setCellToggleTexture(this.tieupTexture),this.renderers.weave.renderer.setTieupTexture(this.tieupTexture)}createWarpTexture(e){this.warpTexture.delete(),this.warpTexture=Jo(this.gl,e.warpColors,e.warpColors.length,e.yarn),this.renderers.warpColors.renderer.setColorTexture(this.warpTexture),this.renderers.weave.renderer.setWarpTexture(this.warpTexture)}createWeftTexture(e){this.weftTexture.delete(),this.weftTexture=Jo(this.gl,e.weftColors,e.weftColors.length,e.yarn),this.renderers.weftColors.renderer.setColorTexture(this.weftTexture),this.renderers.weave.renderer.setWeftTexture(this.weftTexture)}getSpan(e){return e.map((e=>e.path[1])).reduce(((e,t)=>[Math.min(e[0],t),Math.max(e[1],t)]),[Number.MAX_VALUE,Number.MIN_VALUE])}updateValuesInColorTexture(e,t,n,r,i){let o=t.patches[n];if(o.every((e=>"replace"===e.op))){let t=this.getSpan(o),l=e[n].slice(t[0],t[1]+1);Go(this.gl,r,t[0],l,i)}}updateTextures(e,t){if(this.startup)return this.createThreadingTexture(e),this.createTieupTexture(e),this.createTreadleOrderTexture(e),this.createWarpTexture(e),void this.createWeftTexture(e);if(void 0!==t.patches.tieup&&this.createTieupTexture(e),void 0!==t.patches.shaftCount&&(this.createThreadingTexture(e),this.createTieupTexture(e)),void 0!==t.patches.treadleCount&&(this.createTreadleOrderTexture(e),this.createTieupTexture(e)),void 0!==t.patches.warpCount&&(this.createThreadingTexture(e),this.createWarpTexture(e)),void 0!==t.patches.weftCount&&(this.createTreadleOrderTexture(e),this.createWeftTexture(e)),void 0!==t.patches.threading){let n=t.patches.threading;if(n.every((e=>"replace"===e.op))){let t=this.getSpan(n),r=e.threading.slice(t[0],t[1]+1);Go(this.gl,this.threadingTexture,t[0],r,e.shaftCount)}}else this.createThreadingTexture(e);if(void 0!==t.patches.treadleOrder){let n=t.patches.treadleOrder;if(n.every((e=>"replace"===e.op))){let t=this.getSpan(n),r=e.treadleOrder.slice(t[0],t[1]+1);Go(this.gl,this.treadleOrderTexture,t[0],r,e.treadleCount)}}else this.createTreadleOrderTexture(e);if(void 0!==t.patches.warpColors){let n=t.patches.warpColors;if(n.every((e=>"replace"===e.op))){let t=this.getSpan(n),r=e.warpColors.slice(t[0],t[1]+1);Zo(this.gl,this.warpTexture,t[0],r,e.yarn)}else this.createWarpTexture(e)}if(void 0!==t.patches.weftColors){let n=t.patches.weftColors;if(n.every((e=>"replace"===e.op))){let t=this.getSpan(n),r=e.weftColors.slice(t[0],t[1]+1);Zo(this.gl,this.weftTexture,t[0],r,e.yarn)}else this.createWeftTexture(e)}void 0!==t.patches.yarn&&(this.createWarpTexture(e),this.createWeftTexture(e))}getRenderer(e){return this.renderers[e].renderer}getRendererByPos(e){for(let t=0;t<this.names.length;t++){let n=this.names[t];if(this.renderers[n].renderer.isWithinGrid(e)&&this.renderers[n].enabled)return this.renderers[n].renderer}}resizeCanvas(){this.width=this.gl.canvas.width,this.height=this.gl.canvas.height,this.gl.viewport(0,0,this.width,this.height)}addEventListener(e,t){this.scrollContainer.addEventListener(e,t)}render(){this.renderNextFrame=!0}clearCanvas(){let e=this.gl.canvas.width,t=this.gl.canvas.height;this.gl.scissor(0,0,e,t),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}clear(){this.clearCanvas(),Object.values(this.renderers).forEach((e=>e.dirty=!0)),this.render()}}function el(e){let n;return{c(){n=M("canvas"),D(n,"class","weave-display svelte-7nbm36")},m(t,r){S(t,n,r),e[17](n)},p:t,i:t,o:t,d(t){t&&T(n),e[17](null)}}}function tl(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1}function nl(e,t,n){let r,i,o,l,a,s,c,d,h,f;u(e,nr,(e=>n(13,c=e))),u(e,ar,(e=>n(14,d=e))),u(e,mo,(e=>n(15,h=e))),u(e,ei,(e=>n(16,f=e)));let p,g,v,m,w,b,y,$,x,{scrollContainer:C}=t,_=[],S=!1,T=[],k=[];function M(e,t,n){nr.update((r=>{r[e][t]=r[e][t]===n?-1:n}))}function E(e,t,n,r){n<t&&([t,n]=[n,t]),nr.update((i=>{for(let o=0;o<n-t+1;o++)i[e][t+o]=r}))}function A(){void 0!==v&&(p.getRenderer(v).render(),n(6,v=void 0),S=!0,ar.update((e=>{e.isDragging=!1})))}function P(e){let t=[e.offsetX,e.offsetY],n=p.getRendererByPos(t);if(n){let e=n.getCellAtPos(t);e[0]===d.hoverCell[0]&&e[1]===d.hoverCell[1]||ar.update((t=>{t.hoverCell=e}))}}function R(){n(0,g.width=g.offsetWidth*window.devicePixelRatio,g),n(0,g.height=g.offsetHeight*window.devicePixelRatio,g),p.resizeCanvas(),p.clear()}W((()=>{if(n(5,p=new Qo(g,C)),g.addEventListener("webglcontextlost",(function(e){e.preventDefault(),ar.update((e=>{e.showReloadDialog=!0}))}),!1),R(),0!==D.length){for(let e of D)p.addEventListener(e.name,e.func);D=[]}p.addEventListener("pointerdown",(e=>{-1===o&&(2===e.button?(e.preventDefault(),S=!0,function(e){let t=[e.offsetX,e.offsetY],n=p.getRendererByPos(t);if(n)switch(n.name){case"warpColors":{let e=n.getCellAtPos(t),r=c[n.name][e[0]];ar.update((e=>{e.selectedColor=r}));break}case"weftColors":{let e=n.getCellAtPos(t),r=c[n.name][e[1]];ar.update((e=>{e.selectedColor=r}));break}}}(e)):(b=[e.offsetX,e.offsetY],$=[...r],x=!0,w=p.getRendererByPos(b)?.name))})),p.addEventListener("pointermove",(e=>{if(P(e),function(e){let t=void 0===v&&!0&e.buttons&&(0!==e.movementX||0!==e.movementY)&&x&&!l;return!0===t&&(x=!1),t}(e)){let e=p.getRendererByPos(b)?.name;void 0!==e&&"weave"!==e&&(n(6,v=e),ar.update((e=>{e.isDragging=!0})))}if(void 0!==v&&"weave"!==v){y=[e.offsetX,e.offsetY];let t=[b[0]+(r[0]-$[0])/2,b[1]+(r[1]-$[1])/2];if(n(7,m=p.getRenderer(v).getCellsBetweenPoints(t,y)),v.includes("Color")){if(tl(m,_)){let e=c.yarn.find((e=>e.id===i)).color;p.getRenderer(v).renderPoints(...m,e)}ar.update((e=>{e.selectFrom=m[0],e.selectTo=m[1]})),_=m}else if("tieup"===v)tl(m,_)&&p.getRenderer(v).renderPoints(m),_=m;else{let e=function(e){let t=[];return e.forEach((e=>{"treadleOrder"===v?t[e[1]]=e[0]:"threading"===v&&(t[e[0]]=e[1])})),t}(m);tl(e,T)&&p.getRenderer(v).renderPoints(e),T=e}}})),p.addEventListener("pointerup",(e=>{if(void 0!==v)switch(v){case"warpColors":case"weftColors":E(v,m[0],m[1],d.selectedColor),p.clear();break;case"treadleOrder":case"threading":!function(e,t){if(1===m.length){let t=m[0];if("threading"===e){if(c.threading[t[0]]===t[1])return void nr.update((e=>{e.threading[t[0]]=-1}))}else if("treadleOrder"===e&&c.treadleOrder[t[1]]===t[0])return void nr.update((e=>{e.treadleOrder[t[1]]=-1}))}nr.update((n=>{"threading"===e?t.forEach((t=>{n[e][t[0]]=t[1]})):"treadleOrder"===e&&t.forEach((t=>{n[e][t[1]]=t[0]}))}))}(v,m);break;case"tieup":!function(e){if(1===e.length){let t=e[0];if(1===c.tieup[t[1]][t[0]])return void nr.update((e=>{e.tieup[t[1]][t[0]]=0}))}nr.update((t=>{e.forEach((e=>{t.tieup[e[1]][e[0]]=1}))}))}(m)}else if(!l&&!1===S){let t=[e.offsetX,e.offsetY],n=p.getRendererByPos(t)?.name;if(void 0===n||n!==w)w=void 0;else{let e=p.getRenderer(n).getCellAtPos(t);switch(n){case"warpColors":E(n,e[0],e[0],i);break;case"weftColors":E(n,e[1],e[1],i);break;case"threading":M(n,e[0],e[1]);break;case"treadleOrder":M(n,e[1],e[0]);break;case"tieup":!function(e,t){nr.update((n=>{n.tieup[e][t]=1===n.tieup[e][t]?0:1}))}(e[1],e[0])}}}A(),S=!1,w=void 0})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&void 0!==v&&(event.stopPropagation(),A())})),document.addEventListener("visibilitychange",(()=>{document.hidden||p.clear()}))}));let D=[];return e.$$set=e=>{"scrollContainer"in e&&n(1,C=e.scrollContainer)},e.$$.update=()=>{if(16384&e.$$.dirty[0]&&n(10,r=[d.scrollX,d.scrollY]),16384&e.$$.dirty[0]&&n(9,i=d.selectedColor),e.$$.dirty[0],16384&e.$$.dirty[0]&&(o=d.selectedMenu),65536&e.$$.dirty[0]&&(l=f.isSelecting),32768&e.$$.dirty[0]&&n(12,a=h.showTreadleOrder),32768&e.$$.dirty[0]&&n(11,s=h.showThreading),14368&e.$$.dirty[0]&&p&&p.setRendererPosition(c,a,s),24608&e.$$.dirty[0]&&p){p.update(c,d,Gn);try{p.render()}catch(e){console.error(e)}}if(10208&e.$$.dirty[0]){if(void 0!==p&&void 0!==v&&(r[0]!==k[0]||r[1]!==k[1]))if(v.includes("Color")){let e=c.yarn[i].color;p.getRenderer(v).renderPoints(...m,e)}else p.getRenderer(v).renderPoints(m);n(8,k=r)}},[g,C,P,R,function(e,t){void 0!==p?p.addEventListener(e,t):D.push({name:e,func:t})},p,v,m,k,i,r,s,a,c,d,h,f,function(e){Z[e?"unshift":"push"]((()=>{g=e,n(0,g)}))}]}class rl extends Se{constructor(e){super(),_e(this,e,nl,el,a,{scrollContainer:1,setHover:2,syncCanvasDimensions:3,addEventListener:4},null,[-1,-1])}get setHover(){return this.$$.ctx[2]}get syncCanvasDimensions(){return this.$$.ctx[3]}get addEventListener(){return this.$$.ctx[4]}}function il(e,t,n){const r=e.slice();return r[42]=t[n],r}function ol(e){let t,n,r,i=e[2],o=[];for(let t=0;t<i.length;t+=1)o[t]=sl(il(e,i,t));return{c(){t=M("div");for(let e=0;e<o.length;e+=1)o[e].c();D(t,"class","selections")},m(i,l){S(i,t,l);for(let e=0;e<o.length;e+=1)o[e].m(t,null);n||(r=R(t,"pointermove",e[5]),n=!0)},p(e,n){if(463&n[0]){let r;for(i=e[2],r=0;r<i.length;r+=1){const l=il(e,i,r);o[r]?o[r].p(l,n):(o[r]=sl(l),o[r].c(),o[r].m(t,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=i.length}},d(e){e&&T(t),k(o,e),n=!1,r()}}}function ll(e){let t,n;return{c(){t=M("div"),D(t,"style",n=dl(e[42].dragMarker)),D(t,"class","current-selection-marker svelte-vd1v9m")},m(e,n){S(e,t,n)},p(e,r){4&r[0]&&n!==(n=dl(e[42].dragMarker))&&D(t,"style",n)},d(e){e&&T(t)}}}function al(e){let t,n,r,i;function o(){return e[25](e[42])}return{c(){t=M("div"),D(t,"class",g("selection-overlay")+" svelte-vd1v9m"),D(t,"style",n=dl(e[42].selectionArea)),N(t,"applied",e[0][e[42].name]||e[8](e[42].name))},m(e,n){S(e,t,n),r||(i=R(t,"click",o),r=!0)},p(r,i){e=r,4&i[0]&&n!==(n=dl(e[42].selectionArea))&&D(t,"style",n),261&i[0]&&N(t,"applied",e[0][e[42].name]||e[8](e[42].name))},d(e){e&&T(t),r=!1,i()}}}function sl(e){let t,n,r,i,o,l,a,s,u=e[1]&&ll(e),c=e[3]&&al(e);function d(...t){return e[26](e[42],...t)}return{c(){t=M("div"),u&&u.c(),n=A(),c&&c.c(),r=A(),D(t,"data-name",i=e[42].name),D(t,"class",o=g("selection "+e[42].name)+" svelte-vd1v9m"),D(t,"style",l=dl(e[42].canvasArea))},m(e,i){S(e,t,i),u&&u.m(t,null),x(t,n),c&&c.m(t,null),x(t,r),a||(s=R(t,"pointerdown",d),a=!0)},p(a,s){(e=a)[1]?u?u.p(e,s):(u=ll(e),u.c(),u.m(t,n)):u&&(u.d(1),u=null),e[3]?c?c.p(e,s):(c=al(e),c.c(),c.m(t,r)):c&&(c.d(1),c=null),4&s[0]&&i!==(i=e[42].name)&&D(t,"data-name",i),4&s[0]&&o!==(o=g("selection "+e[42].name)+" svelte-vd1v9m")&&D(t,"class",o),4&s[0]&&l!==(l=dl(e[42].canvasArea))&&D(t,"style",l)},d(e){e&&T(t),u&&u.d(),c&&c.d(),a=!1,s()}}}function ul(e){let n,r=e[4]&&ol(e);return{c(){r&&r.c(),n=P()},m(e,t){r&&r.m(e,t),S(e,n,t)},p(e,t){e[4]?r?r.p(e,t):(r=ol(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(e){r&&r.d(e),e&&T(n)}}}function cl(e,t,n){if(e[n]>t[n]){let r=t[n];t[n]=e[n],e[n]=r}}function dl(e){return Object.entries(e).reduce(((e,t)=>e+"; "+t.join(": ")),"")}function hl(e,t,n){let r,i,o,l,a,s,c,d,h,f,p,g,v,m,w,b,y,$,x;u(e,ei,(e=>n(0,y=e))),u(e,ar,(e=>n(23,$=e))),u(e,nr,(e=>n(24,x=e)));let C,{weaveDisplay:_}=t;function S(e,t){let n=[0,0];e[0]>t[0]&&cl(e=je(Ne(),e),t=je(Ne(),t),0),e[1]>t[1]&&cl(e=je(Ne(),e),t=je(Ne(),t),1),Je(n,e)>Je(n,t)&&([e,t]=[t,e]);let i=Ne();Ke(i,e,n),Be(i,i,1/r),i=i.map((e=>Math.max(0,e))).map(Math.floor);let o=Ne();return Ke(o,t,n),Be(o,o,1/r),o=o.map(Math.ceil),{from:i,to:o}}let T,k=[0,0];function M(e,t){let n=e.target.getBoundingClientRect();if(e.shiftKey){let t=[n.width-e.offsetX+v,n.height-e.offsetY+m],r=document.elementFromPoint(e.pageX,e.pageY);P(S(k,t),r.getAttribute("data-name"))}else T=t,k=[n.width-e.offsetX+v,n.height-e.offsetY+m],document.body.addEventListener("pointermove",E),document.body.addEventListener("pointerup",A)}function E(e){let t=e.target.getBoundingClientRect(),r=[t.width-e.offsetX+v,t.height-e.offsetY+m];n(1,C=!0),n(12,w=S(k,r))}function A(e){let t=e.target.getBoundingClientRect(),r=[t.width-e.offsetX+v,t.height-e.offsetY+m],i=document.elementFromPoint(e.pageX,e.pageY).getAttribute("data-name");P(S(k,r),i),n(1,C=!1),document.body.removeEventListener("pointermove",E),document.body.removeEventListener("pointerup",A)}function P(e,t){ei.update((n=>{n.to=e.to,n.from=e.from,"weave"===t?(n.useThreading=!0,n.useWarpColors=!0,n.useTreadleOrder=!0,n.useWeftColors=!0):(n.useThreading=!1,n.useWarpColors=!1,n.useTreadleOrder=!1,n.useWeftColors=!1,n[T]=!0),"weave"!==t&&t!==T&&(n[t]=!0)}))}function R(e){"weave"!==e&&ei.update((t=>{t[e]=!t[e]}))}return e.$$set=e=>{"weaveDisplay"in e&&n(9,_=e.weaveDisplay)},e.$$.update=()=>{8388608&e.$$.dirty[0]&&n(13,r=$.cellSize/2),16777216&e.$$.dirty[0]&&n(21,i=x.shaftCount),16777216&e.$$.dirty[0]&&n(19,o=x.treadleCount),524288&e.$$.dirty[0]&&n(22,l=[o+4,3]),2097152&e.$$.dirty[0]&&n(20,a=[3,i+4]),524288&e.$$.dirty[0]&&n(18,s=[o+4,1]),2097152&e.$$.dirty[0]&&n(17,c=[1,i+4]),2621440&e.$$.dirty[0]&&n(16,d=[o+4,i+4]),1&e.$$.dirty[0]&&n(4,h=y.isSelecting),e.$$.dirty[0],1&e.$$.dirty[0]&&n(15,f=y.to),1&e.$$.dirty[0]&&n(14,p=y.from),1&e.$$.dirty[0]&&n(3,g=y.to[0]-y.from[0]>0&&y.to[1]-y.from[1]>0),e.$$.dirty[0],e.$$.dirty[0],e.$$.dirty[0],e.$$.dirty[0],8388608&e.$$.dirty[0]&&n(11,v=$.scrollX/2),8388608&e.$$.dirty[0]&&n(10,m=$.scrollY/2),e.$$.dirty[0],e.$$.dirty[0],8387584&e.$$.dirty[0]&&n(2,b=[{name:"useThreading",canvasArea:{left:0,right:l[0]*r+"px",bottom:l[1]*r+"px",height:i*r+"px"},selectionArea:{width:r*(f[0]-p[0])+"px",height:r*i+"px",right:p[0]*r-v+"px",bottom:0},dragMarker:{width:r*(w.to[0]-w.from[0])+"px",height:r*i+"px",right:w.from[0]*r-v+"px",bottom:0}},{name:"useTreadleOrder",dir:"vert",canvasArea:{top:0,right:a[0]*r+"px",bottom:a[1]*r+"px",width:o*r+"px"},selectionArea:{width:r*o+"px",height:(f[1]-p[1])*r+"px",bottom:p[1]*r-m+"px"},dragMarker:{width:r*o+"px",height:(w.to[1]-w.from[1])*r+"px",bottom:w.from[1]*r-m+"px"}},{name:"useWarpColors",canvasArea:{height:`${r}px`,right:s[0]*r+"px",bottom:s[1]*r+"px",left:0},selectionArea:{width:(f[0]-p[0])*r+"px",height:`${r}px`,right:p[0]*r-v+"px"},dragMarker:{width:r*(w.to[0]-w.from[0])+"px",right:r*w.from[0]-v+"px",height:`${r}px`}},{name:"useWeftColors",canvasArea:{width:`${r}px`,right:c[0]*r+"px",top:0,bottom:c[1]*r+"px"},selectionArea:{width:`${r}px`,height:(f[1]-p[1])*r+"px",right:0,bottom:p[1]*r-m+"px"},dragMarker:{width:`${r}px`,height:(w.to[1]-w.from[1])*r+"px",right:0,bottom:w.from[1]*r-m+"px"}},{name:"weave",canvasArea:{left:0,right:d[0]*r+"px",top:0,bottom:d[1]*r+"px"},selectionArea:{width:r*(f[0]-p[0])+"px",height:r*(f[1]-p[1])+"px",right:p[0]*r-v+"px",bottom:p[1]*r-m+"px"},dragMarker:{width:(w.to[0]-w.from[0])*r+"px",height:(w.to[1]-w.from[1])*r+"px",right:w.from[0]*r-v+"px",bottom:w.from[1]*r-m+"px"}}])},n(12,w={to:0,from:0}),[y,C,b,g,h,function(e){_.setHover(e)},M,R,function(e){return"weave"===e&&y.useThreading&&y.useTreadleOrder&&y.useWarpColors&&y.useWeftColors},_,m,v,w,r,p,f,d,c,s,o,a,i,l,$,x,e=>R(e.name),(e,t)=>M(t,e.name)]}class fl extends Se{constructor(e){super(),_e(this,e,hl,ul,a,{weaveDisplay:9},null,[-1,-1])}}function pl(e,t,n){const r=e.slice();return r[20]=t[n],r}function gl(e){let t,n,r,i=e[20][0]+"";return{c(){t=M("span"),n=E(i),D(t,"style",r=`${e[3]?"bottom":"right"}: ${e[20][1]}`),D(t,"class","svelte-1xnl843")},m(e,r){S(e,t,r),x(t,n)},p(e,o){1&o&&i!==(i=e[20][0]+"")&&O(n,i),9&o&&r!==(r=`${e[3]?"bottom":"right"}: ${e[20][1]}`)&&D(t,"style",r)},d(e){e&&T(t)}}}function vl(e){let n,r,i,o,l=e[0],a=[];for(let t=0;t<l.length;t+=1)a[t]=gl(pl(e,l,t));return{c(){n=M("div"),r=M("div");for(let e=0;e<a.length;e+=1)a[e].c();D(r,"class","steps svelte-1xnl843"),D(r,"style",i=`\n    height: ${e[2]}px;\n    font-size: ${e[1]/5}pt;\n    transform: ${e[7]};\n    `),D(n,"class","steps-container svelte-1xnl843"),D(n,"style",o=`\n  right: ${e[8][0]}px;\n  bottom: ${e[8][1]}px;\n  height: ${e[4]}px;\n  width: ${e[5]}px\n  `),N(n,"vertical",e[3])},m(t,i){S(t,n,i),x(n,r);for(let e=0;e<a.length;e+=1)a[e].m(r,null);e[19](n)},p(e,[t]){if(9&t){let n;for(l=e[0],n=0;n<l.length;n+=1){const i=pl(e,l,n);a[n]?a[n].p(i,t):(a[n]=gl(i),a[n].c(),a[n].m(r,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=l.length}134&t&&i!==(i=`\n    height: ${e[2]}px;\n    font-size: ${e[1]/5}pt;\n    transform: ${e[7]};\n    `)&&D(r,"style",i),304&t&&o!==(o=`\n  right: ${e[8][0]}px;\n  bottom: ${e[8][1]}px;\n  height: ${e[4]}px;\n  width: ${e[5]}px\n  `)&&D(n,"style",o),8&t&&N(n,"vertical",e[3])},i:t,o:t,d(t){t&&T(n),k(a,t),e[19](null)}}}function ml(e,t,n){let r,i,o,l,a,s,c,d,h,f;u(e,nr,(e=>n(17,h=e))),u(e,ar,(e=>n(18,f=e)));let p,g,v,{width:m=0}=t,{height:w=0}=t,{position:b}=t,{stepCount:y}=t,{distance:$}=t,x=[];return e.$$set=e=>{"width"in e&&n(9,m=e.width),"height"in e&&n(10,w=e.height),"position"in e&&n(11,b=e.position),"stepCount"in e&&n(12,y=e.stepCount),"distance"in e&&n(13,$=e.distance)},e.$$.update=()=>{if(1536&e.$$.dirty&&n(3,r=w>m),262144&e.$$.dirty&&n(1,i=f.cellSize/window.devicePixelRatio),2&e.$$.dirty&&n(2,o=i/2),2052&e.$$.dirty&&n(8,l=[b[0]*o,b[1]*o]),262152&e.$$.dirty&&n(16,a=r?f.scrollY:f.scrollX),65544&e.$$.dirty&&n(7,s=`translate${r?"Y":"X"}(${a/2}px)`),131072&e.$$.dirty&&n(15,c=h.shaftCount),131072&e.$$.dirty&&n(14,d=h.treadleCount),50700&e.$$.dirty&&(r?(n(4,p=w-o*(c+6)-4),n(5,g=o)):(n(4,p=o),n(5,g=m-o*(d+4)+4))),12291&e.$$.dirty){n(0,x=[]);for(let e=0;e<y/$;e++){let t=e*$,n=t*i/2+"px";t>10?n+=` - ${Math.floor(Math.log10(t))}em / 2`:t>0&&(n+=" - 0.5ex"),n=`calc(${n})`,x.push([t,n])}}},[x,i,o,r,p,g,v,s,l,m,w,b,y,$,d,c,a,h,f,function(e){Z[e?"unshift":"push"]((()=>{v=e,n(6,v)}))}]}class wl extends Se{constructor(e){super(),_e(this,e,ml,vl,a,{width:9,height:10,position:11,stepCount:12,distance:13})}}function bl(e){let t,n,r=`${e[2][0]}, ${e[2][1]}`;return{c(){t=M("span"),n=E(r),D(t,"class","svelte-1pjpio4")},m(e,r){S(e,t,r),x(t,n)},p(e,t){4&t&&r!==(r=`${e[2][0]}, ${e[2][1]}`)&&O(n,r)},d(e){e&&T(t)}}}function yl(e){let t,n,r=`${e[0]} → ${e[1]} (${e[4]})`;return{c(){t=M("span"),n=E(r),D(t,"class","svelte-1pjpio4")},m(e,r){S(e,t,r),x(t,n)},p(e,t){19&t&&r!==(r=`${e[0]} → ${e[1]} (${e[4]})`)&&O(n,r)},d(e){e&&T(t)}}}function $l(e){let n;function r(e,t){return e[3]?yl:bl}let i=r(e),o=i(e);return{c(){n=M("div"),o.c(),D(n,"class","info-bar svelte-1pjpio4")},m(e,t){S(e,n,t),o.m(n,null)},p(e,[t]){i===(i=r(e))&&o?o.p(e,t):(o.d(1),o=i(e),o&&(o.c(),o.m(n,null)))},i:t,o:t,d(e){e&&T(n),o.d()}}}function xl(e,t,n){let r,i,o,l,a,s;return u(e,ar,(e=>n(5,s=e))),e.$$.update=()=>{32&e.$$.dirty&&n(0,r=s.selectFrom),32&e.$$.dirty&&n(1,i=s.selectTo),3&e.$$.dirty&&n(4,o=i-r+1),32&e.$$.dirty&&n(3,l=s.isDragging),32&e.$$.dirty&&n(2,a=s.hoverCell)},[r,i,a,l,o,s]}class Cl extends Se{constructor(e){super(),_e(this,e,xl,$l,a,{})}}function _l(e){let t,n,r,i,o,l,a,s,u,c,d,h=e[2](`page.${to[e[0]].name}.title`)+"";var f=to[e[0]].component;return f&&(s=new f({})),{c(){t=M("div"),n=M("div"),r=M("button"),i=A(),o=M("h2"),l=E(h),a=A(),s&&ye(s.$$.fragment),D(r,"class","svelte-1x2iqxb"),D(o,"class","svelte-1x2iqxb"),D(n,"class","header svelte-1x2iqxb"),D(t,"class","dialog svelte-1x2iqxb")},m(h,f){S(h,t,f),x(t,n),x(n,r),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 100 100"><path d="M49.97.07a49.96 49.96 0 100 99.93 49.96 49.96 0 000-99.93zm-4.23 50.75L60.42 65.5a5.55 5.55 0 11-7.85 7.85L34.75 55.53a7.78 7.78 0 010-11l17.82-17.81a5.55 5.55 0 017.85 7.85L45.74 49.25a1.1 1.1 0 000 1.57z"/></svg>\n',x(n,i),x(n,o),x(o,l),x(t,a),s&&$e(s,t,null),e[6](t),u=!0,c||(d=R(r,"click",e[5]),c=!0)},p(e,n){if((!u||5&n)&&h!==(h=e[2](`page.${to[e[0]].name}.title`)+"")&&O(l,h),f!==(f=to[e[0]].component)){if(s){fe();const e=s;ve(e.$$.fragment,1,0,(()=>{xe(e,1)})),pe()}f?(s=new f({}),ye(s.$$.fragment),ge(s.$$.fragment,1),$e(s,t,null)):s=null}},i(e){u||(s&&ge(s.$$.fragment,e),u=!0)},o(e){s&&ve(s.$$.fragment,e),u=!1},d(n){n&&T(t),s&&xe(s),e[6](null),c=!1,d()}}}function Sl(e){let t,n,r=-1!==e[0]&&_l(e);return{c(){r&&r.c(),t=P()},m(e,i){r&&r.m(e,i),S(e,t,i),n=!0},p(e,[n]){-1!==e[0]?r?(r.p(e,n),1&n&&ge(r,1)):(r=_l(e),r.c(),ge(r,1),r.m(t.parentNode,t)):r&&(fe(),ve(r,1,1,(()=>{r=null})),pe())},i(e){n||(ge(r),n=!0)},o(e){ve(r),n=!1},d(e){r&&r.d(e),e&&T(t)}}}function Tl(e,t,n){let r,i,o,l;function a(e){null!==l?-1===r||3===r||l.contains(e.target)||e.target.classList.contains("color-input-canvas")||(e.preventDefault(),ar.update((e=>{e.selectedMenu=-1})),document.body.removeEventListener("pointerdown",a)):document.body.removeEventListener("pointerdown",a)}function s(){ar.update((e=>{e.selectedMenu=-1}))}u(e,ar,(e=>n(4,i=e))),u(e,It,(e=>n(2,o=e))),W((()=>{document.body.addEventListener("pointerdown",a)}));return e.$$.update=()=>{16&e.$$.dirty&&n(0,r=i.selectedMenu),1&e.$$.dirty&&console.log("selected menu",r)},[r,l,o,s,i,()=>s(),function(e){Z[e?"unshift":"push"]((()=>{l=e,n(1,l)}))}]}class kl extends Se{constructor(e){super(),_e(this,e,Tl,Sl,a,{})}}function Ml(e){let t,n;return t=new kl({}),{c(){ye(t.$$.fragment)},m(e,r){$e(t,e,r),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){xe(t,e)}}}function El(e){let t,n,r,i,o,l,a,s;function u(t){e[25](t)}let c={};void 0!==e[3]&&(c.scrollContainer=e[3]),t=new rl({props:c}),e[24](t),Z.push((()=>be(t,"scrollContainer",u))),i=new fl({props:{weaveDisplay:e[11]}});let d=e[0].showThreading&&Al(e),h=e[0].showTreadleOrder&&Pl(e);return{c(){ye(t.$$.fragment),r=A(),ye(i.$$.fragment),o=A(),d&&d.c(),l=A(),h&&h.c(),a=P()},m(e,n){$e(t,e,n),S(e,r,n),$e(i,e,n),S(e,o,n),d&&d.m(e,n),S(e,l,n),h&&h.m(e,n),S(e,a,n),s=!0},p(e,r){const o={};!n&&8&r[0]&&(n=!0,o.scrollContainer=e[3],ie((()=>n=!1))),t.$set(o);const s={};2048&r[0]&&(s.weaveDisplay=e[11]),i.$set(s),e[0].showThreading?d?(d.p(e,r),1&r[0]&&ge(d,1)):(d=Al(e),d.c(),ge(d,1),d.m(l.parentNode,l)):d&&(fe(),ve(d,1,1,(()=>{d=null})),pe()),e[0].showTreadleOrder?h?(h.p(e,r),1&r[0]&&ge(h,1)):(h=Pl(e),h.c(),ge(h,1),h.m(a.parentNode,a)):h&&(fe(),ve(h,1,1,(()=>{h=null})),pe())},i(e){s||(ge(t.$$.fragment,e),ge(i.$$.fragment,e),ge(d),ge(h),s=!0)},o(e){ve(t.$$.fragment,e),ve(i.$$.fragment,e),ve(d),ve(h),s=!1},d(n){e[24](null),xe(t,n),n&&T(r),xe(i,n),n&&T(o),d&&d.d(n),n&&T(l),h&&h.d(n),n&&T(a)}}}function Al(e){let t,n;return t=new wl({props:{width:e[5]*window.devicePixelRatio,stepCount:e[1].warpCount,distance:e[0].xStepDistance,position:[e[1].treadleCount+4,2]}}),{c(){ye(t.$$.fragment)},m(e,r){$e(t,e,r),n=!0},p(e,n){const r={};32&n[0]&&(r.width=e[5]*window.devicePixelRatio),2&n[0]&&(r.stepCount=e[1].warpCount),1&n[0]&&(r.distance=e[0].xStepDistance),2&n[0]&&(r.position=[e[1].treadleCount+4,2]),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){xe(t,e)}}}function Pl(e){let t,n;return t=new wl({props:{height:e[6]*window.devicePixelRatio,stepCount:e[1].weftCount,distance:e[0].yStepDistance,position:[2,e[1].shaftCount+4]}}),{c(){ye(t.$$.fragment)},m(e,r){$e(t,e,r),n=!0},p(e,n){const r={};64&n[0]&&(r.height=e[6]*window.devicePixelRatio),2&n[0]&&(r.stepCount=e[1].weftCount),1&n[0]&&(r.distance=e[0].yStepDistance),2&n[0]&&(r.position=[2,e[1].shaftCount+4]),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){xe(t,e)}}}function Rl(e){let t,n,r,i,o,l,a,s,u,c,d,h,f,p,g,v,m,w,b,y,$,C;function _(t){e[21](t)}function k(t){e[22](t)}let E={};function P(t){e[23](t)}void 0!==e[8]&&(E.height=e[8]),void 0!==e[12]&&(E.sidebarOpen=e[12]),t=new jo({props:E}),Z.push((()=>be(t,"height",_))),Z.push((()=>be(t,"sidebarOpen",k)));let z={};void 0!==e[12]&&(z.open=e[12]),o=new fo({props:z}),Z.push((()=>be(o,"open",P)));let O=-1!==e[13]&&Ml(),V=void 0!==e[3]&&El(e);return w=new Cl({}),{c(){ye(t.$$.fragment),i=A(),ye(o.$$.fragment),a=A(),s=M("div"),O&&O.c(),u=A(),c=M("div"),h=A(),f=M("div"),p=M("div"),V&&V.c(),v=A(),m=M("div"),ye(w.$$.fragment),D(c,"class","scrollpane svelte-nzvidi"),D(c,"style",d=`left: ${1*e[15]}px; top: ${1*e[14]}px;`),D(p,"class","weave-container svelte-nzvidi"),D(f,"class","fixed svelte-nzvidi"),D(f,"style",g=`\n    top: ${e[8]}px;\n    right: ${e[9]}px;\n    bottom: ${e[9]+e[7]}px\n    `),D(m,"class","infobarContainer-container svelte-nzvidi"),D(m,"style",b=`bottom: ${e[10]}px; right: ${e[9]}px`),D(s,"class","container svelte-nzvidi"),D(s,"tabindex","0")},m(n,r){$e(t,n,r),S(n,i,r),$e(o,n,r),S(n,a,r),S(n,s,r),O&&O.m(s,null),x(s,u),x(s,c),x(s,h),x(s,f),x(f,p),V&&V.m(p,null),e[26](f),x(s,v),x(s,m),$e(w,m,null),e[27](m),e[28](s),y=!0,$||(C=R(s,"scroll",e[16]),$=!0)},p(e,i){const a={};!n&&256&i[0]&&(n=!0,a.height=e[8],ie((()=>n=!1))),!r&&4096&i[0]&&(r=!0,a.sidebarOpen=e[12],ie((()=>r=!1))),t.$set(a);const h={};!l&&4096&i[0]&&(l=!0,h.open=e[12],ie((()=>l=!1))),o.$set(h),-1!==e[13]?O?8192&i[0]&&ge(O,1):(O=Ml(),O.c(),ge(O,1),O.m(s,u)):O&&(fe(),ve(O,1,1,(()=>{O=null})),pe()),(!y||49152&i[0]&&d!==(d=`left: ${1*e[15]}px; top: ${1*e[14]}px;`))&&D(c,"style",d),void 0!==e[3]?V?(V.p(e,i),8&i[0]&&ge(V,1)):(V=El(e),V.c(),ge(V,1),V.m(p,null)):V&&(fe(),ve(V,1,1,(()=>{V=null})),pe()),(!y||896&i[0]&&g!==(g=`\n    top: ${e[8]}px;\n    right: ${e[9]}px;\n    bottom: ${e[9]+e[7]}px\n    `))&&D(f,"style",g),(!y||1536&i[0]&&b!==(b=`bottom: ${e[10]}px; right: ${e[9]}px`))&&D(m,"style",b)},i(e){y||(ge(t.$$.fragment,e),ge(o.$$.fragment,e),ge(O),ge(V),ge(w.$$.fragment,e),y=!0)},o(e){ve(t.$$.fragment,e),ve(o.$$.fragment,e),ve(O),ve(V),ve(w.$$.fragment,e),y=!1},d(n){xe(t,n),n&&T(i),xe(o,n),n&&T(a),n&&T(s),O&&O.d(),V&&V.d(),e[26](null),xe(w),e[27](null),e[28](null),$=!1,C()}}}function Dl(e,t,n){let r,i,o,l,a,s,c,d,h,f,p,g,v,m;u(e,ar,(e=>n(0,c=e))),u(e,mo,(e=>n(20,d=e))),u(e,nr,(e=>n(1,h=e)));let w,b,y,$=c.cellSize,x=[],C=0,_=0,S=15,T=15,k=!0;function M(){let e=window.devicePixelRatio;return[(p.scrollWidth-p.clientWidth)*e,(p.scrollHeight-p.clientHeight)*e]}function E(){let[e,t]=M(),n=window.devicePixelRatio;return[e-p.scrollLeft*n,t-p.scrollTop*n]}function A(){let e=$,t=c.cellSize;if(e!==t){w=!0;let[t,n]=E(),[r,i]=M();x=[t/r,n/i],ar.update((t=>{t.cellSize=e}))}}return q((()=>{if(w){w=!1;let[e,t]=M(),n=(1-x[0])*e,r=(1-x[1])*t;p.scrollTo(n,r)}})),W((()=>{n(9,S=p.offsetWidth-p.clientWidth),n(10,T=p.offsetHeight-p.clientHeight),n(7,C=f.clientHeight);let e,t=p.scrollWidth-p.clientWidth,r=p.scrollHeight-p.clientHeight;p.scrollTo(t,r),y=new ResizeObserver((()=>{null!=b&&b.syncCanvasDimensions()})),y.observe(g),p.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),p.addEventListener("wheel",(e=>{e.ctrlKey&&(e.preventDefault(),$+=-.03*e.deltaY,$=Math.max(5,Math.min(70,$)),A())})),p.addEventListener("touchstart",(t=>{let n=t.targetTouches;if(2===n.length){let t=n[0],r=n[1],i=Fe(t.clientX,t.clientY),o=Fe(r.clientX,r.clientY);e=Ye(Ke(Ne(),i,o))}})),p.addEventListener("touchmove",(t=>{let n=t.targetTouches;if(2===n.length){let t=n[0],r=n[1],i=Fe(t.clientX,t.clientY),o=Fe(r.clientX,r.clientY),l=Ye(Ke(Ne(),i,o));$*=l/e,A(),e=l}})),p.addEventListener("touchend",(t=>{0===t.touches.length&&void 0!==e&&(ar.update((e=>{e.cellSize=e.cellSize})),e=void 0)}));let i=g.getBoundingClientRect();n(5,v=i.width),n(6,m=i.height)})),e.$$.update=()=>{2&e.$$.dirty[0]&&n(19,r=h.warpCount),2&e.$$.dirty[0]&&n(18,i=h.weftCount),1&e.$$.dirty[0]&&n(17,o=c.cellSize/window.devicePixelRatio),655360&e.$$.dirty[0]&&n(15,l=r*o),393216&e.$$.dirty[0]&&n(14,a=i*o),e.$$.dirty[0],e.$$.dirty[0],1048576&e.$$.dirty[0]&&n(13,s=d.selectedMenu),e.$$.dirty[0]},[c,h,f,p,g,v,m,C,_,S,T,b,k,s,a,l,function(){let e=E();ar.update((t=>{t.scrollX=e[0],t.scrollY=e[1]}))},o,i,r,d,function(e){_=e,n(8,_)},function(e){k=e,n(12,k)},function(e){k=e,n(12,k)},function(e){Z[e?"unshift":"push"]((()=>{b=e,n(11,b)}))},function(e){p=e,n(3,p)},function(e){Z[e?"unshift":"push"]((()=>{g=e,n(4,g)}))},function(e){Z[e?"unshift":"push"]((()=>{f=e,n(2,f)}))},function(e){Z[e?"unshift":"push"]((()=>{p=e,n(3,p)}))}]}class zl extends Se{constructor(e){super(),_e(this,e,Dl,Rl,a,{},null,[-1,-1])}}function Ol(e){let n,r,i,o,l,a,s;return{c(){n=M("div"),r=M("div"),i=M("span"),i.textContent="Click to reload",o=A(),l=M("button"),l.textContent="Reload page",D(i,"class","svelte-mxbg52"),D(l,"class","svelte-mxbg52"),D(r,"class","reload-dialog svelte-mxbg52"),D(n,"class","container svelte-mxbg52")},m(t,u){S(t,n,u),x(n,r),x(r,i),x(r,o),x(r,l),a||(s=R(l,"click",e[0]),a=!0)},p:t,i:t,o:t,d(e){e&&T(n),a=!1,s()}}}function Vl(e){return[()=>{location.reload()}]}class Ll extends Se{constructor(e){super(),_e(this,e,Vl,Ol,a,{})}}function Nl(e){let t,n;return t=new Ll({}),{c(){ye(t.$$.fragment)},m(e,r){$e(t,e,r),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){xe(t,e)}}}function Fl(e){let t,n,r,i,o,l,a=e[0].showReloadDialog&&Nl();return r=new zl({}),o=new mt({}),{c(){a&&a.c(),t=A(),n=M("div"),ye(r.$$.fragment),i=A(),ye(o.$$.fragment),D(n,"class","application svelte-1qeorvx")},m(e,s){a&&a.m(e,s),S(e,t,s),S(e,n,s),$e(r,n,null),S(e,i,s),$e(o,e,s),l=!0},p(e,[n]){e[0].showReloadDialog?a?1&n&&ge(a,1):(a=Nl(),a.c(),ge(a,1),a.m(t.parentNode,t)):a&&(fe(),ve(a,1,1,(()=>{a=null})),pe())},i(e){l||(ge(a),ge(r.$$.fragment,e),ge(o.$$.fragment,e),l=!0)},o(e){ve(a),ve(r.$$.fragment,e),ve(o.$$.fragment,e),l=!1},d(e){a&&a.d(e),e&&T(t),e&&T(n),xe(r),e&&T(i),xe(o,e)}}}function jl(e,t,n){let r;u(e,ar,(e=>n(0,r=e)));let{locale:i}=t;return console.log("llocale",i),ar.update((e=>{e.locale=i})),e.$$set=e=>{"locale"in e&&n(1,i=e.locale)},[r,i]}Et("en",{"page.weave_settings.title":"Weave settings","page.weave_settings.shaft_count":"Number of shafts","page.weave_settings.treadle_count":"Number of treadles","page.weave_settings.warp_count":"Number of warp threads","page.weave_settings.weft_count":"Number of weft threads","page.yarn_settings.title":"Yarn settings","page.yarn_settings.name":"Name","page.pattern_fill.title":"Threading or treadle order fill","page.pattern_fill.mirrored_repeat":"Mirrored repetition","page.pattern_fill.warp_weft_title":"Threading/treadling","page.pattern_fill.color_title":"Warp/weft colors","page.pattern_fill.apply":"Apply","page.repetition.title":"Warp/weft repetition","page.selection.to":"To","page.selection.from":"From","page.selection.title":"Selection","page.selection.applyRepetition":"Apply repetition","page.selection.fillAll":"Fill entire draft","page.tools.title":"Tools","toolbar.showThreading":"Show threading","toolbar.showTreadleOrder":"Show treadle order","terms.warp":"Warp","terms.weft":"Weft","terms.treadleOrder":"Treadling","terms.threading":"Threading","terms.treadles":"Treadles","terms.heddle":"Heddle","terms.color":"Color","terms.apply":"Apply","terms.save":"Save","terms.download":"Save to file","terms.upload":"Upload file","terms.paste":"Klistra in","terms.undo":"Undo","terms.redo":"Redo","terms.close":"Close"}),Et("sv",{"page.weave_settings.title":"Vävinställningar","page.weave_settings.shaft_count":"Skaft","page.weave_settings.treadle_count":"Trampor","page.weave_settings.warp_count":"Varptrådar","page.weave_settings.weft_count":"Inslag","page.yarn_settings.name":"Namn","page.yarn_settings.title":"Garn","page.pattern_fill.title":"Mönsterifyllning","page.pattern_fill.mirrored_repeat":"Spegelvänd upprepning","page.pattern_fill.warp_weft_title":"Trampor/solv","page.pattern_fill.color_title":"Färger","page.pattern_fill.apply":"Kör","page.repetition.title":"Varp eller inslagsordning","page.selection.to":"Till","page.selection.from":"Från","page.selection.title":"Kopiera/klistra","page.selection.applyRepetition":"Återupprepa markerat område","page.selection.fillAll":"Fyll i hela väven","page.tools.title":"Verktyg","toolbar.showThreading":"Visa solvning","toolbar.showTreadleOrder":"Visa trampordning","terms.warp":"Varp","terms.weft":"Inslag","terms.treadleOrder":"Trampordning","terms.threading":"Solvning","terms.treadles":"Trampor","terms.heddle":"Solv","terms.color":"Färg","terms.apply":"Spara","terms.save":"Spara","terms.download":"Spara till fil","terms.upload":"Ladda upp fil","terms.paste":"Paste","terms.undo":"Ångra","terms.redo":"Återgå","terms.close":"Stäng"});let Il="undefined"==typeof window?Bl||null:window.navigator.language||window.navigator.languages[0];var Bl;let Xl={};location.search.split(/\?|;/).filter((e=>e.length>0)).forEach((e=>{let t=e.split("=");Xl[t[0]]=t[1]})),void 0!==Xl.lang&&(Il=Xl.lang),function(e){const{formats:t,...n}=e,r=e.initialLocale||e.fallbackLocale,i=Ct();Object.assign(i,n,{initialLocale:r}),t&&("number"in t&&Object.assign(i.formats.number,t.number),"date"in t&&Object.assign(i.formats.date,t.date),"time"in t&&Object.assign(i.formats.time,t.time)),Vt.set(r)}({fallbackLocale:"en",initialLocale:Il}),function(){function e(t){if(!Wt(t))return t;if(Array.isArray(t))return t.map(e);if(Qt(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(en(t))return new Set(Array.from(t).map(e));var n=Object.create(Object.getPrototypeOf(t));for(var r in t)n[r]=e(t[r]);return Gt(t,Rn)&&(n[Rn]=t[Rn]),n}function t(t){return Ut(t)?e(t):t}var n="add";!function(e,t){Nn[e]||(Nn[e]=t)}("Patches",{$:function(t,r){return r.forEach((function(r){for(var i=r.path,o=r.op,l=t,a=0;a<i.length-1;a++){var s=Kt(l),u=i[a];0!==s&&1!==s||"__proto__"!==u&&"constructor"!==u||Ht(24),"function"==typeof l&&"prototype"===u&&Ht(24),"object"!=typeof(l=Jt(l,u))&&Ht(15,i.join("/"))}var c=Kt(l),d=e(r.value),h=i[i.length-1];switch(o){case"replace":switch(c){case 2:return l.set(h,d);case 3:Ht(16);default:return l[h]=d}case n:switch(c){case 1:return l.splice(h,0,d);case 2:return l.set(h,d);case 3:return l.add(d);default:return l[h]=d}case"remove":switch(c){case 1:return l.splice(h,1);case 2:return l.delete(h);case 3:return l.delete(r.value);default:return delete l[h]}default:Ht(17,o)}})),t},R:function(e,r,i,o){switch(e.i){case 0:case 4:case 2:return function(e,r,i,o){var l=e.t,a=e.o;qt(e.D,(function(e,s){var u=Jt(l,e),c=Jt(a,e),d=s?Gt(l,e)?"replace":n:"remove";if(u!==c||"replace"!==d){var h=r.concat(e);i.push("remove"===d?{op:d,path:h}:{op:d,path:h,value:c}),o.push(d===n?{op:"remove",path:h}:"remove"===d?{op:n,path:h,value:t(u)}:{op:"replace",path:h,value:t(u)})}}))}(e,r,i,o);case 5:case 1:return function(e,r,i,o){var l=e.t,a=e.D,s=e.o;if(s.length<l.length){var u=[s,l];l=u[0],s=u[1];var c=[o,i];i=c[0],o=c[1]}for(var d=0;d<l.length;d++)if(a[d]&&s[d]!==l[d]){var h=r.concat([d]);i.push({op:"replace",path:h,value:t(s[d])}),o.push({op:"replace",path:h,value:t(l[d])})}for(var f=l.length;f<s.length;f++){var p=r.concat([f]);i.push({op:n,path:p,value:t(s[f])})}l.length<s.length&&o.push({op:"replace",path:r.concat(["length"]),value:l.length})}(e,r,i,o);case 3:return function(e,t,r,i){var o=e.t,l=e.o,a=0;o.forEach((function(e){if(!l.has(e)){var o=t.concat([a]);r.push({op:"remove",path:o,value:e}),i.unshift({op:n,path:o,value:e})}a++})),a=0,l.forEach((function(e){if(!o.has(e)){var l=t.concat([a]);r.push({op:n,path:l,value:e}),i.unshift({op:"remove",path:l,value:e})}a++}))}(e,r,i,o)}},M:function(e,t,n,r){n.push({op:"replace",path:[],value:t}),r.push({op:"replace",path:[],value:e.t})}})}(),window.process={env:{NODE_ENV:"production"}},console.log("lol",Il);const Yl=new class extends Se{constructor(e){super(),_e(this,e,jl,Fl,a,{locale:1})}}({target:document.body,props:{locale:Il.split("-")[0]}});return window.tinycolor=e,Yl}();
//# sourceMappingURL=bundle.js.map
